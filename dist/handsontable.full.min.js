/*!
 * Copyright (c) Handsoncode sp. z o.o.
 * 
 * This Handsontable Pro is a commercial software distributed by Handsoncode sp. z o. o., a limited liability
 * company registered under the laws of Poland, with its registered office in Gdynia, Poland, at 96/98 Aleja ZwycieÌ¨stwa,
 * postal code 81-451, entered into the Entrepreneurs Register of the National Court Register under number 0000538651,
 * share capital: PLN 62,800.00., hereinafter referred to as "HANDSONCODE".
 * 
 * By installing, copying, or otherwise using this software, you agree to be bound by the terms
 * of its General Software License Terms ("Terms") outlined in a file "handsontable-pro-general-terms.pdf"
 * available in the main directory of the software repository.
 * This software is copyrighted and protected by copyright laws and international treaties.
 * 
 * You shall obtain a commercial license for this software at handsontable.com.
 * 
 * YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
 * IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
 * EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
 * RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
 * UNINTERRUPTED OR ERROR FREE.
 * 
 * Version: 1.15.0
 * Release date: 06/12/2017 (built at 06/12/2017 12:54:51)
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Handsontable",[],t):"object"==typeof exports?exports.Handsontable=t():e.Handsontable=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=343)}([function(e,t,n){"use strict";function r(e){for(var t=0,n=e.length;t<n;)e[t]=[e[t]],t++}function o(e,t){for(var n=0,r=t.length;n<r;)e.push(t[n]),n++}function i(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function a(e,t,n,r){var o=-1,i=e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function s(e,t){for(var n=-1,r=e.length,o=-1,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[++o]=a)}return i}function l(e,t){for(var n=-1,r=e.length,o=-1,i=[];++n<r;){var a=e[n];i[++o]=t(a,n,e)}return i}function u(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e}function c(e){return a(e,function(e,t){return e+t},0)}function f(e){return a(e,function(e,t){return e>t?e:t},Array.isArray(e)?e[0]:void 0)}function h(e){return a(e,function(e,t){return e<t?e:t},Array.isArray(e)?e[0]:void 0)}function d(e){return e.length?c(e)/e.length:0}function p(e){return a(e,function(e,t){return e.concat(Array.isArray(t)?p(t):t)},[])}function g(e){var t=[];return u(e,function(e){-1===t.indexOf(e)&&t.push(e)}),t}t.__esModule=!0,t.to2dArray=r,t.extendArray=o,t.pivot=i,t.arrayReduce=a,t.arrayFilter=s,t.arrayMap=l,t.arrayEach=u,t.arraySum=c,t.arrayMax=f,t.arrayMin=h,t.arrayAvg=d,t.arrayFlatten=p,t.arrayUnique=g},function(e,t,n){"use strict";function r(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null;null!=e;){if(n===t){r=e;break}e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e=e.host:(n++,e=e.parentNode)}return r}function o(e,t,n){for(;null!=e&&e!==n;){if(e.nodeType===Node.ELEMENT_NODE&&(t.indexOf(e.nodeName)>-1||t.indexOf(e)>-1))return e;e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return null}function i(e,t,n){for(var r=[];e&&(e=o(e,t,n))&&(!n||n.contains(e));)r.push(e),e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode;var i=r.length;return i?r[i-1]:null}function a(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);null!=n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function s(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===r.toUpperCase()}var n,r="hot-table",o=!1;for(n=l(e);null!=n;){if(t(n)){o=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o=t(n.host))break;n=n.host}n=n.parentNode}return o}function l(e){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(e):e}function u(e){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(e):e}function c(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t}function f(e,t){var n=document.querySelector(".ht_clone_"+e);return n?n.contains(t):null}function h(e){var t=0,n=[];if(!e||!e.length)return n;for(;e[t];)n.push(e[t]),t++;return n}function d(e,t){return K(e,t)}function p(e,t){return q(e,t)}function g(e,t){return Q(e,t)}function v(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,r=n.length-1;r>=0;r--)v(n[r],e)}function m(e){for(var t;t=e.lastChild;)e.removeChild(t)}function y(e,t){oe.test(t)?e.innerHTML=t:w(e,t)}function w(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?ie?n.textContent=t:n.data=t:(m(e),e.appendChild(document.createTextNode(t)))}function b(e){for(var t=e;u(t)!==document.documentElement;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return b(t.host.impl);if(t.host)return b(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0}function C(e){var t,n,r,o,i;if(o=document.documentElement,(0,J.hasCaptionProblem)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName)return i=e.getBoundingClientRect(),{top:i.top+(window.pageYOffset||o.scrollTop)-(o.clientTop||0),left:i.left+(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0)};for(t=e.offsetLeft,n=e.offsetTop,r=e;(e=e.offsetParent)&&e!==document.body;)t+=e.offsetLeft,n+=e.offsetTop,r=e;return r&&"fixed"===r.style.position&&(t+=window.pageXOffset||o.scrollLeft,n+=window.pageYOffset||o.scrollTop),{left:t,top:n}}function E(){var e=window.scrollY;return void 0===e&&(e=document.documentElement.scrollTop),e}function O(){var e=window.scrollX;return void 0===e&&(e=document.documentElement.scrollLeft),e}function _(e){return e===window?E():e.scrollTop}function S(e){return e===window?O():e.scrollLeft}function T(e){for(var t,n,r,o=e.parentNode,i=["auto","scroll"],a="",s="",l="",u="";o&&o.style&&document.body!==o;){if(t=o.style.overflow,n=o.style.overflowX,r=o.style.overflowY,"scroll"==t||"scroll"==n||"scroll"==r)return o;if(window.getComputedStyle&&(a=window.getComputedStyle(o),s=a.getPropertyValue("overflow"),l=a.getPropertyValue("overflow-y"),u=a.getPropertyValue("overflow-x"),"scroll"===s||"scroll"===u||"scroll"===l))return o;if(o.clientHeight<=o.scrollHeight+1&&(-1!==i.indexOf(r)||-1!==i.indexOf(t)||-1!==i.indexOf(s)||-1!==i.indexOf(l)))return o;if(o.clientWidth<=o.scrollWidth+1&&(-1!==i.indexOf(n)||-1!==i.indexOf(t)||-1!==i.indexOf(s)||-1!==i.indexOf(u)))return o;o=o.parentNode}return window}function R(e){for(var t=e.parentNode;t&&t.style&&document.body!==t;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(window.getComputedStyle){var n=window.getComputedStyle(t);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return t}t=t.parentNode}return window}function M(e,t){if(e){if(e!==window){var n,r=e.style[t];return""!==r&&void 0!==r?r:(n=N(e),""!==n[t]&&void 0!==n[t]?n[t]:void 0)}if("width"===t)return window.innerWidth+"px";if("height"===t)return window.innerHeight+"px"}}function N(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function k(e){return e.offsetWidth}function A(e){return(0,J.hasCaptionProblem)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function I(e){return e.clientHeight||e.innerHeight}function D(e){return e.clientWidth||e.innerWidth}function P(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function x(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function L(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),r=n.duplicate();return n.moveToBookmark(t.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}return 0}function H(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;return e.createTextRange().text.indexOf(t.text)+t.text.length}return 0}function j(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}function V(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}}function F(){var e=document.createElement("div");e.style.height="200px",e.style.width="100%";var t=document.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;return n==r&&(r=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-r}function B(){return void 0===re&&(re=F()),re}function U(e){return e.offsetWidth!==e.clientWidth}function W(e){return e.offsetHeight!==e.clientHeight}function Y(e,t,n){(0,Z.isIE8)()||(0,Z.isIE9)()?(e.style.top=n,e.style.left=t):(0,Z.isSafari)()?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)"}function $(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function G(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function z(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function X(e){return z(e)&&-1==e.className.indexOf("handsontableInput")&&-1==e.className.indexOf("copyPaste")}t.__esModule=!0,t.HTML_CHARACTERS=void 0,t.getParent=r,t.closest=o,t.closestDown=i,t.isChildOf=a,t.isChildOfWebComponentTable=s,t.polymerWrap=l,t.polymerUnwrap=u,t.index=c,t.overlayContainsElement=f,t.hasClass=d,t.addClass=p,t.removeClass=g,t.removeTextNodes=v,t.empty=m,t.fastInnerHTML=y,t.fastInnerText=w,t.isVisible=b,t.offset=C,t.getWindowScrollTop=E,t.getWindowScrollLeft=O,t.getScrollTop=_,t.getScrollLeft=S,t.getScrollableElement=T,t.getTrimmingContainer=R,t.getStyle=M,t.getComputedStyle=N,t.outerWidth=k,t.outerHeight=A,t.innerHeight=I,t.innerWidth=D,t.addEvent=P,t.removeEvent=x,t.getCaretPosition=L,t.getSelectionEndPosition=H,t.getSelectionText=j,t.setCaretPosition=V,t.getScrollbarWidth=B,t.hasVerticalScrollbar=U,t.hasHorizontalScrollbar=W,t.setOverlayPosition=Y,t.getCssTransform=$,t.resetCssTransform=G,t.isInput=z,t.isOutsideInput=X;var K,q,Q,Z=n(33),J=n(42),ee=!!document.documentElement.classList;if(ee){var te=function(){var e=document.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")}();K=function(e,t){return void 0!==e.classList&&""!==t&&e.classList.contains(t)},q=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),te)e.classList.add.apply(e.classList,t);else for(;t&&t[n];)e.classList.add(t[n]),n++},Q=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),te)e.classList.remove.apply(e.classList,t);else for(;t&&t[n];)e.classList.remove(t[n]),n++}}else{var ne=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")};K=function(e,t){return void 0!==e.className&&ne(t).test(e.className)},q=function(e,t){var n=0,r=e.className;if("string"==typeof t&&(t=t.split(" ")),""===r)r=t.join(" ");else for(;t&&t[n];)ne(t[n]).test(r)||(r+=" "+t[n]),n++;e.className=r},Q=function(e,t){var n=0,r=e.className;for("string"==typeof t&&(t=t.split(" "));t&&t[n];)r=r.replace(ne(t[n])," ").trim(),n++;e.className!==r&&(e.className=r)}}var re,oe=t.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,ie=!!document.createTextNode("test").textContent},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var t;return Array.isArray(e)?t=[]:(t={},p(e,function(e,n){"__children"!==n&&(t[n]=e&&"object"===(void 0===e?"undefined":w(e))&&!Array.isArray(e)?o(e):Array.isArray(e)?e.length&&"object"===w(e[0])&&!Array.isArray(e[0])?[o(e[0])]:[]:null)})),t}function i(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function a(e,t){return p(t,function(t,n){e[n]=t}),e}function s(e,t){p(t,function(n,r){t[r]&&"object"===w(t[r])?(e[r]||(e[r]=Array.isArray(t[r])?[]:"[object Date]"===Object.prototype.toString.call(t[r])?t[r]:{}),s(e[r],t[r])):e[r]=t[r]})}function l(e){return"object"===(void 0===e?"undefined":w(e))?JSON.parse(JSON.stringify(e)):e}function u(e){var t={};return p(e,function(e,n){t[n]=e}),t}function c(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(0,b.arrayEach)(n,function(t){e.MIXINS.push(t.MIXIN_NAME),p(t,function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '"+n+"' already exist and cannot be overwritten.");if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:function(e,t){e="_"+e;var n=function(e){return(Array.isArray(e)||h(e))&&(e=l(e)),e};return function(){return void 0===this[e]&&(this[e]=n(t)),this[e]}}(n,t),set:function(e){return e="_"+e,function(t){this[e]=t}}(n),configurable:!0})}})}),e}function f(e,t){return JSON.stringify(e)===JSON.stringify(t)}function h(e){return"[object Object]"==Object.prototype.toString.call(e)}function d(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function p(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function g(e,t){var n=t.split("."),r=e;return p(n,function(e){if(void 0===(r=r[e]))return r=void 0,!1}),r}function v(e){if(!h(e))return 0;return function e(t){var n=0;return h(t)?p(t,function(t){n+=e(t)}):n++,n}(e)}function m(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",o="_"+n,i=(t={_touched:!1},r(t,o,e),r(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,n,{get:function(){return this[o]},set:function(e){this._touched=!0,this[o]=e},enumerable:!0,configurable:!0}),i}function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.__esModule=!0;var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.duckSchema=o,t.inherit=i,t.extend=a,t.deepExtend=s,t.deepClone=l,t.clone=u,t.mixin=c,t.isObjectEquals=f,t.isObject=h,t.defineGetter=d,t.objectEach=p,t.getProperty=g,t.deepObjectSize=v,t.createObjectPropListener=m,t.hasOwnProperty=y;var b=n(0)},function(e,t,n){"use strict";t.__esModule=!0;var r=t.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",o=(t.CONTEXTMENU_ITEMS_ROW_ABOVE=r+".insertRowAbove",t.CONTEXTMENU_ITEMS_ROW_BELOW=r+".insertRowBelow",t.CONTEXTMENU_ITEMS_INSERT_LEFT=r+".insertColumnOnTheLeft",t.CONTEXTMENU_ITEMS_INSERT_RIGHT=r+".insertColumnOnTheRight",t.CONTEXTMENU_ITEMS_REMOVE_ROW=r+".removeRow",t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=r+".removeColumn",t.CONTEXTMENU_ITEMS_UNDO=r+".undo",t.CONTEXTMENU_ITEMS_REDO=r+".redo",t.CONTEXTMENU_ITEMS_READ_ONLY=r+".readOnly",t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=r+".clearColumn",t.CONTEXTMENU_ITEMS_COPY=r+".copy",t.CONTEXTMENU_ITEMS_CUT=r+".cut",t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=r+".freezeColumn",t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=r+".unfreezeColumn",t.CONTEXTMENU_ITEMS_MERGE_CELLS=r+".mergeCells",t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=r+".unmergeCells",t.CONTEXTMENU_ITEMS_ADD_COMMENT=r+".addComment",t.CONTEXTMENU_ITEMS_EDIT_COMMENT=r+".editComment",t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=r+".removeComment",t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=r+".readOnlyComment",t.CONTEXTMENU_ITEMS_ALIGNMENT=r+".align",t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=r+".align.left",t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=r+".align.center",t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=r+".align.right",t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=r+".align.justify",t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=r+".align.top",t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=r+".align.middle",t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=r+".align.bottom",t.CONTEXTMENU_ITEMS_BORDERS=r+".borders",t.CONTEXTMENU_ITEMS_BORDERS_TOP=r+".borders.top",t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=r+".borders.right",t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=r+".borders.bottom",t.CONTEXTMENU_ITEMS_BORDERS_LEFT=r+".borders.left",t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=r+".borders.remove",t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=r+".nestedHeaders.insertChildRow",t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=r+".nestedHeaders.detachFromParent",t.CONTEXTMENU_ITEMS_HIDE_COLUMN=r+".hideColumn",t.CONTEXTMENU_ITEMS_SHOW_COLUMN=r+".showColumn",t.CONTEXTMENU_ITEMS_HIDE_ROW=r+".hideRow",t.CONTEXTMENU_ITEMS_SHOW_ROW=r+".showRow",t.FILTERS_NAMESPACE="Filters:"),i=t.FILTERS_CONDITIONS_NAMESPACE=o+"conditions";t.FILTERS_CONDITIONS_NONE=i+".none",t.FILTERS_CONDITIONS_EMPTY=i+".isEmpty",t.FILTERS_CONDITIONS_NOT_EMPTY=i+".isNotEmpty",t.FILTERS_CONDITIONS_EQUAL=i+".isEqualTo",t.FILTERS_CONDITIONS_NOT_EQUAL=i+".isNotEqualTo",t.FILTERS_CONDITIONS_BEGINS_WITH=i+".beginsWith",t.FILTERS_CONDITIONS_ENDS_WITH=i+".endsWith",t.FILTERS_CONDITIONS_CONTAINS=i+".contains",t.FILTERS_CONDITIONS_NOT_CONTAIN=i+".doesNotContain",t.FILTERS_CONDITIONS_BY_VALUE=i+".byValue",t.FILTERS_CONDITIONS_GREATER_THAN=i+".greaterThan",t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=i+".greaterThanOrEqualTo",t.FILTERS_CONDITIONS_LESS_THAN=i+".lessThan",t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=i+".lessThanOrEqualTo",t.FILTERS_CONDITIONS_BETWEEN=i+".isBetween",t.FILTERS_CONDITIONS_NOT_BETWEEN=i+".isNotBetween",t.FILTERS_CONDITIONS_AFTER=i+".after",t.FILTERS_CONDITIONS_BEFORE=i+".before",t.FILTERS_CONDITIONS_TODAY=i+".today",t.FILTERS_CONDITIONS_TOMORROW=i+".tomorrow",t.FILTERS_CONDITIONS_YESTERDAY=i+".yesterday",t.FILTERS_DIVS_FILTER_BY_CONDITION=o+"labels.filterByCondition",t.FILTERS_DIVS_FILTER_BY_VALUE=o+"labels.filterByValue",t.FILTERS_LABELS_CONJUNCTION=o+"labels.conjunction",t.FILTERS_LABELS_DISJUNCTION=o+"labels.disjunction",t.FILTERS_VALUES_BLANK_CELLS=o+"values.blankCells",t.FILTERS_BUTTONS_SELECT_ALL=o+"buttons.selectAll",t.FILTERS_BUTTONS_CLEAR=o+"buttons.clear",t.FILTERS_BUTTONS_OK=o+"buttons.ok",t.FILTERS_BUTTONS_CANCEL=o+"buttons.cancel",t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=o+"buttons.placeholder.search",t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=o+"buttons.placeholder.value",t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=o+"buttons.placeholder.secondValue"},function(e,t,n){"use strict";function r(e){var t=void 0===e?"undefined":s(e);return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function o(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function i(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function a(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100,10)}t.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isNumeric=r,t.rangeEach=o,t.rangeEachReverse=i,t.valueAccordingPercent=a},function(e,t,n){var r=n(17),o=n(48),i=n(38),a=n(37),s=n(39),l=function(e,t,n){var u,c,f,h,d=e&l.F,p=e&l.G,g=e&l.S,v=e&l.P,m=e&l.B,y=p?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,w=p?o:o[t]||(o[t]={}),b=w.prototype||(w.prototype={});p&&(n=t);for(u in n)c=!d&&y&&void 0!==y[u],f=(c?y:n)[u],h=m&&c?s(f,r):v&&"function"==typeof f?s(Function.call,f):f,y&&a(y,u,f,e&l.U),w[u]!=f&&i(w,u,h),v&&b[u]!=f&&(b[u]=f)};r.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";function r(e,t){e=(0,c.toUpperCaseFirst)(e),l.default.getSingleton().add("construct",function(){var n=void 0;f.has(this)||f.set(this,{}),n=f.get(this),n[e]||(n[e]=new t(this))}),l.default.getSingleton().add("afterDestroy",function(){if(f.has(this)){var e=f.get(this);(0,u.objectEach)(e,function(e){return e.destroy()}),f.delete(this)}})}function o(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=(0,c.toUpperCaseFirst)(t);if(f.has(e)&&f.get(e)[n])return f.get(e)[n]}function i(e){return f.has(e)?Object.keys(f.get(e)):[]}function a(e,t){var n=null;return f.has(e)&&(0,u.objectEach)(f.get(e),function(e,r){e===t&&(n=r)}),n}t.__esModule=!0,t.getPluginName=t.getRegistredPluginNames=t.getPlugin=t.registerPlugin=void 0;var s=n(12),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(2),c=n(30),f=new WeakMap;t.registerPlugin=r,t.getPlugin=o,t.getRegistredPluginNames=i,t.getPluginName=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=void 0,r=void 0,o=void 0,i=void 0,a=void 0,f=void 0;if(t.isTargetWebComponent=!1,t.realTarget=t.target,f=t.stopImmediatePropagation,t.stopImmediatePropagation=function(){f.apply(this),(0,c.stopImmediatePropagation)(this)},!h.isHotTableEnv)return t;for(t=(0,s.polymerWrap)(t),a=t.path?t.path.length:0;a--;){if("HOT-TABLE"===t.path[a].nodeName)n=!0;else if(n&&t.path[a].shadowRoot){i=t.path[a];break}0!==a||i||(i=t.path[a])}return i||(i=t.target),t.isTargetWebComponent=!0,(0,u.isWebComponentSupportedNatively)()?t.realTarget=t.srcElement||t.toElement:((0,l.hasOwnProperty)(e,"hot")||e.isHotTableEnv||e.wtTable)&&((0,l.hasOwnProperty)(e,"hot")?r=e.hot?e.hot.view.wt.wtTable.TABLE:null:e.isHotTableEnv?r=e.view.activeWt.wtTable.TABLE.parentNode.parentNode:e.wtTable&&(r=e.wtTable.TABLE.parentNode.parentNode),o=(0,s.closest)(t.target,["HOT-TABLE"],r),t.realTarget=o?r.querySelector("HOT-TABLE")||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return(0,s.polymerWrap)(i)},enumerable:!0,configurable:!0}),t}function i(){return f}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getListenersCounter=i;var s=n(1),l=n(2),u=n(42),c=n(10),f=0,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return a(e,[{key:"addEventListener",value:function(e,t,n){function r(e){e=o(a,e),n.call(this,e)}var i=this,a=this.context;return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:r}),window.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r),f++,function(){i.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var r=this.context.eventListeners.length,o=void 0;r--;)if(o=this.context.eventListeners[r],o.event==t&&o.element==e){if(n&&n!=o.callback)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener?o.element.removeEventListener(o.event,o.callbackProxy,!1):o.element.detachEvent("on"+o.event,o.callbackProxy),f--}}},{key:"clearEvents",value:function(){if(this.context)for(var e=this.context.eventListeners.length;e--;){var t=this.context.eventListeners[e];t&&this.removeEventListener(t.element,t.event,t.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(e,t){var n,r={bubbles:!0,cancelable:"mousemove"!==t,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||document.body.parentNode)):n=document.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}}]),e}();t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(0),s=n(53),l=n(6),u=new WeakMap,c=null;t.default=function(){function e(t){var n=this;r(this,e),(0,i.defineGetter)(this,"hot",t,{writable:!1}),(0,i.defineGetter)(this,"t",(0,s.getTranslator)(t),{writable:!1}),u.set(this,{hooks:{}}),c=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return n.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return n.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return n.init()})}return o(e,[{key:"init",value:function(){this.pluginName=(0,l.getPluginName)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),c||(c=(0,l.getRegistredPluginNames)(this.hot)),c.indexOf(this.pluginName)>=0&&c.splice(c.indexOf(this.pluginName),1),c.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){u.get(this).hooks[e]=u.get(this).hooks[e]||[];var n=u.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),u.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;(0,a.arrayEach)(u.get(this).hooks[e]||[],function(n){t.hot.removeHook(e,n)})}},{key:"clearHooks",value:function(){var e=this,t=u.get(this).hooks;(0,i.objectEach)(t,function(t,n){return e.removeHooks(n)}),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){(0,a.arrayEach)(this.pluginsInitializedCallbacks,function(e){return e()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,i.objectEach)(this,function(t,n){"hot"!==n&&"t"!==n&&(e[n]=null)}),delete this.t,delete this.hot}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!a[e])throw Error('Filter condition "'+e+'" does not exist.');var n=a[e],r=n.condition,o=n.descriptor;return o.inputValuesDecorator&&(t=o.inputValuesDecorator(t)),function(e){return r.apply(e.meta.instance,[].concat([e],[t]))}}function o(e){if(!a[e])throw Error('Filter condition "'+e+'" does not exist.');return a[e].descriptor}function i(e,t,n){n.key=e,a[e]={condition:t,descriptor:n}}t.__esModule=!0,t.getCondition=r,t.getConditionDescriptor=o,t.registerCondition=i;var a=t.conditions={}},function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function i(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function a(e){return e.pageX?e.pageX:e.clientX+(0,c.getWindowScrollLeft)()}function s(e){return e.pageY?e.pageY:e.clientY+(0,c.getWindowScrollTop)()}function l(e){return 2===e.button}function u(e){return 0===e.button}t.__esModule=!0,t.stopImmediatePropagation=r,t.isImmediatePropagationStopped=o,t.stopPropagation=i,t.pageX=a,t.pageY=s,t.isRightClick=l,t.isLeftClick=u;var c=n(1)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=n(2),s=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","afterListen","afterUnlisten"],l=function(){function e(){r(this,e),this.globalBucket=this.createEmptyBucket()}return o(e,null,[{key:"getSingleton",value:function(){return u}}]),o(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return(0,i.arrayEach)(s,function(t){return e[t]=[]}),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))(0,i.arrayEach)(t,function(t){return n.add(e,t,r)});else{var o=this.getBucket(r);if(void 0===o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){var a=!1;t.initialHook&&(0,i.arrayEach)(o[e],function(n,r){if(n.initialHook)return o[e][r]=t,a=!0,!1}),a||o[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?(0,i.arrayEach)(t,function(t){return n.once(e,t,r)}):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,s){var l=this.globalBucket[t],u=-1,c=l?l.length:0;if(c)for(;++u<c;)if(l[u]&&!l[u].skip){var f=l[u].call(e,n,r,o,i,a,s);void 0!==f&&(n=f),l[u]&&l[u].runOnce&&this.remove(t,l[u])}var h=this.getBucket(e)[t],d=-1,p=h?h.length:0;if(p)for(;++d<p;)if(h[d]&&!h[d].skip){var g=h[d].call(e,n,r,o,i,a,s);void 0!==g&&(n=g),h[d]&&h[d].runOnce&&this.remove(t,h[d],e)}return n}},{key:"destroy",value:function(){(0,a.objectEach)(this.getBucket(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),function(e,t,n){return n[t].length=0})}},{key:"register",value:function(e){this.isRegistered(e)||s.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&s.splice(s.indexOf(e),1)}},{key:"isRegistered",value:function(e){return s.indexOf(e)>=0}},{key:"getRegistered",value:function(){return s}}]),e}(),u=new l;t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if("function"==typeof e)return e;if(!_(e))throw Error('No registered renderer found under "'+e+'" name');return O(e)}t.__esModule=!0,t.getRegisteredRenderers=t.getRegisteredRendererNames=t.hasRenderer=t.getRenderer=t.registerRenderer=void 0;var i=n(51),a=r(i),s=n(384),l=r(s),u=n(385),c=r(u),f=n(386),h=r(f),d=n(387),p=r(d),g=n(388),v=r(g),m=n(389),y=r(m),w=n(390),b=r(w),C=(0,a.default)("renderers"),E=C.register,O=C.getItem,_=C.hasItem,S=C.getNames,T=C.getValues;E("base",l.default),E("autocomplete",c.default),E("checkbox",h.default),E("html",p.default),E("numeric",v.default),E("password",y.default),E("text",b.default),t.registerRenderer=E,t.getRenderer=o,t.hasRenderer=_,t.getRegisteredRendererNames=S,t.getRegisteredRenderers=T},function(e,t,n){var r=n(91)("wks"),o=n(55),i=n(17).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.Viewport=t.TableRenderer=t.Table=t.Settings=t.Selection=t.Scroll=t.Overlays=t.Event=t.Core=t.default=t.Border=t.TopLeftCornerOverlay=t.TopOverlay=t.LeftOverlay=t.DebugOverlay=t.RowFilter=t.ColumnFilter=t.CellRange=t.CellCoords=t.ViewportRowsCalculator=t.ViewportColumnsCalculator=void 0,n(85),n(94),n(95),n(96),n(97),n(99),n(101),n(102),n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(131),n(132),n(133),n(134),n(135),n(80),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150);var o=n(187),i=r(o),a=n(188),s=r(a),l=n(60),u=r(l),c=n(151),f=r(c),h=n(189),d=r(h),p=n(190),g=r(p),v=n(366),m=r(v),y=n(369),w=r(y),b=n(370),C=r(b),E=n(371),O=r(E),_=n(314),S=r(_),T=n(191),R=r(T),M=n(307),N=r(M),k=n(308),A=r(k),I=n(309),D=r(I),P=n(372),x=r(P),L=n(310),H=r(L),j=n(311),V=r(j),F=n(312),B=r(F),U=n(313),W=r(U);t.ViewportColumnsCalculator=i.default,t.ViewportRowsCalculator=s.default,t.CellCoords=u.default,t.CellRange=f.default,t.ColumnFilter=d.default,t.RowFilter=g.default,t.DebugOverlay=m.default,t.LeftOverlay=w.default,t.TopOverlay=C.default,t.TopLeftCornerOverlay=O.default,t.Border=S.default,t.default=R.default,t.Core=R.default,t.Event=N.default,t.Overlays=A.default,t.Scroll=D.default,t.Selection=x.default,t.Settings=H.default,t.Table=V.default,t.TableRenderer=B.default,t.Viewport=W.default},function(e,t,n){"use strict";function r(e){var t=void 0;switch(void 0===e?"undefined":c(e)){case"string":case"number":t=""+e;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function o(e){return void 0!==e}function i(e){return void 0===e}function a(e){return null===e||""===e||i(e)}function s(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function l(e,t){e=b(e||"");var n="",r=!0,o=u(e),i=E(),s=a(e)||"trial"===e;if(s||o)if(o){var l=Math.floor((0,d.default)("06/12/2017","DD/MM/YYYY").toDate().getTime()/864e5),c=C(e);(c>45e3||c!==parseInt(c,10))&&(n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly."),n||(l>c+1&&(n=(0,p.toSingleLine)(f)),r=l>c+15)}else n="Evaluation version of Handsontable Pro. Not licensed for use in a production environment.";else n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.";if(i&&(n=!1,r=!1),n&&!O&&(console[s?"info":"warn"](n),O=!0),r&&t.parentNode){var h=document.createElement("div");h.id="hot-display-license-info",h.appendChild(document.createTextNode("Evaluation version of Handsontable Pro.")),h.appendChild(document.createElement("br")),h.appendChild(document.createTextNode("Not licensed for production use.")),t.parentNode.insertBefore(h,t.nextSibling)}}function u(e){var t=[][g],n=t;if(e[g]!==w("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=w(o.shift());i;i=w(o.shift()||"A"))--i<""[g]?n|=(m(""+m(v(r)+(v(y(e,Math.abs(i),2))+[]).padStart(2,"0")))%97||2)>>1:r=y(e,i,i?1===o[g]?9:8:6);return n===t}t.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n          Your license key of Handsontable Pro has expired.ââââ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],["\n          Your license key of Handsontable Pro has expired.ââââ\\x20\n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "]);t.stringify=r,t.isDefined=o,t.isUndefined=i,t.isEmpty=a,t.isRegExp=s,t._injectProductInfo=l;var h=n(21),d=function(e){return e&&e.__esModule?e:{default:e}}(h),p=n(61),g="length",v=function(e){return parseInt(e,16)},m=function(e){return parseInt(e,10)},y=function(e,t,n){return e.substr(t,n)},w=function(e){return e.codePointAt(0)-65},b=function(e){return(""+e).replace(/\-/g,"")},C=function(e){return v(y(b(e),v("12"),w("F")))/(v(y(b(e),w("B"),~~![][g]))||9)},E=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},O=!1},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";function r(e){return 32==e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function o(e){return-1!==[l.ARROW_DOWN,l.ARROW_UP,l.ARROW_LEFT,l.ARROW_RIGHT,l.HOME,l.END,l.DELETE,l.BACKSPACE,l.F1,l.F2,l.F3,l.F4,l.F5,l.F6,l.F7,l.F8,l.F9,l.F10,l.F11,l.F12,l.TAB,l.PAGE_DOWN,l.PAGE_UP,l.ENTER,l.ESCAPE,l.SHIFT,l.CAPS_LOCK,l.ALT].indexOf(e)}function i(e){return-1!==[l.CONTROL_LEFT,224,l.COMMAND_LEFT,l.COMMAND_RIGHT].indexOf(e)}function a(e,t){var n=t.split("|"),r=!1;return(0,s.arrayEach)(n,function(t){if(e===l[t])return r=!0,!1}),r}t.__esModule=!0,t.KEY_CODES=void 0,t.isPrintableChar=r,t.isMetaKey=o,t.isCtrlKey=i,t.isKey=a;var s=n(0),l=t.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},f.default.getSingleton().add("afterDestroy",function(){t={}})}function i(e,t){var n=void 0;if("function"==typeof e)P.get(e)||s(null,e),n=P.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=H(e)}if(!n)throw Error('No editor registered under name "'+e+'"');return n.getInstance(t)}function a(e){if(!j(e))throw Error('No registered editor found under "'+e+'" name');return H(e).getConstructor()}function s(e,t){var n=new o(t);"string"==typeof e&&L(e,n),P.set(t,n)}t.__esModule=!0,t.getRegisteredEditors=t.getRegisteredEditorNames=t.hasEditor=t.getEditorInstance=t.getEditor=t.registerEditor=void 0,t.RegisteredEditor=o,t._getEditorInstance=i;var l=n(51),u=r(l),c=n(12),f=r(c),h=n(52),d=r(h),p=n(315),g=r(p),v=n(374),m=r(v),y=n(375),w=r(y),b=n(378),C=r(b),E=n(316),O=r(E),_=n(379),S=r(_),T=n(380),R=r(T),M=n(382),N=r(M),k=n(383),A=r(k),I=n(62),D=r(I),P=new WeakMap,x=(0,u.default)("editors"),L=x.register,H=x.getItem,j=x.hasItem,V=x.getNames,F=x.getValues;s("base",d.default),s("autocomplete",g.default),s("checkbox",m.default),s("date",w.default),s("dropdown",C.default),s("handsontable",O.default),s("mobile",S.default),s("numeric",R.default),s("password",N.default),s("select",A.default),s("text",D.default),t.registerEditor=s,t.getEditor=a,t.getEditorInstance=i,t.hasEditor=j,t.getRegisteredEditorNames=V,t.getRegisteredEditors=F},function(e,t,n){var r=n(11);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){(function(e){!function(t,n){e.exports=n()}(0,function(){"use strict";function t(){return br.apply(null,arguments)}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function i(e){var t;for(t in e)return!1;return!0}function a(e){return void 0===e}function s(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function l(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){for(var n in t)c(t,n)&&(e[n]=t[n]);return c(t,"toString")&&(e.toString=t.toString),c(t,"valueOf")&&(e.valueOf=t.valueOf),e}function h(e,t,n,r){return wt(e,t,n,r,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function p(e){return null==e._pf&&(e._pf=d()),e._pf}function g(e){if(null==e._isValid){var t=p(e),n=Er.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function v(e){var t=h(NaN);return null!=e?f(p(t),e):p(t).userInvalidated=!0,t}function m(e,t){var n,r,o;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=p(t)),a(t._locale)||(e._locale=t._locale),Or.length>0)for(n=0;n<Or.length;n++)r=Or[n],o=t[r],a(o)||(e[r]=o);return e}function y(e){m(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===_r&&(_r=!0,t.updateOffset(this),_r=!1)}function w(e){return e instanceof y||null!=e&&null!=e._isAMomentObject}function b(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function C(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=b(t)),n}function E(e,t,n){var r,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(r=0;r<o;r++)(n&&e[r]!==t[r]||!n&&C(e[r])!==C(t[r]))&&a++;return a+i}function O(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function _(e,n){var r=!0;return f(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),r){for(var o,i=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){o+="\n["+a+"] ";for(var s in arguments[0])o+=s+": "+arguments[0][s]+", ";o=o.slice(0,-2)}else o=arguments[a];i.push(o)}O(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function S(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),Sr[e]||(O(n),Sr[e]=!0)}function T(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function R(e){var t,n;for(n in e)t=e[n],T(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(e,t){var n,r=f({},e);for(n in t)c(t,n)&&(o(e[n])&&o(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)c(e,n)&&!c(t,n)&&o(e[n])&&(r[n]=f({},r[n]));return r}function N(e){null!=e&&this.set(e)}function k(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return T(r)?r.call(t,n):r}function A(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)})}function I(){return this._invalidDate}function D(e){return this._ordinal.replace("%d",e)}function P(e,t,n,r){var o=this._relativeTime[n];return T(o)?o(e,t,n,r):o.replace(/%d/i,e)}function x(e,t){var n=this._relativeTime[e>0?"future":"past"];return T(n)?n(t):n.replace(/%s/i,t)}function L(e,t){var n=e.toLowerCase();Dr[n]=Dr[n+"s"]=Dr[t]=e}function H(e){return"string"==typeof e?Dr[e]||Dr[e.toLowerCase()]:void 0}function j(e){var t,n,r={};for(n in e)c(e,n)&&(t=H(n))&&(r[t]=e[n]);return r}function V(e,t){Pr[e]=t}function F(e){var t=[];for(var n in e)t.push({unit:n,priority:Pr[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function B(e,n){return function(r){return null!=r?(W(this,e,r),t.updateOffset(this,n),this):U(this,e)}}function U(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function W(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function Y(e){return e=H(e),T(this[e])?this[e]():this}function $(e,t){if("object"==typeof e){e=j(e);for(var n=F(e),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit])}else if(e=H(e),T(this[e]))return this[e](t);return this}function G(e,t,n){var r=""+Math.abs(e),o=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}function z(e,t,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),e&&(jr[e]=o),t&&(jr[t[0]]=function(){return G(o.apply(this,arguments),t[1],t[2])}),n&&(jr[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function X(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function K(e){var t,n,r=e.match(xr);for(t=0,n=r.length;t<n;t++)r[t]=jr[r[t]]?jr[r[t]]:X(r[t]);return function(t){var o,i="";for(o=0;o<n;o++)i+=T(r[o])?r[o].call(t,e):r[o];return i}}function q(e,t){return e.isValid()?(t=Q(t,e.localeData()),(Hr[t]=Hr[t]||K(t))(e)):e.localeData().invalidDate()}function Q(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Lr.lastIndex=0;r>=0&&Lr.test(e);)e=e.replace(Lr,n),Lr.lastIndex=0,r-=1;return e}function Z(e,t,n){no[e]=T(t)?t:function(e,r){return e&&n?n:t}}function J(e,t){return c(no,e)?no[e](t._strict,t._locale):new RegExp(ee(e))}function ee(e){return te(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,o){return t||n||r||o}))}function te(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ne(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),s(t)&&(r=function(e,n){n[t]=C(e)}),n=0;n<e.length;n++)ro[e[n]]=r}function re(e,t){ne(e,function(e,n,r,o){r._w=r._w||{},t(e,r._w,r,o)})}function oe(e,t,n){null!=t&&c(ro,e)&&ro[e](t,n._a,n,e)}function ie(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||go).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function se(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[go.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function le(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===t?(o=po.call(this._shortMonthsParse,a),-1!==o?o:null):(o=po.call(this._longMonthsParse,a),-1!==o?o:null):"MMM"===t?-1!==(o=po.call(this._shortMonthsParse,a))?o:(o=po.call(this._longMonthsParse,a),-1!==o?o:null):-1!==(o=po.call(this._longMonthsParse,a))?o:(o=po.call(this._shortMonthsParse,a),-1!==o?o:null)}function ue(e,t,n){var r,o,i;if(this._monthsParseExact)return le.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=C(t);else if(t=e.localeData().monthsParse(t),!s(t))return e;return n=Math.min(e.date(),ie(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function fe(e){return null!=e?(ce(this,e),t.updateOffset(this,!0),this):U(this,"Month")}function he(){return ie(this.year(),this.month())}function de(e){return this._monthsParseExact?(c(this,"_monthsRegex")||ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=yo),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function pe(e){return this._monthsParseExact?(c(this,"_monthsRegex")||ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=wo),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ge(){function e(e,t){return t.length-e.length}var t,n,r=[],o=[],i=[];for(t=0;t<12;t++)n=h([2e3,t]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)r[t]=te(r[t]),o[t]=te(o[t]);for(t=0;t<24;t++)i[t]=te(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function ve(e){return me(e)?366:365}function me(e){return e%4==0&&e%100!=0||e%400==0}function ye(){return me(this.year())}function we(e,t,n,r,o,i,a){var s=new Date(e,t,n,r,o,i,a);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function be(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ce(e,t,n){var r=7+t-n;return-(7+be(e,0,r).getUTCDay()-t)%7+r-1}function Ee(e,t,n,r,o){var i,a,s=(7+n-r)%7,l=Ce(e,r,o),u=1+7*(t-1)+s+l;return u<=0?(i=e-1,a=ve(i)+u):u>ve(e)?(i=e+1,a=u-ve(e)):(i=e,a=u),{year:i,dayOfYear:a}}function Oe(e,t,n){var r,o,i=Ce(e.year(),t,n),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?(o=e.year()-1,r=a+_e(o,t,n)):a>_e(e.year(),t,n)?(r=a-_e(e.year(),t,n),o=e.year()+1):(o=e.year(),r=a),{week:r,year:o}}function _e(e,t,n){var r=Ce(e,t,n),o=Ce(e+1,t,n);return(ve(e)-r+o)/7}function Se(e){return Oe(e,this._week.dow,this._week.doy).week}function Te(){return this._week.dow}function Re(){return this._week.doy}function Me(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ne(e){var t=Oe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function ke(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Ae(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ie(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:r(this._weekdays)?this._weekdays:this._weekdays.standalone}function De(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Pe(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function xe(e,t,n){var r,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===t?(o=po.call(this._weekdaysParse,a),-1!==o?o:null):"ddd"===t?(o=po.call(this._shortWeekdaysParse,a),-1!==o?o:null):(o=po.call(this._minWeekdaysParse,a),-1!==o?o:null):"dddd"===t?-1!==(o=po.call(this._weekdaysParse,a))?o:-1!==(o=po.call(this._shortWeekdaysParse,a))?o:(o=po.call(this._minWeekdaysParse,a),-1!==o?o:null):"ddd"===t?-1!==(o=po.call(this._shortWeekdaysParse,a))?o:-1!==(o=po.call(this._weekdaysParse,a))?o:(o=po.call(this._minWeekdaysParse,a),-1!==o?o:null):-1!==(o=po.call(this._minWeekdaysParse,a))?o:-1!==(o=po.call(this._weekdaysParse,a))?o:(o=po.call(this._shortWeekdaysParse,a),-1!==o?o:null)}function Le(e,t,n){var r,o,i;if(this._weekdaysParseExact)return xe.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function He(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=ke(e,this.localeData()),this.add(e-t,"d")):t}function je(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ve(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Ae(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Fe(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=So),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Be(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=To),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ue(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ro),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function We(){function e(e,t){return t.length-e.length}var t,n,r,o,i,a=[],s=[],l=[],u=[];for(t=0;t<7;t++)n=h([2e3,1]).day(t),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),a.push(r),s.push(o),l.push(i),u.push(r),u.push(o),u.push(i);for(a.sort(e),s.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)s[t]=te(s[t]),l[t]=te(l[t]),u[t]=te(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Ye(){return this.hours()%12||12}function $e(){return this.hours()||24}function Ge(e,t){z(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function ze(e,t){return t._meridiemParse}function Xe(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function qe(e){return e?e.toLowerCase().replace("_","-"):e}function Qe(e){for(var t,n,r,o,i=0;i<e.length;){for(o=qe(e[i]).split("-"),t=o.length,n=qe(e[i+1]),n=n?n.split("-"):null;t>0;){if(r=Ze(o.slice(0,t).join("-")))return r;if(n&&n.length>=t&&E(o,n,!0)>=t-1)break;t--}i++}return null}function Ze(t){var r=null;if(!Io[t]&&void 0!==e&&e&&e.exports)try{r=Mo._abbr,n(368)("./"+t),Je(r)}catch(e){}return Io[t]}function Je(e,t){var n;return e&&(n=a(t)?nt(e):et(e,t))&&(Mo=n),Mo._abbr}function et(e,t){if(null!==t){var n=Ao;if(t.abbr=e,null!=Io[e])S("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Io[e]._config;else if(null!=t.parentLocale){if(null==Io[t.parentLocale])return Do[t.parentLocale]||(Do[t.parentLocale]=[]),Do[t.parentLocale].push({name:e,config:t}),null;n=Io[t.parentLocale]._config}return Io[e]=new N(M(n,t)),Do[e]&&Do[e].forEach(function(e){et(e.name,e.config)}),Je(e),Io[e]}return delete Io[e],null}function tt(e,t){if(null!=t){var n,r=Ao;null!=Io[e]&&(r=Io[e]._config),t=M(r,t),n=new N(t),n.parentLocale=Io[e],Io[e]=n,Je(e)}else null!=Io[e]&&(null!=Io[e].parentLocale?Io[e]=Io[e].parentLocale:null!=Io[e]&&delete Io[e]);return Io[e]}function nt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Mo;if(!r(e)){if(t=Ze(e))return t;e=[e]}return Qe(e)}function rt(){return Mr(Io)}function ot(e){var t,n=e._a;return n&&-2===p(e).overflow&&(t=n[io]<0||n[io]>11?io:n[ao]<1||n[ao]>ie(n[oo],n[io])?ao:n[so]<0||n[so]>24||24===n[so]&&(0!==n[lo]||0!==n[uo]||0!==n[co])?so:n[lo]<0||n[lo]>59?lo:n[uo]<0||n[uo]>59?uo:n[co]<0||n[co]>999?co:-1,p(e)._overflowDayOfYear&&(t<oo||t>ao)&&(t=ao),p(e)._overflowWeeks&&-1===t&&(t=fo),p(e)._overflowWeekday&&-1===t&&(t=ho),p(e).overflow=t),e}function it(e){var t,n,r,o,i,a,s=e._i,l=Po.exec(s)||xo.exec(s);if(l){for(p(e).iso=!0,t=0,n=Ho.length;t<n;t++)if(Ho[t][1].exec(l[1])){o=Ho[t][0],r=!1!==Ho[t][2];break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,n=jo.length;t<n;t++)if(jo[t][1].exec(l[3])){i=(l[2]||" ")+jo[t][0];break}if(null==i)return void(e._isValid=!1)}if(!r&&null!=i)return void(e._isValid=!1);if(l[4]){if(!Lo.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(i||"")+(a||""),ht(e)}else e._isValid=!1}function at(e){var t,n,r,o,i,a,s,l,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},c="YXWVUTSRQPONZABCDEFGHIKLM";if(t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=Fo.exec(t)){if(r=n[1]?"ddd"+(5===n[1].length?", ":" "):"",o="D MMM "+(n[2].length>10?"YYYY ":"YY "),i="HH:mm"+(n[4]?":ss":""),n[1]){var f=new Date(n[2]),h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][f.getDay()];if(n[1].substr(0,3)!==h)return p(e).weekdayMismatch=!0,void(e._isValid=!1)}switch(n[5].length){case 2:0===l?s=" +0000":(l=c.indexOf(n[5][1].toUpperCase())-12,s=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:s=u[n[5]];break;default:s=u[" GMT"]}n[5]=s,e._i=n.splice(1).join(""),a=" ZZ",e._f=r+o+i+a,ht(e),p(e).rfc2822=!0}else e._isValid=!1}function st(e){var n=Vo.exec(e._i);if(null!==n)return void(e._d=new Date(+n[1]));it(e),!1===e._isValid&&(delete e._isValid,at(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function lt(e,t,n){return null!=e?e:null!=t?t:n}function ut(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function ct(e){var t,n,r,o,i=[];if(!e._d){for(r=ut(e),e._w&&null==e._a[ao]&&null==e._a[io]&&ft(e),null!=e._dayOfYear&&(o=lt(e._a[oo],r[oo]),(e._dayOfYear>ve(o)||0===e._dayOfYear)&&(p(e)._overflowDayOfYear=!0),n=be(o,0,e._dayOfYear),e._a[io]=n.getUTCMonth(),e._a[ao]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=r[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[so]&&0===e._a[lo]&&0===e._a[uo]&&0===e._a[co]&&(e._nextDay=!0,e._a[so]=0),e._d=(e._useUTC?be:we).apply(null,i),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[so]=24)}}function ft(e){var t,n,r,o,i,a,s,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)i=1,a=4,n=lt(t.GG,e._a[oo],Oe(bt(),1,4).year),r=lt(t.W,1),((o=lt(t.E,1))<1||o>7)&&(l=!0);else{i=e._locale._week.dow,a=e._locale._week.doy;var u=Oe(bt(),i,a);n=lt(t.gg,e._a[oo],u.year),r=lt(t.w,u.week),null!=t.d?((o=t.d)<0||o>6)&&(l=!0):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i}r<1||r>_e(n,i,a)?p(e)._overflowWeeks=!0:null!=l?p(e)._overflowWeekday=!0:(s=Ee(n,r,o,i,a),e._a[oo]=s.year,e._dayOfYear=s.dayOfYear)}function ht(e){if(e._f===t.ISO_8601)return void it(e);if(e._f===t.RFC_2822)return void at(e);e._a=[],p(e).empty=!0;var n,r,o,i,a,s=""+e._i,l=s.length,u=0;for(o=Q(e._f,e._locale).match(xr)||[],n=0;n<o.length;n++)i=o[n],r=(s.match(J(i,e))||[])[0],r&&(a=s.substr(0,s.indexOf(r)),a.length>0&&p(e).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),u+=r.length),jr[i]?(r?p(e).empty=!1:p(e).unusedTokens.push(i),oe(i,r,e)):e._strict&&!r&&p(e).unusedTokens.push(i);p(e).charsLeftOver=l-u,s.length>0&&p(e).unusedInput.push(s),e._a[so]<=12&&!0===p(e).bigHour&&e._a[so]>0&&(p(e).bigHour=void 0),p(e).parsedDateParts=e._a.slice(0),p(e).meridiem=e._meridiem,e._a[so]=dt(e._locale,e._a[so],e._meridiem),ct(e),ot(e)}function dt(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function pt(e){var t,n,r,o,i;if(0===e._f.length)return p(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)i=0,t=m({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],ht(t),g(t)&&(i+=p(t).charsLeftOver,i+=10*p(t).unusedTokens.length,p(t).score=i,(null==r||i<r)&&(r=i,n=t));f(e,n||t)}function gt(e){if(!e._d){var t=j(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}function vt(e){var t=new y(ot(mt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function mt(e){var t=e._i,n=e._f;return e._locale=e._locale||nt(e._l),null===t||void 0===n&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),w(t)?new y(ot(t)):(l(t)?e._d=t:r(n)?pt(e):n?ht(e):yt(e),g(e)||(e._d=null),e))}function yt(e){var n=e._i;a(n)?e._d=new Date(t.now()):l(n)?e._d=new Date(n.valueOf()):"string"==typeof n?st(e):r(n)?(e._a=u(n.slice(0),function(e){return parseInt(e,10)}),ct(e)):o(n)?gt(e):s(n)?e._d=new Date(n):t.createFromInputFallback(e)}function wt(e,t,n,a,s){var l={};return!0!==n&&!1!==n||(a=n,n=void 0),(o(e)&&i(e)||r(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=s,l._l=n,l._i=e,l._f=t,l._strict=a,vt(l)}function bt(e,t,n,r){return wt(e,t,n,r,!1)}function Ct(e,t){var n,o;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return bt();for(n=t[0],o=1;o<t.length;++o)t[o].isValid()&&!t[o][e](n)||(n=t[o]);return n}function Et(){return Ct("isBefore",[].slice.call(arguments,0))}function Ot(){return Ct("isAfter",[].slice.call(arguments,0))}function _t(e){for(var t in e)if(-1===Yo.indexOf(t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<Yo.length;++r)if(e[Yo[r]]){if(n)return!1;parseFloat(e[Yo[r]])!==C(e[Yo[r]])&&(n=!0)}return!0}function St(){return this._isValid}function Tt(){return $t(NaN)}function Rt(e){var t=j(e),n=t.year||0,r=t.quarter||0,o=t.month||0,i=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=_t(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=nt(),this._bubble()}function Mt(e){return e instanceof Rt}function Nt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function kt(e,t){z(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+G(~~(e/60),2)+t+G(~~e%60,2)})}function At(e,t){var n=(t||"").match(e);if(null===n)return null;var r=n[n.length-1]||[],o=(r+"").match($o)||["-",0,0],i=60*o[1]+C(o[2]);return 0===i?0:"+"===o[0]?i:-i}function It(e,n){var r,o;return n._isUTC?(r=n.clone(),o=(w(e)||l(e)?e.valueOf():bt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),t.updateOffset(r,!1),r):bt(e).local()}function Dt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Pt(e,n,r){var o,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=At(Jr,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&n&&(o=Dt(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==e&&(!n||this._changeInProgress?qt(this,$t(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Dt(this)}function xt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Lt(e){return this.utcOffset(0,e)}function Ht(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Dt(this),"m")),this}function jt(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=At(Zr,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Vt(e){return!!this.isValid()&&(e=e?bt(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Ft(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Bt(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(m(e,this),e=mt(e),e._a){var t=e._isUTC?h(e._a):bt(e._a);this._isDSTShifted=this.isValid()&&E(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ut(){return!!this.isValid()&&!this._isUTC}function Wt(){return!!this.isValid()&&this._isUTC}function Yt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function $t(e,t){var n,r,o,i=e,a=null;return Mt(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:s(e)?(i={},t?i[t]=e:i.milliseconds=e):(a=Go.exec(e))?(n="-"===a[1]?-1:1,i={y:0,d:C(a[ao])*n,h:C(a[so])*n,m:C(a[lo])*n,s:C(a[uo])*n,ms:C(Nt(1e3*a[co]))*n}):(a=zo.exec(e))?(n="-"===a[1]?-1:1,i={y:Gt(a[2],n),M:Gt(a[3],n),w:Gt(a[4],n),d:Gt(a[5],n),h:Gt(a[6],n),m:Gt(a[7],n),s:Gt(a[8],n)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(o=Xt(bt(i.from),bt(i.to)),i={},i.ms=o.milliseconds,i.M=o.months),r=new Rt(i),Mt(e)&&c(e,"_locale")&&(r._locale=e._locale),r}function Gt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Xt(e,t){var n;return e.isValid()&&t.isValid()?(t=It(t,e),e.isBefore(t)?n=zt(e,t):(n=zt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Kt(e,t){return function(n,r){var o,i;return null===r||isNaN(+r)||(S(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),n="string"==typeof n?+n:n,o=$t(n,r),qt(this,o,e),this}}function qt(e,n,r,o){var i=n._milliseconds,a=Nt(n._days),s=Nt(n._months);e.isValid()&&(o=null==o||o,i&&e._d.setTime(e._d.valueOf()+i*r),a&&W(e,"Date",U(e,"Date")+a*r),s&&ce(e,U(e,"Month")+s*r),o&&t.updateOffset(e,a||s))}function Qt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Zt(e,n){var r=e||bt(),o=It(r,this).startOf("day"),i=t.calendarFormat(this,o)||"sameElse";return this.format(n&&(T(n[i])?n[i].call(this,r):n[i])||this.localeData().calendar(i,this,bt(r)))}function Jt(){return new y(this)}function en(e,t){var n=w(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=H(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function tn(e,t){var n=w(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=H(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function nn(e,t,n,r){return r=r||"()",("("===r[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function rn(e,t){var n,r=w(e)?e:bt(e);return!(!this.isValid()||!r.isValid())&&(t=H(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function on(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function an(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function sn(e,t,n){var r,o,i,a;return this.isValid()?(r=It(e,this),r.isValid()?(o=6e4*(r.utcOffset()-this.utcOffset()),t=H(t),"year"===t||"month"===t||"quarter"===t?(a=ln(this,r),"quarter"===t?a/=3:"year"===t&&(a/=12)):(i=this-r,a="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?a:b(a)):NaN):NaN}function ln(e,t){var n,r,o=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(o,"months");return t-i<0?(n=e.clone().add(o-1,"months"),r=(t-i)/(i-n)):(n=e.clone().add(o+1,"months"),r=(t-i)/(n-i)),-(o+r)||0}function un(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function cn(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):T(Date.prototype.toISOString)?this.toDate().toISOString():q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function fn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");return this.format("["+e+'("]'+(0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY")+"-MM-DD[T]HH:mm:ss.SSS"+t+'[")]')}function hn(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=q(this,e);return this.localeData().postformat(n)}function dn(e,t){return this.isValid()&&(w(e)&&e.isValid()||bt(e).isValid())?$t({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pn(e){return this.from(bt(),e)}function gn(e,t){return this.isValid()&&(w(e)&&e.isValid()||bt(e).isValid())?$t({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function vn(e){return this.to(bt(),e)}function mn(e){var t;return void 0===e?this._locale._abbr:(t=nt(e),null!=t&&(this._locale=t),this)}function yn(){return this._locale}function wn(e){switch(e=H(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bn(e){return void 0===(e=H(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function Cn(){return this._d.valueOf()-6e4*(this._offset||0)}function En(){return Math.floor(this.valueOf()/1e3)}function On(){return new Date(this.valueOf())}function _n(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Sn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tn(){return this.isValid()?this.toISOString():null}function Rn(){return g(this)}function Mn(){return f({},p(this))}function Nn(){return p(this).overflow}function kn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function An(e,t){z(0,[e,e.length],0,t)}function In(e){return Ln.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Dn(e){return Ln.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Pn(){return _e(this.year(),1,4)}function xn(){var e=this.localeData()._week;return _e(this.year(),e.dow,e.doy)}function Ln(e,t,n,r,o){var i;return null==e?Oe(this,r,o).year:(i=_e(e,r,o),t>i&&(t=i),Hn.call(this,e,t,n,r,o))}function Hn(e,t,n,r,o){var i=Ee(e,t,n,r,o),a=be(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function jn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Vn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Fn(e,t){t[co]=C(1e3*("0."+e))}function Bn(){return this._isUTC?"UTC":""}function Un(){return this._isUTC?"Coordinated Universal Time":""}function Wn(e){return bt(1e3*e)}function Yn(){return bt.apply(null,arguments).parseZone()}function $n(e){return e}function Gn(e,t,n,r){return nt()[n](h().set(r,t),e)}function zn(e,t,n){if(s(e)&&(t=e,e=void 0),e=e||"",null!=t)return Gn(e,t,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=Gn(e,r,n,"month");return o}function Xn(e,t,n,r){"boolean"==typeof e?(s(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,s(t)&&(n=t,t=void 0),t=t||"");var o=nt(),i=e?o._week.dow:0;if(null!=n)return Gn(t,(n+i)%7,r,"day");var a,l=[];for(a=0;a<7;a++)l[a]=Gn(t,(a+i)%7,r,"day");return l}function Kn(e,t){return zn(e,t,"months")}function qn(e,t){return zn(e,t,"monthsShort")}function Qn(e,t,n){return Xn(e,t,n,"weekdays")}function Zn(e,t,n){return Xn(e,t,n,"weekdaysShort")}function Jn(e,t,n){return Xn(e,t,n,"weekdaysMin")}function er(){var e=this._data;return this._milliseconds=oi(this._milliseconds),this._days=oi(this._days),this._months=oi(this._months),e.milliseconds=oi(e.milliseconds),e.seconds=oi(e.seconds),e.minutes=oi(e.minutes),e.hours=oi(e.hours),e.months=oi(e.months),e.years=oi(e.years),this}function tr(e,t,n,r){var o=$t(t,n);return e._milliseconds+=r*o._milliseconds,e._days+=r*o._days,e._months+=r*o._months,e._bubble()}function nr(e,t){return tr(this,e,t,1)}function rr(e,t){return tr(this,e,t,-1)}function or(e){return e<0?Math.floor(e):Math.ceil(e)}function ir(){var e,t,n,r,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*or(sr(s)+a),a=0,s=0),l.milliseconds=i%1e3,e=b(i/1e3),l.seconds=e%60,t=b(e/60),l.minutes=t%60,n=b(t/60),l.hours=n%24,a+=b(n/24),o=b(ar(a)),s+=o,a-=or(sr(o)),r=b(s/12),s%=12,l.days=a,l.months=s,l.years=r,this}function ar(e){return 4800*e/146097}function sr(e){return 146097*e/4800}function lr(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=H(e))||"year"===e)return t=this._days+r/864e5,n=this._months+ar(t),"month"===e?n:n/12;switch(t=this._days+Math.round(sr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function ur(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12):NaN}function cr(e){return function(){return this.as(e)}}function fr(e){return e=H(e),this.isValid()?this[e+"s"]():NaN}function hr(e){return function(){return this.isValid()?this._data[e]:NaN}}function dr(){return b(this.days()/7)}function pr(e,t,n,r,o){return o.relativeTime(t||1,!!n,e,r)}function gr(e,t,n){var r=$t(e).abs(),o=bi(r.as("s")),i=bi(r.as("m")),a=bi(r.as("h")),s=bi(r.as("d")),l=bi(r.as("M")),u=bi(r.as("y")),c=o<=Ci.ss&&["s",o]||o<Ci.s&&["ss",o]||i<=1&&["m"]||i<Ci.m&&["mm",i]||a<=1&&["h"]||a<Ci.h&&["hh",a]||s<=1&&["d"]||s<Ci.d&&["dd",s]||l<=1&&["M"]||l<Ci.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=n,pr.apply(null,c)}function vr(e){return void 0===e?bi:"function"==typeof e&&(bi=e,!0)}function mr(e,t){return void 0!==Ci[e]&&(void 0===t?Ci[e]:(Ci[e]=t,"s"===e&&(Ci.ss=t-1),!0))}function yr(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=gr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function wr(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r=Ei(this._milliseconds)/1e3,o=Ei(this._days),i=Ei(this._months);e=b(r/60),t=b(e/60),r%=60,e%=60,n=b(i/12),i%=12;var a=n,s=i,l=o,u=t,c=e,f=r,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(u||c||f?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(f?f+"S":""):"P0D"}var br,Cr;Cr=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var Er=Cr,Or=t.momentProperties=[],_r=!1,Sr={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Tr;Tr=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)c(e,t)&&n.push(t);return n};var Rr,Mr=Tr,Nr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},kr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ar=/\d{1,2}/,Ir={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Dr={},Pr={},xr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Lr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hr={},jr={},Vr=/\d/,Fr=/\d\d/,Br=/\d{3}/,Ur=/\d{4}/,Wr=/[+-]?\d{6}/,Yr=/\d\d?/,$r=/\d\d\d\d?/,Gr=/\d\d\d\d\d\d?/,zr=/\d{1,3}/,Xr=/\d{1,4}/,Kr=/[+-]?\d{1,6}/,qr=/\d+/,Qr=/[+-]?\d+/,Zr=/Z|[+-]\d\d:?\d\d/gi,Jr=/Z|[+-]\d\d(?::?\d\d)?/gi,eo=/[+-]?\d+(\.\d{1,3})?/,to=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,no={},ro={},oo=0,io=1,ao=2,so=3,lo=4,uo=5,co=6,fo=7,ho=8;Rr=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var po=Rr;z("M",["MM",2],"Mo",function(){return this.month()+1}),z("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),z("MMMM",0,0,function(e){return this.localeData().months(this,e)}),L("month","M"),V("month",8),Z("M",Yr),Z("MM",Yr,Fr),Z("MMM",function(e,t){return t.monthsShortRegex(e)}),Z("MMMM",function(e,t){return t.monthsRegex(e)}),ne(["M","MM"],function(e,t){t[io]=C(e)-1}),ne(["MMM","MMMM"],function(e,t,n,r){var o=n._locale.monthsParse(e,r,n._strict);null!=o?t[io]=o:p(n).invalidMonth=e});var go=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vo="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mo="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),yo=to,wo=to;z("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),z(0,["YY",2],0,function(){return this.year()%100}),z(0,["YYYY",4],0,"year"),z(0,["YYYYY",5],0,"year"),z(0,["YYYYYY",6,!0],0,"year"),L("year","y"),V("year",1),Z("Y",Qr),Z("YY",Yr,Fr),Z("YYYY",Xr,Ur),Z("YYYYY",Kr,Wr),Z("YYYYYY",Kr,Wr),ne(["YYYYY","YYYYYY"],oo),ne("YYYY",function(e,n){n[oo]=2===e.length?t.parseTwoDigitYear(e):C(e)}),ne("YY",function(e,n){n[oo]=t.parseTwoDigitYear(e)}),ne("Y",function(e,t){t[oo]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return C(e)+(C(e)>68?1900:2e3)};var bo=B("FullYear",!0);z("w",["ww",2],"wo","week"),z("W",["WW",2],"Wo","isoWeek"),L("week","w"),L("isoWeek","W"),V("week",5),V("isoWeek",5),Z("w",Yr),Z("ww",Yr,Fr),Z("W",Yr),Z("WW",Yr,Fr),re(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=C(e)});var Co={dow:0,doy:6};z("d",0,"do","day"),z("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),z("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),z("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),z("e",0,0,"weekday"),z("E",0,0,"isoWeekday"),L("day","d"),L("weekday","e"),L("isoWeekday","E"),V("day",11),V("weekday",11),V("isoWeekday",11),Z("d",Yr),Z("e",Yr),Z("E",Yr),Z("dd",function(e,t){return t.weekdaysMinRegex(e)}),Z("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Z("dddd",function(e,t){return t.weekdaysRegex(e)}),re(["dd","ddd","dddd"],function(e,t,n,r){var o=n._locale.weekdaysParse(e,r,n._strict);null!=o?t.d=o:p(n).invalidWeekday=e}),re(["d","e","E"],function(e,t,n,r){t[r]=C(e)});var Eo="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Oo="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),_o="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),So=to,To=to,Ro=to;z("H",["HH",2],0,"hour"),z("h",["hh",2],0,Ye),z("k",["kk",2],0,$e),z("hmm",0,0,function(){return""+Ye.apply(this)+G(this.minutes(),2)}),z("hmmss",0,0,function(){return""+Ye.apply(this)+G(this.minutes(),2)+G(this.seconds(),2)}),z("Hmm",0,0,function(){return""+this.hours()+G(this.minutes(),2)}),z("Hmmss",0,0,function(){return""+this.hours()+G(this.minutes(),2)+G(this.seconds(),2)}),Ge("a",!0),Ge("A",!1),L("hour","h"),V("hour",13),Z("a",ze),Z("A",ze),Z("H",Yr),Z("h",Yr),Z("k",Yr),Z("HH",Yr,Fr),Z("hh",Yr,Fr),Z("kk",Yr,Fr),Z("hmm",$r),Z("hmmss",Gr),Z("Hmm",$r),Z("Hmmss",Gr),ne(["H","HH"],so),ne(["k","kk"],function(e,t,n){var r=C(e);t[so]=24===r?0:r}),ne(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ne(["h","hh"],function(e,t,n){t[so]=C(e),p(n).bigHour=!0}),ne("hmm",function(e,t,n){var r=e.length-2;t[so]=C(e.substr(0,r)),t[lo]=C(e.substr(r)),p(n).bigHour=!0}),ne("hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[so]=C(e.substr(0,r)),t[lo]=C(e.substr(r,2)),t[uo]=C(e.substr(o)),p(n).bigHour=!0}),ne("Hmm",function(e,t,n){var r=e.length-2;t[so]=C(e.substr(0,r)),t[lo]=C(e.substr(r))}),ne("Hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[so]=C(e.substr(0,r)),t[lo]=C(e.substr(r,2)),t[uo]=C(e.substr(o))});var Mo,No=/[ap]\.?m?\.?/i,ko=B("Hours",!0),Ao={calendar:Nr,longDateFormat:kr,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Ar,relativeTime:Ir,months:vo,monthsShort:mo,week:Co,weekdays:Eo,weekdaysMin:_o,weekdaysShort:Oo,meridiemParse:No},Io={},Do={},Po=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xo=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lo=/Z|[+-]\d\d(?::?\d\d)?/,Ho=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],jo=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Vo=/^\/?Date\((\-?\d+)/i,Fo=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=_("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Bo=_("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),Uo=_("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}),Wo=function(){return Date.now?Date.now():+new Date},Yo=["year","quarter","month","week","day","hour","minute","second","millisecond"];kt("Z",":"),kt("ZZ",""),Z("Z",Jr),Z("ZZ",Jr),ne(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=At(Jr,e)});var $o=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Go=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,zo=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;$t.fn=Rt.prototype,$t.invalid=Tt;var Xo=Kt(1,"add"),Ko=Kt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var qo=_("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});z(0,["gg",2],0,function(){return this.weekYear()%100}),z(0,["GG",2],0,function(){return this.isoWeekYear()%100}),An("gggg","weekYear"),An("ggggg","weekYear"),An("GGGG","isoWeekYear"),An("GGGGG","isoWeekYear"),L("weekYear","gg"),L("isoWeekYear","GG"),V("weekYear",1),V("isoWeekYear",1),Z("G",Qr),Z("g",Qr),Z("GG",Yr,Fr),Z("gg",Yr,Fr),Z("GGGG",Xr,Ur),Z("gggg",Xr,Ur),Z("GGGGG",Kr,Wr),Z("ggggg",Kr,Wr),re(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=C(e)}),re(["gg","GG"],function(e,n,r,o){n[o]=t.parseTwoDigitYear(e)}),z("Q",0,"Qo","quarter"),L("quarter","Q"),V("quarter",7),Z("Q",Vr),ne("Q",function(e,t){t[io]=3*(C(e)-1)}),z("D",["DD",2],"Do","date"),L("date","D"),V("date",9),Z("D",Yr),Z("DD",Yr,Fr),Z("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ne(["D","DD"],ao),ne("Do",function(e,t){t[ao]=C(e.match(Yr)[0],10)});var Qo=B("Date",!0);z("DDD",["DDDD",3],"DDDo","dayOfYear"),L("dayOfYear","DDD"),V("dayOfYear",4),Z("DDD",zr),Z("DDDD",Br),ne(["DDD","DDDD"],function(e,t,n){n._dayOfYear=C(e)}),z("m",["mm",2],0,"minute"),L("minute","m"),V("minute",14),Z("m",Yr),Z("mm",Yr,Fr),ne(["m","mm"],lo);var Zo=B("Minutes",!1);z("s",["ss",2],0,"second"),L("second","s"),V("second",15),Z("s",Yr),Z("ss",Yr,Fr),ne(["s","ss"],uo);var Jo=B("Seconds",!1);z("S",0,0,function(){return~~(this.millisecond()/100)}),z(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),z(0,["SSS",3],0,"millisecond"),z(0,["SSSS",4],0,function(){return 10*this.millisecond()}),z(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),z(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),z(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),z(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),z(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),L("millisecond","ms"),V("millisecond",16),Z("S",zr,Vr),Z("SS",zr,Fr),Z("SSS",zr,Br);var ei;for(ei="SSSS";ei.length<=9;ei+="S")Z(ei,qr);for(ei="S";ei.length<=9;ei+="S")ne(ei,Fn);var ti=B("Milliseconds",!1);z("z",0,0,"zoneAbbr"),z("zz",0,0,"zoneName");var ni=y.prototype;ni.add=Xo,ni.calendar=Zt,ni.clone=Jt,ni.diff=sn,ni.endOf=bn,ni.format=hn,ni.from=dn,ni.fromNow=pn,ni.to=gn,ni.toNow=vn,ni.get=Y,ni.invalidAt=Nn,ni.isAfter=en,ni.isBefore=tn,ni.isBetween=nn,ni.isSame=rn,ni.isSameOrAfter=on,ni.isSameOrBefore=an,ni.isValid=Rn,ni.lang=qo,ni.locale=mn,ni.localeData=yn,ni.max=Uo,ni.min=Bo,ni.parsingFlags=Mn,ni.set=$,ni.startOf=wn,ni.subtract=Ko,ni.toArray=_n,ni.toObject=Sn,ni.toDate=On,ni.toISOString=cn,ni.inspect=fn,ni.toJSON=Tn,ni.toString=un,ni.unix=En,ni.valueOf=Cn,ni.creationData=kn,ni.year=bo,ni.isLeapYear=ye,ni.weekYear=In,ni.isoWeekYear=Dn,ni.quarter=ni.quarters=jn,ni.month=fe,ni.daysInMonth=he,ni.week=ni.weeks=Me,ni.isoWeek=ni.isoWeeks=Ne,ni.weeksInYear=xn,ni.isoWeeksInYear=Pn,ni.date=Qo,ni.day=ni.days=He,ni.weekday=je,ni.isoWeekday=Ve,ni.dayOfYear=Vn,ni.hour=ni.hours=ko,ni.minute=ni.minutes=Zo,ni.second=ni.seconds=Jo,ni.millisecond=ni.milliseconds=ti,ni.utcOffset=Pt,ni.utc=Lt,ni.local=Ht,ni.parseZone=jt,ni.hasAlignedHourOffset=Vt,ni.isDST=Ft,ni.isLocal=Ut,ni.isUtcOffset=Wt,ni.isUtc=Yt,ni.isUTC=Yt,ni.zoneAbbr=Bn,ni.zoneName=Un,ni.dates=_("dates accessor is deprecated. Use date instead.",Qo),ni.months=_("months accessor is deprecated. Use month instead",fe),ni.years=_("years accessor is deprecated. Use year instead",bo),ni.zone=_("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",xt),ni.isDSTShifted=_("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Bt);var ri=N.prototype;ri.calendar=k,ri.longDateFormat=A,ri.invalidDate=I,ri.ordinal=D,ri.preparse=$n,ri.postformat=$n,ri.relativeTime=P,ri.pastFuture=x,ri.set=R,ri.months=ae,ri.monthsShort=se,ri.monthsParse=ue,ri.monthsRegex=pe,ri.monthsShortRegex=de,ri.week=Se,ri.firstDayOfYear=Re,ri.firstDayOfWeek=Te,ri.weekdays=Ie,ri.weekdaysMin=Pe,ri.weekdaysShort=De,ri.weekdaysParse=Le,ri.weekdaysRegex=Fe,ri.weekdaysShortRegex=Be,ri.weekdaysMinRegex=Ue,ri.isPM=Xe,ri.meridiem=Ke,Je("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===C(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=_("moment.lang is deprecated. Use moment.locale instead.",Je),t.langData=_("moment.langData is deprecated. Use moment.localeData instead.",nt);var oi=Math.abs,ii=cr("ms"),ai=cr("s"),si=cr("m"),li=cr("h"),ui=cr("d"),ci=cr("w"),fi=cr("M"),hi=cr("y"),di=hr("milliseconds"),pi=hr("seconds"),gi=hr("minutes"),vi=hr("hours"),mi=hr("days"),yi=hr("months"),wi=hr("years"),bi=Math.round,Ci={ss:44,s:45,m:45,h:22,d:26,M:11},Ei=Math.abs,Oi=Rt.prototype;return Oi.isValid=St,Oi.abs=er,Oi.add=nr,Oi.subtract=rr,Oi.as=lr,Oi.asMilliseconds=ii,Oi.asSeconds=ai,Oi.asMinutes=si,Oi.asHours=li,Oi.asDays=ui,Oi.asWeeks=ci,Oi.asMonths=fi,Oi.asYears=hi,Oi.valueOf=ur,Oi._bubble=ir,Oi.get=fr,Oi.milliseconds=di,Oi.seconds=pi,Oi.minutes=gi,Oi.hours=vi,Oi.days=mi,Oi.weeks=dr,Oi.months=yi,Oi.years=wi,Oi.humanize=yr,Oi.toISOString=wr,Oi.toString=wr,Oi.toJSON=wr,Oi.locale=mn,Oi.localeData=yn,Oi.toIsoString=_("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",wr),Oi.lang=qo,z("X",0,0,"unix"),z("x",0,0,"valueOf"),Z("x",Qr),Z("X",eo),ne("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ne("x",function(e,t,n){n._d=new Date(C(e))}),t.version="2.18.1",function(e){br=e}(bt),t.fn=ni,t.min=Et,t.max=Ot,t.now=Wo,t.utc=h,t.unix=Wn,t.months=Kn,t.isDate=l,t.locale=Je,t.invalid=v,t.duration=$t,t.isMoment=w,t.weekdays=Qn,t.parseZone=Yn,t.localeData=nt,t.isDuration=Mt,t.monthsShort=qn,t.weekdaysMin=Jn,t.defineLocale=et,t.updateLocale=tt,t.locales=rt,t.weekdaysShort=Zn,t.normalizeUnits=H,t.relativeTimeRounding=vr,t.relativeTimeThreshold=mr,t.calendarFormat=Qt,t.prototype=ni,t}),window.moment=n(21)}).call(t,n(367)(e))},function(e,t,n){var r=n(20),o=n(163),i=n(87),a=Object.defineProperty;t.f=n(24)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";function r(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}function o(e){return(0,E.hasClass)(e,"htSeparator")}function i(e){return(0,E.hasClass)(e,"htSubmenu")}function a(e){return(0,E.hasClass)(e,"htDisabled")}function s(e){return(0,E.hasClass)(e,"htSelectionDisabled")}function l(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function u(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function c(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function f(e,t){for(var n={},r=e.from.row;r<=e.to.row;r++)for(var o=e.from.col;o<=e.to.col;o++)n[r]||(n[r]=[]),n[r][o]=t(r,o);return n}function h(e,t,n,r,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)d(e.from.row,e.from.col,t,n,r,o);else for(var i=e.from.row;i<=e.to.row;i++)for(var a=e.from.col;a<=e.to.col;a++)d(i,a,t,n,r,o)}function d(e,t,n,r,o,i){var a=o(e,t),s=r;a.className&&(s="vertical"===n?u(a.className,r):c(a.className,r)),i(e,t,"className",s)}function p(e,t){var n=!1;return e&&e.forAll(function(e,r){if(t(e,r))return n=!0,!1}),n}function g(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e}function v(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}function m(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}function y(e,t){var n=e.slice(0);return n.reverse(),n=m(n,t),n.reverse(),n}function w(e){var t=[];return(0,C.arrayEach)(e,function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)}),t}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.KEY,n=e.slice(0);return n=m(n,t),n=y(n,t),n=w(n)}t.__esModule=!0,t.normalizeSelection=r,t.isSeparator=o,t.hasSubMenu=i,t.isDisabled=a,t.isSelectionDisabled=s,t.getValidSelection=l,t.prepareVerticalAlignClass=u,t.prepareHorizontalAlignClass=c,t.getAlignmentClasses=f,t.align=h,t.checkSelectionConsistency=p,t.markLabelAsSelected=g,t.isItemHidden=v,t.filterSeparators=b;var C=n(0),E=n(1),O=n(156)},function(e,t,n){e.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(89),o=n(46);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(68),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(5),o=n(48),i=n(25);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",a)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(2),l=n(0),u=n(7),c=r(u),f=n(191),h=r(f),d={};t.default=function(){function e(t){o(this,e),(0,s.defineGetter)(this,"wot",t,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return i(e,null,[{key:"registerOverlay",value:function(t,n){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error("Unsupported overlay ("+t+").");d[t]=n}},{key:"createOverlay",value:function(e,t){return new d[e](t)}},{key:"hasOverlay",value:function(e){return void 0!==d[e]}},{key:"isOverlayTypeOf",value:function(e,t){return!(!e||!d[t])&&e instanceof d[t]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[e.CLONE_TOP,e.CLONE_BOTTOM,e.CLONE_LEFT,e.CLONE_TOP_LEFT_CORNER,e.CLONE_BOTTOM_LEFT_CORNER,e.CLONE_DEBUG]}}]),i(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=(0,a.getScrollableElement)(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error('Clone type "'+t+'" is not supported.');var n=document.createElement("DIV"),r=document.createElement("TABLE");n.className="ht_clone_"+t+" handsontable",n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.overflow="hidden",r.className=this.wot.wtTable.TABLE.className,n.appendChild(r),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(n);var o=this.wot.getSetting("preventOverflow");return this.mainTableScrollableElement=!0===o||"horizontal"===o&&this.type===e.CLONE_TOP||"vertical"===o&&this.type===e.CLONE_LEFT?window:(0,a.getScrollableElement)(this.wot.wtTable.TABLE),new h.default({cloneSource:this.wot,cloneOverlay:this,table:r})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder;(0,l.arrayEach)([e.style,this.clone.wtTable.hider.style,e.parentNode.style],function(e){e.width="",e.height=""})}}},{key:"destroy",value:function(){new c.default(this.clone).destroy()}}]),e}()},function(e,t,n){"use strict";function r(e){return e[0].toUpperCase()+e.substr(1)}function o(){for(var e=[],t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=n.length;o--;){var i=(0,u.stringify)(n[o]).toLowerCase();-1===e.indexOf(i)&&e.push(i)}return 1===e.length}function i(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function a(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(""+e).replace(/(?:\\)?\[([^[\]]+)]/g,function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]})}function l(e){return e+="",e.replace(c,"")}t.__esModule=!0,t.toUpperCaseFirst=r,t.equalsIgnoreCase=o,t.randomString=i,t.isPercentValue=a,t.substitute=s,t.stripTags=l;var u=n(16),c=(n(4),/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi)},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),o=n(2),i={_localHooks:Object.create(null),addLocalHook:function(e,t){this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t)},runLocalHooks:function(e){for(var t=this,n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this._localHooks[e]&&(0,r.arrayEach)(this._localHooks[e],function(e){return e.apply(t,o)})},clearLocalHooks:function(){this._localHooks={}}};(0,o.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.default=i},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";function r(){return l}function o(){return u}function i(){return c}function a(){return f}function s(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}t.__esModule=!0,t.isIE8=r,t.isIE9=o,t.isSafari=i,t.isChrome=a,t.isMobileBrowser=s;var l=!document.createTextNode("test").textContent,u=!!document.documentMode,c=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),f=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(e,t,n){"use strict";function r(e){return"function"==typeof e}function o(e){function t(){var t=this,a=arguments,s=Date.now(),l=!1;o.lastCallThrottled=!0,r||(r=s,l=!0);var u=n-(s-r);return l?(o.lastCallThrottled=!1,e.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(function(){o.lastCallThrottled=!1,e.apply(t,a),r=0,i=void 0},u)),o}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=0,o={lastCallThrottled:!0},i=null;return t}function i(e){function t(){s=i}function n(){return s?(s--,e.apply(this,arguments)):a.apply(this,arguments)}var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=o(e,r),s=i;return n.clearHits=t,n}function a(e){function t(){var t=this,i=arguments;return r&&clearTimeout(r),r=setTimeout(function(){o=e.apply(t,i)},n),o}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null,o=void 0;return t}function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t.slice(1);return function(){return(0,f.arrayReduce)(o,function(e,t){return t(e)},r.apply(this,arguments))}}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function u(e){function t(r){return function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i);return s.length>=n?e.apply(this,s):t(s)}}var n=e.length;return t([])}function c(e){function t(r){return function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i.reverse());return s.length>=n?e.apply(this,s):t(s)}}var n=e.length;return t([])}t.__esModule=!0,t.isFunction=r,t.throttle=o,t.throttleAfterHits=i,t.debounce=a,t.pipe=s,t.partial=l,t.curry=u,t.curryRight=c;var f=n(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if("function"==typeof e)return e;if(!y(e))throw Error('No registered validator found under "'+e+'" name');return m(e)}t.__esModule=!0,t.getRegisteredValidators=t.getRegisteredValidatorNames=t.hasValidator=t.getValidator=t.registerValidator=void 0;var i=n(51),a=r(i),s=n(391),l=r(s),u=n(392),c=r(u),f=n(393),h=r(f),d=n(394),p=r(d),g=(0,a.default)("validators"),v=g.register,m=g.getItem,y=g.hasItem,w=g.getNames,b=g.getValues;v("autocomplete",l.default),v("date",c.default),v("numeric",h.default),v("time",p.default),t.registerValidator=v,t.getValidator=o,t.hasValidator=y,t.getRegisteredValidatorNames=w,t.getRegisteredValidators=b},function(e,t,n){"use strict";function r(e){return"string"==typeof e&&e.length>=2&&"="===e.charAt(0)}function o(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function i(e){return o(e)?e.substr(1):e}function a(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=e.match(t)||[],r=-1;return e.toUpperCase().replace(t,function(){return++r,n[r]})}function s(e,t){return function(n){return{row:"row"===e?t:n.row,column:"column"===e?t:n.column}}}t.__esModule=!0,t.isFormulaExpression=r,t.isFormulaExpressionEscaped=o,t.unescapeFormulaExpression=i,t.toUpperCaseFormula=a,t.cellCoordFactory=s},function(e,t,n){var r=n(17),o=n(38),i=n(32),a=n(55)("src"),s=Function.toString,l=(""+s).split("toString");n(48).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(u&&(i(n,a)||o(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,n){var r=n(22),o=n(56);e.exports=n(24)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(71);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(46);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(55)("meta"),o=n(11),i=n(32),a=n(22).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(25)(function(){return l(Object.preventExtensions({}))}),c=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},f=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,r)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[r].i},h=function(e,t){if(!i(e,r)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[r].w},d=function(e){return u&&p.NEED&&l(e)&&!i(e,r)&&c(e),e},p=e.exports={KEY:r,NEED:!1,fastKey:f,getWeak:h,onFreeze:d}},function(e,t,n){"use strict";function r(e){return d.call(window,e)}function o(e){p.call(window,e)}function i(){return"ontouchstart"in window}function a(){var e=document.createElement("div");return!(!e.createShadowRoot||!e.createShadowRoot.toString().match(/\[native code\]/))}function s(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),v=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function l(){return void 0===v&&s(),v}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m||(m="object"===("undefined"==typeof Intl?"undefined":c(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return(""+e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1})}t.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.requestAnimationFrame=r,t.cancelAnimationFrame=o,t.isTouchSupported=i,t.isWebComponentSupportedNatively=a,t.hasCaptionProblem=l,t.getComparisonFunction=u;for(var f=0,h=["ms","moz","webkit","o"],d=window.requestAnimationFrame,p=window.cancelAnimationFrame,g=0;g<h.length&&!d;++g)d=window[h[g]+"RequestAnimationFrame"],p=window[h[g]+"CancelAnimationFrame"]||window[h[g]+"CancelRequestAnimationFrame"];d||(d=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-f)),r=window.setTimeout(function(){e(t+n)},n);return f=t+n,r}),p||(p=function(e){clearTimeout(e)});var v,m=void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){var e={};return(0,b.objectEach)(P,function(t,n){e[n]=t()}),e}function a(e,t){-1===D.indexOf(e)&&(P[e]=t)}t.__esModule=!0,t.ITEMS=t.UNDO=t.SEPARATOR=t.ROW_BELOW=t.ROW_ABOVE=t.REMOVE_ROW=t.REMOVE_COLUMN=t.REDO=t.READ_ONLY=t.COLUMN_RIGHT=t.COLUMN_LEFT=t.CLEAR_COLUMN=t.ALIGNMENT=void 0;var s,l=n(427);Object.defineProperty(t,"ALIGNMENT",{enumerable:!0,get:function(){return l.KEY}});var u=n(428);Object.defineProperty(t,"CLEAR_COLUMN",{enumerable:!0,get:function(){return u.KEY}});var c=n(429);Object.defineProperty(t,"COLUMN_LEFT",{enumerable:!0,get:function(){return c.KEY}});var f=n(430);Object.defineProperty(t,"COLUMN_RIGHT",{enumerable:!0,get:function(){return f.KEY}});var h=n(431);Object.defineProperty(t,"READ_ONLY",{enumerable:!0,get:function(){return h.KEY}});var d=n(432);Object.defineProperty(t,"REDO",{enumerable:!0,get:function(){return d.KEY}});var p=n(433);Object.defineProperty(t,"REMOVE_COLUMN",{enumerable:!0,get:function(){return p.KEY}});var g=n(434);Object.defineProperty(t,"REMOVE_ROW",{enumerable:!0,get:function(){return g.KEY}});var v=n(435);Object.defineProperty(t,"ROW_ABOVE",{enumerable:!0,get:function(){return v.KEY}});var m=n(436);Object.defineProperty(t,"ROW_BELOW",{enumerable:!0,get:function(){return m.KEY}});var y=n(156);Object.defineProperty(t,"SEPARATOR",{enumerable:!0,get:function(){return y.KEY}});var w=n(437);Object.defineProperty(t,"UNDO",{enumerable:!0,get:function(){return w.KEY}}),t.predefinedItems=i,t.addItem=a;var b=n(2),C=r(l),E=r(u),O=r(c),_=r(f),S=r(h),T=r(d),R=r(p),M=r(g),N=r(v),k=r(m),A=r(y),I=r(w),D=t.ITEMS=[v.KEY,m.KEY,c.KEY,f.KEY,u.KEY,g.KEY,p.KEY,w.KEY,d.KEY,h.KEY,l.KEY,y.KEY],P=(s={},o(s,y.KEY,A.default),o(s,v.KEY,N.default),o(s,m.KEY,k.default),o(s,c.KEY,O.default),o(s,f.KEY,_.default),o(s,u.KEY,E.default),o(s,g.KEY,M.default),o(s,p.KEY,R.default),o(s,w.KEY,I.default),o(s,d.KEY,T.default),o(s,h.KEY,S.default),o(s,l.KEY,C.default),s)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(66),l=n(0),u=n(339),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=[1,2,3];t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.precedents=[],i.value=null,i.error=null,i.state=t.STATE_UP_TO_DATE,i}return i(t,e),a(t,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),a(t,[{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(e){this.error=e}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(e){if(-1===f.indexOf(e))throw Error("Unrecognized state: "+e);this.state=e}},{key:"isState",value:function(e){return this.state===e}},{key:"addPrecedent",value:function(e){if(this.isEqual(e))throw Error(s.ERROR_REF);this.hasPrecedent(e)||this.precedents.push(e)}},{key:"removePrecedent",value:function(e){if(this.isEqual(e))throw Error(s.ERROR_REF);this.precedents=(0,l.arrayFilter)(this.precedents,function(t){return!t.isEqual(e)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(e){return(0,l.arrayFilter)(this.precedents,function(t){return t.isEqual(e)}).length>0}}]),t}(c.default)},function(e,t,n){var r=n(164),o=n(92);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(11);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){var r=n(14)("unscopables"),o=Array.prototype;void 0==o[r]&&n(38)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){function e(e,t){l.set(e,t)}function t(e){return l.get(e)}function n(e){return l.has(e)}function o(){return[].concat(r(l.keys()))}function a(){return[].concat(r(l.values()))}var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(s)||i.set(s,new Map);var l=i.get(s);return{register:e,getItem:t,hasItem:n,getNames:o,getValues:a}}t.__esModule=!0,t.default=o;var i=t.collection=new Map},function(e,t,n){"use strict";function r(e){this.instance=e,this.state=a.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}t.__esModule=!0,t.EditorState=void 0;var o=n(15),i=n(16),a=t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};r.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},r.prototype.init=function(){},r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},r.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},r.prototype.open=function(){throw Error("Editor open() method unimplemented")},r.prototype.close=function(){throw Error("Editor close() method unimplemented")},r.prototype.prepare=function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=a.VIRGIN},r.prototype.extend=function(){function e(){t.apply(this,arguments)}var t=this.constructor;return function(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}(e,t)},r.prototype.saveValue=function(e,t){var n=void 0,r=void 0;t?(n=this.instance.getSelected(),n[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")},r.prototype.beginEditing=function(e,t){this.state==a.VIRGIN&&(this.instance.view.scrollViewport(new o.CellCoords(this.row,this.col)),this.instance.view.render(),this.state=a.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue((0,i.stringify)(e)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},r.prototype.finishEditing=function(e,t,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e),o.instance.view.render()}}if(!this.isWaiting()){if(this.state==a.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){o._fireCallbacks(!0)},0));if(this.state==a.EDITING){if(e)return this.cancelChanges(),void this.instance.view.render();var s=this.getValue();r=this.instance.getSettings().trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=a.WAITING,this.saveValue(r,t),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(e){o.state=a.FINISHED,o.discardEditor(e)}):(this.state=a.FINISHED,this.discardEditor(!0))}}},r.prototype.cancelChanges=function(){this.state=a.FINISHED,this.discardEditor()},r.prototype.discardEditor=function(e){this.state===a.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=a.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=a.VIRGIN,this._fireCallbacks(!0)))},r.prototype.enableFullEditMode=function(){this._fullEditMode=!0},r.prototype.isInFullEditMode=function(){return this._fullEditMode},r.prototype.isOpened=function(){return this._opened},r.prototype.isWaiting=function(){return this.state===a.WAITING},r.prototype.checkEditorSection=function(){var e=this.instance.countRows(),t="";return this.row<this.instance.getSettings().fixedRowsTop?t=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom?t=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(t="left"),t},t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){f.set(e,t)}function i(e){var t=void 0;if(!(e instanceof l.default)){if(!f.has(e))throw Error("Record translator was not registered for this object identity");e=f.get(e)}return h.has(e)?t=h.get(e):(t=new c(e),h.set(e,t)),t}t.__esModule=!0,t.RecordTranslator=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.registerIdentity=o,t.getTranslator=i;var s=n(153),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(2),c=function(){function e(t){r(this,e),this.hot=t}return a(e,[{key:"toVisualRow",value:function(e){return this.hot.runHooks("unmodifyRow",e)}},{key:"toVisualColumn",value:function(e){return this.hot.runHooks("unmodifyCol",e)}},{key:"toVisual",value:function(e,t){return(0,u.isObject)(e)?{row:this.toVisualRow(e.row),column:this.toVisualColumn(e.column)}:[this.toVisualRow(e),this.toVisualColumn(t)]}},{key:"toPhysicalRow",value:function(e){return this.hot.runHooks("modifyRow",e)}},{key:"toPhysicalColumn",value:function(e){return this.hot.runHooks("modifyCol",e)}},{key:"toPhysical",value:function(e,t){return(0,u.isObject)(e)?{row:this.toPhysicalRow(e.row),column:this.toPhysicalColumn(e.column)}:[this.toPhysicalRow(e),this.toPhysicalColumn(t)]}}]),e}();t.RecordTranslator=c;var f=new WeakMap,h=new WeakMap},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),o=n(2),i=n(4),a={_arrayMap:[],getValueByIndex:function(e){var t=void 0;return void 0===(t=this._arrayMap[e])?null:t},getIndexByValue:function(e){var t=void 0;return-1===(t=this._arrayMap.indexOf(e))?null:t},insertItems:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=(0,r.arrayMax)(this._arrayMap)+1,a=[];return(0,i.rangeEach)(n-1,function(n){a.push(t._arrayMap.splice(e+n,0,o+n))}),a},removeItems:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[];if(Array.isArray(e)){var i=[].concat(this._arrayMap);e.sort(function(e,t){return t-e}),o=(0,r.arrayReduce)(e,function(e,n){return t._arrayMap.splice(n,1),e.concat(i.slice(n,n+1))},[])}else o=this._arrayMap.splice(e,n);return o},unshiftItems:function(e){function t(e){return(0,r.arrayReduce)(o,function(t,n){return e>n&&t++,t},0)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=this.removeItems(e,n);this._arrayMap=(0,r.arrayMap)(this._arrayMap,function(e,n){var r=t(e);return r&&(e-=r),e})},shiftItems:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._arrayMap=(0,r.arrayMap)(this._arrayMap,function(t){return t>=e&&(t+=n),t}),(0,i.rangeEach)(n-1,function(n){t._arrayMap.splice(e+n,0,e+n)})},clearMap:function(){this._arrayMap.length=0}};(0,o.defineGetter)(a,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1}),t.default=a},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports={}},function(e,t,n){var r=n(22).f,o=n(32),i=n(14)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(){function e(t,n){r(this,e),void 0!==t&&void 0!==n?(this.row=t,this.col=n):(this.row=null,this.col=null)}return o(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}}]),e}()},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(0,o.arrayReduce)(e,function(e,t,r){return e+t.replace(/(?:\r?\n\s+)/g,"")+(n[r]?n[r]:"")},"").trim()}t.__esModule=!0,t.toSingleLine=r;var o=n(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(1),i=n(373),a=r(i),s=n(52),l=r(s),u=n(7),c=r(u),f=n(18),h=n(10),d=l.default.prototype.extend();d.prototype.init=function(){var e=this;this.createElements(),this.eventManager=new c.default(this),this.bindEvents(),this.autoResize=(0,a.default)(),this.instance.addHook("afterDestroy",function(){e.destroy()})},d.prototype.getValue=function(){return this.TEXTAREA.value},d.prototype.setValue=function(e){this.TEXTAREA.value=e};var p=function(e){var t,n=this,r=n.getActiveEditor();if(t=(e.ctrlKey||e.metaKey)&&!e.altKey,e.target===r.TEXTAREA&&!(0,h.isImmediatePropagationStopped)(e)){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void(0,h.stopImmediatePropagation)(e);switch(e.keyCode){case f.KEY_CODES.ARROW_RIGHT:case f.KEY_CODES.ARROW_LEFT:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode))&&(0,h.stopImmediatePropagation)(e);break;case f.KEY_CODES.ARROW_UP:case f.KEY_CODES.ARROW_DOWN:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode))&&(0,h.stopImmediatePropagation)(e);break;case f.KEY_CODES.ENTER:var i=r.instance.getSelected(),a=!(i[0]===i[2]&&i[1]===i[3]);if(t&&!a||e.altKey){if(r.isOpened()){var s=(0,o.getCaretPosition)(r.TEXTAREA),l=r.getValue();r.setValue(l.slice(0,s)+"\n"+l.slice(s)),(0,o.setCaretPosition)(r.TEXTAREA,s+1)}else r.beginEditing(r.originalValue+"\n");(0,h.stopImmediatePropagation)(e)}e.preventDefault();break;case f.KEY_CODES.A:case f.KEY_CODES.X:case f.KEY_CODES.C:case f.KEY_CODES.V:t&&(0,h.stopImmediatePropagation)(e);break;case f.KEY_CODES.BACKSPACE:case f.KEY_CODES.DELETE:case f.KEY_CODES.HOME:case f.KEY_CODES.END:(0,h.stopImmediatePropagation)(e)}-1===[f.KEY_CODES.ARROW_UP,f.KEY_CODES.ARROW_RIGHT,f.KEY_CODES.ARROW_DOWN,f.KEY_CODES.ARROW_LEFT].indexOf(e.keyCode)&&r.autoResize.resize(String.fromCharCode(e.keyCode))}};d.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",p)},d.prototype.close=function(e){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",p)},d.prototype.focus=function(){this.TEXTAREA.focus(),(0,o.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},d.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),(0,o.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),(0,o.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},d.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":e=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":e=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},d.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()},d.prototype.refreshDimensions=function(){if(this.state===s.EditorState.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close(!0);var e,t=(0,o.offset)(this.TD),n=(0,o.offset)(this.instance.rootElement),r=(0,o.getScrollableElement)(this.TD),i=this.instance.countRows(),a=t.top===n.top?0:1,l=t.top-n.top-a-(r.scrollTop||0),u=t.left-n.left-1-(r.scrollLeft||0),c=this.instance.getSettings(),f=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),h=this.checkEditorSection(),d=this.TD.style.backgroundColor;switch(h){case"top":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(f&&0===this.instance.getSelected()[0]||c.fixedRowsBottom&&this.instance.getSelected()[0]===i-c.fixedRowsBottom)&&(l+=1),0===this.instance.getSelected()[1]&&(u+=1),e&&-1!=e?this.textareaParentStyle[e[0]]=e[1]:(0,o.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top=l+"px",this.textareaParentStyle.left=u+"px";var p=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,g=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,v=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),m=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),y=(0,o.getScrollbarWidth)(),w=this.TD.offsetTop+p-m,b=this.TD.offsetLeft+g-v,C=(0,o.innerWidth)(this.TD)-8,E=(0,o.hasVerticalScrollbar)(r)?y:0,O=(0,o.hasHorizontalScrollbar)(r)?y:0,_=this.instance.view.maximumVisibleElementWidth(b)-9-E,S=this.TD.scrollHeight+1,T=Math.max(this.instance.view.maximumVisibleElementHeight(w)-O,23),R=(0,o.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=R.fontSize,this.TEXTAREA.style.fontFamily=R.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=d||(0,o.getComputedStyle)(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(S,T),maxHeight:T,minWidth:Math.min(C,_),maxWidth:_},!0),this.textareaParentStyle.display="block"}},d.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){(0,h.stopPropagation)(e)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){(0,h.stopPropagation)(e)}),this.instance.addHook("afterScrollHorizontally",function(){e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.destroy()})},d.prototype.destroy=function(){this.eventManager.destroy()},t.default=d},function(e,t,n){"use strict";function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:f(e,t)}function o(e,t){return""===e&&(e="("+t+")"),e}function i(e){return h&&(e=new Set(e)),function(t){return h?e.has(t):!!~e.indexOf(t)}}function a(e){return null==e?"":e}function s(e){return e=d?Array.from(new Set(e)):(0,c.arrayUnique)(e),e=e.sort(function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1})}function l(e,t,n,r){var a=[],s=e===t,l=void 0;return s||(l=i(t)),(0,c.arrayEach)(e,function(e){var t=!1;(s||l(e))&&(t=!0);var i={checked:t,value:e,visualValue:o(e,n)};r&&r(i),a.push(i)}),a}t.__esModule=!0,t.sortComparison=r,t.toVisualValue=o,t.createArrayAssertion=i,t.toEmptyString=a,t.unifyColumnValues=s,t.intersectValues=l;var u=n(42),c=n(0),f=(0,u.getComparisonFunction)(),h=new Set([1]).has(1),d=h&&"function"==typeof Array.from},function(e,t,n){"use strict";function r(e){if(!a[e])throw Error('Operation with id "'+e+'" does not exist.');var t=a[e].func;return function(e,n){return t(e,n)}}function o(e){return a[e].name}function i(e,t,n){a[e]={name:t,func:n}}t.__esModule=!0,t.getOperationFunc=r,t.getOperationName=o,t.registerOperation=i;var a=t.operations={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=n(31),l=r(s),u=n(7),c=r(u),f=n(1),h=n(0),d=["click","input","keydown","keypress","keyup","focus","blur","change"],p=function(){function e(t,n){o(this,e),this.hot=t,this.eventManager=new c.default(this),this.options=(0,a.extend)(e.DEFAULTS,n),this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}return i(e,null,[{key:"DEFAULTS",get:function(){return(0,a.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),i(e,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return"built"===this.buildState}},{key:"build",value:function(){var e=this,t=function(t,n){e.eventManager.addEventListener(t,n,function(t){return e.runLocalHooks(n,t,e)})};if(this.buildState||(this.buildState="building"),this.options.className&&(0,f.addClass)(this._element,this.options.className),this.options.children.length)(0,h.arrayEach)(this.options.children,function(t){return e._element.appendChild(t.element)});else if(this.options.wrapIt){var n=document.createElement(this.options.tagName);(0,a.objectEach)(this.options,function(e,t){void 0!==n[t]&&"className"!==t&&"tagName"!==t&&"children"!==t&&(n[t]=e)}),this._element.appendChild(n),(0,h.arrayEach)(d,function(e){return t(n,e)})}else(0,h.arrayEach)(d,function(n){return t(e._element,n)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return"building"===this.buildState?this._element:"built"===this.buildState?(this.update(),this._element):(this.buildState="building",this.build(),this.buildState="built",this._element)}}]),e}();(0,a.mixin)(p,l.default),t.default=p},function(module,exports,__webpack_require__){!function(e,t){module.exports=t()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t){t.nil=new Error("#NULL!"),t.div0=new Error("#DIV/0!"),t.value=new Error("#VALUE!"),t.ref=new Error("#REF!"),t.name=new Error("#NAME?"),t.num=new Error("#NUM!"),t.na=new Error("#N/A"),t.error=new Error("#ERROR!"),t.data=new Error("#GETTING_DATA")},function(e,t,n){var r=n(0);t.flattenShallow=function(e){return e&&e.reduce?e.reduce(function(e,t){var n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]}):e},t.isFlat=function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},t.flatten=function(){for(var e=t.argsToArray.apply(null,arguments);!t.isFlat(e);)e=t.flattenShallow(e);return e},t.argsToArray=function(e){var n=[];return t.arrayEach(e,function(e){n.push(e)}),n},t.numbers=function(){return this.flatten.apply(null,arguments).filter(function(e){return"number"==typeof e})},t.cleanFloat=function(e){return Math.round(1e14*e)/1e14},t.parseBool=function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||r.value},t.parseNumber=function(e){return void 0===e||""===e?r.value:isNaN(e)?r.value:parseFloat(e)},t.parseNumberArray=function(e){var n;if(!e||0===(n=e.length))return r.value;for(var o;n--;){if((o=t.parseNumber(e[n]))===r.value)return o;e[n]=o}return e},t.parseMatrix=function(e){if(!e||0===e.length)return r.value;for(var n,o=0;o<e.length;o++)if(n=t.parseNumberArray(e[o]),e[o]=n,n instanceof Error)return n;return e};var o=new Date(1900,0,1);t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?r.num:t<=60?new Date(o.getTime()+864e5*(t-1)):new Date(o.getTime()+864e5*(t-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?r.value:e},t.parseDateArray=function(e){for(var t,n=e.length;n--;){if((t=this.parseDate(e[n]))===r.value)return t;e[n]=t}return e},t.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){for(var t,n=e.length;n--;)if("number"!=typeof(t=e[n]))if(!0!==t)if(!1!==t){if("string"==typeof t){var r=this.parseNumber(t);e[n]=r instanceof Error?0:r}}else e[n]=0;else e[n]=1;return e},t.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},t.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},t.arrayEach=function(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e},t.transpose=function(e){return e?e[0].map(function(t,n){return e.map(function(e){return e[n]})}):r.value}},function(e,t,n){"use strict";function r(e){var t=void 0;return e=(e+"").replace(/#|!|\?/g,""),p[e]&&(t=p[e]),t||null}function o(e){var t=!1;for(var n in p)if(Object.prototype.hasOwnProperty.call(p,n)&&p[n]===e){t=!0;break}return t}t.__esModule=!0;var i;t.default=r,t.isValidStrict=o;var a=t.ERROR="ERROR",s=t.ERROR_DIV_ZERO="DIV/0",l=t.ERROR_NAME="NAME",u=t.ERROR_NOT_AVAILABLE="N/A",c=t.ERROR_NULL="NULL",f=t.ERROR_NUM="NUM",h=t.ERROR_REF="REF",d=t.ERROR_VALUE="VALUE",p=(i={},i[a]="#ERROR!",i[s]="#DIV/0!",i[l]="#NAME?",i[u]="#N/A",i[c]="#NULL!",i[f]="#NUM!",i[h]="#REF!",i[d]="#VALUE!",i)},function(e,t,n){"use strict";function r(e){var t=void 0;return"number"==typeof e?t=e:"string"==typeof e&&(t=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)),t}function o(e){return-1*r(e)}t.__esModule=!0,t.toNumber=r,t.invertNumber=o},function(module,exports,__webpack_require__){var utils=__webpack_require__(1),error=__webpack_require__(0),statistical=__webpack_require__(5),information=__webpack_require__(7);exports.ABS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(e)},exports.ACOS=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.acos(e);return isNaN(t)&&(t=error.num),t},exports.ACOSH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=error.num),t},exports.ACOT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},exports.ACOTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=error.num),t},exports.AGGREGATE=function(e,t,n,r){if(e=utils.parseNumber(e),t=utils.parseNumber(e),utils.anyIsError(e,t))return error.value;switch(e){case 1:return statistical.AVERAGE(n);case 2:return statistical.COUNT(n);case 3:return statistical.COUNTA(n);case 4:return statistical.MAX(n);case 5:return statistical.MIN(n);case 6:return exports.PRODUCT(n);case 7:return statistical.STDEV.S(n);case 8:return statistical.STDEV.P(n);case 9:return exports.SUM(n);case 10:return statistical.VAR.S(n);case 11:return statistical.VAR.P(n);case 12:return statistical.MEDIAN(n);case 13:return statistical.MODE.SNGL(n);case 14:return statistical.LARGE(n,r);case 15:return statistical.SMALL(n,r);case 16:return statistical.PERCENTILE.INC(n,r);case 17:return statistical.QUARTILE.INC(n,r);case 18:return statistical.PERCENTILE.EXC(n,r);case 19:return statistical.QUARTILE.EXC(n,r)}},exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},exports.ASIN=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.asin(e);return isNaN(t)&&(t=error.num),t},exports.ASINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},exports.ATANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=error.num),t},exports.BASE=function(e,t,n){if(n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;n=void 0===n?0:n;var r=e.toString(t);return new Array(Math.max(n+1-r.length,0)).join("0")+r},exports.CEILING=function(e,t,n){if(t=void 0===t?1:Math.abs(t),n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;if(0===t)return 0;var r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,r):0===n?-exports.ROUND(Math.floor(Math.abs(e)/t)*t,r):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,r)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return e=utils.parseNumber(e),e instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=function(e){return arguments.length<1?error.na:"number"!=typeof e||arguments.length>1?error.error:e=Math.exp(e)};var MEMOIZED_FACT=[];exports.FACT=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:MEMOIZED_FACT[t]=exports.FACT(t-1)*t},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return 0;if(!(e>0&&t>0||e<0&&t<0))return error.num;t=Math.abs(t);var n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/t)*t,n):-exports.ROUND(Math.ceil(Math.abs(e)/t),n)},exports.FLOOR.MATH=function(e,t,n){if(t=void 0===t?1:t,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;if(0===t)return 0;t=t?Math.abs(t):1;var r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/t)*t,r):0===n||void 0===n?-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,r):-exports.ROUND(Math.floor(Math.abs(e)/t)*t,r)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,n=e[0],r=n<0?-n:n,o=1;o<t;o++){for(var i=e[o],a=i<0?-i:i;r&&a;)r>a?r%=a:a%=r;r+=a}return r},exports.INT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,n,r,o,i=1;void 0!==(r=e.pop());)for(;r>1;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);o=t<=n?t:r}else o=2;for(r/=o,i*=o,t=e.length;t;e[--t]%o==0&&1==(e[t]/=o)&&e.splice(t,1));}return i},exports.LN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)},exports.LN10=function(){return Math.log(10)},exports.LN2=function(){return Math.log(2)},exports.LOG10E=function(){return Math.LOG10E},exports.LOG2E=function(){return Math.LOG2E},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(t=void 0===t?10:t,Math.log(e)/Math.log(t))},exports.LOG10=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var n=Math.abs(e%t);return t>0?n:-n},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=1,r=0;r<e.length;r++)t+=e[r],n*=exports.FACT(e[r]);return exports.FACT(t)/n},exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.E=function(){return Math.E},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=Math.pow(e,t);return isNaN(n)?error.num:n},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,n=0;n<e.length;n++)t*=e[n];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;for(var t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",o=3;o--;)r=(n[+t.pop()+10*o]||"")+r;return new Array(+t.join("")+1).join("M")+r},exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,n,r){if(e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumberArray(r),utils.anyIsError(e,t,n,r))return error.value;for(var o=r[0]*Math.pow(e,t),i=1;i<r.length;i++)o+=r[i]*Math.pow(e,t+i*n);return o},exports.SIGN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SQRT1_2=function(){return 1/Math.sqrt(2)},exports.SQRT2=function(){return Math.sqrt(2)},exports.SUBTOTAL=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}},exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){var e=0;return utils.arrayEach(utils.argsToArray(arguments),function(t){if("number"==typeof t)e+=t;else if("string"==typeof t){var n=parseFloat(t);!isNaN(n)&&(e+=n)}else Array.isArray(t)&&(e+=exports.SUM.apply(null,t))}),e},exports.SUMIF=function(range,criteria){if((range=utils.parseNumberArray(utils.flatten(range)))instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var e,t,n,r,o=arguments.length+1,i=0,a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(var s=0;s<arguments[0][a].length;s++){for(e=1,t=1;t<o;t++){if((r=utils.parseNumber(arguments[t-1][a][s]))instanceof Error)return r;e*=r}i+=e}else{for(e=1,t=1;t<o;t++){if((n=utils.parseNumber(arguments[t-1][a]))instanceof Error)return n;e*=n}i+=e}return i},exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=e.length,r=0;r<n;r++)t+=information.ISNUMBER(e[r])?e[r]*e[r]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=0,r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n=0;e=utils.flatten(e),t=utils.flatten(t);for(var r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},exports.TAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(4),text=__webpack_require__(6),jStat=__webpack_require__(11).jStat,utils=__webpack_require__(1),error=__webpack_require__(0),misc=__webpack_require__(12);exports.AVEDEV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.sum(jStat(e).subtract(jStat.mean(e)).abs()[0])/e.length},exports.AVERAGE=function(){for(var e,t=utils.numbers(utils.flatten(arguments)),n=t.length,r=0,o=0,i=0;i<n;i++)r+=t[i],o+=1;return e=r/o,isNaN(e)&&(e=error.num),e},exports.AVERAGEA=function(){for(var e,t=utils.flatten(arguments),n=t.length,r=0,o=0,i=0;i<n;i++){var a=t[i];"number"==typeof a&&(r+=a),!0===a&&r++,null!==a&&o++}return e=r/o,isNaN(e)&&(e=error.num),e},exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1)return error.na;if(average_range=average_range||range,range=utils.flatten(range),(average_range=utils.parseNumberArray(utils.flatten(average_range)))instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(e,t,n,r,o,i){return arguments.length<4?error.value:(o=void 0===o?0:o,i=void 0===i?1:i,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),o=utils.parseNumber(o),i=utils.parseNumber(i),utils.anyIsError(e,t,n,o,i)?error.value:(e=(e-o)/(i-o),r?jStat.beta.cdf(e,t,n):jStat.beta.pdf(e,t,n)))},exports.BETA.INV=function(e,t,n,r,o){return r=void 0===r?0:r,o=void 0===o?1:o,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),o=utils.parseNumber(o),utils.anyIsError(e,t,n,r,o)?error.value:jStat.beta.inv(e,t,n)*(o-r)+r},exports.BINOM={},exports.BINOM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r)?error.value:r?jStat.binomial.cdf(e,t,n):jStat.binomial.pdf(e,t,n)},exports.BINOM.DIST.RANGE=function(e,t,n,r){if(r=void 0===r?n:r,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r))return error.value;for(var o=0,i=n;i<=r;i++)o+=mathTrig.COMBIN(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return o},exports.BINOM.INV=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;for(var r=0;r<=e;){if(jStat.binomial.cdf(r,e,t)>=n)return r;r++}},exports.CHISQ={},exports.CHISQ.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.chisquare.cdf(e,t):jStat.chisquare.pdf(e,t)},exports.CHISQ.DIST.RT=function(e,t){return!e|!t?error.na:e<1||t>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t?error.value:1-jStat.chisquare.cdf(e,t)},exports.CHISQ.INV=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:jStat.chisquare.inv(e,t)},exports.CHISQ.INV.RT=function(e,t){return!e|!t?error.na:e<0||e>1||t<1||t>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t?error.value:jStat.chisquare.inv(1-e,t)},exports.CHISQ.TEST=function(e,t){if(2!==arguments.length)return error.na;if(!(e instanceof Array&&t instanceof Array))return error.value;if(e.length!==t.length)return error.value;if(e[0]&&t[0]&&e[0].length!==t[0].length)return error.value;var n,r,o,i=e.length;for(r=0;r<i;r++)e[r]instanceof Array||(n=e[r],e[r]=[],e[r].push(n)),t[r]instanceof Array||(n=t[r],t[r]=[],t[r].push(n));var a=e[0].length,s=1===a?i-1:(i-1)*(a-1),l=0,u=Math.PI;for(r=0;r<i;r++)for(o=0;o<a;o++)l+=Math.pow(e[r][o]-t[r][o],2)/t[r][o];return Math.round(1e6*function(e,t){var n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));for(var r=t;r>=2;)n=n*e/r,r-=2;for(var o=n,i=t;o>1e-10*n;)i+=2,o=o*e/i,n+=o;return 1-n}(l,s))/1e6},exports.COLUMN=function(e,t){return 2!==arguments.length?error.na:t<0?error.num:e instanceof Array&&"number"==typeof t?0!==e.length?jStat.col(e,t):void 0:error.value},exports.COLUMNS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.cols(e):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.normalci(1,e,t,n)[1]-1},exports.CONFIDENCE.T=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.tci(1,e,t,n)[1]-1},exports.CORREL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:jStat.corrcoeff(e,t)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){var n=0;e=utils.flatten(e);for(var r=0;r<e.length;r++)e[r]===t&&n++;return n},exports.COUNTBLANK=function(){for(var e,t=utils.flatten(arguments),n=0,r=0;r<t.length;r++)null!==(e=t[r])&&""!==e||n++;return n},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)results[j]="string"!=typeof range[j]?results[j]&&eval(range[j]+criteria):results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=0,i=e.length,a=0;a<i;a++)o+=(e[a]-n)*(t[a]-r);return o/i},exports.COVARIANCE.S=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:jStat.covariance(e,t)},exports.DEVSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},exports.EXPON={},exports.EXPON.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.exponential.cdf(e,t):jStat.exponential.pdf(e,t)},exports.F={},exports.F.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.centralF.cdf(e,t,n):jStat.centralF.pdf(e,t,n)},exports.F.DIST.RT=function(e,t,n){return 3!==arguments.length?error.na:e<0||t<1||n<1?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:1-jStat.centralF.cdf(e,t,n)},exports.F.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:e<=0||e>1?error.num:jStat.centralF.inv(e,t,n)},exports.F.INV.RT=function(e,t,n){return 3!==arguments.length?error.na:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:jStat.centralF.inv(1-e,t,n)},exports.F.TEST=function(e,t){if(!e||!t)return error.na;if(!(e instanceof Array&&t instanceof Array))return error.na;if(e.length<2||t.length<2)return error.div0;var n=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},r=mathTrig.SUM(e)/e.length,o=mathTrig.SUM(t)/t.length;return n(e,r)/(e.length-1)/(n(t,o)/(t.length-1))},exports.FISHER=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.FORECAST=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(e,t,n))return error.value;for(var r=jStat.mean(n),o=jStat.mean(t),i=n.length,a=0,s=0,l=0;l<i;l++)a+=(n[l]-r)*(t[l]-o),s+=Math.pow(n[l]-r,2);var u=a/s;return o-u*r+u*e},exports.FREQUENCY=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=e.length,r=t.length,o=[],i=0;i<=r;i++){o[i]=0;for(var a=0;a<n;a++)0===i?e[a]<=t[0]&&(o[0]+=1):i<r?e[a]>t[i-1]&&e[a]<=t[i]&&(o[i]+=1):i===r&&e[a]>t[r-1]&&(o[r]+=1)}return o},exports.GAMMA=function(e){return e=utils.parseNumber(e),e instanceof Error?e:0===e?error.num:parseInt(e,10)===e&&e<0?error.num:jStat.gammafn(e)},exports.GAMMA.DIST=function(e,t,n,r){return 4!==arguments.length?error.na:e<0||t<=0||n<=0?error.value:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:r?jStat.gamma.cdf(e,t,n,!0):jStat.gamma.pdf(e,t,n,!1)},exports.GAMMA.INV=function(e,t,n){return 3!==arguments.length?error.na:e<0||e>1||t<=0||n<=0?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:jStat.gamma.inv(e,t,n)},exports.GAMMALN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.gammaln(e)},exports.GAMMALN.PRECISE=function(e){return 1!==arguments.length?error.na:e<=0?error.num:"number"!=typeof e?error.value:jStat.gammaln(e)},exports.GAUSS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.normal.cdf(e,0,1)-.5},exports.GEOMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.geomean(e)},exports.GROWTH=function(e,t,n,r){if((e=utils.parseNumberArray(e))instanceof Error)return e;var o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);if(t=utils.parseNumberArray(t),n=utils.parseNumberArray(n),utils.anyIsError(t,n))return error.value;void 0===r&&(r=!0);var i=e.length,a=0,s=0,l=0,u=0;for(o=0;o<i;o++){var c=t[o],f=Math.log(e[o]);a+=c,s+=f,l+=c*f,u+=c*c}a/=i,s/=i,l/=i,u/=i;var h,d;r?(h=(l-a*s)/(u-a*a),d=s-h*a):(h=l/u,d=0);var p=[];for(o=0;o<n.length;o++)p.push(Math.exp(d+h*n[o]));return p},exports.HARMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,n=0,r=0;r<t;r++)n+=1/e[r];return t/n},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(e,t,n,r,o){function i(e,t,n,r){return mathTrig.COMBIN(n,e)*mathTrig.COMBIN(r-n,t-e)/mathTrig.COMBIN(r,t)}return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r)?error.value:o?function(e,t,n,r){for(var o=0,a=0;a<=e;a++)o+=i(a,t,n,r);return o}(e,t,n,r):i(e,t,n,r)},exports.INTERCEPT=function(e,t){return e=utils.parseNumberArray(e),t=utils.parseNumberArray(t),utils.anyIsError(e,t)?error.value:e.length!==t.length?error.na:exports.FORECAST(0,e,t)},exports.KURT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return r/=Math.pow(jStat.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return t-e})[t-1]},exports.LINEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=t.length,i=0,a=0,s=0;s<o;s++)i+=(t[s]-r)*(e[s]-n),a+=Math.pow(t[s]-r,2);var l=i/a;return[l,n-l*r]},exports.LOGEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=0;n<e.length;n++)e[n]=Math.log(e[n]);var r=exports.LINEST(e,t);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},exports.LOGNORM={},exports.LOGNORM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.lognormal.cdf(e,t,n):jStat.lognormal.pdf(e,t,n)},exports.LOGNORM.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.lognormal.inv(e,t,n)},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MEDIAN=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments)),t=jStat.median(e);return isNaN(t)&&(t=error.num),t},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,n=e.length,r={},o=[],i=0,a=0;a<n;a++)t=e[a],r[t]=r[t]?r[t]+1:1,r[t]>i&&(i=r[t],o=[]),r[t]===i&&(o[o.length]=t);return o},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(e,t){return e-t})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.negbin.cdf(e,t,n):jStat.negbin.pdf(e,t,n)},exports.NORM={},exports.NORM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:n<=0?error.num:r?jStat.normal.cdf(e,t,n):jStat.normal.pdf(e,t,n)},exports.NORM.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.normal.inv(e,t,n)},exports.NORM.S={},exports.NORM.S.DIST=function(e,t){return e=utils.parseNumber(e),e instanceof Error?error.value:t?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)},exports.NORM.S.INV=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:jStat.normal.inv(e,0,1)},exports.PEARSON=function(e,t){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=e.length,i=0,a=0,s=0,l=0;l<o;l++)i+=(e[l]-n)*(t[l]-r),a+=Math.pow(e[l]-n,2),s+=Math.pow(t[l]-r,2);return i/Math.sqrt(a*s)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort(function(e,t){return e-t});var n=e.length;if(t<1/(n+1)||t>1-1/(n+1))return error.num;var r=t*(n+1)-1,o=Math.floor(r);return utils.cleanFloat(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort(function(e,t){return e-t});var n=e.length,r=t*(n-1),o=Math.floor(r);return utils.cleanFloat(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,n){if(n=void 0===n?3:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;e=e.sort(function(e,t){return e-t});for(var r=misc.UNIQUE.apply(null,e),o=e.length,i=r.length,a=Math.pow(10,n),s=0,l=!1,u=0;!l&&u<i;)t===r[u]?(s=(e.indexOf(r[u])+1)/(o+1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(s=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(o+1),l=!0),u++;return Math.floor(s*a)/a},exports.PERCENTRANK.INC=function(e,t,n){if(n=void 0===n?3:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;e=e.sort(function(e,t){return e-t});for(var r=misc.UNIQUE.apply(null,e),o=e.length,i=r.length,a=Math.pow(10,n),s=0,l=!1,u=0;!l&&u<i;)t===r[u]?(s=e.indexOf(r[u])/(o-1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(s=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(o-1),l=!0),u++;return Math.floor(s*a)/a},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:mathTrig.FACT(e)/mathTrig.FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:Math.exp(-.5*e*e)/2.5066282746310002},exports.POISSON={},exports.POISSON.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.poisson.cdf(e,t):jStat.poisson.pdf(e,t)},exports.PROB=function(e,t,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r))return error.value;if(n===r)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;for(var o=e.sort(function(e,t){return e-t}),i=o.length,a=0,s=0;s<i;s++)o[s]>=n&&o[s]<=r&&(a+=t[e.indexOf(o[s])]);return a},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;t=utils.flatten(t),n=n||!1,t=t.sort(n?function(e,t){return e-t}:function(e,t){return t-e});for(var r=t.length,o=0,i=0;i<r;i++)t[i]===e&&o++;return o>1?(2*t.indexOf(e)+o+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:(n=n||!1,t=t.sort(n?function(e,t){return e-t}:function(e,t){return t-e}),t.indexOf(e)+1)},exports.ROW=function(e,t){return 2!==arguments.length?error.na:t<0?error.num:e instanceof Array&&"number"==typeof t?0!==e.length?jStat.row(e,t):void 0:error.value},exports.ROWS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.rows(e):error.value},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SKEW=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(jStat.stdev(e,!0),3))},exports.SKEW.P=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0,i=0;i<n;i++)o+=Math.pow(e[i]-t,3),r+=Math.pow(e[i]-t,2);return o/=n,r/=n,o/Math.pow(r,1.5)},exports.SLOPE=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,i=0,a=0,s=0;s<o;s++)i+=(t[s]-n)*(e[s]-r),a+=Math.pow(t[s]-n,2);return i/a},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return e-t})[t-1]},exports.STANDARDIZE=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:(e-t)/n},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments),t=Math.sqrt(e);return isNaN(t)&&(t=error.num),t},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments),t=Math.sqrt(e);return isNaN(t)&&(t=error.num),t},exports.STEYX=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,i=0,a=0,s=0,l=0;l<o;l++)i+=Math.pow(e[l]-r,2),a+=(t[l]-n)*(e[l]-r),s+=Math.pow(t[l]-n,2);return Math.sqrt((i-a*a/s)/(o-2))},exports.TRANSPOSE=function(e){return e?jStat.transpose(e):error.na},exports.T=text.T,exports.T.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.studentt.cdf(e,t):jStat.studentt.pdf(e,t)},exports.T.DIST["2T"]=function(e,t){return 2!==arguments.length?error.na:e<0||t<1?error.num:"number"!=typeof e||"number"!=typeof t?error.value:2*(1-jStat.studentt.cdf(e,t))},exports.T.DIST.RT=function(e,t){return 2!==arguments.length?error.na:e<0||t<1?error.num:"number"!=typeof e||"number"!=typeof t?error.value:1-jStat.studentt.cdf(e,t)},exports.T.INV=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:jStat.studentt.inv(e,t)},exports.T.INV["2T"]=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),e<=0||e>1||t<1?error.num:utils.anyIsError(e,t)?error.value:Math.abs(jStat.studentt.inv(e/2,t))},exports.T.TEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n,r=jStat.mean(e),o=jStat.mean(t),i=0,a=0;for(n=0;n<e.length;n++)i+=Math.pow(e[n]-r,2);for(n=0;n<t.length;n++)a+=Math.pow(t[n]-o,2);i/=e.length-1,a/=t.length-1;var s=Math.abs(r-o)/Math.sqrt(i/e.length+a/t.length);return exports.T.DIST["2T"](s,e.length+t.length-2)},exports.TREND=function(e,t,n){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(e,t,n))return error.value;var r=exports.LINEST(e,t),o=r[0],i=r[1],a=[];return n.forEach(function(e){a.push(o*e+i)}),a},exports.TRIMMEAN=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=mathTrig.FLOOR(e.length*t,2)/2;return jStat.mean(utils.initial(utils.rest(e.sort(function(e,t){return e-t}),n),n))},exports.VAR={},exports.VAR.P=function(){for(var e,t=utils.numbers(utils.flatten(arguments)),n=t.length,r=0,o=exports.AVERAGE(t),i=0;i<n;i++)r+=Math.pow(t[i]-o,2);return e=r/n,isNaN(e)&&(e=error.num),e},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,n=0,r=exports.AVERAGE(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,n=0,r=0,o=exports.AVERAGEA(e),i=0;i<t;i++){var a=e[i];n+="number"==typeof a?Math.pow(a-o,2):!0===a?Math.pow(1-o,2):Math.pow(0-o,2),null!==a&&r++}return n/(r-1)},exports.VARPA=function(){for(var e,t=utils.flatten(arguments),n=t.length,r=0,o=0,i=exports.AVERAGEA(t),a=0;a<n;a++){var s=t[a];r+="number"==typeof s?Math.pow(s-i,2):!0===s?Math.pow(1-i,2):Math.pow(0-i,2),null!==s&&o++}return e=r/o,isNaN(e)&&(e=error.num),e},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},exports.Z={},exports.Z.TEST=function(e,t,n){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;n=n||exports.STDEV.S(e);var r=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(n/Math.sqrt(r)),!0)}},function(e,t,n){var r=n(1),o=n(0),i=n(9);t.ASC=function(){throw new Error("ASC is not implemented")},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.CHAR=function(e){return e=r.parseNumber(e),e instanceof Error?e:String.fromCharCode(e)},t.CLEAN=function(e){return e=e||"",e.replace(/[\0-\x1F]/g,"")},t.CODE=function(e){e=e||"";var t=e.charCodeAt(0);return isNaN(t)&&(t=o.na),t},t.CONCATENATE=function(){for(var e=r.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var n=0;(n=e.indexOf(!1))>-1;)e[n]="FALSE";return e.join("")},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DOLLAR=function(e,t){if(t=void 0===t?2:t,e=r.parseNumber(e),t=r.parseNumber(t),r.anyIsError(e,t))return o.value;var n="";return t<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),n="($0,0)"):t>0&&(n="($0,0."+new Array(t+1).join("0")+")"),i(e).format(n)},t.EXACT=function(e,t){return 2!==arguments.length?o.na:e===t},t.FIND=function(e,t,n){return arguments.length<2?o.na:(n=void 0===n?0:n,t?t.indexOf(e,n-1)+1:null)},t.FIXED=function(e,t,n){if(t=void 0===t?2:t,n=void 0!==n&&n,e=r.parseNumber(e),t=r.parseNumber(t),r.anyIsError(e,t))return o.value;var a=n?"0":"0,0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(a+="."+new Array(t+1).join("0")),i(e).format(a)},t.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach(function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")}):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},t.LEFT=function(e,t){return t=void 0===t?1:t,t=r.parseNumber(t),t instanceof Error||"string"!=typeof e?o.value:e?e.substring(0,t):null},t.LEN=function(e){return 0===arguments.length?o.error:"string"==typeof e?e?e.length:0:e.length?e.length:o.value},t.LOWER=function(e){return"string"!=typeof e?o.value:e?e.toLowerCase():e},t.MID=function(e,t,n){if(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)||"string"!=typeof e)return n;var o=t-1;return e.substring(o,o+n)},t.NUMBERVALUE=function(e,t,n){return t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,""))},t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return void 0===e||0===e.length?o.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?o.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})))},t.REGEXEXTRACT=function(e,t){if(arguments.length<2)return o.na;var n=e.match(new RegExp(t));return n?n[n.length>1?n.length-1:0]:null},t.REGEXMATCH=function(e,t,n){if(arguments.length<2)return o.na;var r=e.match(new RegExp(t));return n?r:!!r},t.REGEXREPLACE=function(e,t,n){return arguments.length<3?o.na:e.replace(new RegExp(t),n)},t.REPLACE=function(e,t,n,i){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)||"string"!=typeof e||"string"!=typeof i?o.value:e.substr(0,t-1)+i+e.substr(t-1+n)},t.REPT=function(e,t){return t=r.parseNumber(t),t instanceof Error?t:new Array(t+1).join(e)},t.RIGHT=function(e,t){return t=void 0===t?1:t,t=r.parseNumber(t),t instanceof Error?t:e?e.substring(e.length-t):o.na},t.SEARCH=function(e,t,n){var r;return"string"!=typeof e||"string"!=typeof t?o.value:(n=void 0===n?0:n,r=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===r?o.value:r)},t.SPLIT=function(e,t){return e.split(t)},t.SUBSTITUTE=function(e,t,n,r){if(arguments.length<2)return o.na;if(!(e&&t&&n))return e;if(void 0===r)return e.replace(new RegExp(t,"g"),n);for(var i=0,a=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++a===r)return e.substring(0,i)+n+e.substring(i+t.length)},t.T=function(e){return"string"==typeof e?e:""},t.TEXT=function(e,t){return e=r.parseNumber(e),r.anyIsError(e)?o.na:i(e).format(t)},t.TRIM=function(e){return"string"!=typeof e?o.value:e.replace(/ +/g," ").trim()},t.UNICHAR=t.CHAR,t.UNICODE=t.CODE,t.UPPER=function(e){return"string"!=typeof e?o.value:e.toUpperCase()},t.VALUE=function(e){if("string"!=typeof e)return o.value;var t=i().unformat(e);return void 0===t?0:t}},function(e,t,n){var r=n(0);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},t.INFO=function(){throw new Error("INFO is not implemented")},t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===r.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=function(e){return!0===e||!1===e},t.ISNA=function(e){return e===r.na},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},t.NA=function(){return r.na},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0}},function(e,t,n){function r(e){return 1===new Date(e,1,29).getMonth()}function o(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function i(e){return(e-l)/864e5+(e>-22038912e5?2:1)}var a=n(0),s=n(1),l=new Date(1900,0,1),u=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],c=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],f=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];t.DATE=function(e,t,n){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?a.value:e<0||t<0||n<0?a.num:new Date(e,t-1,n)},t.DATEVALUE=function(e){if("string"!=typeof e)return a.value;var t=Date.parse(e);return isNaN(t)?a.value:t<=-22038912e5?(t-l)/864e5+1:(t-l)/864e5+2},t.DAY=function(e){var t=s.parseDate(e);return t instanceof Error?t:t.getDate()},t.DAYS=function(e,t){return e=s.parseDate(e),t=s.parseDate(t),e instanceof Error?e:t instanceof Error?t:i(e)-i(t)},t.DAYS360=function(e,t,n){if(n=s.parseBool(n),e=s.parseDate(e),t=s.parseDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;var r,o,i=e.getMonth(),a=t.getMonth();if(n)r=31===e.getDate()?30:e.getDate(),o=31===t.getDate()?30:t.getDate();else{var l=new Date(e.getFullYear(),i+1,0).getDate(),u=new Date(t.getFullYear(),a+1,0).getDate();r=e.getDate()===l?30:e.getDate(),t.getDate()===u?r<30?(a++,o=1):o=30:o=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(a-i)+(o-r)},t.EDATE=function(e,t){return(e=s.parseDate(e))instanceof Error?e:isNaN(t)?a.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),i(e))},t.EOMONTH=function(e,t){return(e=s.parseDate(e))instanceof Error?e:isNaN(t)?a.value:(t=parseInt(t,10),i(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},t.HOUR=function(e){return e=s.parseDate(e),e instanceof Error?e:e.getHours()},t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return a.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var n=Math.floor(e/2592e3);e%=2592e3;var r=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);e%=60;var s=e;return t=t>0?t+"Y":"",n=n>0?n+"M":"",r=r>0?r+"D":"",o=o>0?o+"H":"",i=i>0?i+"M":"",s=s>0?s+"S":"","P"+t+n+r+"T"+o+i+s},t.ISOWEEKNUM=function(e){if((e=s.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return e=s.parseDate(e),e instanceof Error?e:e.getMinutes()},t.MONTH=function(e){return e=s.parseDate(e),e instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,n){return this.NETWORKDAYS.INTL(e,t,1,n)},t.NETWORKDAYS.INTL=function(e,t,n,r){if((e=s.parseDate(e))instanceof Error)return e;if((t=s.parseDate(t))instanceof Error)return t;if(!((n=void 0===n?f[1]:f[n])instanceof Array))return a.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var o=0;o<r.length;o++){var i=s.parseDate(r[o]);if(i instanceof Error)return i;r[o]=i}var l=(t-e)/864e5+1,u=l,c=e;for(o=0;o<l;o++){var h=(new Date).getTimezoneOffset()>0?c.getUTCDay():c.getDay(),d=!1;h!==n[0]&&h!==n[1]||(d=!0);for(var p=0;p<r.length;p++){var g=r[p];if(g.getDate()===c.getDate()&&g.getMonth()===c.getMonth()&&g.getFullYear()===c.getFullYear()){d=!0;break}}d&&u--,c.setDate(c.getDate()+1)}return u},t.NOW=function(){return new Date},t.SECOND=function(e){return e=s.parseDate(e),e instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,n){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?a.value:e<0||t<0||n<0?a.num:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return e=s.parseDate(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TODAY=function(){return new Date},t.WEEKDAY=function(e,t){if((e=s.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return c[t][n]},t.WEEKNUM=function(e,t){if((e=s.parseDate(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var n=u[t],r=new Date(e.getFullYear(),0,1),o=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((e-r)/864e5/7+1)+o},t.WORKDAY=function(e,t,n){return this.WORKDAY.INTL(e,t,1,n)},t.WORKDAY.INTL=function(e,t,n,r){if((e=s.parseDate(e))instanceof Error)return e;if((t=s.parseNumber(t))instanceof Error)return t;if(t<0)return a.num;if(!((n=void 0===n?f[1]:f[n])instanceof Array))return a.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var o=0;o<r.length;o++){var i=s.parseDate(r[o]);if(i instanceof Error)return i;r[o]=i}for(var l=0;l<t;){e.setDate(e.getDate()+1);var u=e.getDay();if(u!==n[0]&&u!==n[1]){for(var c=0;c<r.length;c++){var h=r[c];if(h.getDate()===e.getDate()&&h.getMonth()===e.getMonth()&&h.getFullYear()===e.getFullYear()){l--;break}}l++}}return e},t.YEAR=function(e){return e=s.parseDate(e),e instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,n){if((e=s.parseDate(e))instanceof Error)return e;if((t=s.parseDate(t))instanceof Error)return t;n=n||0;var i=e.getDate(),a=e.getMonth()+1,l=e.getFullYear(),u=t.getDate(),c=t.getMonth()+1,f=t.getFullYear();switch(n){case 0:return 31===i&&31===u?(i=30,u=30):31===i?i=30:30===i&&31===u&&(u=30),(u+30*c+360*f-(i+30*a+360*l))/360;case 1:var h=365;if(l===f||l+1===f&&(a>c||a===c&&i>=u))return(l===f&&r(l)||function(e,t){var n=e.getFullYear(),o=new Date(n,2,1);if(r(n)&&e<o&&t>=o)return!0;var i=t.getFullYear(),a=new Date(i,2,1);return r(i)&&t>=a&&e<a}(e,t)||1===c&&29===u)&&(h=366),o(e,t)/h;var d=f-l+1,p=(new Date(f+1,0,1)-new Date(l,0,1))/1e3/60/60/24,g=p/d;return o(e,t)/g;case 2:return o(e,t)/360;case 3:return o(e,t)/365;case 4:return(u+30*c+360*f-(i+30*a+360*l))/360}}},function(e,t,n){(function(r){var o,i;/*!
 * numbro.js
 * version : 1.11.0
 * author : FÃ¶retagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";function a(e){this._value=e}function s(e){return 0===e?1:Math.floor(Math.log(Math.abs(e))/Math.LN10)+1}function l(e){var t,n="";for(t=0;t<e;t++)n+="0";return n}function u(e,t){var n,r,o,i,a,s,u,c;return c=e.toString(),n=c.split("e")[0],i=c.split("e")[1],r=n.split(".")[0],o=n.split(".")[1]||"",+i>0?c=r+o+l(i-o.length):(a=+r<0?"-0":"0",t>0&&(a+="."),u=l(-1*i-1),s=(u+Math.abs(r)+o).substr(0,t),c=a+s),+i>0&&t>0&&(c+="."+l(t)),c}function c(e,t,n,r){var o,i,a=Math.pow(10,t);return e.toString().indexOf("e")>-1?(i=u(e,t),"-"===i.charAt(0)&&+i>=0&&(i=i.substr(1))):i=(n(e+"e+"+t)/a).toFixed(t),r&&(o=new RegExp("0{1,"+r+"}$"),i=i.replace(o,"")),i}function f(e,t,n){var r=t.replace(/\{[^\{\}]*\}/g,"");return r.indexOf("$")>-1?d(e,N[A].currency.symbol,t,n):r.indexOf("%")>-1?g(e,t,n):r.indexOf(":")>-1?v(e):w(e._value,t,n)}function h(e,t){var n,r,o,i,a,s=t,l=!1;if(t.indexOf(":")>-1)e._value=m(t);else if(t===I)e._value=0;else{for("."!==N[A].delimiters.decimal&&(t=t.replace(/\./g,"").replace(N[A].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+N[A].abbreviations.thousand+"(?:\\)|(\\"+N[A].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+N[A].abbreviations.million+"(?:\\)|(\\"+N[A].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+N[A].abbreviations.billion+"(?:\\)|(\\"+N[A].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+N[A].abbreviations.trillion+"(?:\\)|(\\"+N[A].currency.symbol+")?(?:\\))?)?$"),a=1;a<S.length&&!l;++a)t.indexOf(S[a])>-1?l=Math.pow(1024,a):t.indexOf(T[a])>-1&&(l=Math.pow(1e3,a));var u=t.replace(/[^0-9\.]+/g,"");""===u?e._value=NaN:(e._value=(l||1)*(s.match(n)?Math.pow(10,3):1)*(s.match(r)?Math.pow(10,6):1)*(s.match(o)?Math.pow(10,9):1)*(s.match(i)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(u),e._value=l?Math.ceil(e._value):e._value)}return e._value}function d(e,t,n,r){var o,i,a=n,s=a.indexOf("$"),l=a.indexOf("("),u=a.indexOf("+"),c=a.indexOf("-"),f="",h="";if(-1===a.indexOf("$")?"infix"===N[A].currency.position?(h=t,N[A].currency.spaceSeparated&&(h=" "+h+" ")):N[A].currency.spaceSeparated&&(f=" "):a.indexOf(" $")>-1?(f=" ",a=a.replace(" $","")):a.indexOf("$ ")>-1?(f=" ",a=a.replace("$ ","")):a=a.replace("$",""),i=w(e._value,a,r,h),-1===n.indexOf("$"))switch(N[A].currency.position){case"postfix":i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,f+t),i=i.join("")):i=i+f+t;break;case"infix":break;case"prefix":i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),o=Math.max(l,c)+1,i.splice(o,0,t+f),i=i.join("")):i=t+f+i;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else s<=1?i.indexOf("(")>-1||i.indexOf("+")>-1||i.indexOf("-")>-1?(i=i.split(""),o=1,(s<l||s<u||s<c)&&(o=0),i.splice(o,0,t+f),i=i.join("")):i=t+f+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,f+t),i=i.join("")):i=i+f+t;return i}function p(e,t,n,r){return d(e,t,n,r)}function g(e,t,n){var r,o="",i=100*e._value;return t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%",""),r=w(i,t,n),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,o+"%"),r=r.join("")):r=r+o+"%",r}function v(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}function m(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function y(e,t,n){var r,o,i,a=t[0],s=Math.abs(e);if(s>=n){for(r=1;r<t.length;++r)if(o=Math.pow(n,r),i=Math.pow(n,r+1),s>=o&&s<i){a=t[r],e/=o;break}a===t[0]&&(e/=Math.pow(n,t.length-1),a=t[t.length-1])}return{value:e,suffix:a}}function w(e,t,n,r){var o,i,a,u,f,h,d,p,g,v,m,w,b,C,E,O,_=!1,S=!1,T=!1,R="",k=!1,D=!1,P=!1,x=!1,L=!1,H="",j="",V=Math.abs(e),F="",B=!1,U=!1,W="";if(0===e&&null!==I)return I;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var Y=t.indexOf("}");if(-1===Y)throw Error('Format should also contain a "}"');v=t.slice(1,Y),t=t.slice(Y+1)}else v="";if(t.indexOf("}")===t.length-1&&t.length){var $=t.indexOf("{");if(-1===$)throw Error('Format should also contain a "{"');m=t.slice($+1,-1),t=t.slice(0,$+1)}else m="";var G;for(G=t.match(-1===t.indexOf(".")?/([0-9]+).*/:/([0-9]+)\..*/),E=null===G?-1:G[1].length,-1!==t.indexOf("-")&&(B=!0),t.indexOf("(")>-1?(_=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(S=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),k=t.indexOf("aK")>=0,D=t.indexOf("aM")>=0,P=t.indexOf("aB")>=0,x=t.indexOf("aT")>=0,L=k||D||P||x,t.indexOf(" a")>-1?(R=" ",t=t.replace(" a","")):t=t.replace("a",""),a=s(e),f=a%3,f=0===f?3:f,p&&0!==V&&(h=3*~~((Math.min(p,a)-f)/3),V/=Math.pow(10,h)),a!==p&&(V>=Math.pow(10,12)&&!L||x?(R+=N[A].abbreviations.trillion,e/=Math.pow(10,12)):V<Math.pow(10,12)&&V>=Math.pow(10,9)&&!L||P?(R+=N[A].abbreviations.billion,e/=Math.pow(10,9)):V<Math.pow(10,9)&&V>=Math.pow(10,6)&&!L||D?(R+=N[A].abbreviations.million,e/=Math.pow(10,6)):(V<Math.pow(10,6)&&V>=Math.pow(10,3)&&!L||k)&&(R+=N[A].abbreviations.thousand,e/=Math.pow(10,3))),u=s(e),p&&u<p&&-1===t.indexOf(".")&&(t+="[.]",t+=l(p-u))),O=0;O<M.length;++O)if(o=M[O],t.indexOf(o.marker)>-1){t.indexOf(" "+o.marker)>-1&&(H=" "),t=t.replace(H+o.marker,""),i=y(e,o.suffixes,o.scale),e=i.value,H+=i.suffix;break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(j=" ",t=t.replace(" o","")):t=t.replace("o",""),N[A].ordinal&&(j+=N[A].ordinal(e))),t.indexOf("[.]")>-1&&(T=!0,t=t.replace("[.]",".")),g=t.split(".")[1],w=t.indexOf(","),g){var z=[];if(-1!==g.indexOf("*")?(F=e.toString(),z=F.split("."),z.length>1&&(F=c(e,z[1].length,n))):g.indexOf("[")>-1?(g=g.replace("]",""),g=g.split("["),F=c(e,g[0].length+g[1].length,n,g[1].length)):F=c(e,g.length,n),z=F.split("."),d=z[0],z.length>1&&z[1].length){F=(r?R+r:N[A].delimiters.decimal)+z[1]}else F="";T&&0===Number(F.slice(1))&&(F="")}else d=c(e,0,n);return d.indexOf("-")>-1&&(d=d.slice(1),U=!0),d.length<E&&(d=l(E-d.length)+d),w>-1&&(d=d.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+N[A].delimiters.thousands)),0===t.indexOf(".")&&(d=""),b=t.indexOf("("),C=t.indexOf("-"),W=b<C?(_&&U?"(":"")+(B&&U||!_&&U?"-":""):(B&&U||!_&&U?"-":"")+(_&&U?"(":""),v+W+(!U&&S&&0!==e?"+":"")+d+F+(j||"")+(R&&!r?R:"")+(H||"")+(_&&U?")":"")+m}function b(e,t){N[e]=t}function C(e){A=e;var t=N[e].defaults;t&&t.format&&_.defaultFormat(t.format),t&&t.currencyFormat&&_.defaultCurrencyFormat(t.currencyFormat)}function E(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function O(){return Array.prototype.slice.call(arguments).reduce(function(e,t){var n=E(e),r=E(t);return n>r?n:r},-1/0)}var _,S=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],T=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],R={general:{scale:1024,suffixes:T,marker:"bd"},binary:{scale:1024,suffixes:S,marker:"b"},decimal:{scale:1e3,suffixes:T,marker:"d"}},M=[R.general,R.binary,R.decimal],N={},k=N,A="en-US",I=null,D="0,0",P="0$",x=void 0!==e&&e.exports,L={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};_=function(e){return e=_.isNumbro(e)?e.value():"string"==typeof e||"number"==typeof e?_.fn.unformat(e):NaN,new a(Number(e))},_.version="1.11.0",_.isNumbro=function(e){return e instanceof a},_.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=e,r=e.split("-")[0],o=null;k[n]||(Object.keys(k).forEach(function(e){o||e.split("-")[0]!==r||(o=e)}),n=o||t||"en-US"),C(n)},_.setCulture=function(e,t){var n=e,r=e.split("-")[1],o=null;N[n]||(r&&Object.keys(N).forEach(function(e){o||e.split("-")[1]!==r||(o=e)}),n=o||t||"en-US"),C(n)},_.language=function(e,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return A;if(e&&!t){if(!k[e])throw new Error("Unknown language : "+e);C(e)}return!t&&k[e]||b(e,t),_},_.culture=function(e,t){if(!e)return A;if(e&&!t){if(!N[e])throw new Error("Unknown culture : "+e);C(e)}return!t&&N[e]||b(e,t),_},_.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return k[A];if(!k[e])throw new Error("Unknown language : "+e);return k[e]},_.cultureData=function(e){if(!e)return N[A];if(!N[e])throw new Error("Unknown culture : "+e);return N[e]},_.culture("en-US",L),_.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),k},_.cultures=function(){return N},_.zeroFormat=function(e){I="string"==typeof e?e:null},_.defaultFormat=function(e){D="string"==typeof e?e:"0.0"},_.defaultCurrencyFormat=function(e){P="string"==typeof e?e:"0$"},_.validate=function(e,t){var n,r,o,i,a,s,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),e=e.replace(/^[+-]?/,""),e.match(/^\d+$/))return!0;if(""===e)return!1;try{l=_.cultureData(t)}catch(e){l=_.cultureData(_.culture())}return o=l.currency.symbol,a=l.abbreviations,n=l.delimiters.decimal,r="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=e.match(/^[^\d\.\,]+/))||(e=e.substr(1),u[0]===o))&&((null===(u=e.match(/[^\d]+$/))||(e=e.slice(0,-1),u[0]===a.thousand||u[0]===a.million||u[0]===a.billion||u[0]===a.trillion))&&(s=new RegExp(r+"{2}"),!e.match(/[^\d.,]/g)&&(i=e.split(n),!(i.length>2)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(s):""===i[0]?!i[0].match(s)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(s)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(s)&&!!i[1].match(/^\d+$/)))))},_.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),_.loadCulturesInNode()},_.loadCulturesInNode=function(){var e=n(27);for(var t in e)t&&_.culture(t,e[t])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,r,o=this.length>>>0,i=!1;for(1<arguments.length&&(r=t,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?r=e(r,this[n],n,this):(r=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return r}),_.fn=a.prototype={clone:function(){return _(this)},format:function(e,t){return f(this,e||D,void 0!==t?t:Math.round)},formatCurrency:function(e,t){return d(this,N[A].currency.symbol,e||P,void 0!==t?t:Math.round)},formatForeignCurrency:function(e,t,n){return p(this,e,t||P,void 0!==n?n:Math.round)},unformat:function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=h(this,e);return isNaN(t)?void 0:t}},binaryByteUnits:function(){return y(this._value,R.binary.suffixes,R.binary.scale).suffix},byteUnits:function(){return y(this._value,R.general.suffixes,R.general.scale).suffix},decimalByteUnits:function(){return y(this._value,R.decimal.suffixes,R.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+n*t}var n=O.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t){return e-n*t}var n=O.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t){var n=O(e,t),r=e*n;return r*=t*n,r/=n*n}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var n=O(e,t);return e*n/(t*n)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(_(this._value).subtract(e).value())}},function(){return void 0!==r&&void 0===r.browser&&r.title&&(-1!==r.title.indexOf("node")||r.title.indexOf("meteor-tool")>0||"grunt"===r.title||"gulp"===r.title)&&!0}()&&_.loadCulturesInNode(),x?e.exports=_:("undefined"==typeof ender&&(this.numbro=_),o=[],void 0!==(i=function(){return _}.apply(t,o))&&(e.exports=i))}).call("undefined"==typeof window?this:window)}).call(t,n(10))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){g&&d&&(g=!1,d.length?p=d.concat(p):v=-1,p.length&&s())}function s(){if(!g){var e=o(a);g=!0;for(var t=p.length;t;){for(d=p,p=[];++v<t;)d&&d[v].run();v=-1,t=p.length}d=null,g=!1,i(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,f,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,p=[],g=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||g||o(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){var e=function(e,t){function n(t,n){var r=t>n?t:n;return e.pow(10,17-~~(e.log(r>0?r:-r)*e.LOG10E))}function r(e){return"[object Function]"===d.call(e)}function o(e){return"number"==typeof e&&e===e}function a(e){return f.apply([],e)}function s(){return new s._init(arguments)}function l(){return 0}function u(){return 1}function c(e,t){return e===t?1:0}var f=Array.prototype.concat,h=Array.prototype.slice,d=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===d.call(e)};s.fn=s.prototype,s._init=function(e){var t;if(p(e[0]))if(p(e[0][0])){r(e[1])&&(e[0]=s.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=r(e[1])?s.map(e[0],e[1]):e[0],this.length=1;else if(o(e[0]))this[0]=s.seq.apply(null,e),this.length=1;else{if(e[0]instanceof s)return s(e[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:n,isArray:p,isFunction:r,isNumber:o,toVector:a},s.extend=function(e){var t,n;if(1===arguments.length){for(n in e)s[n]=e[n];return this}for(var t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},s.rows=function(e){return e.length||1},s.cols=function(e){return e[0].length||1},s.dimensions=function(e){return{rows:s.rows(e),cols:s.cols(e)}},s.row=function(e,t){return p(t)?t.map(function(t){return s.row(e,t)}):e[t]},s.rowa=function(e,t){return s.row(e,t)},s.col=function(e,t){if(p(t)){var n=s.arange(e.length).map(function(e){return new Array(t.length)});return t.forEach(function(t,r){s.arange(e.length).forEach(function(o){n[o][r]=e[o][t]})}),n}for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=[e[o][t]];return r},s.cola=function(e,t){return s.col(e,t).map(function(e){return e[0]})},s.diag=function(e){for(var t=s.rows(e),n=new Array(t),r=0;r<t;r++)n[r]=[e[r][r]];return n},s.antidiag=function(e){for(var t=s.rows(e)-1,n=new Array(t),r=0;t>=0;t--,r++)n[r]=[e[r][t]];return n},s.transpose=function(e){var t,n,r,o,i,a=[];p(e[0])||(e=[e]),n=e.length,r=e[0].length;for(var i=0;i<r;i++){for(t=new Array(n),o=0;o<n;o++)t[o]=e[o][i];a.push(t)}return 1===a.length?a[0]:a},s.map=function(e,t,n){var r,o,i,a,s;for(p(e[0])||(e=[e]),o=e.length,i=e[0].length,a=n?e:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),s=0;s<i;s++)a[r][s]=t(e[r][s],r,s);return 1===a.length?a[0]:a},s.cumreduce=function(e,t,n){var r,o,i,a,s;for(p(e[0])||(e=[e]),o=e.length,i=e[0].length,a=n?e:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),i>0&&(a[r][0]=e[r][0]),s=1;s<i;s++)a[r][s]=t(a[r][s-1],e[r][s]);return 1===a.length?a[0]:a},s.alter=function(e,t){return s.map(e,t,!0)},s.create=function(e,t,n){var o,i,a=new Array(e);r(t)&&(n=t,t=e);for(var o=0;o<e;o++)for(a[o]=new Array(t),i=0;i<t;i++)a[o][i]=n(o,i);return a},s.zeros=function(e,t){return o(t)||(t=e),s.create(e,t,l)},s.ones=function(e,t){return o(t)||(t=e),s.create(e,t,u)},s.rand=function(t,n){return o(n)||(n=t),s.create(t,n,e.random)},s.identity=function(e,t){return o(t)||(t=e),s.create(e,t,c)},s.symmetric=function(e){var t,n,r=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<r;t++)for(n=0;n<r;n++)if(e[n][t]!==e[t][n])return!1;return!0},s.clear=function(e){return s.alter(e,l)},s.seq=function(e,t,o,i){r(i)||(i=!1);var a,s=[],l=n(e,t),u=(t*l-e*l)/((o-1)*l),c=e;for(a=0;c<=t&&a<o;a++,c=(e*l+u*l*a)/l)s.push(i?i(c,a):c);return s},s.arange=function(e,n,r){var o=[];if(r=r||1,n===t&&(n=e,e=0),e===n||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(i=e;i<n;i+=r)o.push(i);else for(i=e;i>n;i+=r)o.push(i);return o},s.slice=function(){function e(e,n,r,o){var i,a=[],l=e.length;if(n===t&&r===t&&o===t)return s.copy(e);if(n=n||0,r=r||e.length,n=n>=0?n:l+n,r=r>=0?r:l+r,o=o||1,n===r||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)a.push(e[i]);else for(i=n;i>r;i+=o)a.push(e[i]);return a}function n(t,n){if(n=n||{},o(n.row)){if(o(n.col))return t[n.row][n.col];var r=s.rowa(t,n.row),i=n.col||{};return e(r,i.start,i.end,i.step)}if(o(n.col)){var a=s.cola(t,n.col),l=n.row||{};return e(a,l.start,l.end,l.step)}var l=n.row||{},i=n.col||{};return e(t,l.start,l.end,l.step).map(function(t){return e(t,i.start,i.end,i.step)})}return n}(),s.sliceAssign=function(n,r,i){if(o(r.row)){if(o(r.col))return n[r.row][r.col]=i;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var a=s.arange(r.col.start,e.min(n.length,r.col.end),r.col.step),l=r.row;return a.forEach(function(e,t){n[l][e]=i[t]}),n}if(o(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1;var u=s.arange(r.row.start,e.min(n[0].length,r.row.end),r.row.step),c=r.col;return u.forEach(function(e,t){n[e][c]=i[t]}),n}i[0].length===t&&(i=[i]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var u=s.arange(r.row.start,e.min(n.length,r.row.end),r.row.step),a=s.arange(r.col.start,e.min(n[0].length,r.col.end),r.col.step);return u.forEach(function(e,t){a.forEach(function(r,o){n[e][r]=i[t][o]})}),n},s.diagonal=function(e){var t=s.zeros(e.length,e.length);return e.forEach(function(e,n){t[n][n]=e}),t},s.copy=function(e){return e.map(function(e){return o(e)?e:e.map(function(e){return e})})};var g=s.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?h.call(this):h.call(this)[0]},g.map=function(e,t){return s(s.map(this,e,t))},g.cumreduce=function(e,t){return s(s.cumreduce(this,e,t))},g.alter=function(e){return s.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){g[e]=function(t){var n,r=this;return t?(setTimeout(function(){t.call(r,g[e].call(r))}),this):(n=s[e](this),p(n)?s(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){g[e]=function(t,n){var r=this;return n?(setTimeout(function(){n.call(r,g[e].call(r,t))}),this):s(s[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){g[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")}(e[t])}("create zeros ones rand identity".split(" ")),s}(Math);return function(e,t){function n(e,t){return e-t}function r(e,n,r){return t.max(n,t.min(e,r))}var o=e.utils.isFunction;e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,r=e.mean(t),o=0,i=t.length;--i>=0;)n=t[i]-r,o+=n*n;return o},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){return t.pow(e.product(n),1/n.length)},e.median=function(e){var t=e.length,r=e.slice().sort(n);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){for(var t,n=[],r=e.length,t=1;t<r;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){for(var t=e.length,r=e.slice().sort(n),o=new Array(t),i=0;i<t;i++){var a=r.indexOf(e[i]),s=r.lastIndexOf(e[i]);if(a===s)var l=a;else var l=(a+s)/2;o[i]=l+1}return o},e.mode=function(e){for(var t,r=e.length,o=e.slice().sort(n),i=1,a=0,s=0,l=[],t=0;t<r;t++)o[t]===o[t+1]?i++:(i>a?(l=[o[t]],a=i,s=0):i===a&&(l.push(o[t]),s++),i=1);return 0===s?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce(function(t,n){return t+e.sumsqerr(n)},0)/(t.reduce(function(e,t){return e+t.length},0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),r=t.length,o=new Array(r),i=0;i<r;i++)o[i]=t[i]-n;return o},e.stdev=function(n,r){return t.sqrt(e.variance(n,r))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var r=e.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.mean(o)},e.meddev=function(n){for(var r=e.median(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var r=e.length,o=e.slice().sort(n);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(3*r/4)-1]]},e.quantiles=function(e,o,i,a){var s,l,u,c,f,h,d=e.slice().sort(n),p=[o.length],g=e.length;void 0===i&&(i=3/8),void 0===a&&(a=3/8);for(var s=0;s<o.length;s++)l=o[s],u=i+l*(1-i-a),c=g*l+u,f=t.floor(r(c,1,g-1)),h=r(c-f,0,1),p[s]=(1-h)*d[f-1]+h*d[f];return p},e.percentile=function(e,t){var r=e.slice().sort(n),o=t*(r.length-1),i=parseInt(o),a=o-i;return i+1<r.length?r[i]*(1-a)+r[i+1]*a:r[i]},e.percentileOfScore=function(e,t,n){var r,o,i=0,a=e.length,s=!1;"strict"===n&&(s=!0);for(var o=0;o<a;o++)r=e[o],(s&&r<t||!s&&r<=t)&&i++;return i/a},e.histogram=function(n,r){for(var o,i=e.min(n),a=r||4,s=(e.max(n)-i)/a,l=n.length,r=[],o=0;o<a;o++)r[o]=0;for(var o=0;o<l;o++)r[t.min(t.floor((n[o]-i)/s),a-1)]+=1;return r},e.covariance=function(t,n){for(var r,o=e.mean(t),i=e.mean(n),a=t.length,s=new Array(a),r=0;r<a;r++)s[r]=(t[r]-o)*(n[r]-i);return e.sum(s)/(a-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,r){for(var o=e.mean(n),i=e.stdev(n),a=n.length,s=0,l=0;l<a;l++)s+=t.pow((n[l]-o)/i,r);return s/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(n,r){var a=[],s=0,l=this;if(o(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(l,i[t].call(l,n))}),this;if(this.length>1){for(l=!0===n?this:this.transpose();s<l.length;s++)a[s]=e[t](l[s]);return a}return e[t](this[0],n)}}(t[n])}("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(n,r){var a=[],s=0,l=this;if(o(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(l,i[t].call(l,n))}),this;if(this.length>1){for("sumrow"!==t&&(l=!0===n?this:this.transpose());s<l.length;s++)a[s]=e[t](l[s]);return!0===n?e[t](e.utils.toVector(a)):a}return e[t](this[0],n)}}(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(){var n=[],r=0,a=this,s=Array.prototype.slice.call(arguments);if(o(s[s.length-1])){var l=s[s.length-1],u=s.slice(0,s.length-1);return setTimeout(function(){l.call(a,i[t].apply(a,u))}),this}var l=void 0,c=function(n){return e[t].apply(a,[n].concat(s))};if(this.length>1){for(a=a.transpose();r<a.length;r++)n[r]=c(a[r]);return n}return c(this[0])}}(t[n])}("quantiles percentileOfScore".split(" "))}(e,Math),function(e,t){e.gammaln=function(e){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(o=(r=n=e)+5.5,o-=(n+.5)*t.log(o);i<6;i++)s+=a[i]/++r;return t.log(2.5066282746310007*s/n)-o},e.gammafn=function(e){var n,r,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,f=0,h=e;if(h<=0){if(!(i=h%1+3.6e-16))return 1/0;l=(1&h?-1:1)*t.PI/t.sin(t.PI*i),h=1-h}o=h,r=h<1?h++:(h-=u=(0|h)-1)-1;for(var n=0;n<8;++n)f=(f+a[n])*r,c=c*r+s[n];if(i=f/c+1,o<h)i/=o;else if(o>h)for(var n=0;n<u;++n)i*=h,h++;return l&&(i=l/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,r){var o,i=e.gammaln(n),a=n,s=1/n,l=s,u=r+1-n,c=1/1e-30,f=1/u,h=f,d=1,p=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;d<=p;d++)s+=l*=r/++a;return s*t.exp(-r+n*t.log(r)-i)}for(;d<=p;d++)o=-d*(d-n),u+=2,f=o*f+u,c=u+o/c,f=1/f,h*=f*c;return 1-h*t.exp(-r+n*t.log(r)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,r){return n>170||r>170?t.exp(e.combinationln(n,r)):e.factorial(n)/e.factorial(r)/e.factorial(n-r)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?t.exp(e.betaln(n,r)):e.gammafn(n)*e.gammafn(r)/e.gammafn(n+r)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,r){var o,i,a,s,l=1,u=n+r,c=n+1,f=n-1,h=1,d=1-u*e/c;for(t.abs(d)<1e-30&&(d=1e-30),d=1/d,s=d;l<=100&&(o=2*l,i=l*(r-l)*e/((f+o)*(n+o)),d=1+i*d,t.abs(d)<1e-30&&(d=1e-30),h=1+i/h,t.abs(h)<1e-30&&(h=1e-30),d=1/d,s*=d*h,i=-(n+l)*(u+l)*e/((n+o)*(c+o)),d=1+i*d,t.abs(d)<1e-30&&(d=1e-30),h=1+i/h,t.abs(h)<1e-30&&(h=1e-30),d=1/d,a=d*h,s*=a,!(t.abs(a-1)<3e-7));l++);return s},e.gammapinv=function(n,r){var o,i,a,s,l,u,c,f=0,h=r-1,d=e.gammaln(r);if(n>=1)return t.max(100,r+100*t.sqrt(r));if(n<=0)return 0;for(r>1?(u=t.log(h),c=t.exp(h*(u-1)-d),l=n<.5?n:1-n,a=t.sqrt(-2*t.log(l)),o=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,n<.5&&(o=-o),o=t.max(.001,r*t.pow(1-1/(9*r)-o/(3*t.sqrt(r)),3))):(a=1-r*(.253+.12*r),o=n<a?t.pow(n/a,1/r):1-t.log(1-(n-a)/(1-a)));f<12;f++){if(o<=0)return 0;if(i=e.lowRegGamma(r,o)-n,a=r>1?c*t.exp(-(o-h)+h*(t.log(o)-u)):t.exp(-o+h*t.log(o)-d),s=i/a,o-=a=s/(1-.5*t.min(1,s*((r-1)/o-1))),o<=0&&(o=.5*(o+a)),t.abs(a)<1e-8*o)break}return o},e.erf=function(e){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],s=a.length-1,l=!1,u=0,c=0;for(e<0&&(e=-e,l=!0),n=2/(2+e),r=4*n-2;s>0;s--)o=u,u=r*u-c+a[s],c=o;return i=n*t.exp(-e*e+.5*(a[0]+r*u)-c),l?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var r,o,i,a,s=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,i=t.sqrt(-2*t.log(a/2)),r=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);s<2;s++)o=e.erfc(r)-a,r+=o/(1.1283791670955126*t.exp(-r*r)-r*o);return n<1?r:-r},e.ibetainv=function(n,r,o){var i,a,s,l,u,c,f,h,d,p,g,v=r-1,m=o-1,y=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(s=n<.5?n:1-n,l=t.sqrt(-2*t.log(s)),f=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l,n<.5&&(f=-f),h=(f*f-3)/6,d=2/(1/(2*r-1)+1/(2*o-1)),p=f*t.sqrt(h+d)/d-(1/(2*o-1)-1/(2*r-1))*(h+5/6-2/(3*d)),f=r/(r+o*t.exp(2*p))):(i=t.log(r/(r+o)),a=t.log(o/(r+o)),l=t.exp(r*i)/r,u=t.exp(o*a)/o,p=l+u,f=n<l/p?t.pow(r*p*n,1/r):1-t.pow(o*p*(1-n),1/o)),g=-e.gammaln(r)-e.gammaln(o)+e.gammaln(r+o);y<10;y++){if(0===f||1===f)return f;if(c=e.ibeta(f,r,o)-n,l=t.exp(v*t.log(f)+m*t.log(1-f)+g),u=c/l,f-=l=u/(1-.5*t.min(1,u*(v/f-m/(1-f)))),f<=0&&(f=.5*(f+l)),f>=1&&(f=.5*(f+l+1)),t.abs(l)<1e-8*f&&y>0)break}return f},e.ibeta=function(n,r,o){var i=0===n||1===n?0:t.exp(e.gammaln(r+o)-e.gammaln(r)-e.gammaln(o)+r*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*e.betacf(n,r,o)/r:1-i*e.betacf(1-n,o,r)/o)},e.randn=function(n,r){var o,i,a,s,l;if(r||(r=n),n)return e.create(n,r,function(){return e.randn()});do{o=t.random(),i=1.7156*(t.random()-.5),a=o-.449871,s=t.abs(i)+.386595,l=a*a+s*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o},e.randg=function(n,r,o){var i,a,s,l,u,c,f=n;if(o||(o=r),n||(n=1),r)return c=e.zeros(r,o),c.alter(function(){return e.randg(n)}),c;n<1&&(n+=1),i=n-1/3,a=1/t.sqrt(9*i);do{do{u=e.randn(),l=1+a*u}while(l<=0);l*=l*l,s=t.random()}while(s>1-.331*t.pow(u,4)&&t.log(s)>.5*u*u+i*(1-l+t.log(l)));if(n==f)return i*l;do{s=t.random()}while(0===s);return t.pow(s,1/f)*i*l},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,function(n){return e[t](n)}))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(e,Math),function(e,t){function n(e){return e/t.abs(e)}function r(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var l=2*e.normal.cdf(s,0,1,1,0)-1;l=l>=t.exp(-50/o)?t.pow(l,o):0;var u;u=n>3?2:3;for(var c=s,f=(8-s)/u,h=c+f,d=0,p=o-1,g=1;g<=u;g++){for(var v=0,m=.5*(h+c),y=.5*(h-c),w=1;w<=12;w++){var b,C;6<w?(b=12-w+1,C=i[b-1]):(b=w,C=-i[b-1]);var E=y*C,O=m+E,_=O*O;if(_>60)break;var S=2*e.normal.cdf(O,0,1,1,0),T=2*e.normal.cdf(O,n,1,1,0),R=.5*S-.5*T;R>=t.exp(-30/p)&&(R=a[b-1]*t.exp(-.5*_)*t.pow(R,p),v+=R)}v*=2*y*o/t.sqrt(2*t.PI),d+=v,c=h,h+=f}return(l+=d)<=t.exp(-30/r)?0:(l=t.pow(l,r),l>=1?1:l)}function o(e,n,r){var o=.5-.5*e,i=t.sqrt(t.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(a+=(a*a*a+a)/r/4);var s=.8832-.2368*a;return r<120&&(s+=-1.214/r+1.208*a/r),a*(s*t.log(n-1)+1.4142)}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function(e,t,n){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=n,this):new arguments.callee(e,t,n)},e.fn[t]=function(n,r,o){var i=e[t](n,r,o);return i.data=this,i},e[t].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?e.alter(n,function(){return e[t].sample(r,o,i)}):e[t].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!=typeof r?e.fn.map.call(r,function(r){return e[t][n](r,o,i,a)}):e[t][n](r,o,i,a)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?t.pow(n,r-1)*t.pow(1-n,o-1)/e.betafn(r,o):t.exp((r-1)*t.log(n)+(o-1)*t.log(1-n)-e.betaln(r,o))},cdf:function(t,n,r){return t>1||t<0?1*(t>1):e.ibeta(t,n,r)},inv:function(t,n,r){return e.ibetainv(t,n,r)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var r=e.randg(t);return r/(r+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,r,o){var i,a;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/e.betafn(r/2,o/2)*t.pow(r/o,r/2)*t.pow(n,r/2-1)*t.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),a=o/(o+n*r),r*a/2*e.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(t,n,r){return t<0?0:e.ibeta(n*t/(n*t+r),n/2,r/2)},inv:function(t,n,r){return r/(n*(1/e.ibetainv(t,n/2,r/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,r){return r<0?0:r/(t.pow(e-n,2)+t.pow(r,2))/t.PI},cdf:function(e,n,r){return t.atan((e-n)/r)/t.PI+.5},inv:function(e,n,r){return n+r*t.tan(t.PI*(e-.5))},median:function(e,t){return e},mode:function(e,t){return e},sample:function(n,r){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*r+n}}),e.extend(e.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:t.exp((r/2-1)*t.log(n)-n/2-r/2*t.log(2)-e.gammaln(r/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(e){return 0},sample:function(e){return-1/e*t.log(t.random())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:t.exp((r-1)*t.log(n)-n/o-e.gammaln(r)-r*t.log(o))},cdf:function(t,n,r){return t<0?0:e.lowRegGamma(n,t/r)},inv:function(t,n,r){return e.gammapinv(t,n)*r},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,r,o){return n<=0?0:t.exp(-(r+1)*t.log(n)-o/n-e.gammaln(r)+r*t.log(o))},cdf:function(t,n,r){return t<=0?0:1-e.lowRegGamma(n,r/t)},inv:function(t,n,r){return r/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,r){return 0===e&&1===n?r:1===e&&1===r?n:t.exp(t.log(n)+t.log(r)+(n-1)*t.log(e)+(r-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,r){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),r)},inv:function(e,n,r){return t.pow(1-t.pow(1-e,1/r),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(e,t){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,r){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(e)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*e.erf((t.log(n)-r)/t.sqrt(2*o*o))},inv:function(n,r,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*n)+r)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e,n){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,r){return t.exp(e.randn()*r+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,r,o){return t.abs(o)<1e-14?e.studentt.pdf(n,r):t.abs(n)<1e-14?t.exp(e.gammaln((r+1)/2)-o*o/2-.5*t.log(t.PI*r)-e.gammaln(r/2)):r/n*(e.noncentralt.cdf(n*t.sqrt(1+2/r),r+2,o)-e.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){if(t.abs(o)<1e-14)return e.studentt.cdf(n,r);var i=!1;n<0&&(i=!0,o=-o);for(var a=e.normal.cdf(-o,0,1),s=1e-14+1,l=s,u=n*n/(n*n+r),c=0,f=t.exp(-o*o/2),h=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;c<200||l>1e-14||s>1e-14;)l=s,c>0&&(f*=o*o/(2*c),h*=o*o/(2*(c+.5))),s=f*e.beta.cdf(u,c+.5,r/2)+h*e.beta.cdf(u,c+1,r/2),a+=.5*s,c++;return i?1-a:a}}),e.extend(e.normal,{pdf:function(e,n,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(e-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+e.erf((n-r)/t.sqrt(2*o*o)))},inv:function(t,n,r){return-1.4142135623730951*r*e.erfcinv(2*t)+n},mean:function(e,t){return e},median:function(e,t){return e},mode:function(e,t){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,r){return e<n?0:r*t.pow(n,r)/t.pow(e,r+1)},cdf:function(e,n,r){return e<n?0:1-t.pow(n/e,r)},inv:function(e,n,r){return n/t.pow(1-e,1/r)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e,t){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*e.betafn(.5,r/2))*t.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return e.ibeta((n+t.sqrt(n*n+r))/(2*t.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=e.ibetainv(2*t.min(n,1-n),.5*r,.5);return o=t.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(e){return 0},mode:function(e){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,r){return e<0||n<0||r<0?0:r/n*t.pow(e/n,r-1)*t.exp(-t.pow(e/n,r))},cdf:function(e,n,r){return e<0?0:1-t.exp(-t.pow(e/n,r))},inv:function(e,n,r){return n*t.pow(-t.log(1-e),1/r)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(e,n){return e*t.pow(-t.log(t.random()),1/n)},variance:function(n,r){return n*n*e.gammafn(1+2/r)-t.pow(e.weibull.mean(n,r),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(e,t){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t.random()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:e.combination(r,n)*t.pow(o,n)*t.pow(1-o,r-n)},cdf:function(t,n,r){var o=[],i=0;if(t<0)return 0;if(t<n){for(;i<=t;i++)o[i]=e.binomial.pdf(i,n,r);return e.sum(o)}return 1}}),e.extend(e.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:e.combination(n+r-1,r-1)*t.pow(1-o,n)*t.pow(o,r))},cdf:function(t,n,r){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=e.negbin.pdf(i,n,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,r,o,i){if(n!==n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?e.hypgeom.pdf(r-o-i+n,r,r-o,r-i):e.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return e.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return e.hypgeom.pdf(n,r,i,o);for(var a=1,s=0,l=0;l<n;l++){for(;a>1&&s<i;)a*=1-o/(r-s),s++;a*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;s<i;s++)a*=1-o/(r-s);return t.min(1,t.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?e.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-e.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-e.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return e.hypgeom.cdf(n,r,i,o);for(var a=1,s=1,l=0,u=0;u<n;u++){for(;a>1&&l<i;){var c=1-o/(r-l);s*=c,a*=c,l++}s*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1)),a+=s}for(;l<i;l++)a*=1-o/(r-l);return t.min(1,t.max(0,a))}}),e.extend(e.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:t.pow(r,n)*t.exp(-r)/e.factorial(n)},cdf:function(t,n){var r=[],o=0;if(t<0)return 0;for(;o<=t;o++)r.push(e.poisson.pdf(o,n));return e.sum(r)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var n=1,r=0,o=t.exp(-e);do{r++,n*=t.random()}while(n>o);return r-1}}),e.extend(e.triangular,{pdf:function(e,t,n,r){return n<=t||r<t||r>n?NaN:e<t||e>n?0:e<r?2*(e-t)/((n-t)*(r-t)):e===r?2/(n-t):2*(n-e)/((n-t)*(n-r))},cdf:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=n?0:e>=r?1:e<=o?t.pow(e-n,2)/((r-n)*(o-n)):1-t.pow(r-e,2)/((r-n)*(r-o))},inv:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=(o-n)/(r-n)?n+(r-n)*t.sqrt(e*((o-n)/(r-n))):n+(r-n)*(1-t.sqrt((1-e)*(1-(o-n)/(r-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,r){return r<=(e+n)/2?n-t.sqrt((n-e)*(n-r))/t.sqrt(2):r>(e+n)/2?e+t.sqrt((n-e)*(r-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(e,n,r){var o=t.random();return o<(r-e)/(n-e)?e+t.sqrt(o*(n-e)*(r-e)):n-t.sqrt((1-o)*(n-e)*(n-r))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,r){return r<=n?NaN:e<=n||e>=r?0:2/t.PI*t.pow(t.pow(r-n,2)-t.pow(2*e-n-r,2),-.5)},cdf:function(e,n,r){return e<n?0:e<r?2/t.PI*t.asin(t.sqrt((e-n)/(r-n))):1},inv:function(e,n,r){return n+(.5-.5*t.cos(t.PI*e))*(r-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(e,t){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,r){return r<=0?0:t.exp(-t.abs(e-n)/r)/(2*r)},cdf:function(e,n,r){return r<=0?0:e<n?.5*t.exp((e-n)/r):1-.5*t.exp(-(e-n)/r)},mean:function(e,t){return e},median:function(e,t){return e},mode:function(e,t){return e},variance:function(e,t){return 2*t*t},sample:function(e,r){var o=t.random()-.5;return e-r*n(o)*t.log(1-2*t.abs(o))}}),e.extend(e.tukey,{cdf:function(n,o,i){var a=o,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return r(n,1,a);var u,c=.5*i,f=c*t.log(i)-i*t.log(2)-e.gammaln(c),h=c-1,d=.25*i;u=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=t.log(u);for(var p=0,g=1;g<=50;g++){for(var v=0,m=(2*g-1)*u,y=1;y<=16;y++){var w,b;8<y?(w=y-8-1,b=f+h*t.log(m+s[w]*u)-(s[w]*u+m)*d):(w=y-1,b=f+h*t.log(m-s[w]*u)+(s[w]*u-m)*d);var C;if(b>=-30){C=8<y?n*t.sqrt(.5*(s[w]*u+m)):n*t.sqrt(.5*(-s[w]*u+m));v+=r(C,1,a)*l[w]*t.exp(b)}}if(g*u>=1&&v<=1e-14)break;p+=v}if(v>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(n,r,i){var a=r;if(i<2||a<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var s,l=o(n,a,i),u=e.tukey.cdf(l,r,i)-n;s=u>0?t.max(0,l-1):l+1;for(var c,f=e.tukey.cdf(s,r,i)-n,h=1;h<50;h++){c=s-f*(s-l)/(f-u),u=f,l=s,c<0&&(c=0,f=-n),f=e.tukey.cdf(c,r,i)-n,s=c;if(t.abs(s-l)<1e-4)return c}throw new Error("tukey.inv failed to converge")}})}(e,Math),function(e,t){function n(t){return a(t)||t instanceof e}var o=Array.prototype.push,a=e.utils.isArray;e.extend({add:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.map(t,function(e,t,n){return e+r[t][n]})):e.map(t,function(e){return e+r})},subtract:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.map(t,function(e,t,n){return e-r[t][n]||0})):e.map(t,function(e){return e-r})},divide:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.multiply(t,e.inv(r))):e.map(t,function(e){return e/r})},multiply:function(t,r){var o,i,a,s,l,u,c,f;if(void 0===t.length&&void 0===r.length)return t*r;if(l=t.length,u=t[0].length,c=e.zeros(l,a=n(r)?r[0].length:u),f=0,n(r)){for(;f<a;f++)for(o=0;o<l;o++){for(s=0,i=0;i<u;i++)s+=t[o][i]*r[i][f];c[o][f]=s}return 1===l&&1===f?c[0][0]:c}return e.map(t,function(e){return e*r})},outer:function(t,n){return e.multiply(t.map(function(e){return[e]}),[n])},dot:function(t,r){n(t[0])||(t=[t]),n(r[0])||(r=[r]);for(var o,i,a=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===r[0].length&&1!==r.length?e.transpose(r):r,l=[],u=0,c=a.length,f=a[0].length;u<c;u++){for(l[u]=[],o=0,i=0;i<f;i++)o+=a[u][i]*s[u][i];l[u]=o}return 1===l.length?l[0]:l},pow:function(n,r){return e.map(n,function(e){return t.pow(e,r)})},exp:function(n){return e.map(n,function(e){return t.exp(e)})},log:function(n){return e.map(n,function(e){return t.log(e)})},abs:function(n){return e.map(n,function(e){return t.abs(e)})},norm:function(e,r){var o=0,i=0;for(isNaN(r)&&(r=2),n(e[0])&&(e=e[0]);i<e.length;i++)o+=t.pow(t.abs(e[i]),r);return t.pow(o,1/r)},angle:function(n,r){return t.acos(e.dot(n,r)/(e.norm(n)*e.norm(r)))},aug:function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r].slice());for(var r=0;r<n.length;r++)o.apply(n[r],t[r]);return n},inv:function(t){for(var n,r=t.length,o=t[0].length,i=e.identity(r,o),a=e.gauss_jordan(t,i),s=[],l=0;l<r;l++)for(s[l]=[],n=o;n<a[0].length;n++)s[l][n-o]=a[l][n];return s},det:function(e){var t,n=e.length,r=2*n,o=new Array(r),i=n-1,a=r-1,s=i-n+1,l=a,u=0,c=0;if(2===n)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;u<r;u++)o[u]=1;for(var u=0;u<n;u++){for(t=0;t<n;t++)o[s<0?s+n:s]*=e[u][t],o[l<n?l+n:l]*=e[u][t],s++,l--;s=--i-n+1,l=--a}for(var u=0;u<n;u++)c+=o[u];for(;u<r;u++)c-=o[u];return c},gauss_elimination:function(n,r){var o,i,a,s,l=0,u=0,c=n.length,f=n[0].length,h=1,d=0,p=[];n=e.aug(n,r),o=n[0].length;for(var l=0;l<c;l++){for(i=n[l][l],u=l,s=l+1;s<f;s++)i<t.abs(n[s][l])&&(i=n[s][l],u=s);if(u!=l)for(s=0;s<o;s++)a=n[l][s],n[l][s]=n[u][s],n[u][s]=a;for(u=l+1;u<c;u++)for(h=n[u][l]/n[l][l],s=l;s<o;s++)n[u][s]=n[u][s]-h*n[l][s]}for(var l=c-1;l>=0;l--){for(d=0,u=l+1;u<=c-1;u++)d+=p[u]*n[l][u];p[l]=(n[l][o-1]-d)/n[l][l]}return p},gauss_jordan:function(n,r){for(var o=e.aug(n,r),i=o.length,a=o[0].length,s=0,l=0;l<i;l++){for(var u=l,c=l+1;c<i;c++)t.abs(o[c][l])>t.abs(o[u][l])&&(u=c);var f=o[l];o[l]=o[u],o[u]=f;for(var c=l+1;c<i;c++){s=o[c][l]/o[l][l];for(var h=l;h<a;h++)o[c][h]-=o[l][h]*s}}for(var l=i-1;l>=0;l--){s=o[l][l];for(var c=0;c<l;c++)for(var h=a-1;h>l-1;h--)o[c][h]-=o[l][h]*o[c][l]/s;o[l][l]/=s;for(var h=i;h<a;h++)o[l][h]/=s}return o},triaUpSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return void 0!=n[0].length&&(n=n.map(function(e){return e[0]}),a=!0),e.arange(o-1,-1,-1).forEach(function(a){r=e.arange(a+1,o).map(function(e){return i[e]*t[a][e]}),i[a]=(n[a]-e.sum(r))/t[a][a]}),a?i.map(function(e){return[e]}):i},triaLowSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return void 0!=n[0].length&&(n=n.map(function(e){return e[0]}),a=!0),e.arange(o).forEach(function(o){r=e.arange(o).map(function(e){return t[o][e]*i[e]}),i[o]=(n[o]-e.sum(r))/t[o][o]}),a?i.map(function(e){return[e]}):i},lu:function(t){var n,r=t.length,o=e.identity(r),a=e.zeros(t.length,t[0].length);return e.arange(r).forEach(function(e){a[0][e]=t[0][e]}),e.arange(1,r).forEach(function(s){e.arange(s).forEach(function(r){n=e.arange(r).map(function(e){return o[s][e]*a[e][r]}),o[s][r]=(t[s][r]-e.sum(n))/a[r][r]}),e.arange(s,r).forEach(function(r){n=e.arange(s).map(function(e){return o[s][e]*a[e][r]}),a[s][r]=t[i][r]-e.sum(n)})}),[o,a]},cholesky:function(n){var r,o=n.length,i=e.zeros(n.length,n[0].length);return e.arange(o).forEach(function(a){r=e.arange(a).map(function(e){return t.pow(i[a][e],2)}),i[a][a]=t.sqrt(n[a][a]-e.sum(r)),e.arange(a+1,o).forEach(function(t){r=e.arange(a).map(function(e){return i[a][e]*i[t][e]}),i[t][a]=(n[a][t]-e.sum(r))/i[a][a]})}),i},gauss_jacobi:function(n,r,o,i){for(var a,s,l,u,c=0,f=0,h=n.length,d=[],p=[],g=[];c<h;c++)for(d[c]=[],p[c]=[],g[c]=[],f=0;f<h;f++)c>f?(d[c][f]=n[c][f],p[c][f]=g[c][f]=0):c<f?(p[c][f]=n[c][f],d[c][f]=g[c][f]=0):(g[c][f]=n[c][f],d[c][f]=p[c][f]=0);for(l=e.multiply(e.multiply(e.inv(g),e.add(d,p)),-1),s=e.multiply(e.inv(g),r),a=o,u=e.add(e.multiply(l,o),s),c=2;t.abs(e.norm(e.subtract(u,a)))>i;)a=u,u=e.add(e.multiply(l,a),s),c++;return u},gauss_seidel:function(n,r,o,i){for(var a,s,l,u,c,f=0,h=n.length,d=[],p=[],g=[];f<h;f++)for(d[f]=[],p[f]=[],g[f]=[],a=0;a<h;a++)f>a?(d[f][a]=n[f][a],p[f][a]=g[f][a]=0):f<a?(p[f][a]=n[f][a],d[f][a]=g[f][a]=0):(g[f][a]=n[f][a],d[f][a]=p[f][a]=0);for(u=e.multiply(e.multiply(e.inv(e.add(g,d)),p),-1),l=e.multiply(e.inv(e.add(g,d)),r),s=o,c=e.add(e.multiply(u,o),l),f=2;t.abs(e.norm(e.subtract(c,s)))>i;)s=c,c=e.add(e.multiply(u,s),l),f+=1;return c},SOR:function(n,r,o,i,a){for(var s,l,u,c,f,h=0,d=n.length,p=[],g=[],v=[];h<d;h++)for(p[h]=[],g[h]=[],v[h]=[],s=0;s<d;s++)h>s?(p[h][s]=n[h][s],g[h][s]=v[h][s]=0):h<s?(g[h][s]=n[h][s],p[h][s]=v[h][s]=0):(v[h][s]=n[h][s],p[h][s]=g[h][s]=0);for(c=e.multiply(e.inv(e.add(v,e.multiply(p,a))),e.subtract(e.multiply(v,1-a),e.multiply(g,a))),u=e.multiply(e.multiply(e.inv(e.add(v,e.multiply(p,a))),r),a),l=o,f=e.add(e.multiply(c,o),u),h=2;t.abs(e.norm(e.subtract(f,l)))>i;)l=f,f=e.add(e.multiply(c,l),u),h++;return f},householder:function(n){for(var r,o,i,a,s,l=n.length,u=n[0].length,c=0,f=[],h=[];c<l-1;c++){for(r=0,a=c+1;a<u;a++)r+=n[a][c]*n[a][c];for(s=n[c+1][c]>0?-1:1,r=s*t.sqrt(r),o=t.sqrt((r*r-n[c+1][c]*r)/2),f=e.zeros(l,1),f[c+1][0]=(n[c+1][c]-r)/(2*o),i=c+2;i<l;i++)f[i][0]=n[i][c]/(2*o);h=e.subtract(e.identity(l,u),e.multiply(e.multiply(f,e.transpose(f)),2)),n=e.multiply(h,e.multiply(n,h))}return n},QR:function(){function n(n){var a=n.length,s=n[0].length;n=e.copy(n),r=e.zeros(s,s);var l,u,c;for(u=0;u<s;u++){for(r[u][u]=t.sqrt(o(i(a).map(function(e){return n[e][u]*n[e][u]}))),l=0;l<a;l++)n[l][u]=n[l][u]/r[u][u];for(c=u+1;c<s;c++)for(r[u][c]=o(i(a).map(function(e){return n[e][u]*n[e][c]})),l=0;l<a;l++)n[l][c]=n[l][c]-n[l][u]*r[u][c]}return[n,r]}var o=e.sum,i=e.arange;return n}(),lstsq:function(t,n){function r(t){t=e.copy(t);var n=t.length,r=e.identity(n);return e.arange(n-1,-1,-1).forEach(function(n){e.sliceAssign(r,{row:n},e.divide(e.slice(r,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach(function(o){var i=e.multiply(t[o][n],-1),a=e.slice(t,{row:o}),s=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:o},e.add(a,s));var l=e.slice(r,{row:o}),u=e.multiply(e.slice(r,{row:n}),i);e.sliceAssign(r,{row:o},e.add(l,u))})}),r}function o(t,n){var o=!1;void 0===n[0].length&&(n=n.map(function(e){return[e]}),o=!0);var i=e.QR(t),a=i[0],s=i[1],l=t[0].length,u=e.slice(a,{col:{end:l}}),c=e.slice(s,{row:{end:l}}),f=r(c),h=e.transpose(u);void 0===h[0].length&&(h=[h]);var d=e.multiply(e.multiply(f,h),n);return void 0===d.length&&(d=[[d]]),o?d.map(function(e){return e[0]}):d}return o}(),jacobi:function(n){for(var r,o,i,a,s,l,u,c,f=1,h=0,d=n.length,p=e.identity(d,d),g=[];1===f;){h++,l=n[0][1],a=0,s=1;for(var o=0;o<d;o++)for(i=0;i<d;i++)o!=i&&l<t.abs(n[o][i])&&(l=t.abs(n[o][i]),a=o,s=i);u=n[a][a]===n[s][s]?n[a][s]>0?t.PI/4:-t.PI/4:t.atan(2*n[a][s]/(n[a][a]-n[s][s]))/2,c=e.identity(d,d),c[a][a]=t.cos(u),c[a][s]=-t.sin(u),c[s][a]=t.sin(u),c[s][s]=t.cos(u),p=e.multiply(p,c),r=e.multiply(e.multiply(e.inv(c),n),c),n=r,f=0;for(var o=1;o<d;o++)for(i=1;i<d;i++)o!=i&&t.abs(n[o][i])>.001&&(f=1)}for(var o=0;o<d;o++)g.push(n[o][o]);return[p,g]},rungekutta:function(e,t,n,r,o,i){var a,s,l,u,c;if(2===i)for(;r<=n;)a=t*e(r,o),s=t*e(r+t,o+a),l=o+(a+s)/2,o=l,r+=t;if(4===i)for(;r<=n;)a=t*e(r,o),s=t*e(r+t/2,o+a/2),u=t*e(r+t/2,o+s/2),c=t*e(r+t,o+u),l=o+(a+2*s+2*u+c)/6,o=l,r+=t;return o},romberg:function(e,n,r,o){for(var i,a,s,l,u,c=0,f=(r-n)/2,h=[],d=[],p=[];c<o/2;){for(u=e(n),s=n,l=0;s<=r;s+=f,l++)h[l]=s;for(i=h.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*e(h[s]);u=f/3*(u+e(r)),p[c]=u,f/=2,c++}for(a=p.length,i=1;1!==a;){for(s=0;s<a-1;s++)d[s]=(t.pow(4,i)*p[s+1]-p[s])/(t.pow(4,i)-1);a=d.length,p=d,d=[],i++}return p},richardson:function(e,n,r,o){function i(e,t){for(var n,r=0,o=e.length;r<o;r++)e[r]===t&&(n=r);return n}for(var a,s,l,u,c,f=t.abs(r-e[i(e,r)+1]),h=0,d=[],p=[];o>=f;)a=i(e,r+o),s=i(e,r),d[h]=(n[a]-2*n[s]+n[2*s-a])/(o*o),o/=2,h++;for(u=d.length,l=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(t.pow(4,l)*d[c+1]-d[c])/(t.pow(4,l)-1);u=p.length,d=p,p=[],l++}return d},simpson:function(e,t,n,r){for(var o,i=(n-t)/r,a=e(t),s=[],l=t,u=0,c=1;l<=n;l+=i,u++)s[u]=l;for(o=s.length;c<o-1;c++)a+=(c%2!=0?4:2)*e(s[c]);return i/3*(a+e(n))},hermite:function(e,t,n,r){for(var o,i=e.length,a=0,s=0,l=[],u=[],c=[],f=[];s<i;s++){for(l[s]=1,o=0;o<i;o++)s!=o&&(l[s]*=(r-e[o])/(e[s]-e[o]));for(u[s]=0,o=0;o<i;o++)s!=o&&(u[s]+=1/(e[s]-e[o]));c[s]=l[s]*l[s]*(1-2*(r-e[s])*u[s]),f[s]=l[s]*l[s]*(r-e[s]),a+=c[s]*t[s]+f[s]*n[s]}return a},lagrange:function(e,t,n){for(var r,o,i=0,a=0,s=e.length;a<s;a++){for(o=t[a],r=0;r<s;r++)a!=r&&(o*=(n-e[r])/(e[a]-e[r]));i+=o}return i},cubic_spline:function(t,n,r){for(var o,i=t.length,a=0,s=[],l=[],u=[],c=[],f=[],h=[],d=[];a<i-1;a++)f[a]=t[a+1]-t[a];u[0]=0;for(var a=1;a<i-1;a++)u[a]=3/f[a]*(n[a+1]-n[a])-3/f[a-1]*(n[a]-n[a-1]);for(var a=1;a<i-1;a++)s[a]=[],l[a]=[],s[a][a-1]=f[a-1],s[a][a]=2*(f[a-1]+f[a]),s[a][a+1]=f[a],l[a][0]=u[a];for(c=e.multiply(e.inv(s),l),o=0;o<i-1;o++)h[o]=(n[o+1]-n[o])/f[o]-f[o]*(c[o+1][0]+2*c[o][0])/3,d[o]=(c[o+1][0]-c[o][0])/(3*f[o]);for(o=0;o<i&&!(t[o]>r);o++);return o-=1,n[o]+(r-t[o])*h[o]+e.sq(r-t[o])*c[o]+(r-t[o])*e.sq(r-t[o])*d[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){for(var n,r,o=t.length,i=t[0].length,a=0,s=[],l=[],u=[],c=[],f=[],h=[],d=[],p=[],g=[],v=[],a=0;a<o;a++)s[a]=e.sum(t[a])/i;for(var a=0;a<i;a++)for(d[a]=[],n=0;n<o;n++)d[a][n]=t[n][a]-s[n];d=e.transpose(d);for(var a=0;a<o;a++)for(p[a]=[],n=0;n<o;n++)p[a][n]=e.dot([d[a]],[d[n]])/(i-1);u=e.jacobi(p),g=u[0],l=u[1],v=e.transpose(g);for(var a=0;a<l.length;a++)for(n=a;n<l.length;n++)l[a]<l[n]&&(r=l[a],l[a]=l[n],l[n]=r,c=v[a],v[a]=v[n],v[n]=c);h=e.transpose(d);for(var a=0;a<o;a++)for(f[a]=[],n=0;n<h.length;n++)f[a][n]=e.dot([v[a]],[h[n]]);return[t,l,v,f]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,r){var o=this;return r?(setTimeout(function(){r.call(o,e.fn[t].call(o,n))},15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(e,Math),function(e,t){function n(e,n,r,o){if(e>1||r>1||e<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+r*o)/(n+o);return(e-r)/t.sqrt(i*(1-i)*(1/n+1/o))}var r=[].slice,o=e.utils.isNumber,i=e.utils.isArray;e.extend({zscore:function(){var t=r.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,o=r.call(arguments);return i(o[1])?(n=e.zscore(o[0],o[1],o[3]),1===o[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):o.length>2?(n=e.zscore(o[0],o[1],o[2]),1===o[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=o[0],1===o[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,r,o){var i=t.abs(this.zscore(n,o));return 1===r?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var n,i=r.call(arguments);return 5===i.length?(n=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-n,i[3]-1):2*e.studentt.cdf(-n,i[3]-1)):o(i[1])?(n=t.abs(i[0]),1==i[2]?e.studentt.cdf(-n,i[1]-1):2*e.studentt.cdf(-n,i[1]-1)):(n=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-n,i[1].length-1):2*e.studentt.cdf(-n,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,o,i,a,s,l,u,c,f=r.call(arguments);if(1===f.length){s=new Array(f[0].length);for(var u=0;u<f[0].length;u++)s[u]=f[0][u];f=s}if(2===f.length)return e.variance(f[0])/e.variance(f[1]);o=new Array;for(var u=0;u<f.length;u++)o=o.concat(f[u]);i=e.mean(o),n=0;for(var u=0;u<f.length;u++)n+=f[u].length*t.pow(e.mean(f[u])-i,2);n/=f.length-1,l=0;for(var u=0;u<f.length;u++)for(a=e.mean(f[u]),c=0;c<f[u].length;c++)l+=t.pow(f[u][c]-a,2);return l/=o.length-f.length,n/l},anovaftest:function(){var t,n,i,a,s=r.call(arguments);if(o(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);anovafscore=e.anovafscore(s),t=s.length-1,i=0;for(var a=0;a<s.length;a++)i+=s[a].length;return n=i-t-1,1-e.centralF.cdf(anovafscore,t,n)},ftest:function(t,n,r){return 1-e.centralF.cdf(t,n,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){for(var t,n=0,t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var n,i,a,s,l,u=r.call(arguments);return o(u[0])?(n=u[0],i=u[1],a=u[2],s=u[3],l=u[4]):(n=e.mean(u[0]),i=e.mean(u[1]),a=u[0].length,s=u[1].length,l=u[2]),t.abs(n-i)/(l*t.sqrt((1/a+1/s)/2))},qtest:function(){var t,n=r.call(arguments);3===n.length?(t=n[0],n=n.slice(1)):7===n.length?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],i=n[1];return 1-e.tukey.cdf(t,i,o-i)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),r=t.map(function(t){return e.mean(t)}),o=t.reduce(function(e,t){return e+t.length},0),i=[],a=0;a<t.length;++a)for(var s=a+1;s<t.length;++s){var l=e.qtest(r[a],r[s],t[a].length,t[s].length,n,o,t.length);i.push([[a,s],l])}return i}}),e.extend({normalci:function(){var n,o=r.call(arguments),i=new Array(2);return n=t.abs(4===o.length?e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3]):e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},tci:function(){var n,o=r.call(arguments),i=new Array(2);return n=t.abs(4===o.length?e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3]):e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,r,o,i){var a=n(t,r,o,i);return e.ztest(a,1)},twoSidedDifferenceOfProportions:function(t,r,o,i){var a=n(t,r,o,i);return e.ztest(a,2)}})}(e,Math),e.models=function(){function t(e,t){return n(e,t)}function t(t){var r=t[0].length;return e.arange(r).map(function(o){var i=e.arange(r).filter(function(e){return e!==o});return n(e.col(t,o).map(function(e){return e[0]}),e.col(t,i))})}function n(t,n){var r=t.length,o=n[0].length-1,i=r-o-1,a=e.lstsq(n,t),s=e.multiply(n,a.map(function(e){return[e]})).map(function(e){return e[0]}),l=e.subtract(t,s),u=e.mean(t),c=e.sum(s.map(function(e){return Math.pow(e-u,2)})),f=e.sum(t.map(function(e,t){return Math.pow(e-s[t],2)})),h=c+f;return{exog:n,endog:t,nobs:r,df_model:o,df_resid:i,coef:a,predict:s,resid:l,ybar:u,SST:h,SSE:c,SSR:f,R2:c/h}}function r(n){var r=t(n.exog),o=Math.sqrt(n.SSR/n.df_resid),i=r.map(function(e){var t=e.SST,n=e.R2;return o/Math.sqrt(t*(1-n))}),a=n.coef.map(function(e,t){return(e-0)/i[t]}),s=a.map(function(t){var r=e.studentt.cdf(t,n.df_resid);return 2*(r>.5?1-r:r)}),l=e.studentt.inv(.975,n.df_resid),u=n.coef.map(function(e,t){var n=l*i[t];return[e-n,e+n]});return{se:i,t:a,p:s,sigmaHat:o,interval95:u}}function o(t){var n=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:n,pvalue:1-function(t,n,r){return e.beta.cdf(t/(r/n+t),n/2,r/2)}(n,t.df_model,t.df_resid)}}function i(e,t){var i=n(e,t),a=r(i),s=o(i),l=1-(i.nobs-1)/i.df_resid*(1-i.R2);return i.t=a,i.f=s,i.adjust_R2=l,i}return{ols:i}}(),e.jStat=e,e})},function(e,t,n){var r=n(1),o=n(9),i=n(0);t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var n=!1,r=arguments[t],o=0;o<e.length&&!(n=e[o]===r);++o);n||e.push(r)}return e},t.FLATTEN=r.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){if(!arguments.length)return i.error;try{for(var n=t.split("."),r=e,o=0;o<n.length;++o){var a=n[o];if("]"===a[a.length-1]){var s=a.indexOf("["),l=a.substring(s+1,a.length-1);r=r[a.substring(0,s)][l]}else r=r[a]}return r}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){return r.flatten(arguments).filter(function(e){return"number"==typeof e})},t.NUMERAL=function(e,t){return o(e).format(t)}},function(e,t,n){function r(e){return/^[01]{1,10}$/.test(e)}var o=n(0),i=n(11).jStat,a=n(6),s=n(1),l=n(28);t.BESSELI=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:l.besseli(e,t)},t.BESSELJ=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:l.besselj(e,t)},t.BESSELK=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:l.besselk(e,t)},t.BESSELY=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:l.bessely(e,t)},t.BIN2DEC=function(e){if(!r(e))return o.num;var t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!r(e))return o.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var i=parseInt(e,2).toString(16);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?a.REPT("0",t-i.length)+i:o.num)},t.BIN2OCT=function(e,t){if(!r(e))return o.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var i=parseInt(e,2).toString(8);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?a.REPT("0",t-i.length)+i:o.num)},t.BITAND=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e&t},t.BITLSHIFT=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e<0?o.num:Math.floor(e)!==e?o.num:e>0xffffffffffff?o.num:Math.abs(t)>53?o.num:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e|t},t.BITRSHIFT=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e<0?o.num:Math.floor(e)!==e?o.num:e>0xffffffffffff?o.num:Math.abs(t)>53?o.num:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e^t},t.COMPLEX=function(e,t,n){if(e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return o.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();var r=t>0?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)},t.CONVERT=function(e,t,n){if((e=s.parseNumber(e))instanceof Error)return e;for(var r,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["Ã¥ngstrÃ¶m","Ã",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic Ã¥ngstrÃ¶m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","Â°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["Årsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Î©",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestÃ¤rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square Ã¥ngstrÃ¶m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=t,h=n,d=1,p=1,g=0;g<i.length;g++)r=null===i[g][2]?[]:i[g][2],(i[g][1]===f||r.indexOf(f)>=0)&&(u=i[g]),(i[g][1]===h||r.indexOf(h)>=0)&&(c=i[g]);if(null===u){var v=a[t.substring(0,2)],m=l[t.substring(0,1)];"da"===t.substring(0,2)&&(m=["dekao",10,"da"]),v?(d=v[2],f=t.substring(2)):m&&(d=m[1],f=t.substring(m[2].length));for(var y=0;y<i.length;y++)r=null===i[y][2]?[]:i[y][2],(i[y][1]===f||r.indexOf(f)>=0)&&(u=i[y])}if(null===c){var w=a[n.substring(0,2)],b=l[n.substring(0,1)];"da"===n.substring(0,2)&&(b=["dekao",10,"da"]),w?(p=w[2],h=n.substring(2)):b&&(p=b[1],h=n.substring(b[2].length));for(var C=0;C<i.length;C++)r=null===i[C][2]?[]:i[C][2],(i[C][1]===h||r.indexOf(h)>=0)&&(c=i[C])}return null===u||null===c?o.na:u[3]!==c[3]?o.na:e*u[6]*d/(c[6]*p)},t.DEC2BIN=function(e,t){if((e=s.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return o.num;if(e<0)return"1"+a.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?a.REPT("0",t-n.length)+n:o.num)},t.DEC2HEX=function(e,t){if((e=s.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return o.num;if(e<0)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?a.REPT("0",t-n.length)+n:o.num)},t.DEC2OCT=function(e,t){if((e=s.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return o.num;if(e<0)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?a.REPT("0",t-n.length)+n:o.num)},t.DELTA=function(e,t){return t=void 0===t?0:t,e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:e===t?1:0},t.ERF=function(e,t){return t=void 0===t?0:t,e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?o.value:i.erf(e)},t.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},t.ERFC=function(e){return isNaN(e)?o.value:i.erfc(e)},t.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},t.GESTEP=function(e,t){return t=t||0,e=s.parseNumber(e),s.anyIsError(t,e)?e:e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return o.num;if(n)return"1"+a.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?a.REPT("0",t-i.length)+i:o.num)},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return o.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var r=n.toString(8);return void 0===t?r:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=r.length?a.REPT("0",t-r.length)+r:o.num)},t.IMABS=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:Math.sqrt(Math.pow(n,2)+Math.pow(r,2))},t.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return o.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),i="i"===r||"j"===r;return t>=0||n>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?o.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?o.num:-Number(e.substring(n+1,e.length-1)):o.num:i?isNaN(e.substring(0,e.length-1))?o.num:e.substring(0,e.length-1):isNaN(e)?o.num:0},t.IMARGUMENT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:0===n&&0===r?o.div0:0===n&&r>0?Math.PI/2:0===n&&r<0?-Math.PI/2:0===r&&n>0?0:0===r&&n<0?-Math.PI:n>0?Math.atan(r/n):n<0&&r>=0?Math.atan(r/n)+Math.PI:Math.atan(r/n)-Math.PI},t.IMCONJUGATE=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",0!==r?t.COMPLEX(n,-r,i):e},t.IMCOS=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(n)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(n)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMCOSH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(r)*(Math.exp(n)-Math.exp(-n))/2,i)},t.IMCOT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,n){var r=t.IMREAL(e),i=t.IMAGINARY(e),a=t.IMREAL(n),l=t.IMAGINARY(n);if(s.anyIsError(r,i,a,l))return o.value;var u=e.substring(e.length-1),c=n.substring(n.length-1),f="i";if("j"===u?f="j":"j"===c&&(f="j"),0===a&&0===l)return o.num;var h=a*a+l*l;return t.COMPLEX((r*a+i*l)/h,(i*a-r*l)/h,f)},t.IMEXP=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var a=Math.exp(n);return t.COMPLEX(a*Math.cos(r),a*Math.sin(r),i)},t.IMLN=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r)),Math.atan(r/n),i)},t.IMLOG10=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r))/Math.log(10),Math.atan(r/n)/Math.log(10),i)},t.IMLOG2=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r))/Math.log(2),Math.atan(r/n)/Math.log(2),i)},t.IMPOWER=function(e,n){n=s.parseNumber(n);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(s.anyIsError(n,r,i))return o.value;var a=e.substring(e.length-1);a="i"===a||"j"===a?a:"i";var l=Math.pow(t.IMABS(e),n),u=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(n*u),l*Math.sin(n*u),a)},t.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length)return o.value;for(var n=1;n<arguments.length;n++){var r=t.IMREAL(e),i=t.IMAGINARY(e),a=t.IMREAL(arguments[n]),l=t.IMAGINARY(arguments[n]);if(s.anyIsError(r,i,a,l))return o.value;e=t.COMPLEX(r*a-i*l,r*l+i*a)}return e},t.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return o.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),i="i"===r||"j"===r;return t>=0||n>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?o.num:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?o.num:Number(e.substring(0,n)):o.num:i?isNaN(e.substring(0,e.length-1))?o.num:0:isNaN(e)?o.num:e},t.IMSEC=function(e){if(!0===e||!1===e)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.sin(n)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(n)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMSINH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(r)*(Math.exp(n)+Math.exp(-n))/2,i)},t.IMSQRT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(s.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var a=Math.sqrt(t.IMABS(e)),l=t.IMARGUMENT(e);return t.COMPLEX(a*Math.cos(l/2),a*Math.sin(l/2),i)},t.IMCSC=function(e){if(!0===e||!1===e)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.num:t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(!0===e||!1===e)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.num:t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,t){var n=this.IMREAL(e),r=this.IMAGINARY(e),i=this.IMREAL(t),a=this.IMAGINARY(t);if(s.anyIsError(n,r,i,a))return o.value;var l=e.substring(e.length-1),u=t.substring(t.length-1),c="i";return"j"===l?c="j":"j"===u&&(c="j"),this.COMPLEX(n-i,r-a,c)},t.IMSUM=function(){if(!arguments.length)return o.value;for(var e=s.flatten(arguments),t=e[0],n=1;n<e.length;n++){var r=this.IMREAL(t),i=this.IMAGINARY(t),a=this.IMREAL(e[n]),l=this.IMAGINARY(e[n]);if(s.anyIsError(r,i,a,l))return o.value;t=this.COMPLEX(r+a,i+l)}return t},t.IMTAN=function(e){if(!0===e||!1===e)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return s.anyIsError(n,r)?o.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return o.num;var n=10===e.length&&"7"===e.substring(0,1),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return o.num;if(n)return"1"+a.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?a.REPT("0",t-i.length)+i:o.num)},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return o.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return o.num;var n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return void 0===t?r:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=r.length?a.REPT("0",t-r.length)+r:o.num)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(e,t,n){"use strict";function r(e){var t=parseInt(e,10);return t=isNaN(t)?-1:Math.max(t-1,-1)}function o(e){var t="";return e>=0&&(t=""+(e+1)),t}function i(e){var t=0;if("string"==typeof e){e=e.toUpperCase();for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(c,r)*(u.indexOf(e[n])+1)}return--t}function a(e){for(var t="";e>=0;)t=String.fromCharCode(e%c+97)+t,e=Math.floor(e/c)-1;return t.toUpperCase()}function s(e){if("string"!=typeof e||!f.test(e))return[];var t=e.toUpperCase().match(f),n=t[1],o=t[2],a=t[3],s=t[4];return[{index:r(s),label:s,isAbsolute:"$"===a},{index:i(o),label:o,isAbsolute:"$"===n}]}function l(e,t){var n=(e.isAbsolute?"$":"")+o(e.index);return(t.isAbsolute?"$":"")+a(t.index)+n}t.__esModule=!0,t.rowLabelToIndex=r,t.rowIndexToLabel=o,t.columnLabelToIndex=i,t.columnIndexToLabel=a,t.extractLabel=s,t.toLabel=l;var u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=u.length,f=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=void 0;var o=n(17),i=r(o),a=n(14),s=r(a),l=n(2),u=r(l),c=n(15);t.SUPPORTED_FORMULAS=s.default,t.ERROR=l.ERROR,t.ERROR_DIV_ZERO=l.ERROR_DIV_ZERO,t.ERROR_NAME=l.ERROR_NAME,t.ERROR_NOT_AVAILABLE=l.ERROR_NOT_AVAILABLE,t.ERROR_NULL=l.ERROR_NULL,t.ERROR_NUM=l.ERROR_NUM,t.ERROR_REF=l.ERROR_REF,t.ERROR_VALUE=l.ERROR_VALUE,t.Parser=i.default,t.error=u.default,t.extractLabel=c.extractLabel,t.toLabel=c.toLabel,t.columnIndexToLabel=c.columnIndexToLabel,t.columnLabelToIndex=c.columnLabelToIndex,t.rowIndexToLabel=c.rowIndexToLabel,t.rowLabelToIndex=c.rowLabelToIndex},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(18),l=r(s),u=n(19),c=r(u),f=n(41),h=n(43),d=n(3),p=n(2),g=r(p),v=n(15);t.default=function(e){function t(){o(this,t);var n=i(this,e.call(this));return n.parser=new f.Parser,n.parser.yy={toNumber:d.toNumber,trimEdges:h.trimEdges,invertNumber:d.invertNumber,throwError:function(e){return n._throwError(e)},callVariable:function(e){return n._callVariable(e)},evaluateByOperator:c.default,callFunction:function(e,t){return n._callFunction(e,t)},cellValue:function(e){return n._callCellValue(e)},rangeValue:function(e,t){return n._callRangeValue(e,t)}},n.variables=Object.create(null),n.functions=Object.create(null),n.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),n}return a(t,e),t.prototype.parse=function(e){var t=null,n=null;try{t=""===e?"":this.parser.parse(e)}catch(e){var r=(0,g.default)(e.message);n=r||(0,g.default)(p.ERROR)}return t instanceof Error&&(n=(0,g.default)(t.message)||(0,g.default)(p.ERROR),t=null),{error:n,result:t}},t.prototype.setVariable=function(e,t){return this.variables[e]=t,this},t.prototype.getVariable=function(e){return this.variables[e]},t.prototype._callVariable=function(e){var t=this.getVariable(e);if(this.emit("callVariable",e,function(e){void 0!==e&&(t=e)}),void 0===t)throw Error(p.ERROR_NAME);return t},t.prototype.setFunction=function(e,t){return this.functions[e]=t,this},t.prototype.getFunction=function(e){return this.functions[e]},t.prototype._callFunction=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getFunction(e),r=void 0;return n&&(r=n(t)),this.emit("callFunction",e,t,function(e){void 0!==e&&(r=e)}),void 0===r?(0,c.default)(e,t):r},t.prototype._callCellValue=function(e){e=e.toUpperCase();var t=(0,v.extractLabel)(e),n=t[0],r=t[1],o=void 0;return this.emit("callCellValue",{label:e,row:n,column:r},function(e){o=e}),o},t.prototype._callRangeValue=function(e,t){e=e.toUpperCase(),t=t.toUpperCase();var n=(0,v.extractLabel)(e),r=n[0],o=n[1],i=(0,v.extractLabel)(t),a=i[0],s=i[1],l={},u={};r.index<=a.index?(l.row=r,u.row=a):(l.row=a,u.row=r),o.index<=s.index?(l.column=o,u.column=s):(l.column=s,u.column=o),l.label=(0,v.toLabel)(l.row,l.column),u.label=(0,v.toLabel)(u.row,u.column);var c=[];return this.emit("callRangeValue",l,u,function(){c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}),c},t.prototype._throwError=function(e){if((0,p.isValidStrict)(e))throw Error(e);throw Error(p.ERROR)},t}(l.default)},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){o.off(e,r),t.apply(n,arguments)}var o=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;for(r;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e=e.toUpperCase(),!D[e])throw Error(I.ERROR_NAME);return D[e].apply(D,t)}function i(e,t){Array.isArray(e)||(e=[e.toUpperCase()]),e.forEach(function(e){D[e]=t.isFactory?t(e):t})}t.__esModule=!0,t.default=o,t.registerOperation=i;var a=n(20),s=r(a),l=n(21),u=r(l),c=n(22),f=r(c),h=n(23),d=r(h),p=n(24),g=r(p),v=n(33),m=r(v),y=n(34),w=r(y),b=n(35),C=r(b),E=n(36),O=r(E),_=n(37),S=r(_),T=n(38),R=r(T),M=n(39),N=r(M),k=n(40),A=r(k),I=n(2),D=Object.create(null);i(s.default.SYMBOL,s.default),i(u.default.SYMBOL,u.default),i(f.default.SYMBOL,f.default),i(d.default.SYMBOL,d.default),i(A.default.SYMBOL,A.default),i(g.default.SYMBOL,g.default),i(m.default.SYMBOL,m.default),i(w.default.SYMBOL,w.default),i(C.default.SYMBOL,C.default),i(O.default.SYMBOL,O.default),i(R.default.SYMBOL,R.default),i(N.default.SYMBOL,N.default),i(S.default.SYMBOL,S.default)},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.reduce(function(e,t){return e+(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(a))throw Error(i.ERROR_VALUE);return a}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(3),i=n(2);r.SYMBOL=t.SYMBOL="+"},function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e+t.toString()},"")}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL="&"},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.reduce(function(e,t){return e/(0,o.toNumber)(t)},(0,o.toNumber)(e));if(a===1/0)throw Error(i.ERROR_DIV_ZERO);if(isNaN(a))throw Error(i.ERROR_VALUE);return a}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(3),i=n(2);r.SYMBOL=t.SYMBOL="/"},function(e,t,n){"use strict";function r(e,t){return e===t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL="="},function(e,t,n){"use strict";function r(e){return function(){e=e.toUpperCase();var t=e.split("."),n=!1,r=void 0;if(1===t.length)i[t[0]]&&(n=!0,r=i[t[0]].apply(i,arguments));else{for(var o=t.length,a=0,s=i;a<o;)if(s=s[t[a]],a++,!s){s=null;break}s&&(n=!0,r=s.apply(void 0,arguments))}if(!n)throw Error(l.ERROR_NAME);return r}}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(25),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(14),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=n(2),u=t.SYMBOL=s.default;r.isFactory=!0,r.SYMBOL=u},function(e,t,n){var r=[n(26),n(29),n(13),n(30),n(4),n(6),n(8),n(31),n(7),n(32),n(5),n(12)];for(var o in r){var i=r[o];for(var a in i)t[a]=t[a]||i[a]}},function(e,t,n){function r(e,t){if(t)for(var n in t)e[n]=t[n];return e}var o=n(4),i=n(5),a=n(13),s=n(8);t.BETADIST=i.BETA.DIST,t.BETAINV=i.BETA.INV,t.BINOMDIST=i.BINOM.DIST,t.CEILING=t.ISOCEILING=r(o.CEILING.MATH,o.CEILING),t.CEILINGMATH=o.CEILING.MATH,t.CEILINGPRECISE=o.CEILING.PRECISE,t.CHIDIST=i.CHISQ.DIST,t.CHIDISTRT=i.CHISQ.DIST.RT,t.CHIINV=i.CHISQ.INV,t.CHIINVRT=i.CHISQ.INV.RT,t.CHITEST=i.CHISQ.TEST,t.CONFIDENCE=r(i.CONFIDENCE.NORM,i.CONFIDENCE),t.COVAR=i.COVARIANCE.P,t.COVARIANCEP=i.COVARIANCE.P,t.COVARIANCES=i.COVARIANCE.S,t.CRITBINOM=i.BINOM.INV,t.EXPONDIST=i.EXPON.DIST,t.ERFCPRECISE=a.ERFC.PRECISE,t.ERFPRECISE=a.ERF.PRECISE,t.FDIST=i.F.DIST,t.FDISTRT=i.F.DIST.RT,t.FINVRT=i.F.INV.RT,t.FINV=i.F.INV,t.FLOOR=r(o.FLOOR.MATH,o.FLOOR),t.FLOORMATH=o.FLOOR.MATH,t.FLOORPRECISE=o.FLOOR.PRECISE,t.FTEST=i.F.TEST,t.GAMMADIST=i.GAMMA.DIST,t.GAMMAINV=i.GAMMA.INV,t.GAMMALNPRECISE=i.GAMMALN.PRECISE,t.HYPGEOMDIST=i.HYPGEOM.DIST,t.LOGINV=i.LOGNORM.INV,t.LOGNORMINV=i.LOGNORM.INV,t.LOGNORMDIST=i.LOGNORM.DIST,t.MODE=r(i.MODE.SNGL,i.MODE),t.MODEMULT=i.MODE.MULT,t.MODESNGL=i.MODE.SNGL,t.NEGBINOMDIST=i.NEGBINOM.DIST,t.NETWORKDAYSINTL=s.NETWORKDAYS.INTL,t.NORMDIST=i.NORM.DIST,t.NORMINV=i.NORM.INV,t.NORMSDIST=i.NORM.S.DIST,t.NORMSINV=i.NORM.S.INV,t.PERCENTILE=r(i.PERCENTILE.EXC,i.PERCENTILE),t.PERCENTILEEXC=i.PERCENTILE.EXC,t.PERCENTILEINC=i.PERCENTILE.INC,t.PERCENTRANK=r(i.PERCENTRANK.INC,i.PERCENTRANK),t.PERCENTRANKEXC=i.PERCENTRANK.EXC,t.PERCENTRANKINC=i.PERCENTRANK.INC,t.POISSON=r(i.POISSON.DIST,i.POISSON),t.POISSONDIST=i.POISSON.DIST,t.QUARTILE=r(i.QUARTILE.INC,i.QUARTILE),t.QUARTILEEXC=i.QUARTILE.EXC,t.QUARTILEINC=i.QUARTILE.INC,t.RANK=r(i.RANK.EQ,i.RANK),t.RANKAVG=i.RANK.AVG,t.RANKEQ=i.RANK.EQ,t.SKEWP=i.SKEW.P,t.STDEV=r(i.STDEV.S,i.STDEV),t.STDEVP=i.STDEV.P,t.STDEVS=i.STDEV.S,t.TDIST=i.T.DIST,t.TDISTRT=i.T.DIST.RT,t.TINV=i.T.INV,t.TTEST=i.T.TEST,t.VAR=r(i.VAR.S,i.VAR),t.VARP=i.VAR.P,t.VARS=i.VAR.S,t.WEIBULL=r(i.WEIBULL.DIST,i.WEIBULL),t.WEIBULLDIST=i.WEIBULL.DIST,t.WORKDAYINTL=s.WORKDAY.INTL,t.ZTEST=i.Z.TEST},function(e,t){},function(e,t,n){function r(e,t){return e.reduce(function(e,n){return t*e+n},0)}function o(e,t,n,r,o){o||(o=-1);var i,a=2/e;if(0===t)return n;if(1===t)return r;for(var s=1;s!=t;++s)i=r*s*a+o*n,n=r,r=i;return r}function i(e,t,n,r,i){return function(a,s){if(0===s)return e(a);if(1===s)return t(a);if(s<0)throw n+": Order ("+s+") must be nonnegative";if(1==r&&0===a)throw n+": Undefined when x == 0";if(2==r&&a<=0)throw n+": Undefined when x <= 0";return o(a,s,e(a),t(a),i)}}var a=Math,s=function(){function e(e){var t,o,c,f=e*e,h=a.abs(e)-.785398164;return a.abs(e)<8?(o=r(n,f),c=r(i,f),t=o/c):(f=64/f,o=r(s,f),c=r(l,f),t=a.sqrt(u/a.abs(e))*(a.cos(h)*o-a.sin(h)*c*8/a.abs(e))),t}function t(e){var t,n,o,i=e*e,s=a.abs(e)-2.356194491;return Math.abs(e)<8?(n=e*r(c,i),o=r(f,i),t=n/o):(i=64/i,n=r(h,i),o=r(d,i),t=a.sqrt(u/a.abs(e))*(a.cos(s)*n-a.sin(s)*o*8/a.abs(e)),e<0&&(t=-t)),t}var n=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),u=.636619772,c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),f=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(n,r){if(0===(r=Math.round(r)))return e(a.abs(n));if(1===r)return t(a.abs(n));if(r<0)throw"BESSELJ: Order ("+r+") must be nonnegative";if(0===a.abs(n))return 0;var i,s,l,u,c,f,h,d,p=2/a.abs(n);if(a.abs(n)>r)i=o(n,r,e(a.abs(n)),t(a.abs(n)),-1);else{for(l=2*a.floor((r+a.floor(a.sqrt(40*r)))/2),u=0,f=i=c=0,h=1,s=l;s>0;s--)d=s*p*h-f,f=h,h=d,a.abs(h)>1e10&&(h*=1e-10,f*=1e-10,i*=1e-10,c*=1e-10),u&&(c+=h),u=!u,s==r&&(i=f);c=2*c-h,i/=c}return n<0&&r%2?-i:i}}(),l=function(){function e(e){var t,i,f,h=e*e,d=e-.785398164;return e<8?(i=r(n,h),f=r(o,h),t=i/f+c*s(e,0)*a.log(e)):(h=64/h,i=r(l,h),f=r(u,h),t=a.sqrt(c/e)*(a.sin(d)*i+a.cos(d)*f*8/e)),t}function t(e){var t,n,o,i=e*e,l=e-2.356194491;return e<8?(n=e*r(f,i),o=r(h,i),t=n/o+c*(s(e,1)*a.log(e)-1/e)):(i=64/i,n=r(d,i),o=r(p,i),t=a.sqrt(c/e)*(a.sin(l)*n+a.cos(l)*o*8/e)),t}var n=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=.636619772,f=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),h=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return i(e,t,"BESSELY",1,-1)}(),u=function(){function e(e){return e<=3.75?r(n,e*e/14.0625):a.exp(a.abs(e))/a.sqrt(a.abs(e))*r(o,3.75/a.abs(e))}function t(e){return e<3.75?e*r(i,e*e/14.0625):(e<0?-1:1)*a.exp(a.abs(e))/a.sqrt(a.abs(e))*r(s,3.75/a.abs(e))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),o=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),i=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),s=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function n(r,o){if(0===(o=Math.round(o)))return e(r);if(1==o)return t(r);if(o<0)throw"BESSELI Order ("+o+") must be nonnegative";if(0===a.abs(r))return 0;var i,s,l,u,c,f,h=2/a.abs(r);for(l=2*a.round((o+a.round(a.sqrt(40*o)))/2),u=i=0,c=1,s=l;s>0;s--)f=s*h*c+u,u=c,c=f,a.abs(c)>1e10&&(c*=1e-10,u*=1e-10,i*=1e-10),s==o&&(i=u);return i*=n(r,0)/c,r<0&&o%2?-i:i}}(),c=function(){function e(e){return e<=2?-a.log(e/2)*u(e,0)+r(n,e*e/4):a.exp(-e)/a.sqrt(e)*r(o,2/e)}function t(e){return e<=2?a.log(e/2)*u(e,1)+1/e*r(s,e*e/4):a.exp(-e)/a.sqrt(e)*r(l,2/e)}var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),s=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i(e,t,"BESSELK",2,1)}();t.besselj=s,t.bessely=l,t.besseli=u,t.besselk=c},function(module,exports,__webpack_require__){function compact(e){var t=[];return utils.arrayEach(e,function(e){e&&t.push(e)}),t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(0),stats=__webpack_require__(5),maths=__webpack_require__(4),utils=__webpack_require__(1);exports.FINDFIELD=function(e,t){var n=null;return utils.arrayEach(e,function(e,r){if(e[0]===t)return n=r,!1}),null==n?error.value:n},exports.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=0;return utils.arrayEach(r,function(e){a+=o[e]}),0===r.length?error.div0:a/r.length},exports.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),stats.COUNT(a)},exports.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),stats.COUNTA(a)},exports.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);return 0===r.length?error.value:r.length>1?error.num:o[r[0]]},exports.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=o[r[0]];return utils.arrayEach(r,function(e){a<o[e]&&(a=o[e])}),a},exports.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=o[r[0]];return utils.arrayEach(r,function(e){a>o[e]&&(a=o[e])}),a},exports.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];utils.arrayEach(r,function(e){a.push(o[e])}),a=compact(a);var s=1;return utils.arrayEach(a,function(e){s*=e}),s},exports.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),a=compact(a),stats.STDEV.S(a)},exports.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),a=compact(a),stats.STDEV.P(a)},exports.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),maths.SUM(a)},exports.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),stats.VAR.S(a)},exports.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var a=[];return utils.arrayEach(r,function(e){a.push(o[e])}),stats.VAR.P(a)}},function(e,t,n){var r=n(0),o=n(1),i=n(7);t.AND=function(){for(var e=o.flatten(arguments),t=!0,n=0;n<e.length;n++)e[n]||(t=!1);return t},t.CHOOSE=function(){if(arguments.length<2)return r.na;var e=arguments[0];return e<1||e>254?r.value:arguments.length<e+1?r.value:arguments[e]},t.FALSE=function(){return!1},t.IF=function(e,t,n){return e?t:n},t.IFERROR=function(e,t){return i.ISERROR(e)?t:e},t.IFNA=function(e,t){return e===r.na?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=o.flatten(arguments),t=!1,n=0;n<e.length;n++)e[n]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=o.flatten(arguments),t=0,n=0;n<e.length;n++)e[n]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],n=arguments.length-1,o=Math.floor(n/2),i=!1,a=n%2!=0,s=n%2==0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(t===arguments[2*l+1]){e=arguments[2*l+2],i=!0;break}i||(e=a?s:r.na)}else e=r.value;return e}},function(e,t,n){function r(e){return e&&e.getTime&&!isNaN(e.getTime())}function o(e){return e instanceof Date?e:new Date(e)}var i=n(0),a=n(8),s=n(1);t.ACCRINT=function(e,t,n,s,l,u,c){return e=o(e),t=o(t),n=o(n),r(e)&&r(t)&&r(n)?s<=0||l<=0?i.num:-1===[1,2,4].indexOf(u)?i.num:-1===[0,1,2,3,4].indexOf(c)?i.num:n<=e?i.num:(l=l||0,c=c||0,l*s*a.YEARFRAC(e,n,c)):i.value},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.CUMIPMT=function(e,n,r,o,a,l){if(e=s.parseNumber(e),n=s.parseNumber(n),r=s.parseNumber(r),s.anyIsError(e,n,r))return i.value;if(e<=0||n<=0||r<=0)return i.num;if(o<1||a<1||o>a)return i.num;if(0!==l&&1!==l)return i.num;var u=t.PMT(e,n,r,0,l),c=0;1===o&&0===l&&(c=-r,o++);for(var f=o;f<=a;f++)c+=1===l?t.FV(e,f-2,u,r,1)-u:t.FV(e,f-1,u,r,0);return c*=e},t.CUMPRINC=function(e,n,r,o,a,l){if(e=s.parseNumber(e),n=s.parseNumber(n),r=s.parseNumber(r),s.anyIsError(e,n,r))return i.value;if(e<=0||n<=0||r<=0)return i.num;if(o<1||a<1||o>a)return i.num;if(0!==l&&1!==l)return i.num;var u=t.PMT(e,n,r,0,l),c=0;1===o&&(c=0===l?u+r*e:u,o++);for(var f=o;f<=a;f++)c+=l>0?u-(t.FV(e,f-2,u,r,1)-u)*e:u-t.FV(e,f-1,u,r,0)*e;return c},t.DB=function(e,t,n,r,o){if(o=void 0===o?12:o,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o))return i.value;if(e<0||t<0||n<0||r<0)return i.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return i.num;if(r>n)return i.num;if(t>=e)return 0;for(var a=(1-Math.pow(t/e,1/n)).toFixed(3),l=e*a*o/12,u=l,c=0,f=r===n?n-1:r,h=2;h<=f;h++)c=(e-u)*a,u+=c;return 1===r?l:r===n?(e-u)*a:c},t.DDB=function(e,t,n,r,o){if(o=void 0===o?2:o,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o))return i.value;if(e<0||t<0||n<0||r<0||o<=0)return i.num;if(r>n)return i.num;if(t>=e)return 0;for(var a=0,l=0,u=1;u<=r;u++)l=Math.min(o/n*(e-a),e-t-a),a+=l;return l},t.DISC=function(){throw new Error("DISC is not implemented")},t.DOLLARDE=function(e,t){if(e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t))return i.value;if(t<0)return i.num;if(t>=0&&t<1)return i.div0;t=parseInt(t,10);var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r},t.DOLLARFR=function(e,t){if(e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t))return i.value;if(t<0)return i.num;if(t>=0&&t<1)return i.div0;t=parseInt(t,10);var n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.EFFECT=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?i.value:e<=0||t<1?i.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.FV=function(e,t,n,r,o){if(r=r||0,o=o||0,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o))return i.value;var a;if(0===e)a=r+n*t;else{var l=Math.pow(1+e,t);a=1===o?r*l+n*(1+e)*(l-1)/e:r*l+n*(l-1)/e}return-a},t.FVSCHEDULE=function(e,t){if(e=s.parseNumber(e),t=s.parseNumberArray(s.flatten(t)),s.anyIsError(e,t))return i.value;for(var n=t.length,r=e,o=0;o<n;o++)r*=1+t[o];return r},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=function(e,n,r,o,a,l){if(a=a||0,l=l||0,e=s.parseNumber(e),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),a=s.parseNumber(a),l=s.parseNumber(l),s.anyIsError(e,n,r,o,a,l))return i.value;var u=t.PMT(e,r,o,a,l);return(1===n?1===l?0:-o:1===l?t.FV(e,n-2,u,o,1)-u:t.FV(e,n-1,u,o,0))*e},t.IRR=function(e,t){if(t=t||0,e=s.parseNumberArray(s.flatten(e)),t=s.parseNumber(t),s.anyIsError(e,t))return i.value;for(var n=[],r=!1,o=!1,a=0;a<e.length;a++)n[a]=0===a?0:n[a-1]+365,e[a]>0&&(r=!0),e[a]<0&&(o=!0);if(!r||!o)return i.num;t=void 0===t?.1:t;var l,u,c,f=t,h=!0;do{c=function(e,t,n){for(var r=n+1,o=e[0],i=1;i<e.length;i++)o+=e[i]/Math.pow(r,(t[i]-t[0])/365);return o}(e,n,f),l=f-c/function(e,t,n){for(var r=n+1,o=0,i=1;i<e.length;i++){var a=(t[i]-t[0])/365;o-=a*e[i]/Math.pow(r,a+1)}return o}(e,n,f),u=Math.abs(l-f),f=l,h=u>1e-10&&Math.abs(c)>1e-10}while(h);return f},t.ISPMT=function(e,t,n,r){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),s.anyIsError(e,t,n,r)?i.value:r*e*(t/n-1)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MIRR=function(e,n,r){if(e=s.parseNumberArray(s.flatten(e)),n=s.parseNumber(n),r=s.parseNumber(r),s.anyIsError(e,n,r))return i.value;for(var o=e.length,a=[],l=[],u=0;u<o;u++)e[u]<0?a.push(e[u]):l.push(e[u]);var c=-t.NPV(r,l)*Math.pow(1+r,o-1),f=t.NPV(n,a)*(1+n);return Math.pow(c/f,1/(o-1))-1},t.NOMINAL=function(e,t){return e=s.parseNumber(e),t=s.parseNumber(t),s.anyIsError(e,t)?i.value:e<=0||t<1?i.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,n,r,o){if(o=void 0===o?0:o,r=void 0===r?0:r,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o))return i.value;var a=t*(1+e*o)-r*e,l=n*e+t*(1+e*o);return Math.log(a/l)/Math.log(1+e)},t.NPV=function(){var e=s.parseNumberArray(s.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],n=0,r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,n){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:e<=0?i.num:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,n,r,o){if(r=r||0,o=o||0,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o))return i.value;var a;if(0===e)a=(n+r)/t;else{var l=Math.pow(1+e,t);a=1===o?(r*e/(l-1)+n*e/(1-1/l))/(1+e):r*e/(l-1)+n*e/(1-1/l)}return-a},t.PPMT=function(e,n,r,o,a,l){return a=a||0,l=l||0,e=s.parseNumber(e),r=s.parseNumber(r),o=s.parseNumber(o),a=s.parseNumber(a),l=s.parseNumber(l),s.anyIsError(e,r,o,a,l)?i.value:t.PMT(e,r,o,a,l)-t.IPMT(e,n,r,o,a,l)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PV=function(e,t,n,r,o){return r=r||0,o=o||0,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),s.anyIsError(e,t,n,r,o)?i.value:0===e?-n*t-r:((1-Math.pow(1+e,t))/e*n*(1+e*o)-r)/Math.pow(1+e,t)},t.RATE=function(e,t,n,r,o,a){if(a=void 0===a?.01:a,r=void 0===r?0:r,o=void 0===o?0:o,e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),o=s.parseNumber(o),a=s.parseNumber(a),s.anyIsError(e,t,n,r,o,a))return i.value;var l,u,c,f,h=0,d=0,p=0,g=a;for(Math.abs(g)<1e-10?l=n*(1+e*g)+t*(1+g*o)*e+r:(d=Math.exp(e*Math.log(1+g)),l=n*d+t*(1/g+o)*(d-1)+r),u=n+t*e+r,c=n*d+t*(1/g+o)*(d-1)+r,p=f=0,h=g;Math.abs(u-c)>1e-10&&p<50;)g=(c*f-u*h)/(c-u),f=h,h=g,Math.abs(g)<1e-10?l=n*(1+e*g)+t*(1+g*o)*e+r:(d=Math.exp(e*Math.log(1+g)),l=n*d+t*(1/g+o)*(d-1)+r),u=c,c=l,++p;return g},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.RRI=function(e,t,n){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:0===e||0===t?i.num:Math.pow(n/t,1/e)-1},t.SLN=function(e,t,n){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:0===n?i.num:(e-t)/n},t.SYD=function(e,t,n,r){return e=s.parseNumber(e),t=s.parseNumber(t),n=s.parseNumber(n),r=s.parseNumber(r),s.anyIsError(e,t,n,r)?i.value:0===n?i.num:r<1||r>n?i.num:(r=parseInt(r,10),(e-t)*(n-r+1)*2/(n*(n+1)))},t.TBILLEQ=function(e,t,n){return e=s.parseDate(e),t=s.parseDate(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:365*n/(360-n*a.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,n){return e=s.parseDate(e),t=s.parseDate(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:100*(1-n*a.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return e=s.parseDate(e),t=s.parseDate(t),n=s.parseNumber(n),s.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:360*(100-n)/(n*a.DAYS360(e,t,!1))},t.VDB=function(){throw new Error("VDB is not implemented")},t.XNPV=function(e,t,n){if(e=s.parseNumber(e),t=s.parseNumberArray(s.flatten(t)),n=s.parseDateArray(s.flatten(n)),s.anyIsError(e,t,n))return i.value;for(var r=0,o=0;o<t.length;o++)r+=t[o]/Math.pow(1+e,a.DAYS(n[o],n[0])/365);return r},t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,n){var r=n(0),o=n(1);t.MATCH=function(e,t,n){if(!e&&!t)return r.na;if(2===arguments.length&&(n=1),!(t instanceof Array))return r.na;if(-1!==n&&0!==n&&1!==n)return r.na;for(var o,i,a=0;a<t.length;a++)if(1===n){if(t[a]===e)return a+1;t[a]<e&&(i?t[a]>i&&(o=a+1,i=t[a]):(o=a+1,i=t[a]))}else if(0===n){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[a].toLowerCase().match(e.toLowerCase()))return a+1}else if(t[a]===e)return a+1}else if(-1===n){if(t[a]===e)return a+1;t[a]>e&&(i?t[a]<i&&(o=a+1,i=t[a]):(o=a+1,i=t[a]))}return o||r.na},t.VLOOKUP=function(e,t,n,o){if(!e||!t||!n)return r.na;o=o||!1;for(var i=0;i<t.length;i++){var a=t[i];if(!o&&a[0]===e||a[0]===e||o&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(e.toLowerCase()))return n<a.length+1?a[n-1]:r.ref}return r.na},t.HLOOKUP=function(e,t,n,i){if(!e||!t||!n)return r.na;i=i||!1;for(var a=o.transpose(t),s=0;s<a.length;s++){var l=a[s];if(!i&&l[0]===e||l[0]===e||i&&"string"==typeof l[0]&&-1!==l[0].toLowerCase().indexOf(e.toLowerCase()))return n<l.length+1?l[n-1]:r.ref}return r.na}},function(e,t,n){"use strict";function r(e,t){return e>t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL=">"},function(e,t,n){"use strict";function r(e,t){return e>=t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL=">="},function(e,t,n){"use strict";function r(e,t){return e<t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL="<"},function(e,t,n){"use strict";function r(e,t){return e<=t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL="<="},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.reduce(function(e,t){return e-(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(a))throw Error(i.ERROR_VALUE);return a}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(3),i=n(2);r.SYMBOL=t.SYMBOL="-"},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.reduce(function(e,t){return e*(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(a))throw Error(i.ERROR_VALUE);return a}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(3),i=n(2);r.SYMBOL=t.SYMBOL="*"},function(e,t,n){"use strict";function r(e,t){return e!==t}t.__esModule=!0,t.default=r,r.SYMBOL=t.SYMBOL="<>"},function(e,t,n){"use strict";function r(e,t){var n=Math.pow((0,o.toNumber)(e),(0,o.toNumber)(t));if(isNaN(n))throw Error(i.ERROR_VALUE);return n}t.__esModule=!0,t.SYMBOL=void 0,t.default=r;var o=n(3),i=n(2);r.SYMBOL=t.SYMBOL="^"},function(module,exports,__webpack_require__){(function(module,process){var grammarParser=function(){function Parser(){this.yy={}}var o=function(e,t,n,r){for(n=n||{},r=e.length;r--;n[e[r]]=t);return n},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(e){result.push(e)}),this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 46:this.$=.01*$$[$0-1];break;case 47:this.$=yy.throwError($$[$0])}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function(e,t){function n(e,t){this.message=e,this.hash=t}if(!t.recoverable)throw n.prototype=Error,new n(e,t);this.trace(e)},parse:function(e){function t(e){for(var t=r.length-1,n=0;;){if(f.toString()in a[e])return n;if(0===e||t<2)return!1;t-=2,e=r[t],++n}}var n=this,r=[0],o=[null],i=[],a=this.table,s="",l=0,u=0,c=0,f=2,h=i.slice.call(arguments,1),d=Object.create(this.lexer),p={yy:{}};for(var g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(p.yy[g]=this.yy[g]);d.setInput(e,p.yy),p.yy.lexer=d,p.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var v=d.yylloc;i.push(v);var m=d.options&&d.options.ranges;this.parseError="function"==typeof p.yy.parseError?p.yy.parseError:Object.getPrototypeOf(this).parseError;for(var y,w,b,C,E,O,_,S,T,R=function(){var e;return e=d.lex()||1,"number"!=typeof e&&(e=n.symbols_[e]||e),e},M={};;){if(b=r[r.length-1],this.defaultActions[b]?C=this.defaultActions[b]:(null!==y&&void 0!==y||(y=R()),C=a[b]&&a[b][y]),void 0===C||!C.length||!C[0]){var N,k="";if(c)1!==w&&(N=t(b));else{N=t(b),T=[];for(O in a[b])this.terminals_[O]&&O>f&&T.push("'"+this.terminals_[O]+"'");k=d.showPosition?"Parse error on line "+(l+1)+":\n"+d.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(k,{text:d.match,token:this.terminals_[y]||y,line:d.yylineno,loc:v,expected:T,recoverable:!1!==N})}if(3==c){if(1===y||1===w)throw new Error(k||"Parsing halted while starting to recover from another error.");u=d.yyleng,s=d.yytext,l=d.yylineno,v=d.yylloc,y=R()}if(!1===N)throw new Error(k||"Parsing halted. No suitable error recovery rule available.");!function(e){r.length=r.length-2*e,o.length=o.length-e,i.length=i.length-e}(N),w=y==f?null:y,y=f,b=r[r.length-1],C=a[b]&&a[b][f],c=3}if(C[0]instanceof Array&&C.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(C[0]){case 1:r.push(y),o.push(d.yytext),i.push(d.yylloc),r.push(C[1]),y=null,w?(y=w,w=null):(u=d.yyleng,s=d.yytext,l=d.yylineno,v=d.yylloc,c>0&&c--);break;case 2:if(_=this.productions_[C[1]][1],M.$=o[o.length-_],M._$={first_line:i[i.length-(_||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(_||1)].first_column,last_column:i[i.length-1].last_column},m&&(M._$.range=[i[i.length-(_||1)].range[0],i[i.length-1].range[1]]),void 0!==(E=this.performAction.apply(M,[s,u,l,p.yy,C[1],o,i].concat(h))))return E;_&&(r=r.slice(0,-1*_*2),o=o.slice(0,-1*_),i=i.slice(0,-1*_)),r.push(this.productions_[C[1]][0]),o.push(M.$),i.push(M._$),S=a[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},lexer=function(){return{EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((n=this._input.match(this.rules[o[i]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,o[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,o[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}}}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();exports.parser=grammarParser,exports.Parser=grammarParser.Parser,exports.parse=function(){return grammarParser.parse.apply(grammarParser,arguments)},void 0!==module&&__webpack_require__.c[__webpack_require__.s]===module&&exports.main(process.argv.slice(1))}).call(exports,__webpack_require__(42)(module),__webpack_require__(10))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.substring(t,e.length-t)}t.__esModule=!0,t.trimEdges=r}])})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(66),s=n(0),l=n(2),u=n(31),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=n(36),h=/^\$?[A-Z]+\$?\d+$/,d=/\$?[A-Z]+\$?\d+/,p=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,g=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,v=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,m=function(){function e(t){r(this,e),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof t&&this.setExpression(t)}return i(e,[{key:"setExpression",value:function(e){return this.cells.length=0,this.expression=(0,f.toUpperCaseFormula)(e),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(e){this.customModifier=e}},{key:"translate",value:function(e){var t=this,n=e.row,r=e.column,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.arrayEach)(this.cells,function(e){null!=n&&t._translateCell(e,"row",n,o.row),null!=r&&t._translateCell(e,"column",r,o.column)}),this}},{key:"toString",value:function(){var e=this,t=this.expression.replace(v,function(t,n,r){var o=-1===t.indexOf(":"),i=t,s=t,l=null;o&&(s=h.test(n)?n:r);var u=e._searchCell(s);return u&&(l=u.refError?(0,a.error)(a.ERROR_REF):u.toLabel(),i=o?t.replace(s,l):l),i});return t.startsWith("=")||(t="="+t),t}},{key:"_translateCell",value:function(e,t,n,r){var i=e.start,a=e.end,s=i[t].index,l=a[t].index,u=n,c=n,f=!1;if(this.customModifier){var h=this.customModifier(e,t,n,r),d=o(h,3);u=d[0],c=d[1],f=d[2]}else i[t].isAbsolute&&(u=0),a[t].isAbsolute&&(c=0);u&&!f&&(s+u<0&&(f=!0),i[t].index=Math.max(s+u,0)),c&&!f&&(l+c<0&&(f=!0),a[t].index=Math.max(l+c,0)),f&&(e.refError=!0)}},{key:"_extractCells",value:function(){var e=this,t=this.expression.match(p);t&&(0,s.arrayEach)(t,function(t){if(t=t.match(d)){var n=(0,a.extractLabel)(t[0]),r=o(n,2),i=r[0],s=r[1];e.cells.push(e._createCell({row:i,column:s},{row:i,column:s},t[0]))}})}},{key:"_extractCellsRange",value:function(){var e=this,t=this.expression.match(g);t&&(0,s.arrayEach)(t,function(t){var n=t.split(":"),r=o(n,2),i=r[0],s=r[1],l=(0,a.extractLabel)(i),u=o(l,2),c=u[0],f=u[1],h=(0,a.extractLabel)(s),d=o(h,2);e.cells.push(e._createCell({row:c,column:f},{row:d[0],column:d[1]},t))})}},{key:"_searchCell",value:function(e){var t=(0,s.arrayFilter)(this.cells,function(t){return t.origLabel===e});return o(t,1)[0]||null}},{key:"_createCell",value:function(e,t,n){return{start:e,end:t,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var e=(0,a.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(e+=":"+(0,a.toLabel)(this.end.row,this.end.column)),e}}}}]),e}();(0,l.mixin)(m,c.default),t.default=m},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(68),o=Math.max,i=Math.min;e.exports=function(e,t){return e=r(e),e<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(37);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(39),o=n(167),i=n(168),a=n(20),s=n(27),l=n(169),u={},c={},t=e.exports=function(e,t,n,f,h){var d,p,g,v,m=h?function(){return e}:l(e),y=r(n,f,t?2:1),w=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(d=s(e.length);d>w;w++)if((v=t?y(a(p=e[w])[0],p[1]):y(e[w]))===u||v===c)return v}else for(g=m.call(e);!(p=g.next()).done;)if((v=o(g,y,p.value,t))===u||v===c)return v};t.BREAK=u,t.RETURN=c},function(e,t){e.exports=!1},function(e,t,n){"use strict";var r=n(17),o=n(5),i=n(37),a=n(70),s=n(41),l=n(73),u=n(72),c=n(11),f=n(25),h=n(93),d=n(58),p=n(346);e.exports=function(e,t,n,g,v,m){var y=r[e],w=y,b=v?"set":"add",C=w&&w.prototype,E={},O=function(e){var t=C[e];i(C,e,"delete"==e?function(e){return!(m&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof w&&(m||C.forEach&&!f(function(){(new w).entries().next()}))){var _=new w,S=_[b](m?{}:-0,1)!=_,T=f(function(){_.has(1)}),R=h(function(e){new w(e)}),M=!m&&f(function(){for(var e=new w,t=5;t--;)e[b](t,t);return!e.has(-0)});R||(w=t(function(t,n){u(t,w,e);var r=p(new y,t,w);return void 0!=n&&l(n,v,r[b],r),r}),w.prototype=C,C.constructor=w),(T||M)&&(O("delete"),O("has"),v&&O("get")),(M||S)&&O(b),m&&C.clear&&delete C.clear}else w=g.getConstructor(t,e,v,b),a(w.prototype,n),s.NEED=!0;return d(w,e),E[e]=w,o(o.G+o.W+o.F*(w!=y),E),m||g.setStrong(w,e,v),w}},function(e,t,n){var r=n(59),o=n(56),i=n(26),a=n(87),s=n(32),l=n(163),u=Object.getOwnPropertyDescriptor;t.f=n(24)?u:function(e,t){if(e=i(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(39),o=n(89),i=n(40),a=n(27),s=n(347);e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,c=4==e,f=6==e,h=5==e||f,d=t||s;return function(t,s,p){for(var g,v,m=i(t),y=o(m),w=r(s,p,3),b=a(y.length),C=0,E=n?d(t,b):l?d(t,0):void 0;b>C;C++)if((h||C in y)&&(g=y[C],v=w(g,C,m),e))if(n)E[C]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return C;case 2:E.push(g)}else if(c)return!1;return f?-1:u||c?c:E}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var r=n(38),o=n(37),i=n(25),a=n(46),s=n(14);e.exports=function(e,t,n){var l=s(e),u=n(a,l,""[e]),c=u[0],f=u[1];i(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(o(String.prototype,e,c),r(RegExp.prototype,l,2==t?function(e,t){return f.call(e,this,t)}:function(e){return f.call(e,this)}))}},function(e,t,n){"use strict";var r=n(50),o=n(173),i=n(57),a=n(26);e.exports=n(171)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,n):"values"==t?o(0,e[n]):o(0,[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r,o;/*!
 * numbro.js
 * version : 1.11.0
 * author : FÃ¶retagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";function i(e){this._value=e}function a(e){return 0===e?1:Math.floor(Math.log(Math.abs(e))/Math.LN10)+1}function s(e){var t,n="";for(t=0;t<e;t++)n+="0";return n}function l(e,t){var n,r,o,i,a,l,u,c;return c=e.toString(),n=c.split("e")[0],i=c.split("e")[1],r=n.split(".")[0],o=n.split(".")[1]||"",+i>0?c=r+o+s(i-o.length):(a=+r<0?"-0":"0",t>0&&(a+="."),u=s(-1*i-1),l=(u+Math.abs(r)+o).substr(0,t),c=a+l),+i>0&&t>0&&(c+="."+s(t)),c}function u(e,t,n,r){var o,i,a=Math.pow(10,t);return e.toString().indexOf("e")>-1?(i=l(e,t),"-"===i.charAt(0)&&+i>=0&&(i=i.substr(1))):i=(n(e+"e+"+t)/a).toFixed(t),r&&(o=new RegExp("0{1,"+r+"}$"),i=i.replace(o,"")),i}function c(e,t,n){var r=t.replace(/\{[^\{\}]*\}/g,"");return r.indexOf("$")>-1?h(e,M[k].currency.symbol,t,n):r.indexOf("%")>-1?p(e,t,n):r.indexOf(":")>-1?g(e):y(e._value,t,n)}function f(e,t){var n,r,o,i,a,s=t,l=!1;if(t.indexOf(":")>-1)e._value=v(t);else if(t===A)e._value=0;else{for("."!==M[k].delimiters.decimal&&(t=t.replace(/\./g,"").replace(M[k].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+M[k].abbreviations.thousand+"(?:\\)|(\\"+M[k].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+M[k].abbreviations.million+"(?:\\)|(\\"+M[k].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+M[k].abbreviations.billion+"(?:\\)|(\\"+M[k].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+M[k].abbreviations.trillion+"(?:\\)|(\\"+M[k].currency.symbol+")?(?:\\))?)?$"),a=1;a<_.length&&!l;++a)t.indexOf(_[a])>-1?l=Math.pow(1024,a):t.indexOf(S[a])>-1&&(l=Math.pow(1e3,a));var u=t.replace(/[^0-9\.]+/g,"");""===u?e._value=NaN:(e._value=(l||1)*(s.match(n)?Math.pow(10,3):1)*(s.match(r)?Math.pow(10,6):1)*(s.match(o)?Math.pow(10,9):1)*(s.match(i)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(u),e._value=l?Math.ceil(e._value):e._value)}return e._value}function h(e,t,n,r){var o,i,a=n,s=a.indexOf("$"),l=a.indexOf("("),u=a.indexOf("+"),c=a.indexOf("-"),f="",h="";if(-1===a.indexOf("$")?"infix"===M[k].currency.position?(h=t,M[k].currency.spaceSeparated&&(h=" "+h+" ")):M[k].currency.spaceSeparated&&(f=" "):a.indexOf(" $")>-1?(f=" ",a=a.replace(" $","")):a.indexOf("$ ")>-1?(f=" ",a=a.replace("$ ","")):a=a.replace("$",""),i=y(e._value,a,r,h),-1===n.indexOf("$"))switch(M[k].currency.position){case"postfix":i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,f+t),i=i.join("")):i=i+f+t;break;case"infix":break;case"prefix":i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),o=Math.max(l,c)+1,i.splice(o,0,t+f),i=i.join("")):i=t+f+i;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else s<=1?i.indexOf("(")>-1||i.indexOf("+")>-1||i.indexOf("-")>-1?(i=i.split(""),o=1,(s<l||s<u||s<c)&&(o=0),i.splice(o,0,t+f),i=i.join("")):i=t+f+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,f+t),i=i.join("")):i=i+f+t;return i}function d(e,t,n,r){return h(e,t,n,r)}function p(e,t,n){var r,o="",i=100*e._value;return t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%",""),r=y(i,t,n),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,o+"%"),r=r.join("")):r=r+o+"%",r}function g(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}function v(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function m(e,t,n){var r,o,i,a=t[0],s=Math.abs(e);if(s>=n){for(r=1;r<t.length;++r)if(o=Math.pow(n,r),i=Math.pow(n,r+1),s>=o&&s<i){a=t[r],e/=o;break}a===t[0]&&(e/=Math.pow(n,t.length-1),a=t[t.length-1])}return{value:e,suffix:a}}function y(e,t,n,r){var o,i,l,c,f,h,d,p,g,v,y,w,b,C,E,O,_=!1,S=!1,T=!1,N="",I=!1,D=!1,P=!1,x=!1,L=!1,H="",j="",V=Math.abs(e),F="",B=!1,U=!1,W="";if(0===e&&null!==A)return A;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var Y=t.indexOf("}");if(-1===Y)throw Error('Format should also contain a "}"');v=t.slice(1,Y),t=t.slice(Y+1)}else v="";if(t.indexOf("}")===t.length-1&&t.length){var $=t.indexOf("{");if(-1===$)throw Error('Format should also contain a "{"');y=t.slice($+1,-1),t=t.slice(0,$+1)}else y="";var G;for(G=t.match(-1===t.indexOf(".")?/([0-9]+).*/:/([0-9]+)\..*/),E=null===G?-1:G[1].length,-1!==t.indexOf("-")&&(B=!0),t.indexOf("(")>-1?(_=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(S=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),I=t.indexOf("aK")>=0,D=t.indexOf("aM")>=0,P=t.indexOf("aB")>=0,x=t.indexOf("aT")>=0,L=I||D||P||x,t.indexOf(" a")>-1?(N=" ",t=t.replace(" a","")):t=t.replace("a",""),l=a(e),f=l%3,f=0===f?3:f,p&&0!==V&&(h=3*~~((Math.min(p,l)-f)/3),V/=Math.pow(10,h)),l!==p&&(V>=Math.pow(10,12)&&!L||x?(N+=M[k].abbreviations.trillion,e/=Math.pow(10,12)):V<Math.pow(10,12)&&V>=Math.pow(10,9)&&!L||P?(N+=M[k].abbreviations.billion,e/=Math.pow(10,9)):V<Math.pow(10,9)&&V>=Math.pow(10,6)&&!L||D?(N+=M[k].abbreviations.million,e/=Math.pow(10,6)):(V<Math.pow(10,6)&&V>=Math.pow(10,3)&&!L||I)&&(N+=M[k].abbreviations.thousand,e/=Math.pow(10,3))),c=a(e),p&&c<p&&-1===t.indexOf(".")&&(t+="[.]",t+=s(p-c))),O=0;O<R.length;++O)if(o=R[O],t.indexOf(o.marker)>-1){t.indexOf(" "+o.marker)>-1&&(H=" "),t=t.replace(H+o.marker,""),i=m(e,o.suffixes,o.scale),e=i.value,H+=i.suffix;break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(j=" ",t=t.replace(" o","")):t=t.replace("o",""),M[k].ordinal&&(j+=M[k].ordinal(e))),t.indexOf("[.]")>-1&&(T=!0,t=t.replace("[.]",".")),g=t.split(".")[1],w=t.indexOf(","),g){var z=[];if(-1!==g.indexOf("*")?(F=e.toString(),z=F.split("."),z.length>1&&(F=u(e,z[1].length,n))):g.indexOf("[")>-1?(g=g.replace("]",""),g=g.split("["),F=u(e,g[0].length+g[1].length,n,g[1].length)):F=u(e,g.length,n),z=F.split("."),d=z[0],z.length>1&&z[1].length){F=(r?N+r:M[k].delimiters.decimal)+z[1]}else F="";T&&0===Number(F.slice(1))&&(F="")}else d=u(e,0,n);return d.indexOf("-")>-1&&(d=d.slice(1),U=!0),d.length<E&&(d=s(E-d.length)+d),w>-1&&(d=d.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+M[k].delimiters.thousands)),0===t.indexOf(".")&&(d=""),b=t.indexOf("("),C=t.indexOf("-"),W=b<C?(_&&U?"(":"")+(B&&U||!_&&U?"-":""):(B&&U||!_&&U?"-":"")+(_&&U?"(":""),v+W+(!U&&S&&0!==e?"+":"")+d+F+(j||"")+(N&&!r?N:"")+(H||"")+(_&&U?")":"")+y}function w(e,t){M[e]=t}function b(e){k=e;var t=M[e].defaults;t&&t.format&&O.defaultFormat(t.format),t&&t.currencyFormat&&O.defaultCurrencyFormat(t.currencyFormat)}function C(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function E(){return Array.prototype.slice.call(arguments).reduce(function(e,t){var n=C(e),r=C(t);return n>r?n:r},-1/0)}var O,_=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],S=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T={general:{scale:1024,suffixes:S,marker:"bd"},binary:{scale:1024,suffixes:_,marker:"b"},decimal:{scale:1e3,suffixes:S,marker:"d"}},R=[T.general,T.binary,T.decimal],M={},N=M,k="en-US",A=null,I="0,0",D="0$",P=void 0!==e&&e.exports,x={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};O=function(e){return e=O.isNumbro(e)?e.value():"string"==typeof e||"number"==typeof e?O.fn.unformat(e):NaN,new i(Number(e))},O.version="1.11.0",O.isNumbro=function(e){return e instanceof i},O.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=e,r=e.split("-")[0],o=null;N[n]||(Object.keys(N).forEach(function(e){o||e.split("-")[0]!==r||(o=e)}),n=o||t||"en-US"),b(n)},O.setCulture=function(e,t){var n=e,r=e.split("-")[1],o=null;M[n]||(r&&Object.keys(M).forEach(function(e){o||e.split("-")[1]!==r||(o=e)}),n=o||t||"en-US"),b(n)},O.language=function(e,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return k;if(e&&!t){if(!N[e])throw new Error("Unknown language : "+e);b(e)}return!t&&N[e]||w(e,t),O},O.culture=function(e,t){if(!e)return k;if(e&&!t){if(!M[e])throw new Error("Unknown culture : "+e);b(e)}return!t&&M[e]||w(e,t),O},O.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return N[k];if(!N[e])throw new Error("Unknown language : "+e);return N[e]},O.cultureData=function(e){if(!e)return M[k];if(!M[e])throw new Error("Unknown culture : "+e);return M[e]},O.culture("en-US",x),O.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),N},O.cultures=function(){return M},O.zeroFormat=function(e){A="string"==typeof e?e:null},O.defaultFormat=function(e){I="string"==typeof e?e:"0.0"},O.defaultCurrencyFormat=function(e){D="string"==typeof e?e:"0$"},O.validate=function(e,t){var n,r,o,i,a,s,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),e=e.replace(/^[+-]?/,""),e.match(/^\d+$/))return!0;if(""===e)return!1;try{l=O.cultureData(t)}catch(e){l=O.cultureData(O.culture())}return o=l.currency.symbol,a=l.abbreviations,n=l.delimiters.decimal,r="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=e.match(/^[^\d\.\,]+/))||(e=e.substr(1),u[0]===o))&&((null===(u=e.match(/[^\d]+$/))||(e=e.slice(0,-1),u[0]===a.thousand||u[0]===a.million||u[0]===a.billion||u[0]===a.trillion))&&(s=new RegExp(r+"{2}"),!e.match(/[^\d.,]/g)&&(i=e.split(n),!(i.length>2)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(s):""===i[0]?!i[0].match(s)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(s)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(s)&&!!i[1].match(/^\d+$/)))))},O.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),O.loadCulturesInNode()},O.loadCulturesInNode=function(){var e=n(381);for(var t in e)t&&O.culture(t,e[t])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,r,o=this.length>>>0,i=!1;for(1<arguments.length&&(r=t,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?r=e(r,this[n],n,this):(r=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return r}),O.fn=i.prototype={clone:function(){return O(this)},format:function(e,t){return c(this,e||I,void 0!==t?t:Math.round)},formatCurrency:function(e,t){return h(this,M[k].currency.symbol,e||D,void 0!==t?t:Math.round)},formatForeignCurrency:function(e,t,n){return d(this,e,t||D,void 0!==n?n:Math.round)},unformat:function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=f(this,e);return isNaN(t)?void 0:t}},binaryByteUnits:function(){return m(this._value,T.binary.suffixes,T.binary.scale).suffix},byteUnits:function(){return m(this._value,T.general.suffixes,T.general.scale).suffix},decimalByteUnits:function(){return m(this._value,T.decimal.suffixes,T.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+n*t}var n=E.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t){return e-n*t}var n=E.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t){var n=E(e,t),r=e*n;return r*=t*n,r/=n*n}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var n=E(e,t);return e*n/(t*n)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(O(this._value).subtract(e).value())}},function(){return"undefined"!=typeof process&&void 0===process.browser&&process.title&&(-1!==process.title.indexOf("node")||process.title.indexOf("meteor-tool")>0||"grunt"===process.title||"gulp"===process.title)&&!0}()&&O.loadCulturesInNode(),P?e.exports=O:("undefined"==typeof ender&&(this.numbro=O),r=[],void 0!==(o=function(){return O}.apply(t,r))&&(e.exports=o))}).call("undefined"==typeof window?this:window),window.numbro=n(81)},function(e,t,n){"use strict";function r(e){for(var t=e+1,n="",r=void 0;t>0;)r=(t-1)%d,n=String.fromCharCode(65+r)+n,t=parseInt((t-r)/d,10);return n}function o(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(d,r)*(h.indexOf(e[n])+1);return--t}function i(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=[];for(e=0;e<n;e++){var a=[];for(t=0;t<o;t++)a.push(r(t)+(e+1));i.push(a)}return i}function a(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=[];for(e=0;e<n;e++){var a={};for(t=0;t<o;t++)a["prop"+t]=r(t)+(e+1);i.push(a)}return i}function s(e,t){for(var n=[],r=void 0,o=0;o<e;o++){r=[];for(var i=0;i<t;i++)r.push("");n.push(r)}return n}function l(e){var t,n,r,o,i=[],a=0;for(t=0,n=e.length;t<n;t++)for(r=0,o=e[t].length;r<o;r++)r==a&&(i.push([]),a++),i[r].push(e[t][r]);return i}function u(e,t){return t=void 0===t||t,function(n,r){return function n(r){if(r){if((0,f.hasOwnProperty)(r,e)&&void 0!==r[e])return r[e];if((0,f.hasOwnProperty)(r,"type")&&r.type){var o;if("string"!=typeof r.type)throw new Error("Cell type must be a string ");if(o=(0,c.getCellType)(r.type),(0,f.hasOwnProperty)(o,e))return o[e];if(t)return}return n(Object.getPrototypeOf(r))}}("number"==typeof n?this.getCellMeta(n,r):n)}}t.__esModule=!0,t.spreadsheetColumnLabel=r,t.spreadsheetColumnIndex=o,t.createSpreadsheetData=i,t.createSpreadsheetObjectData=a,t.createEmptySpreadsheetData=s,t.translateRowsToColumns=l,t.cellMethodLookupFactory=u;var c=n(152),f=n(2),h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",d=h.length},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e;return(0,c.isObject)(e)&&(t=e,n=t.languageCode),l(n,t),y(n,(0,c.deepClone)(t)),(0,c.deepClone)(t)}function i(e){return a(e)?(0,c.deepClone)(w(e)):null}function a(e){return b(e)}function s(){return g.default}function l(e,t){e!==v&&(0,f.extendNotExistingKeys)(t,w(v))}function u(){return C()}t.__esModule=!0,t.DEFAULT_LANGUAGE_CODE=t.getLanguagesDictionaries=t.getDefaultLanguageDictionary=t.hasLanguageDictionary=t.getLanguageDictionary=t.registerLanguageDictionary=void 0;var c=n(2),f=n(322),h=n(51),d=r(h),p=n(410),g=r(p),v=g.default.languageCode,m=(0,d.default)("languagesDictionaries"),y=m.register,w=m.getItem,b=m.hasItem,C=m.getValues;t.registerLanguageDictionary=o,t.getLanguageDictionary=i,t.hasLanguageDictionary=a,t.getDefaultLanguageDictionary=s,t.getLanguagesDictionaries=u,t.DEFAULT_LANGUAGE_CODE=v,o(g.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=n(2),l=n(31),u=r(l),c=n(492),f=r(c),h=function(){function e(t){o(this,e),this.hot=t,this.elements=[],this.hidden=!1}return i(e,[{key:"reset",value:function(){(0,a.arrayEach)(this.elements,function(e){return e.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),(0,a.arrayEach)(this.elements,function(e){return e.destroy()}),this.elements=null,this.hot=null}}]),e}();(0,s.mixin)(h,u.default),(0,s.mixin)(h,f.default),t.default=h},function(e,t,n){"use strict";var r=n(162),o=n(49);e.exports=n(75)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(o(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(o(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){var r=n(11),o=n(17).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,n){var r=n(11);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(20),o=n(344),i=n(92),a=n(90)("IE_PROTO"),s=function(){},l=function(){var e,t=n(86)("iframe"),r=i.length;for(t.style.display="none",n(166).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[i[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(47);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(91)("keys"),o=n(55);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(17),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(14)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:n=!0}},i[r]=function(){return a},e(i)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(162),o=n(49);e.exports=n(75)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(o(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,o=n(77)(0),i=n(37),a=n(41),s=n(177),l=n(178),u=n(11),c=n(25),f=n(49),h=a.getWeak,d=Object.isExtensible,p=l.ufstore,g={},v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(e){if(u(e)){var t=h(e);return!0===t?p(f(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(f(this,"WeakMap"),e,t)}},y=e.exports=n(75)("WeakMap",v,m,l,!0,!0);c(function(){return 7!=(new y).set((Object.freeze||Object)(g),7).get(g)})&&(r=l.getConstructor(v,"WeakMap"),s(r.prototype,m),a.NEED=!0,o(["delete","has","get","set"],function(e){var t=y.prototype,n=t[e];i(t,e,function(t,o){if(u(t)&&!d(t)){this._f||(this._f=new r);var i=this._f[e](t,o);return"set"==e?this:i}return n.call(this,t,o)})}))},function(e,t,n){"use strict";var r=n(178),o=n(49);n(75)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(o(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r,o,i,a,s=n(74),l=n(17),u=n(39),c=n(170),f=n(5),h=n(11),d=n(71),p=n(72),g=n(73),v=n(349),m=n(98).set,y=n(351)(),w=n(179),b=n(352),C=n(353),E=l.TypeError,O=l.process,_=l.Promise,S="process"==c(O),T=function(){},R=o=w.f,M=!!function(){try{var e=_.resolve(1),t=(e.constructor={})[n(14)("species")]=function(e){e(T,T)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(T)instanceof t}catch(e){}}(),N=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var n=e._c;y(function(){for(var r=e._v,o=1==e._s,i=0;n.length>i;)!function(t){var n,i,a=o?t.ok:t.fail,s=t.resolve,l=t.reject,u=t.domain;try{a?(o||(2==e._h&&D(e),e._h=1),!0===a?n=r:(u&&u.enter(),n=a(r),u&&u.exit()),n===t.promise?l(E("Promise-chain cycle")):(i=N(n))?i.call(n,s,l):s(n)):l(r)}catch(e){l(e)}}(n[i++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){m.call(l,function(){var t,n,r,o=e._v,i=I(e);if(i&&(t=b(function(){S?O.emit("unhandledRejection",o,e):(n=l.onunhandledrejection)?n({promise:e,reason:o}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=S||I(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},I=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if(t=n[r++],t.fail||!I(t.promise))return!1;return!0},D=function(e){m.call(l,function(){var t;S?O.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},P=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},x=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw E("Promise can't be resolved itself");(t=N(e))?y(function(){var r={_w:n,_d:!1};try{t.call(e,u(x,r,1),u(P,r,1))}catch(e){P.call(r,e)}}):(n._v=e,n._s=1,k(n,!1))}catch(e){P.call({_w:n,_d:!1},e)}}};M||(_=function(e){p(this,_,"Promise","_h"),d(e),r.call(this);try{e(u(x,this,1),u(P,this,1))}catch(e){P.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(70)(_.prototype,{then:function(e,t){var n=R(v(this,_));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?O.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=u(x,e,1),this.reject=u(P,e,1)},w.f=R=function(e){return e===_||e===a?new i(e):o(e)}),f(f.G+f.W+f.F*!M,{Promise:_}),n(58)(_,"Promise"),n(174)("Promise"),a=n(48).Promise,f(f.S+f.F*!M,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!M),"Promise",{resolve:function(e){return C(s&&this===a?_:this,e)}}),f(f.S+f.F*!(M&&n(93)(function(e){_.all(e).catch(T)})),"Promise",{all:function(e){var t=this,n=R(t),r=n.resolve,o=n.reject,i=b(function(){var n=[],i=0,a=1;g(e,!1,function(e){var s=i++,l=!1;n.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--a||r(n))},o)}),--a||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=R(t),r=n.reject,o=b(function(){g(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){var r,o,i,a=n(39),s=n(350),l=n(166),u=n(86),c=n(17),f=c.process,h=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,g=c.Dispatch,v=0,m={},y=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},w=function(e){y.call(e.data)};h&&d||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++v]=function(){s("function"==typeof e?e:Function(e),t)},r(v),v},d=function(e){delete m[e]},"process"==n(47)(f)?r=function(e){f.nextTick(a(y,e,1))}:g&&g.now?r=function(e){g.now(a(y,e,1))}:p?(o=new p,i=o.port2,o.port1.onmessage=w,r=a(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",w,!1)):r="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:h,clear:d}},function(e,t,n){"use strict";var r=n(17),o=n(32),i=n(24),a=n(5),s=n(37),l=n(41).KEY,u=n(25),c=n(91),f=n(58),h=n(55),d=n(14),p=n(180),g=n(354),v=n(355),m=n(176),y=n(20),w=n(26),b=n(87),C=n(56),E=n(88),O=n(181),_=n(76),S=n(22),T=n(45),R=_.f,M=S.f,N=O.f,k=r.Symbol,A=r.JSON,I=A&&A.stringify,D=d("_hidden"),P=d("toPrimitive"),x={}.propertyIsEnumerable,L=c("symbol-registry"),H=c("symbols"),j=c("op-symbols"),V=Object.prototype,F="function"==typeof k,B=r.QObject,U=!B||!B.prototype||!B.prototype.findChild,W=i&&u(function(){return 7!=E(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=R(V,t);r&&delete V[t],M(e,t,n),r&&e!==V&&M(V,t,r)}:M,Y=function(e){var t=H[e]=E(k.prototype);return t._k=e,t},$=F&&"symbol"==typeof k.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof k},G=function(e,t,n){return e===V&&G(j,t,n),y(e),t=b(t,!0),y(n),o(H,t)?(n.enumerable?(o(e,D)&&e[D][t]&&(e[D][t]=!1),n=E(n,{enumerable:C(0,!1)})):(o(e,D)||M(e,D,C(1,{})),e[D][t]=!0),W(e,t,n)):M(e,t,n)},z=function(e,t){y(e);for(var n,r=v(t=w(t)),o=0,i=r.length;i>o;)G(e,n=r[o++],t[n]);return e},X=function(e,t){return void 0===t?E(e):z(E(e),t)},K=function(e){var t=x.call(this,e=b(e,!0));return!(this===V&&o(H,e)&&!o(j,e))&&(!(t||!o(this,e)||!o(H,e)||o(this,D)&&this[D][e])||t)},q=function(e,t){if(e=w(e),t=b(t,!0),e!==V||!o(H,t)||o(j,t)){var n=R(e,t);return!n||!o(H,t)||o(e,D)&&e[D][t]||(n.enumerable=!0),n}},Q=function(e){for(var t,n=N(w(e)),r=[],i=0;n.length>i;)o(H,t=n[i++])||t==D||t==l||r.push(t);return r},Z=function(e){for(var t,n=e===V,r=N(n?j:w(e)),i=[],a=0;r.length>a;)!o(H,t=r[a++])||n&&!o(V,t)||i.push(H[t]);return i};F||(k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(n){this===V&&t.call(j,n),o(this,D)&&o(this[D],e)&&(this[D][e]=!1),W(this,e,C(1,n))};return i&&U&&W(V,e,{configurable:!0,set:t}),Y(e)},s(k.prototype,"toString",function(){return this._k}),_.f=q,S.f=G,n(100).f=O.f=Q,n(59).f=K,n(78).f=Z,i&&!n(74)&&s(V,"propertyIsEnumerable",K,!0),p.f=function(e){return Y(d(e))}),a(a.G+a.W+a.F*!F,{Symbol:k});for(var J="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;J.length>ee;)d(J[ee++]);for(var te=T(d.store),ne=0;te.length>ne;)g(te[ne++]);a(a.S+a.F*!F,"Symbol",{for:function(e){return o(L,e+="")?L[e]:L[e]=k(e)},keyFor:function(e){if(!$(e))throw TypeError(e+" is not a symbol!");for(var t in L)if(L[t]===e)return t},useSetter:function(){U=!0},useSimple:function(){U=!1}}),a(a.S+a.F*!F,"Object",{create:X,defineProperty:G,defineProperties:z,getOwnPropertyDescriptor:q,getOwnPropertyNames:Q,getOwnPropertySymbols:Z}),A&&a(a.S+a.F*(!F||u(function(){var e=k();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!$(e)){for(var t,n,r=[e],o=1;arguments.length>o;)r.push(arguments[o++]);return t=r[1],"function"==typeof t&&(n=t),!n&&m(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!$(t))return t}),r[1]=t,I.apply(A,r)}}}),k.prototype[P]||n(38)(k.prototype,P,k.prototype.valueOf),f(k,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(164),o=n(92).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){var r=n(11),o=n(41).onFreeze;n(28)("freeze",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(11),o=n(41).onFreeze;n(28)("seal",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(11),o=n(41).onFreeze;n(28)("preventExtensions",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(11);n(28)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(11);n(28)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(11);n(28)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){var r=n(26),o=n(76).f;n(28)("getOwnPropertyDescriptor",function(){return function(e,t){return o(r(e),t)}})},function(e,t,n){var r=n(40),o=n(172);n(28)("getPrototypeOf",function(){return function(e){return o(r(e))}})},function(e,t,n){var r=n(40),o=n(45);n(28)("keys",function(){return function(e){return o(r(e))}})},function(e,t,n){n(28)("getOwnPropertyNames",function(){return n(181).f})},function(e,t,n){var r=n(5);r(r.S+r.F,"Object",{assign:n(177)})},function(e,t,n){var r=n(5);r(r.S,"Object",{is:n(356)})},function(e,t,n){var r=n(5);r(r.S,"Object",{setPrototypeOf:n(175).set})},function(e,t,n){var r=n(22).f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||n(24)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},function(e,t,n){var r=n(5),o=n(26),i=n(27);r(r.S,"String",{raw:function(e){for(var t=o(e.raw),n=i(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){var r=n(5),o=n(69),i=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";var r=n(5),o=n(357)(!1);r(r.P,"String",{codePointAt:function(e){return o(this,e)}})},function(e,t,n){var r=n(5);r(r.P,"String",{repeat:n(182)})},function(e,t,n){"use strict";var r=n(5),o=n(27),i=n(120),a="".startsWith;r(r.P+r.F*n(121)("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),n=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){var r=n(183),o=n(46);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(e))}},function(e,t,n){var r=n(14)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";var r=n(5),o=n(27),i=n(120),a="".endsWith;r(r.P+r.F*n(121)("endsWith"),"String",{endsWith:function(e){var t=i(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=o(t.length),s=void 0===n?r:Math.min(o(n),r),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";var r=n(5),o=n(120);r(r.P+r.F*n(121)("includes"),"String",{includes:function(e){return!!~o(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){n(24)&&"g"!=/./g.flags&&n(22).f(RegExp.prototype,"flags",{configurable:!0,get:n(358)})},function(e,t,n){n(79)("match",1,function(e,t,n){return[function(n){"use strict";var r=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(79)("replace",2,function(e,t,n){return[function(r,o){"use strict";var i=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,i,o):n.call(String(i),r,o)},n]})},function(e,t,n){n(79)("split",2,function(e,t,r){"use strict";var o=n(183),i=r,a=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var l=void 0===/()??/.exec("")[1];r=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!o(e))return i.call(n,e,t);var r,u,c,f,h,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,v=void 0===t?4294967295:t>>>0,m=new RegExp(e.source,p+"g");for(l||(r=new RegExp("^"+m.source+"$(?!\\s)",p));(u=m.exec(n))&&!((c=u.index+u[0][s])>g&&(d.push(n.slice(g,u.index)),!l&&u[s]>1&&u[0].replace(r,function(){for(h=1;h<arguments[s]-2;h++)void 0===arguments[h]&&(u[h]=void 0)}),u[s]>1&&u.index<n[s]&&a.apply(d,u.slice(1)),f=u[0][s],g=c,d[s]>=v));)m.lastIndex===u.index&&m.lastIndex++;return g===n[s]?!f&&m.test("")||d.push(""):d.push(n.slice(g)),d[s]>v?d.slice(0,v):d}}else"0".split(void 0,0)[s]&&(r=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(n,o){var i=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,i,o):r.call(String(i),n,o)},r]})},function(e,t,n){n(79)("search",1,function(e,t,n){return[function(n){"use strict";var r=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){"use strict";var r=n(39),o=n(5),i=n(40),a=n(167),s=n(168),l=n(27),u=n(130),c=n(169);o(o.S+o.F*!n(93)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,o,f,h=i(e),d="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,m=0,y=c(h);if(v&&(g=r(g,p>2?arguments[2]:void 0,2)),void 0==y||d==Array&&s(y))for(t=l(h.length),n=new d(t);t>m;m++)u(n,m,v?g(h[m],m):h[m]);else for(f=y.call(h),n=new d;!(o=f.next()).done;m++)u(n,m,v?a(f,g,[o.value,m],!0):o.value);return n.length=m,n}})},function(e,t,n){"use strict";var r=n(22),o=n(56);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){"use strict";var r=n(5),o=n(130);r(r.S+r.F*n(25)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)o(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){var r=n(5);r(r.P,"Array",{copyWithin:n(359)}),n(50)("copyWithin")},function(e,t,n){"use strict";var r=n(5),o=n(77)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(50)("find")},function(e,t,n){"use strict";var r=n(5),o=n(77)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(50)(i)},function(e,t,n){var r=n(5);r(r.P,"Array",{fill:n(360)}),n(50)("fill")},function(e,t,n){var r=n(5),o=n(17).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&o(e)}})},function(e,t,n){var r=n(5);r(r.S,"Number",{isInteger:n(184)})},function(e,t,n){var r=n(5),o=n(184),i=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return o(e)&&i(e)<=9007199254740991}})},function(e,t,n){var r=n(5);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(5);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(5);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(5);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){"use strict";var r=n(5),o=n(165)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(50)("includes")},function(e,t,n){var r=n(5),o=n(185)(!1);r(r.S,"Object",{values:function(e){return o(e)}})},function(e,t,n){var r=n(5),o=n(185)(!0);r(r.S,"Object",{entries:function(e){return o(e)}})},function(e,t,n){var r=n(5),o=n(361),i=n(26),a=n(76),s=n(130);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=i(e),l=a.f,u=o(r),c={},f=0;u.length>f;)void 0!==(n=l(r,t=u[f++]))&&s(c,t,n);return c}})},function(e,t,n){"use strict";var r=n(5),o=n(186);r(r.P,"String",{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var r=n(5),o=n(186);r(r.P,"String",{padEnd:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){var r=n(5),o=n(98);r(r.G+r.B,{setImmediate:o.set,clearImmediate:o.clear})},function(e,t,n){for(var r=n(80),o=n(45),i=n(37),a=n(17),s=n(38),l=n(57),u=n(14),c=u("iterator"),f=u("toStringTag"),h=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(d),g=0;g<p.length;g++){var v,m=p[g],y=d[m],w=a[m],b=w&&w.prototype;if(b&&(b[c]||s(b,c,h),b[f]||s(b,f,m),l[m]=h,y))for(v in r)b[v]||i(b,v,r[v],!0)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(60),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(){function e(t,n,o){r(this,e),this.highlight=t,this.from=n,this.to=o}return o(e,[{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getTopLeftCorner(),o=this.getBottomRightCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)}},{key:"expand",value:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new a.default(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new a.default(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var n=this.getTopLeftCorner(),r=this.getBottomRightCorner(),o=(this.getTopRightCorner(),this.getBottomLeftCorner(),t.getTopLeftCorner()),i=t.getBottomRightCorner(),s=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,i.row),c=Math.max(r.col,i.col),f=new a.default(s,l),h=new a.default(u,c),d=new e(f,f,h).isCorner(this.from,t),p=t.isEqual(new e(f,f,h));return d&&!p&&(this.from.col>f.col&&(f.col=c,h.col=l),this.from.row>f.row&&(f.row=u,h.row=s)),this.from=f,this.to=h,!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getTopLeftCorner",value:function(){return new a.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new a.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new a.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new a.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new a.default(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new a.default(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new a.default(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new a.default(t.to.row,t.to.col))))||(e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof a.default))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new a.default(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new a.default(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new a.default(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new a.default(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top==n.top&&r.push("top"),t.right==n.right&&r.push("right"),t.bottom==n.bottom&&r.push("bottom"),t.left==n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(new a.default(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)n.push(e.row===r&&e.col===o?e:t.row===r&&t.col===o?t:new a.default(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++){var i=e(r,o);if(!1===i)return}}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!I(e))throw Error('You declared cell type "'+e+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return A(e)}function i(e,t){var n=t.editor,r=t.renderer,o=t.validator;n&&(0,l.registerEditor)(e,n),r&&(0,u.registerRenderer)(e,r),o&&(0,c.registerValidator)(e,o),k(e,t)}t.__esModule=!0,t.getRegisteredCellTypes=t.getRegisteredCellTypeNames=t.hasCellType=t.getCellType=t.registerCellType=void 0;var a=n(51),s=r(a),l=n(19),u=n(13),c=n(35),f=n(395),h=r(f),d=n(396),p=r(d),g=n(397),v=r(g),m=n(398),y=r(m),w=n(399),b=r(w),C=n(400),E=r(C),O=n(401),_=r(O),S=n(402),T=r(S),R=n(403),M=r(R),N=(0,s.default)("cellTypes"),k=N.register,A=N.getItem,I=N.hasItem,D=N.getNames,P=N.getValues;i("autocomplete",h.default),i("checkbox",p.default),i("date",v.default),i("dropdown",y.default),i("handsontable",b.default),i("numeric",E.default),i("password",_.default),i("text",T.default),i("time",M.default),t.registerCellType=i,t.getCellType=o,t.hasCellType=I,t.getRegisteredCellTypeNames=D,t.getRegisteredCellTypes=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){function n(e){var t=(0,W.normalizeLanguageCode)(e);(0,U.hasLanguageDictionary)(t)?(X.runHooks("beforeLanguageChange",t),M.settings.language=t,X.runHooks("afterLanguageChange",t)):(0,W.warnUserAboutLanguageRegistration)(e)}function r(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(e){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty(this.valid))}}}function i(e,t,n){function o(){var r;e.length&&(r=X.runHooks("beforeChange",e,t),(0,h.isFunction)(r)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===r&&e.splice(0,e.length)),n()}var i=new r;i.onQueueEmpty=o;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var s=e[a][0],l=k.propToCol(e[a][1]),f=X.getCellMeta(s,l),p=f.numericFormat,g=p&&p.culture,v=p&&p.pattern;if("numeric"===f.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&(/^-?[\d\s]*(\.|,)?\d*$/.test(e[a][3])||v)){var m=e[a][3].length;u.default.culture((0,d.isUndefined)(g)?"en-US":e[a][3].indexOf(".")===m-3&&-1===e[a][3].indexOf(",")?"en-US":g),e[a][3]=u.default.validate(e[a][3])&&!isNaN(e[a][3])?parseFloat(e[a][3]):(0,u.default)().unformat(e[a][3])||e[a][3]}X.getCellValidator(f)&&(i.addValidatorToQueue(),X.validateCell(e[a][3],f,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){e.splice(t,1),n.valid=!0;var o=X.getCell(n.visualRow,n.visualCol);(0,c.removeClass)(o,X.getSettings().invalidCellClassName),--t}i.removeValidatorFormQueue()}}(a,f),t))}i.checkIfQueueIsEmpty()}function l(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var r=!1;if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(M.settings.allowInsertRow)for(;e[n][0]>X.countRows()-1;){var o=k.createRow(void 0,void 0,t);if(0===o){r=!0;break}}if(!r){if("array"===X.dataType&&(!M.settings.columns||0===M.settings.columns.length)&&M.settings.allowInsertColumn)for(;k.propToCol(e[n][1])>X.countCols()-1;)k.createCol(void 0,void 0,t);k.set(e[n][0],e[n][1],e[n][3])}}}else e.splice(n,1)}X.forceFullRender=!0,j.adjustRowsAndCols(),X.runHooks("beforeChangeRender",e,t),$.refreshBorders(null,!0),X.view.wt.wtOverlays.adjustElementsSize(),X.runHooks("afterChange",e,t||"edit");var i=X.getActiveEditor();i&&(0,d.isDefined)(i.refreshValue)&&i.refreshValue()}}function g(e,t,n){return"object"===(void 0===e?"undefined":s(e))?e:[[e,t,n]]}function m(e){if((0,C.hasOwnProperty)(e,"type")){var t,n={};"object"===s(e.type)?t=e.type:"string"==typeof e.type&&(t=(0,F.getCellType)(e.type));for(var r in t)(0,C.hasOwnProperty)(t,r)&&!(0,C.hasOwnProperty)(e,r)&&(n[r]=t[r]);return n}}function w(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var M,k,L,j,$,G,z=arguments.length>2&&void 0!==arguments[2]&&arguments[2],X=this,K=function(){},q=new b.default(X);(0,C.extend)(K.prototype,V.default.prototype),(0,C.extend)(K.prototype,t),(0,C.extend)(K.prototype,m(t)),(0,W.applyLanguageSetting)(t.language,K.prototype),(0,P.hasValidParameter)(z)&&(0,P.registerAsRootInstance)(this),this.rootElement=e,this.isHotTableEnv=(0,c.isChildOfWebComponentTable)(this.rootElement),b.default.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,P.isRootInstance)(this)&&(0,d._injectProductInfo)(t.licenseKey,e),this.guid="ht_"+(0,T.randomString)();var Q=(0,D.getTranslator)(X);L=new A.default(X),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),M={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new K,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},j={alter:function(e,t,n,r,i){function a(e,t,n,r){var i=function(){var e=void 0;return"array"===r?e=[]:"object"===r&&(e={}),e},a=(0,E.arrayMap)(new Array(n),function(){return i()});a.unshift(t,0),e.splice.apply(e,o(a))}var s;switch(n=n||1,e){case"insert_row":var l=X.countSourceRows();if(X.getSettings().maxRows===l)return;t=(0,d.isDefined)(t)?t:l,s=k.createRow(t,n,r),a(M.cellSettings,t,n,"array"),s&&($.isSelected()&&M.selRange.from.row>=t?(M.selRange.from.row+=s,$.transformEnd(s,0)):$.refreshBorders());break;case"insert_col":s=k.createCol(t,n,r);for(var u=0,c=X.countSourceRows();u<c;u++)M.cellSettings[u]&&a(M.cellSettings[u],t,n);if(s){if(Array.isArray(X.getSettings().colHeaders)){var f=[t,0];f.length+=s,Array.prototype.splice.apply(X.getSettings().colHeaders,f)}$.isSelected()&&M.selRange.from.col>=t?(M.selRange.from.col+=s,$.transformEnd(0,s)):$.refreshBorders()}break;case"remove_row":k.removeRow(t,n,r),M.cellSettings.splice(t,n);var h=X.countRows(),p=X.getSettings().fixedRowsTop;p>=t+1&&(X.getSettings().fixedRowsTop-=Math.min(n,p-t));var g=X.getSettings().fixedRowsBottom;g&&t>=h-g&&(X.getSettings().fixedRowsBottom-=Math.min(n,g)),j.adjustRowsAndCols(),$.refreshBorders();break;case"remove_col":var v=Q.toPhysicalColumn(t);k.removeCol(t,n,r);for(var m=0,y=X.countSourceRows();m<y;m++)M.cellSettings[m]&&M.cellSettings[m].splice(v,n);var w=X.getSettings().fixedColumnsLeft;w>=t+1&&(X.getSettings().fixedColumnsLeft-=Math.min(n,w-t)),Array.isArray(X.getSettings().colHeaders)&&(void 0===v&&(v=-1),X.getSettings().colHeaders.splice(v,n)),j.adjustRowsAndCols(),$.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}i||j.adjustRowsAndCols()},adjustRowsAndCols:function(){if(M.settings.minRows){var e=X.countRows();if(e<M.settings.minRows)for(var t=0,n=M.settings.minRows;t<n-e;t++)k.createRow(X.countRows(),1,"auto")}if(M.settings.minSpareRows){var r=X.countEmptyRows(!0);if(r<M.settings.minSpareRows)for(;r<M.settings.minSpareRows&&X.countSourceRows()<M.settings.maxRows;r++)k.createRow(X.countRows(),1,"auto")}var o=void 0;if((M.settings.minCols||M.settings.minSpareCols)&&(o=X.countEmptyCols(!0)),M.settings.minCols&&!M.settings.columns&&X.countCols()<M.settings.minCols)for(;X.countCols()<M.settings.minCols;o++)k.createCol(X.countCols(),1,"auto");if(M.settings.minSpareCols&&!M.settings.columns&&"array"===X.dataType&&o<M.settings.minSpareCols)for(;o<M.settings.minSpareCols&&X.countCols()<M.settings.maxCols;o++)k.createCol(X.countCols(),1,"auto");var i=X.countRows(),a=X.countCols();if(0!==i&&0!==a||$.deselect(),$.isSelected()){var s=!1,l=M.selRange.from.row,u=M.selRange.from.col,c=M.selRange.to.row,f=M.selRange.to.col;l>i-1?(l=i-1,s=!0,c>l&&(c=l)):c>i-1&&(c=i-1,s=!0,l>c&&(l=c)),u>a-1?(u=a-1,s=!0,f>u&&(f=u)):f>a-1&&(f=a-1,s=!0,u>f&&(u=f)),s&&X.selectCell(l,u,c,f)}X.view&&X.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,n,r,i,a,l){var u,c,f,h,p=[],g={};if(0===(c=t.length))return!1;var v,m,y,w;switch(i){case"shift_down":for(v=n?n.col-e.col+1:0,m=n?n.row-e.row+1:0,t=(0,I.translateRowsToColumns)(t),f=0,h=t.length,y=Math.max(h,v);f<y;f++)if(f<h){var b;for(u=0,c=t[f].length;u<m-c;u++)t[f].push(t[f][u%c]);t[f].unshift(e.col+f,e.row,0),(b=X).spliceCol.apply(b,o(t[f]))}else{var E;t[f%h][0]=e.col+f,(E=X).spliceCol.apply(E,o(t[f%h]))}break;case"shift_right":for(v=n?n.col-e.col+1:0,m=n?n.row-e.row+1:0,u=0,c=t.length,w=Math.max(c,m);u<w;u++)if(u<c){var O;for(f=0,h=t[u].length;f<v-h;f++)t[u].push(t[u][f%h]);t[u].unshift(e.row+u,e.col,0),(O=X).spliceRow.apply(O,o(t[u]))}else{var _;t[u%c][0]=e.row+u,(_=X).spliceRow.apply(_,o(t[u%c]))}break;case"overwrite":default:g.row=e.row,g.col=e.col;var S={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},T=0,R=0,N=!0,k=void 0,A=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},D=t.length,P=n?n.row-e.row+1:0;for(c=n?P:Math.max(D,P),u=0;u<c&&!(n&&g.row>n.row&&P>D||!M.settings.allowInsertRow&&g.row>X.countRows()-1||g.row>=M.settings.maxRows);u++){var x=u-T,L=A(x).length,H=n?n.col-e.col+1:0;if(h=n?H:Math.max(L,H),g.col=e.col,k=X.getCellMeta(g.row,g.col),"CopyPaste.paste"!==r&&"Autofill.autofill"!==r||!k.skipRowOnPaste){for(R=0,f=0;f<h&&!(n&&g.col>n.col&&H>L||!M.settings.allowInsertColumn&&g.col>X.countCols()-1||g.col>=M.settings.maxCols);f++)if(k=X.getCellMeta(g.row,g.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!k.skipColumnOnPaste)if(k.readOnly)g.col++;else{var j=f-R,V=A(x,j),F=X.getDataAtCell(g.row,g.col),B={row:x,col:j};if("Autofill.fill"===r){var U=X.runHooks("beforeAutofillInsidePopulate",B,a,t,l,{},S);U&&(V=(0,d.isUndefined)(U.value)?V:U.value)}if(null!==V&&"object"===(void 0===V?"undefined":s(V)))if(null===F||"object"!==(void 0===F?"undefined":s(F)))N=!1;else{var W=(0,C.duckSchema)(F[0]||F),Y=(0,C.duckSchema)(V[0]||V);(0,C.isObjectEquals)(W,Y)?V=(0,C.deepClone)(V):N=!1}else null!==F&&"object"===(void 0===F?"undefined":s(F))&&(N=!1);N&&p.push([g.row,g.col,V]),N=!0,g.col++}else R++,g.col++,h++;g.row++}else T++,g.row++,c++}X.setDataAtCell(p,null,null,r||"populateFromArray")}}},this.selection=$={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];X.selection.selectedHeader.rows=e,X.selection.selectedHeader.cols=t,X.selection.selectedHeader.corner=n},begin:function(){X.selection.inProgress=!0},finish:function(){var e=X.getSelected();X.runHooks("afterSelectionEnd",e[0],e[1],e[2],e[3]),X.runHooks("afterSelectionEndByProp",e[0],X.colToProp(e[1]),e[2],X.colToProp(e[3])),X.selection.inProgress=!1},isInProgress:function(){return X.selection.inProgress},setRangeStart:function(e,t){X.runHooks("beforeSetRangeStart",e),M.selRange=new x.CellRange(e,e,e),$.setRangeEnd(e,null,t)},setRangeStartOnly:function(e){X.runHooks("beforeSetRangeStartOnly",e),M.selRange=new x.CellRange(e,e,e)},setRangeEnd:function(e,t,n){if(null!==M.selRange){var r,o=!1,i=!0,a=X.view.wt.wtTable.getFirstVisibleRow(),s=X.view.wt.wtTable.getFirstVisibleColumn(),l={row:null,col:null};X.runHooks("beforeSetRangeEnd",e),X.selection.begin(),l.row=e.row<0?a:e.row,l.col=e.col<0?s:e.col,M.selRange.to=new x.CellCoords(l.row,l.col),M.settings.multiSelect||(M.selRange.from=e),X.view.wt.selections.current.clear(),r=X.getCellMeta(M.selRange.highlight.row,M.selRange.highlight.col).disableVisualSelection,"string"==typeof r&&(r=[r]),(!1===r||Array.isArray(r)&&-1===r.indexOf("current"))&&X.view.wt.selections.current.add(M.selRange.highlight),X.view.wt.selections.area.clear(),(!1===r||Array.isArray(r)&&-1===r.indexOf("area"))&&$.isMultiple()&&(X.view.wt.selections.area.add(M.selRange.from),X.view.wt.selections.area.add(M.selRange.to)),(M.settings.currentHeaderClassName||M.settings.currentRowClassName||M.settings.currentColClassName)&&(X.view.wt.selections.highlight.clear(),X.view.wt.selections.highlight.add(M.selRange.from),X.view.wt.selections.highlight.add(M.selRange.to));var u=(0,C.createObjectPropListener)("value");X.runHooks("afterSelection",M.selRange.from.row,M.selRange.from.col,M.selRange.to.row,M.selRange.to.col,u),X.runHooks("afterSelectionByProp",M.selRange.from.row,k.colToProp(M.selRange.from.col),M.selRange.to.row,k.colToProp(M.selRange.to.col),u),(X.selection.selectedHeader.cols||X.selection.selectedHeader.rows)&&(o=!0),(e.row<0||e.col<0)&&(i=!1),u.isTouched()&&(t=!u.value),!1!==t&&!o&&i&&X.view.scrollViewport(M.selRange.from&&!$.isMultiple()?M.selRange.from:e),$.selectedHeader.rows&&$.selectedHeader.cols?(0,c.addClass)(X.rootElement,["ht__selection--rows","ht__selection--columns"]):$.selectedHeader.rows?((0,c.removeClass)(X.rootElement,"ht__selection--columns"),(0,c.addClass)(X.rootElement,"ht__selection--rows")):$.selectedHeader.cols?((0,c.removeClass)(X.rootElement,"ht__selection--rows"),(0,c.addClass)(X.rootElement,"ht__selection--columns")):(0,c.removeClass)(X.rootElement,["ht__selection--rows","ht__selection--columns"]),$.refreshBorders(null,n)}},refreshBorders:function(e,t){t||G.destroyEditor(e),X.view.render(),$.isSelected()&&!t&&G.prepareEditor()},isMultiple:function(){var e=!(M.selRange.to.col===M.selRange.from.col&&M.selRange.to.row===M.selRange.from.row),t=X.runHooks("afterIsMultipleSelection",e);if(e)return t},transformStart:function(e,t,n,r){var o,i,a,s,l=new x.CellCoords(e,t),u=0,c=0;X.runHooks("modifyTransformStart",l),o=X.countRows(),i=X.countCols(),s=X.getSettings().fixedRowsBottom,M.selRange.highlight.row+e>o-1?n&&M.settings.minSpareRows>0&&!(s&&M.selRange.highlight.row>=o-s-1)?(X.alter("insert_row",o),o=X.countRows()):M.settings.autoWrapCol&&(l.row=1-o,l.col=M.selRange.highlight.col+l.col==i-1?1-i:1):M.settings.autoWrapCol&&M.selRange.highlight.row+l.row<0&&M.selRange.highlight.col+l.col>=0&&(l.row=o-1,l.col=M.selRange.highlight.col+l.col==0?i-1:-1),M.selRange.highlight.col+l.col>i-1?n&&M.settings.minSpareCols>0?(X.alter("insert_col",i),i=X.countCols()):M.settings.autoWrapRow&&(l.row=M.selRange.highlight.row+l.row==o-1?1-o:1,l.col=1-i):M.settings.autoWrapRow&&M.selRange.highlight.col+l.col<0&&M.selRange.highlight.row+l.row>=0&&(l.row=M.selRange.highlight.row+l.row==0?o-1:-1,l.col=i-1),a=new x.CellCoords(M.selRange.highlight.row+l.row,M.selRange.highlight.col+l.col),a.row<0?(u=-1,a.row=0):a.row>0&&a.row>=o&&(u=1,a.row=o-1),a.col<0?(c=-1,a.col=0):a.col>0&&a.col>=i&&(c=1,a.col=i-1),X.runHooks("afterModifyTransformStart",a,u,c),$.setRangeStart(a,r)},transformEnd:function(e,t){var n,r,o,i=new x.CellCoords(e,t),a=0,s=0;X.runHooks("modifyTransformEnd",i),n=X.countRows(),r=X.countCols(),o=new x.CellCoords(M.selRange.to.row+i.row,M.selRange.to.col+i.col),o.row<0?(a=-1,o.row=0):o.row>0&&o.row>=n&&(a=1,o.row=n-1),o.col<0?(s=-1,o.col=0):o.col>0&&o.col>=r&&(s=1,o.col=r-1),X.runHooks("afterModifyTransformEnd",o,a,s),$.setRangeEnd(o,!0)},isSelected:function(){return null!==M.selRange},inInSelection:function(e){return!!$.isSelected()&&M.selRange.includes(e)},deselect:function(){$.isSelected()&&(X.selection.inProgress=!1,M.selRange=null,X.view.wt.selections.current.clear(),X.view.wt.selections.area.clear(),(M.settings.currentHeaderClassName||M.settings.currentRowClassName||M.settings.currentColClassName)&&X.view.wt.selections.highlight.clear(),G.destroyEditor(),$.refreshBorders(),(0,c.removeClass)(X.rootElement,["ht__selection--rows","ht__selection--columns"]),X.runHooks("afterDeselect"))},selectAll:function(){M.settings.multiSelect&&($.setSelectedHeaders(!0,!0,!0),$.setRangeStart(new x.CellCoords(0,0)),$.setRangeEnd(new x.CellCoords(X.countRows()-1,X.countCols()-1),!1))},empty:function(){if($.isSelected()){var e,t,n=M.selRange.getTopLeftCorner(),r=M.selRange.getBottomRightCorner(),o=[];for(e=n.row;e<=r.row;e++)for(t=n.col;t<=r.col;t++)X.getCellMeta(e,t).readOnly||o.push([e,t,""]);X.setDataAtCell(o)}}},this.init=function(){L.setData(M.settings.data),X.runHooks("beforeInit"),(0,p.isMobileBrowser)()&&(0,c.addClass)(X.rootElement,"mobile"),this.updateSettings(M.settings,!0),this.view=new N.default(this),G=new y.default(X,M,$,k),this.forceFullRender=!0,X.runHooks("init"),this.view.render(),"object"===s(M.firstRun)&&(X.runHooks("afterChange",M.firstRun[0],M.firstRun[1]),M.firstRun=!1),X.runHooks("afterInit")},this.validateCell=function(e,t,n,r){function o(e){var r=t.visualCol,o=t.visualRow,i=X.getCell(o,r,!0);i&&"TH"!=i.nodeName&&X.view.wt.wtSettings.settings.cellRenderer(o,r,i),n(e)}var i=X.getCellValidator(t);(0,d.isRegExp)(i)&&(i=function(e){return function(t,n){n(e.test(t))}}(i)),(0,h.isFunction)(i)?(e=X.runHooks("beforeValidate",e,t.visualRow,t.prop,r),X._registerTimeout(setTimeout(function(){i.call(t,e,function(n){n=X.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,o(n),X.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r)})},0))):X._registerTimeout(setTimeout(function(){t.valid=!0,o(t.valid)},0))},this.setDataAtCell=function(e,t,n,r){var o,a,u,c=g(e,t,n),f=[];for(o=0,a=c.length;o<a;o++){if("object"!==s(c[o]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof c[o][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=k.colToProp(c[o][1]),f.push([c[o][0],u,L.getAtCell(Q.toPhysicalRow(c[o][0]),c[o][1]),c[o][2]])}r||"object"!==(void 0===e?"undefined":s(e))||(r=t),X.runHooks("afterSetDataAtCell",f,r),i(f,r,function(){l(f,r)})},this.setDataAtRowProp=function(e,t,n,r){var o,a,u=g(e,t,n),c=[];for(o=0,a=u.length;o<a;o++)c.push([u[o][0],u[o][1],L.getAtCell(Q.toPhysicalRow(u[o][0]),u[o][1]),u[o][2]]);r||"object"!==(void 0===e?"undefined":s(e))||(r=t),X.runHooks("afterSetDataAtRowProp",c,r),i(c,r,function(){l(c,r)})},this.listen=function(){if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var e=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;document.activeElement&&document.activeElement!==document.body&&!e?document.activeElement.blur():e&&document.body.focus()}X&&!X.isListening()&&(Y=X.guid,X.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Y=null,X.runHooks("afterUnlisten"))},this.isListening=function(){return Y===X.guid},this.destroyEditor=function(e){$.refreshBorders(e)},this.populateFromArray=function(e,t,n,r,o,i,a,l,u){var c;if("object"!==(void 0===n?"undefined":s(n))||"object"!==s(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");return c="number"==typeof r?new x.CellCoords(r,o):null,j.populateFromArray(new x.CellCoords(e,t),n,c,i,a,l,u)},this.spliceCol=function(e,t,n){var r;return(r=k).spliceCol.apply(r,arguments)},this.spliceRow=function(e,t,n){var r;return(r=k).spliceRow.apply(r,arguments)},this.getSelected=function(){if($.isSelected())return[M.selRange.from.row,M.selRange.from.col,M.selRange.to.row,M.selRange.to.col]},this.getSelectedRange=function(){if($.isSelected())return M.selRange},this.render=function(){X.view&&(X.renderCall=!0,X.forceFullRender=!0,$.refreshBorders(null,!0))},this.loadData=function(e){if(X.dataType=Array.isArray(M.settings.dataSchema)?"array":(0,h.isFunction)(M.settings.dataSchema)?"function":"object",k&&k.destroy(),k=new v.default(X,M,K),"object"===(void 0===e?"undefined":s(e))&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+(void 0===e?"undefined":s(e))+" given)");e=[];var t,n=0,r=0,o=k.getSchema();for(n=0,r=M.settings.startRows;n<r;n++)if("object"!==X.dataType&&"function"!==X.dataType||!M.settings.dataSchema)if("array"===X.dataType)t=(0,C.deepClone)(o[0]),e.push(t);else{t=[];for(var i=0,a=M.settings.startCols;i<a;i++)t.push(null);e.push(t)}else t=(0,C.deepClone)(o),e.push(t)}M.isPopulated=!1,K.prototype.data=e,Array.isArray(e[0])&&(X.dataType="array"),k.dataSource=e,L.data=e,L.dataType=X.dataType,L.colToProp=k.colToProp.bind(k),L.propToCol=k.propToCol.bind(k),function(){M.cellSettings.length=0}(),j.adjustRowsAndCols(),X.runHooks("afterLoadData",M.firstRun),M.firstRun?M.firstRun=[null,"loadData"]:(X.runHooks("afterChange",null,"loadData"),X.render()),M.isPopulated=!0},this.getData=function(e,t,n,r){return(0,d.isUndefined)(e)?k.getAll():k.getRange(new x.CellCoords(e,t),new x.CellCoords(n,r),k.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return k.getCopyableText(new x.CellCoords(e,t),new x.CellCoords(n,r))},this.getCopyableData=function(e,t){return k.getCopyable(e,k.colToProp(t))},this.getSchema=function(){return k.getSchema()},this.updateSettings=function(e,t){var r=!1,o=void 0,i=void 0,a=void 0;if((0,d.isDefined)(e.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if((0,d.isDefined)(e.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(o in e)"data"!==o&&("language"!==o?H.default.getSingleton().getRegistered().indexOf(o)>-1?((0,h.isFunction)(e[o])||Array.isArray(e[o]))&&(e[o].initialHook=!0,X.addHook(o,e[o])):!t&&(0,C.hasOwnProperty)(e,o)&&(K.prototype[o]=e[o]):n(e.language));void 0===e.data&&void 0===M.settings.data?X.loadData(null):void 0!==e.data?X.loadData(e.data):void 0!==e.columns&&k.createMap(),a=X.countCols();var s=e.columns||K.prototype.columns;if(s&&(0,h.isFunction)(s)&&(a=X.countSourceCols(),r=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||(M.cellSettings.length=0),a>0){var l=void 0,u=void 0;for(o=0,i=0;o<a;o++)r&&!s(o)||(M.columnSettings[i]=(0,f.columnFactory)(K,M.columnsSettingConflicts),l=M.columnSettings[i].prototype,s&&(u=r?s(o):s[i])&&((0,C.extend)(l,u),(0,C.extend)(l,m(u))),i++)}if((0,d.isDefined)(e.cell))for(var p in e.cell)if((0,C.hasOwnProperty)(e.cell,p)){var g=e.cell[p];X.setCellMetaObject(g.row,g.col,g)}X.runHooks("afterCellMetaReset"),(0,d.isDefined)(e.className)&&(K.prototype.className&&(0,c.removeClass)(X.rootElement,K.prototype.className),e.className&&(0,c.addClass)(X.rootElement,e.className));var v=X.rootElement.style.height;""!==v&&(v=parseInt(X.rootElement.style.height,10));var y=e.height;if((0,h.isFunction)(y)&&(y=y()),t){X.rootElement.getAttribute("style")&&X.rootElement.setAttribute("data-initialstyle",X.rootElement.getAttribute("style"))}if(null===y){var w=X.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?X.rootElement.setAttribute("style",w):(X.rootElement.style.height="",X.rootElement.style.overflow="")}else void 0!==y&&(X.rootElement.style.height=y+"px",X.rootElement.style.overflow="hidden");if(void 0!==e.width){var b=e.width;(0,h.isFunction)(b)&&(b=b()),X.rootElement.style.width=b+"px"}t||(k.clearLengthCache(),X.view&&X.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),X.runHooks("afterUpdateSettings",e)),j.adjustRowsAndCols(),X.view&&!M.firstRun&&(X.forceFullRender=!0,$.refreshBorders(null,!0)),t||!X.view||""!==v&&""!==y&&void 0!==y||v===y||X.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=X.getSelected();if(K.prototype.getValue){if((0,h.isFunction)(K.prototype.getValue))return K.prototype.getValue.call(X);if(e)return X.getData()[e[0]][K.prototype.getValue]}else if(e)return X.getDataAtCell(e[0],e[1])},this.getSettings=function(){return M.settings},this.clear=function(){$.selectAll(),$.empty()},this.alter=function(e,t,n,r,o){j.alter(e,t,n,r,o)},this.getCell=function(e,t,n){return X.view.getCellAtCoords(new x.CellCoords(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return k.colToProp(e)},this.propToCol=function(e){return k.propToCol(e)},this.toVisualRow=function(e){return Q.toVisualRow(e)},this.toVisualColumn=function(e){return Q.toVisualColumn(e)},this.toPhysicalRow=function(e){return Q.toPhysicalRow(e)},this.toPhysicalColumn=function(e){return Q.toPhysicalColumn(e)},this.getDataAtCell=function(e,t){return k.get(e,k.colToProp(t))},this.getDataAtRowProp=function(e,t){return k.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,o(k.getRange(new x.CellCoords(0,e),new x.CellCoords(M.settings.data.length-1,e),k.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=[];return t=k.getRange(new x.CellCoords(0,k.propToCol(e)),new x.CellCoords(M.settings.data.length-1,k.propToCol(e)),k.DESTINATION_RENDERER),n.concat.apply(n,o(t))},this.getSourceData=function(e,t,n,r){return void 0===e?L.getData():L.getByRange(new x.CellCoords(e,t),new x.CellCoords(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?L.getData(!0):L.getByRange(new x.CellCoords(e,t),new x.CellCoords(n,r),!0)},this.getSourceDataAtCol=function(e){return L.getAtColumn(e)},this.getSourceDataAtRow=function(e){return L.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return L.getAtCell(e,t)},this.getDataAtRow=function(e){return k.getRange(new x.CellCoords(e,0),new x.CellCoords(e,this.countCols()-1),k.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var o=this,i=null,a=null;void 0===e&&(e=0,n=this.countRows(),t=0,r=this.countCols()),void 0===n&&(n=e),void 0===r&&(r=t);var s="mixed";return(0,R.rangeEach)(Math.min(e,n),Math.max(e,n),function(e){var n=!0;return(0,R.rangeEach)(Math.min(t,r),Math.max(t,r),function(t){var r=o.getCellMeta(e,t);return a=r.type,i?n=i===a:i=a,n}),s=n?a:"mixed",n}),s},this.removeCellMeta=function(e,t,n){var r=Q.toPhysical(e,t),o=a(r,2),i=o[0],s=o[1],l=M.cellSettings[i][s][n];!1!==X.runHooks("beforeRemoveCellMeta",e,t,n,l)&&(delete M.cellSettings[i][s][n],X.runHooks("afterRemoveCellMeta",e,t,n,l)),l=null},this.spliceCellsMeta=function(e,t){for(var n,r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];(n=M.cellSettings).splice.apply(n,[e,t].concat(o))},this.setCellMetaObject=function(e,t,n){if("object"===(void 0===n?"undefined":s(n)))for(var r in n)if((0,C.hasOwnProperty)(n,r)){var o=n[r];this.setCellMeta(e,t,r,o)}},this.setCellMeta=function(e,t,n,r){var o=Q.toPhysical(e,t),i=a(o,2),s=i[0],l=i[1];M.columnSettings[l]||(M.columnSettings[l]=(0,f.columnFactory)(K,M.columnsSettingConflicts)),M.cellSettings[s]||(M.cellSettings[s]=[]),M.cellSettings[s][l]||(M.cellSettings[s][l]=new M.columnSettings[l]),M.cellSettings[s][l][n]=r,X.runHooks("afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return(0,E.arrayFlatten)(M.cellSettings)},this.getCellMeta=function(e,t){var n=k.colToProp(t),r=void 0,o=Q.toPhysical(e,t),i=a(o,2),s=i[0],l=i[1];if(M.columnSettings[l]||(M.columnSettings[l]=(0,f.columnFactory)(K,M.columnsSettingConflicts)),M.cellSettings[s]||(M.cellSettings[s]=[]),M.cellSettings[s][l]||(M.cellSettings[s][l]=new M.columnSettings[l]),r=M.cellSettings[s][l],r.row=s,r.col=l,r.visualRow=e,r.visualCol=t,r.prop=n,r.instance=X,X.runHooks("beforeGetCellMeta",e,t,r),(0,C.extend)(r,m(r)),r.cells){var u=r.cells.call(r,s,l,n);u&&((0,C.extend)(r,u),(0,C.extend)(r,m(u)))}return X.runHooks("afterGetCellMeta",e,t,r),r},this.getCellMetaAtRow=function(e){return M.cellSettings[e]},this.isColumnModificationAllowed=function(){return!("object"===X.dataType||X.getSettings().columns)};var Z=(0,I.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(e,t){return(0,_.getRenderer)(Z.call(this,e,t))},this.getCellEditor=(0,I.cellMethodLookupFactory)("editor");var J=(0,I.cellMethodLookupFactory)("validator");this.getCellValidator=function(e,t){var n=J.call(this,e,t);return"string"==typeof n&&(n=(0,S.getValidator)(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var o=new r;e&&(o.onQueueEmpty=e);for(var i=X.countRows()-1;i>=0;)if(void 0===t||-1!==t.indexOf(i)){for(var a=X.countCols()-1;a>=0;)void 0===n||-1!==n.indexOf(a)?(o.addValidatorToQueue(),X.validateCell(X.getDataAtCell(i,a),X.getCellMeta(i,a),function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(o.valid=!1),o.removeValidatorFormQueue()},"validateCells"),a--):a--;i--}else i--;o.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=M.settings.rowHeaders;return void 0!==e&&(e=X.runHooks("modifyRowHeader",e)),void 0===e?(t=[],(0,R.rangeEach)(X.countRows()-1,function(e){t.push(X.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[e]?t=t[e]:(0,h.isFunction)(t)?t=t(e):t&&"string"!=typeof t&&"number"!=typeof t&&(t=e+1),t},this.hasRowHeaders=function(){return!!M.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==M.settings.colHeaders&&null!==M.settings.colHeaders)return!!M.settings.colHeaders;for(var e=0,t=X.countCols();e<t;e++)if(X.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=M.settings.columns&&(0,h.isFunction)(M.settings.columns),n=M.settings.colHeaders;if(void 0===(e=X.runHooks("modifyColHeader",e))){for(var r=[],o=t?X.countSourceCols():X.countCols(),i=0;i<o;i++)r.push(X.getColHeader(i));n=r}else{var a=e;e=X.runHooks("modifyCol",e);var s=function(e){for(var t=[],n=X.countSourceCols(),r=0;r<n;r++)(0,h.isFunction)(X.getSettings().columns)&&X.getSettings().columns(r)&&t.push(r);return t[e]}(e);M.settings.columns&&(0,h.isFunction)(M.settings.columns)&&M.settings.columns(s)&&M.settings.columns(s).title?n=M.settings.columns(s).title:M.settings.columns&&M.settings.columns[e]&&M.settings.columns[e].title?n=M.settings.columns[e].title:Array.isArray(M.settings.colHeaders)&&void 0!==M.settings.colHeaders[e]?n=M.settings.colHeaders[e]:(0,h.isFunction)(M.settings.colHeaders)?n=M.settings.colHeaders(e):M.settings.colHeaders&&"string"!=typeof M.settings.colHeaders&&"number"!=typeof M.settings.colHeaders&&(n=(0,I.spreadsheetColumnLabel)(a))}return n},this._getColWidthFromSettings=function(e){var t=X.getCellMeta(0,e),n=t.width;if(void 0!==n&&n!==M.settings.width||(n=t.colWidths),void 0!==n&&null!==n){switch(void 0===n?"undefined":s(n)){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var t=X._getColWidthFromSettings(e);return t=X.runHooks("modifyColWidth",t,e),void 0===t&&(t=x.ViewportColumnsCalculator.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=M.settings.rowHeights;if(void 0!==t&&null!==t){switch(void 0===t?"undefined":s(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=X._getRowHeightFromSettings(e);return t=X.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return X.runHooks("modifySourceLength")||(X.getSourceData()?X.getSourceData().length:0)},this.countSourceCols=function(){var e=X.getSourceData()&&X.getSourceData()[0]?X.getSourceData()[0]:[];return(0,C.isObject)(e)?(0,C.deepObjectSize)(e):e.length||0},this.countRows=function(){return k.getLength()},this.countCols=function(){var e=this.getSettings().maxCols,t=!1,n=0;if("array"===X.dataType&&(t=M.settings.data&&M.settings.data[0]&&M.settings.data[0].length),t&&(n=M.settings.data[0].length),M.settings.columns){if((0,h.isFunction)(M.settings.columns))if("array"===X.dataType){for(var r=0,o=0;o<n;o++)M.settings.columns(o)&&r++;n=r}else"object"!==X.dataType&&"function"!==X.dataType||(n=k.colToPropCache.length);else n=M.settings.columns.length}else"object"!==X.dataType&&"function"!==X.dataType||(n=k.colToPropCache.length);return Math.min(e,n)},this.rowOffset=function(){return X.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return X.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return X.view.wt.drawn?X.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return X.view.wt.drawn?X.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return X.view.wt.drawn?X.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return X.view.wt.drawn?X.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var t,n=X.countRows()-1,r=0;n>=0;){if(t=X.runHooks("modifyRow",n),X.isEmptyRow(t))r++;else if(e)break;n--}return r},this.countEmptyCols=function(e){if(X.countRows()<1)return 0;for(var t=X.countCols()-1,n=0;t>=0;){if(X.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return M.settings.isEmptyRow.call(X,e)},this.isEmptyCol=function(e){return M.settings.isEmptyCol.call(X,e)},this.selectCell=function(e,t,n,r,o,i){var a;if(i=(0,d.isUndefined)(i)||!0===i,"number"!=typeof e||e<0||e>=X.countRows())return!1;if("number"!=typeof t||t<0||t>=X.countCols())return!1;if((0,d.isDefined)(n)){if("number"!=typeof n||n<0||n>=X.countRows())return!1;if("number"!=typeof r||r<0||r>=X.countCols())return!1}return a=new x.CellCoords(e,t),M.selRange=new x.CellRange(a,a,a),i&&X.listen(),(0,d.isUndefined)(n)?$.setRangeEnd(M.selRange.from,o):$.setRangeEnd(new x.CellCoords(n,r),o),X.selection.finish(),!0},this.selectCellByProp=function(e,t,n,r,o){var i;return arguments[1]=k.propToCol(arguments[1]),(0,d.isDefined)(arguments[3])&&(arguments[3]=k.propToCol(arguments[3])),(i=X).selectCell.apply(i,arguments)},this.deselectCell=function(){$.deselect()},this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(void 0!==e&&(e<0||e>=X.countRows()))return!1;if(void 0!==t&&(t<0||t>=X.countCols()))return!1;var o=!1;return void 0!==e&&void 0!==t&&(X.view.wt.wtOverlays.topOverlay.scrollTo(e,n),X.view.wt.wtOverlays.leftOverlay.scrollTo(t,r),o=!0),"number"==typeof e&&"number"!=typeof t&&(X.view.wt.wtOverlays.topOverlay.scrollTo(e,n),o=!0),"number"==typeof t&&"number"!=typeof e&&(X.view.wt.wtOverlays.leftOverlay.scrollTo(t,r),o=!0),o},this.destroy=function(){if(X._clearTimeouts(),X.view&&X.view.destroy(),L&&L.destroy(),L=null,(0,P.isRootInstance)(X)){var e=document.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,c.empty)(X.rootElement),q.destroy(),X.runHooks("afterDestroy"),H.default.getSingleton().destroy(X);for(var t in X)(0,C.hasOwnProperty)(X,t)&&((0,h.isFunction)(X[t])?X[t]=w:"guid"!==t&&(X[t]=null));k&&k.destroy(),k=null,M=null,j=null,$=null,G=null,X=null,K=null},this.getActiveEditor=function(){return G.getActiveEditor()},this.getPlugin=function(e){return(0,O.getPlugin)(this,e)},this.getInstance=function(){return X},this.addHook=function(e,t){H.default.getSingleton().add(e,t,X)},this.hasHook=function(e){return H.default.getSingleton().has(e,X)},this.addHookOnce=function(e,t){H.default.getSingleton().once(e,t,X)},this.removeHook=function(e,t){H.default.getSingleton().remove(e,t,X)},this.runHooks=function(e,t,n,r,o,i,a){return H.default.getSingleton().run(X,e,t,n,r,o,i,a)},this.getTranslatedPhrase=function(e,t){return(0,B.getTranslatedPhrase)(M.settings.language,e,t)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++)clearTimeout(this.timeouts[e])},H.default.getSingleton().run(X,"construct")}t.__esModule=!0;var a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=i;var l=n(81),u=r(l),c=n(1),f=n(154),h=n(34),d=n(16),p=n(33),g=n(404),v=r(g),m=n(407),y=r(m),w=n(7),b=r(w),C=n(2),E=n(0),O=n(6),_=n(13),S=n(35),T=n(30),R=n(4),M=n(408),N=r(M),k=n(409),A=r(k),I=n(82),D=n(53),P=n(319),x=n(15),L=n(12),H=r(L),j=n(320),V=r(j),F=n(152),B=n(321),U=n(83),W=n(322),Y=null},function(e,t,n){"use strict";function r(e,t){function n(){}(0,o.inherit)(n,e);for(var r=0,i=t.length;r<i;r++)n.prototype[t[r]]=void 0;return n}t.__esModule=!0,t.columnFactory=r;var o=n(2)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(0);t.default=function(){function e(t){r(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return o(e,[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){if(null!=this.hot.getColHeader(0)){var t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),(0,a.arrayEach)(this.rows,function(t){e(t.row,(0,i.outerHeight)(t.table)-1)})}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),(0,a.arrayEach)(this.columns,function(t){e(t.col,(0,i.outerWidth)(t.table))})}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=document,n=t.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(t){(0,a.arrayEach)(t.strings,function(t){n.appendChild(e.createColElement(t.col))})}),n}},{key:"createRow",value:function(e){var t=this,n=document,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach(function(o){(0,a.arrayEach)(o.strings,function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var s=t.hot.getCellRenderer(a),l=n.createElement("td");s(t.hot,l,e,i,t.hot.colToProp(i),o.value,a),r.appendChild(l)})}),r}},{key:"createColumnHeadersRow",value:function(){var e=this,t=document,n=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var r=t.createElement("th");this.hot.view.appendColHeader(-1,r),n.appendChild(r)}return this.samples.forEach(function(r){(0,a.arrayEach)(r.strings,function(r){var o=r.col,i=t.createElement("th");e.hot.view.appendColHeader(o,i),n.appendChild(i)})}),n}},{key:"createCol",value:function(e){var t=this,n=document,r=n.createDocumentFragment();return this.samples.forEach(function(o){(0,a.arrayEach)(o.strings,function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var s=t.hot.getCellRenderer(a),l=n.createElement("td"),u=n.createElement("tr");s(t.hot,l,i,e,t.hot.colToProp(e),o.value,a),u.appendChild(l),r.appendChild(u)})}),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=document,n=t.createElement("col");return n.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(e)+"px",n}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),a=t.createElement("tbody"),s=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&a.appendChild(l),r.appendChild(a),(0,i.addClass)(r,e),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),r=t.createElement("div");return e="htGhostTable htAutoSize "+e.trim(),(0,i.addClass)(r,e),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),e}()},function(e,t,n){"use strict";function r(){return{name:o}}t.__esModule=!0,t.default=r;var o=t.KEY="---------"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(153),s=r(a),l=n(1),u=n(0),c=n(438),f=r(c),h=n(7),d=r(h),p=n(2),g=n(16),v=n(34),m=n(23),y=n(18),w=n(31),b=r(w),C=n(43),E=n(10),O=function(){function e(t,n){o(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new d.default(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return i(e,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return e.onDocumentMouseDown(t)})}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"setOffset",value:function(e){this.offset[e]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.container.removeAttribute("style"),this.container.style.display="block";var t=(0,v.debounce)(function(t){return e.openSubMenu(t)},300),n=(0,u.arrayFilter)(this.menuItems,function(t){return(0,m.isItemHidden)(t,e.hot)});n=(0,m.filterSeparators)(n,C.SEPARATOR);var r={data:n,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,n,r,o,i,a){return e.menuItemRenderer(t,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function(n,r,o){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return n[e].name===C.SEPARATOR?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new s.default(this.container,r),this.hotMenu.addHook("afterInit",function(){return e.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(t,n,r,o,i){return e.onAfterSelection(t,n,r,o,i)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!(0,m.hasSubMenu)(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;(0,u.arrayEach)(this.hotMenu.getData(),function(t,n){return e.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hotMenu.getSelected()){var t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);if(this.runLocalHooks("select",t,e),!1!==t.isCommand&&t.name!==C.SEPARATOR){var n=this.hot.getSelectedRange(),r=n?(0,m.normalizeSelection)(n):{},o=!0;(!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(this.hot)||t.submenu)&&(o=!1),this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e),o&&this.close(!0)}}}},{key:"setPosition",value:function(e){var t=new f.default(e);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=t+"px"}},{key:"setPositionBelowCursor",value:function(e){var t=this.offset.below+e.top;this.isSubMenu()&&(t=e.top-1),this.container.style.top=t+"px"}},{key:"setPositionOnRightOfCursor",value:function(e){var t=void 0;t=this.isSubMenu()?1+e.left+e.cellWidth:this.offset.right+1+e.left,this.container.style.left=t+"px"}},{key:"setPositionOnLeftOfCursor",value:function(e){this.container.style.left=this.offset.left+e.left-this.container.offsetWidth+(0,l.getScrollbarWidth)()+4+"px"}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);(0,m.isSeparator)(e)||(0,m.isDisabled)(e)||(0,m.isSelectionDisabled)(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);(0,m.isSeparator)(t)||(0,m.isDisabled)(t)||(0,m.isSelectionDisabled)(t)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)}},{key:"selectNextCell",value:function(e,t){var n=e+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;r&&((0,m.isSeparator)(r)||(0,m.isDisabled)(r)||(0,m.isSelectionDisabled)(r)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"selectPrevCell",value:function(e,t){var n=e-1,r=n>=0?this.hotMenu.getCell(n,t):null;r&&((0,m.isSeparator)(r)||(0,m.isDisabled)(r)||(0,m.isSelectionDisabled)(r)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"menuItemRenderer",value:function(e,t,n,r,o,i){var a=this,s=e.getSourceDataAtRow(n),u=document.createElement("div"),c=function(e){return e.disableSelection};"function"==typeof i&&(i=i.call(this.hot)),(0,l.empty)(t),(0,l.addClass)(u,"htItemWrapper"),t.appendChild(u),!function(e){return new RegExp(C.SEPARATOR,"i").test(e.name)}(s)?"function"==typeof s.renderer?((0,l.addClass)(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(e,u,n,r,o,i))):(0,l.fastInnerHTML)(u,i):(0,l.addClass)(t,"htSeparator"),!function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(a.hot)}(s)?c(s)?((0,l.addClass)(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})):!function(e){return(0,p.hasOwnProperty)(e,"submenu")}(s)?((0,l.removeClass)(t,"htSubmenu"),(0,l.removeClass)(t,"htDisabled"),c(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})):((0,l.addClass)(t,"htSubmenu"),c(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})):((0,l.addClass)(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()}))}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=void 0;return e?((0,v.isFunction)(e)&&(e=e.call(this.hot),e=null===e||(0,g.isUndefined)(e)?"":e.toString()),e=e.replace(/[^A-z0-9]/g,"_"),e=this.options.className+"Sub_"+e,t=document.querySelector("."+this.options.className+"."+e)):t=document.querySelector("."+this.options.className),t||(t=document.createElement("div"),(0,l.addClass)(t,"htMenu "+this.options.className),e&&(0,l.addClass)(t,e),document.getElementsByTagName("body")[0].appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(e){var t=this.hotMenu.getSelected(),n=!1;switch(this.keyEvent=!0,e.keyCode){case y.KEY_CODES.ESCAPE:this.close(),n=!0;break;case y.KEY_CODES.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?n=!0:(this.executeCommand(e),this.close(!0)));break;case y.KEY_CODES.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),n=!0;break;case y.KEY_CODES.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),n=!0;break;case y.KEY_CODES.ARROW_RIGHT:if(t){var r=this.openSubMenu(t[0]);r&&r.selectFirstCell()}n=!0;break;case y.KEY_CODES.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(e.preventDefault(),(0,E.stopImmediatePropagation)(e)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var e=this.hotMenu.getSettings().data,t=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,r=parseInt(t.width,10),o=(0,u.arrayReduce)(e,function(e,t){return e+(t.name===C.SEPARATOR?1:26)},0);n.width=r+22+"px",n.height=o+4+"px",t.height=n.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.container&&(0,l.isChildOf)(e.target,this.container)&&this.executeCommand(e),this.options.standalone&&this.hotMenu&&!(0,l.isChildOf)(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,l.isChildOf)(e.target,".htMenu")&&(0,l.isChildOf)(e.target,document)&&this.close(!0))}}]),e}();(0,p.mixin)(O,b.default),t.default=O},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var t=[];return V[e]||(e=H),(0,s.arrayEach)(V[e],function(e){var n=void 0;n=e===l.SEPARATOR?{name:l.SEPARATOR}:(0,a.clone)((0,u.getConditionDescriptor)(e)),t.push(n)}),t}t.__esModule=!0,t.TYPES=t.TYPE_DATE=t.TYPE_TEXT=t.TYPE_NUMERIC=t.OPERATION_OR_THEN_VARIABLE=t.OPERATION_OR=t.OPERATION_AND=t.CONDITION_FALSE=t.CONDITION_TRUE=t.CONDITION_BY_VALUE=t.CONDITION_YESTERDAY=t.CONDITION_TODAY=t.CONDITION_TOMORROW=t.CONDITION_DATE_AFTER=t.CONDITION_DATE_BEFORE=t.CONDITION_NOT_CONTAINS=t.CONDITION_CONTAINS=t.CONDITION_ENDS_WITH=t.CONDITION_BEGINS_WITH=t.CONDITION_NOT_BETWEEN=t.CONDITION_BETWEEN=t.CONDITION_LESS_THAN_OR_EQUAL=t.CONDITION_LESS_THAN=t.CONDITION_GREATER_THAN_OR_EQUAL=t.CONDITION_GREATER_THAN=t.CONDITION_NOT_EQUAL=t.CONDITION_EQUAL=t.CONDITION_NOT_EMPTY=t.CONDITION_EMPTY=t.CONDITION_NONE=void 0;var i;t.default=o;var a=n(2),s=n(0),l=n(43),u=n(9),c=n(493),f=n(329),h=n(494),d=n(330),p=n(495),g=n(496),v=n(497),m=n(498),y=n(499),w=n(331),b=n(500),C=n(501),E=n(502),O=n(334),_=n(503),S=n(333),T=n(332),R=n(504),M=n(505),N=n(506),k=n(507),A=n(508),I=n(509),D=n(159),P=n(335),x=n(336);t.CONDITION_NONE=c.CONDITION_NAME,t.CONDITION_EMPTY=f.CONDITION_NAME,t.CONDITION_NOT_EMPTY=h.CONDITION_NAME,t.CONDITION_EQUAL=d.CONDITION_NAME,t.CONDITION_NOT_EQUAL=p.CONDITION_NAME,t.CONDITION_GREATER_THAN=g.CONDITION_NAME,t.CONDITION_GREATER_THAN_OR_EQUAL=v.CONDITION_NAME,t.CONDITION_LESS_THAN=m.CONDITION_NAME,t.CONDITION_LESS_THAN_OR_EQUAL=y.CONDITION_NAME,t.CONDITION_BETWEEN=w.CONDITION_NAME,t.CONDITION_NOT_BETWEEN=b.CONDITION_NAME,t.CONDITION_BEGINS_WITH=C.CONDITION_NAME,t.CONDITION_ENDS_WITH=E.CONDITION_NAME,t.CONDITION_CONTAINS=O.CONDITION_NAME,t.CONDITION_NOT_CONTAINS=_.CONDITION_NAME,t.CONDITION_DATE_BEFORE=S.CONDITION_NAME,t.CONDITION_DATE_AFTER=T.CONDITION_NAME,t.CONDITION_TOMORROW=R.CONDITION_NAME,t.CONDITION_TODAY=M.CONDITION_NAME,t.CONDITION_YESTERDAY=N.CONDITION_NAME,t.CONDITION_BY_VALUE=k.CONDITION_NAME,t.CONDITION_TRUE=A.CONDITION_NAME,t.CONDITION_FALSE=I.CONDITION_NAME,t.OPERATION_AND=D.OPERATION_ID,t.OPERATION_OR=P.OPERATION_ID,t.OPERATION_OR_THEN_VARIABLE=x.OPERATION_ID;var L=t.TYPE_NUMERIC="numeric",H=t.TYPE_TEXT="text",j=t.TYPE_DATE="date",V=t.TYPES=(i={},r(i,L,[c.CONDITION_NAME,l.SEPARATOR,f.CONDITION_NAME,h.CONDITION_NAME,l.SEPARATOR,d.CONDITION_NAME,p.CONDITION_NAME,l.SEPARATOR,g.CONDITION_NAME,v.CONDITION_NAME,m.CONDITION_NAME,y.CONDITION_NAME,w.CONDITION_NAME,b.CONDITION_NAME]),r(i,H,[c.CONDITION_NAME,l.SEPARATOR,f.CONDITION_NAME,h.CONDITION_NAME,l.SEPARATOR,d.CONDITION_NAME,p.CONDITION_NAME,l.SEPARATOR,C.CONDITION_NAME,E.CONDITION_NAME,l.SEPARATOR,O.CONDITION_NAME,_.CONDITION_NAME]),r(i,j,[c.CONDITION_NAME,l.SEPARATOR,f.CONDITION_NAME,h.CONDITION_NAME,l.SEPARATOR,d.CONDITION_NAME,p.CONDITION_NAME,l.SEPARATOR,S.CONDITION_NAME,T.CONDITION_NAME,w.CONDITION_NAME,l.SEPARATOR,R.CONDITION_NAME,M.CONDITION_NAME,N.CONDITION_NAME]),i)},function(e,t,n){"use strict";function r(e,t){return e.every(function(e){return e.func(t)})}t.__esModule=!0,t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0,t.operationResult=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);(0,n(64).registerOperation)(t.OPERATION_ID="conjunction",t.SHORT_NAME_FOR_COMPONENT=i.FILTERS_LABELS_CONJUNCTION,r)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=n(2),c=n(3),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),h=n(65),d=function(e){return e&&e.__esModule?e:{default:e}}(h),p=new WeakMap;t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,(0,u.extend)(t.DEFAULTS,n)));return p.set(i,{}),i.registerHooks(),i}return i(t,e),s(t,null,[{key:"DEFAULTS",get:function(){return(0,u.clone)({placeholder:"",type:"text",tagName:"input"})}}]),s(t,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)}),this.addLocalHook("keyup",function(t){return e.onKeyup(t)})}},{key:"build",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var e=p.get(this),n=document.createElement("div");e.input=this._element.firstChild,(0,l.addClass)(this._element,"htUIInput"),(0,l.addClass)(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=p.get(this).input;e.type=this.options.type,e.placeholder=this.hot.getTranslatedPhrase(this.options.placeholder),e.value="string"==typeof this.options.value&&this.options.value.startsWith(f.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(this.options.value):this.options.value}}},{key:"focus",value:function(){this.isBuilt()&&p.get(this).input.focus()}},{key:"onClick",value:function(e){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}]),t}(d.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.default=function e(t,n){r(this,e),this.hot=n,this.plugin=t}},function(e,t,n){"use strict";var r=n(22).f,o=n(88),i=n(70),a=n(39),s=n(72),l=n(73),u=n(171),c=n(173),f=n(174),h=n(24),d=n(41).fastKey,p=n(49),g=h?"_s":"size",v=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var c=e(function(e,r){s(e,c,t,"_i"),e._t=t,e._i=o(null),e._f=void 0,e._l=void 0,e[g]=0,void 0!=r&&l(r,n,e[u],e)});return i(c.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var n=p(this,t),r=v(n,e);if(r){var o=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=o),o&&(o.p=i),n._f==r&&(n._f=o),n._l==r&&(n._l=i),n[g]--}return!!r},forEach:function(e){p(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(p(this,t),e)}}),h&&r(c.prototype,"size",{get:function(){return p(this,t)[g]}}),c},def:function(e,t,n){var r,o,i=v(e,t);return i?i.v=n:(e._l=i={i:o=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=i),r&&(r.n=i),e[g]++,"F"!==o&&(e._i[o]=i)),e},getEntry:v,setStrong:function(e,t,n){u(e,t,function(e,n){this._t=p(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?c(0,n.k):"values"==t?c(0,n.v):c(0,[n.k,n.v]):(e._t=void 0,c(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){e.exports=!n(24)&&!n(25)(function(){return 7!=Object.defineProperty(n(86)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(32),o=n(26),i=n(165)(!1),a=n(90)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~i(u,n)||u.push(n));return u}},function(e,t,n){var r=n(26),o=n(27),i=n(69);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=o(l.length),c=i(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(17).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(20);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(57),o=n(14)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(170),o=n(14)("iterator"),i=n(57);e.exports=n(48).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(47),o=n(14)("toStringTag"),i="Arguments"==r(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=a(t=Object(e),o))?n:i?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";var r=n(74),o=n(5),i=n(37),a=n(38),s=n(32),l=n(57),u=n(345),c=n(58),f=n(172),h=n(14)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,g,v,m,y){u(n,t,g);var w,b,C,E=function(e){if(!d&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},O=t+" Iterator",_="values"==v,S=!1,T=e.prototype,R=T[h]||T["@@iterator"]||v&&T[v],M=R||E(v),N=v?_?E("entries"):M:void 0,k="Array"==t?T.entries||R:R;if(k&&(C=f(k.call(new e)))!==Object.prototype&&C.next&&(c(C,O,!0),r||s(C,h)||a(C,h,p)),_&&R&&"values"!==R.name&&(S=!0,M=function(){return R.call(this)}),r&&!y||!d&&!S&&T[h]||a(T,h,M),l[t]=M,l[O]=p,v)if(w={values:_?M:E("values"),keys:m?M:E("keys"),entries:N},y)for(b in w)b in T||i(T,b,w[b]);else o(o.P+o.F*(d||S),t,w);return w}},function(e,t,n){var r=n(32),o=n(40),i=n(90)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(17),o=n(22),i=n(24),a=n(14)("species");e.exports=function(e){var t=r[e];i&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(11),o=n(20),i=function(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(39)(Function.call,n(76).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t,n){var r=n(47);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(45),o=n(78),i=n(59),a=n(40),s=n(89),l=Object.assign;e.exports=!l||n(25)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var n=a(e),l=arguments.length,u=1,c=o.f,f=i.f;l>u;)for(var h,d=s(arguments[u++]),p=c?r(d).concat(c(d)):r(d),g=p.length,v=0;g>v;)f.call(d,h=p[v++])&&(n[h]=d[h]);return n}:l},function(e,t,n){"use strict";var r=n(70),o=n(41).getWeak,i=n(20),a=n(11),s=n(72),l=n(73),u=n(77),c=n(32),f=n(49),h=u(5),d=u(6),p=0,g=function(e){return e._l||(e._l=new v)},v=function(){this.a=[]},m=function(e,t){return h(e.a,function(e){return e[0]===t})};v.prototype={get:function(e){var t=m(this,e);if(t)return t[1]},has:function(e){return!!m(this,e)},set:function(e,t){var n=m(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,i){var u=e(function(e,r){s(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,void 0!=r&&l(r,n,e[i],e)});return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=o(e);return!0===n?g(f(this,t)).delete(e):n&&c(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=o(e);return!0===n?g(f(this,t)).has(e):n&&c(n,this._i)}}),u},def:function(e,t,n){var r=o(i(t),!0);return!0===r?g(e).set(t,n):r[e._i]=n,e},ufstore:g}},function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=o(t),this.reject=o(n)}var o=n(71);e.exports.f=function(e){return new r(e)}},function(e,t,n){t.f=n(14)},function(e,t,n){var r=n(26),o=n(100).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(e){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==i.call(e)?s(e):o(r(e))}},function(e,t,n){"use strict";var r=n(68),o=n(46);e.exports=function(e){var t=String(o(this)),n="",i=r(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},function(e,t,n){var r=n(11),o=n(47),i=n(14)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},function(e,t,n){var r=n(11),o=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&o(e)===e}},function(e,t,n){var r=n(45),o=n(26),i=n(59).f;e.exports=function(e){return function(t){for(var n,a=o(t),s=r(a),l=s.length,u=0,c=[];l>u;)i.call(a,n=s[u++])&&c.push(e?[n,a[n]]:a[n]);return c}}},function(e,t,n){var r=n(27),o=n(182),i=n(46);e.exports=function(e,t,n,a){var s=String(i(e)),l=s.length,u=void 0===n?" ":String(n),c=r(t);if(c<=l||""==u)return s;var f=c-l,h=o.call(u,Math.ceil(f/u.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new WeakMap;t.default=function(){function e(t,n,o,a,s,l,u){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(e){return e};r(this,e),i.set(this,{viewportWidth:t,scrollOffset:n,totalColumns:o,columnWidthFn:a,overrideFn:s,onlyFullyVisible:l,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return o(e,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),o(e,[{key:"calculate",value:function(){for(var e=0,t=!0,n=[],r=void 0,o=i.get(this),a=o.onlyFullyVisible,s=o.overrideFn,l=o.scrollOffset,u=o.totalColumns,c=o.viewportWidth,f=0;f<u;f++){r=this._getColumnWidth(f),e<=l&&!a&&(this.startColumn=f);var h=l>0?c+1:c;if(e>=l&&e+r<=l+h&&(null==this.startColumn&&(this.startColumn=f),this.endColumn=f),n.push(e),e+=r,a||(this.endColumn=f),e>=l+c){t=!1;break}}if(this.endColumn===u-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){var d=n[this.endColumn]+r-n[this.startColumn-1];if((d<=c||!a)&&this.startColumn--,d>c)break}null!==this.startColumn&&s&&s(this),this.startPosition=n[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){this.totalTargetWidth=e;for(var t=i.get(this),n=t.totalColumns,r=0,o=0;o<n;o++){var a=this._getColumnWidth(o),s=t.stretchingColumnWidthFn(void 0,o);"number"==typeof s?e-=s:r+=a}var l=e-r;if("all"===this.stretch&&l>0)this.stretchAllRatio=e/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(n-1),c=l+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=i.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var a=Math.round(t*this.stretchAllRatio),s=r.stretchingColumnWidthFn(a,e);this.stretchAllColumnsWidth[e]=void 0===s?a:isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===i.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=i.get(this).columnWidthFn(t);return void 0===n&&(n=e.DEFAULT_WIDTH),n}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new WeakMap;t.default=function(){function e(t,n,o,a,s,l,u){r(this,e),i.set(this,{viewportHeight:t,scrollOffset:n,totalRows:o,rowHeightFn:a,overrideFn:s,onlyFullyVisible:l,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return o(e,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),o(e,[{key:"calculate",value:function(){for(var t=0,n=!0,r=[],o=i.get(this),a=o.onlyFullyVisible,s=o.overrideFn,l=o.rowHeightFn,u=o.scrollOffset,c=o.totalRows,f=o.viewportHeight,h=o.horizontalScrollbarHeight||0,d=void 0,p=0;p<c;p++)if(d=l(p),void 0===d&&(d=e.DEFAULT_HEIGHT),t<=u&&!a&&(this.startRow=p),t>=u&&t+d<=u+f-h&&(null===this.startRow&&(this.startRow=p),this.endRow=p),r.push(t),t+=d,a||(this.endRow=p),t>=u+f-h){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var g=r[this.endRow]+d-r[this.startRow-1];if((g<=f-h||!a)&&this.startRow--,g>=f-h)break}null!==this.startRow&&s&&s(this),this.startPosition=r[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(){function e(t,n,o){r(this,e),this.offset=t,this.total=n,this.countTH=o}return o(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(){function e(t,n,o){r(this,e),this.offset=t,this.total=n,this.countTH=o}return o(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(2),l=n(30),u=n(307),c=r(u),f=n(308),h=r(f),d=n(309),p=r(d),g=n(310),v=r(g),m=n(311),y=r(m),w=n(313),b=r(w);t.default=function(){function e(t){o(this,e);var n=[];if(this.guid="wt_"+(0,l.randomString)(),t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new y.default(this,t.table,t.wtRootElement),this.wtScroll=new p.default(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new c.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new v.default(this,t),this.wtTable=new y.default(this,t.table),this.wtScroll=new p.default(this),this.wtViewport=new b.default(this),this.wtEvent=new c.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new h.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;r<i;r++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){(0,a.fastInnerText)(t,n[e])}])}this.drawn=!1,this.drawInterrupted=!1}return i(e,[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||(0,a.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);var t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<n&&e.col<o)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=t-r){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollVertical",value:function(e){return this.wtOverlays.topOverlay.scrollTo(e),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(e){return this.wtOverlays.leftOverlay.scrollTo(e),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(e){return this.wtScroll.scrollViewport(e),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(e){return!!this.cloneOverlay&&this.cloneOverlay.type===e}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t={rowHeaders:["array"],columnHeaders:["array"]},n=[],r=[];(0,s.objectEach)(t,function(t,o){t.indexOf("array")>-1&&e.getSetting(o).length&&r.push("ht"+(0,l.toUpperCaseFirst)(o)),n.push("ht"+(0,l.toUpperCaseFirst)(o))}),(0,a.removeClass)(this.wtTable.wtRootElement.parentNode,n),(0,a.addClass)(this.wtTable.wtRootElement.parentNode,r)}},{key:"getSetting",value:function(e,t,n,r,o){return this.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),e}()},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){var t=this,n=new l.default(e);this.instance=e;var r=[null,null];this.dblClickTimeout=[null,null];var s=function(e){var n=document.activeElement,a=(0,i.partial)(o.getParent,e.realTarget),s=e.realTarget;if(s!==n&&a(0)!==n&&a(1)!==n){var l=t.parentCell(s);(0,o.hasClass)(s,"corner")?t.instance.getSetting("onCellCornerMouseDown",e,s):l.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",e,l.coords,l.TD,t.instance),2!==e.button&&l.TD&&(r[0]=l.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))}},u=function(e){t.instance.touchMoving=!0},c=function(e){n.addEventListener(this,"touchmove",u),t.checkIfTouchMove=setTimeout(function(){!0===t.instance.touchMoving&&(t.instance.touchMoving=void 0,n.removeEventListener("touchmove",u,!1)),s(e)},30)},f=function(e){var n,r,i;t.instance.hasSetting("onCellMouseOver")&&(n=t.instance.wtTable.TABLE,r=(0,o.closestDown)(e.realTarget,["TD","TH"],n),i=t.instance.cloneSource||t.instance,r&&r!==i.lastMouseOver&&(0,o.isChildOf)(r,n)&&(i.lastMouseOver=r,t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(r),r,t.instance)))},h=function(e){var n=void 0,r=void 0,i=void 0;t.instance.hasSetting("onCellMouseOut")&&(n=t.instance.wtTable.TABLE,r=(0,o.closestDown)(e.realTarget,["TD","TH"],n),i=(0,o.closestDown)(e.relatedTarget,["TD","TH"],n),r&&r!==i&&(0,o.isChildOf)(r,n)&&t.instance.getSetting("onCellMouseOut",e,t.instance.wtTable.getCoords(r),r,t.instance))},d=function(e){if(2!==e.button){var n=t.parentCell(e.realTarget);n.TD===r[0]&&n.TD===r[1]?((0,o.hasClass)(e.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,t.instance):t.instance.getSetting("onCellDblClick",e,n.coords,n.TD,t.instance),r[0]=null,r[1]=null):n.TD===r[0]?(t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance),r[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500)):n.TD&&t.instance.hasSetting("onCellMouseUp")&&t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance)}},p=function(e){clearTimeout(void 0),e.preventDefault(),d(e)};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",s),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",f),n.addEventListener(this.instance.wtTable.TABLE,"mouseout",h),n.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&(0,a.isMobileBrowser)()&&!t.instance.wtTable.isWorkingOnClone()){var g="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){t.instance.touchApplied=!0,(0,o.isChildOf)(e.target,g)&&c.call(e.target,e)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(e){t.instance.touchApplied=!1,(0,o.isChildOf)(e.target,g)&&p.call(e.target,e)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==t.instance.getSetting("stretchH")&&t.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}t.__esModule=!0;var o=n(1),i=n(34),a=n(33),s=n(7),l=function(e){return e&&e.__esModule?e:{default:e}}(s);r.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,r=(0,o.closestDown)(e,["TD","TH"],n);return r?(t.coords=this.instance.wtTable.getCoords(r),t.TD=r):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(0),l=n(18),u=n(33),c=n(7),f=r(c),h=n(29),d=r(h);t.default=function(){function e(t){o(this,e),this.wot=t,this.instance=this.wot,this.eventManager=new f.default(this.wot),this.wot.update("scrollbarWidth",(0,a.getScrollbarWidth)()),this.wot.update("scrollbarHeight",(0,a.getScrollbarWidth)()),this.scrollableElement=(0,a.getScrollableElement)(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()}return i(e,[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=d.default.createOverlay(d.default.CLONE_TOP,this.wot),d.default.hasOverlay(d.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),d.default.hasOverlay(d.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=d.default.createOverlay(d.default.CLONE_BOTTOM,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=d.default.createOverlay(d.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=d.default.createOverlay(d.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=d.default.createOverlay(d.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=d.default.createOverlay(d.default.CLONE_DEBUG,this.wot)),e}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var e=this,t=this.topOverlay.mainTableScrollableElement,n=this.leftOverlay.mainTableScrollableElement,r=[];for(r.push([document.documentElement,"keydown",function(t){return e.onKeyDown(t)}]),r.push([document.documentElement,"keyup",function(){return e.onKeyUp()}]),r.push([document,"visibilitychange",function(){return e.onKeyUp()}]),r.push([t,"scroll",function(t){return e.onTableScroll(t)}]),t!==n&&r.push([n,"scroll",function(t){return e.onTableScroll(t)}]),this.topOverlay.needFullRender&&(r.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.bottomOverlay.needFullRender&&(r.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.leftOverlay.needFullRender&&(r.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&r.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&r.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&r.push([window,"wheel",function(t){var n=void 0,r=t.wheelDeltaY||t.deltaY,o=t.wheelDeltaX||t.deltaX;e.topOverlay.clone.wtTable.holder.contains(t.realTarget)?n="top":e.bottomOverlay.clone&&e.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?n="bottom":e.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?n="left":e.topLeftCornerOverlay&&e.topLeftCornerOverlay.clone&&e.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?n="topLeft":e.bottomLeftCornerOverlay&&e.bottomLeftCornerOverlay.clone&&e.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(n="bottomLeft"),("top"==n&&0!==r||"left"==n&&0!==o||"bottom"==n&&0!==r||("topLeft"===n||"bottomLeft"===n)&&(0!==r||0!==o))&&t.preventDefault()}]);r.length;){var o=r.pop();this.eventManager.addEventListener(o[0],o[1],o[2]),this.registeredListeners.push(o)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var e=this.registeredListeners.pop();this.eventManager.removeEventListener(e[0],e[1],e[2])}}},{key:"onTableScroll",value:function(e){if(!(0,u.isMobileBrowser)()){var t=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(n!==window&&r!==window&&!e.target.contains(n)||t!==window&&r!==window&&!e.target.contains(t))||("scroll"===e.type?this.syncScrollPositions(e):this.translateMouseWheelToScroll(e))}}},{key:"onKeyDown",value:function(e){this.keyPressed=(0,l.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.topOverlay.clone.wtTable.holder,n=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,r=this.leftOverlay.clone.wtTable.holder,o=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,i=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,a=e.wheelDeltaY||-1*e.deltaY,s=e.wheelDeltaX||-1*e.deltaX,l=null,u={type:"wheel"},c=e.target,f=null;for(1===e.deltaMode&&(a*=120,s*=120);c!=document&&null!=c;){if(c.className.indexOf("wtHolder")>-1){l=c;break}c=c.parentNode}return u.target=l,l===o||l===i?(this.syncScrollPositions(u,-.2*s,"x"),this.syncScrollPositions(u,-.2*a,"y")):(l===t||l===n?f=a:l===r&&(f=s),this.syncScrollPositions(u,-.2*f)),!1}},{key:"syncScrollPositions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var r=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,s=0,l=!1,u=void 0,c=void 0,f=void 0,h=void 0,d=void 0,p=!1,g=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(u=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(d=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(c=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(f=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(h=this.bottomLeftCornerOverlay.clone.wtTable.holder),i===document&&(i=window),i===r||i===o?(s=(0,a.getScrollLeft)(g?this.scrollableElement:i),this.horizontalScrolling=this.overlayScrollPositions.master.left!==s,this.overlayScrollPositions.master.left=s,l=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(u&&u.scrollLeft!==s&&(null==t&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=r!==window),d&&d.scrollLeft!==s&&(null==t&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=s,p=r!==window)),s=(0,a.getScrollTop)(i),this.verticalScrolling=this.overlayScrollPositions.master.top!==s,this.overlayScrollPositions.master.top=s,l=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:c&&c.scrollTop!==s&&(null==t&&this.pendingScrollCallbacks.left.top++,c.scrollTop=s,p=o!==window)):i===d?(s=(0,a.getScrollLeft)(i),this.overlayScrollPositions.bottom.left=s,l=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==t&&this.pendingScrollCallbacks.master.left++,r.scrollLeft=s,u&&u.scrollLeft!==s&&(null==t&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=s,p=o!==window)),null!==t&&(l=!0,o.scrollTop+=t)):i===u?(s=(0,a.getScrollLeft)(i),this.overlayScrollPositions.top.left=s,l=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==t&&this.pendingScrollCallbacks.master.left++,r.scrollLeft=s),null!==t&&(l=!0,o.scrollTop+=t),d&&d.scrollLeft!==s&&(null==t&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=s,p=o!==window)):i===c?(s=(0,a.getScrollTop)(i),this.overlayScrollPositions.left.top!==s&&(this.overlayScrollPositions.left.top=s,l=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==t&&this.pendingScrollCallbacks.master.top++,o.scrollTop=s)),null!==t&&(l=!0,o.scrollLeft+=t)):i!==f&&i!==h||null!==t&&(l=!0,"x"===n?o.scrollLeft+=t:"y"===n&&(o.scrollTop+=t)),!this.keyPressed&&l&&"scroll"===e.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),p&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=(0,a.getScrollableElement)(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e),this.debug&&this.debug.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),r=this.wot.wtViewport.getRowHeaderWidth(),o=this.wot.wtViewport.getColumnHeaderHeight(),i=this.wot.wtTable.hider.style;i.width=r+this.leftOverlay.sumCellSizes(0,t)+"px",i.height=o+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return(0,s.arrayEach)(t,function(t,r){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(4);t.default=function(){function e(t){r(this,e),this.wot=t,this.instance=t}return o(e,[{key:"scrollViewport",value:function(e){if(this.wot.drawn){var t=this._getVariables(),n=t.topOverlay,r=t.leftOverlay,o=t.totalRows,i=t.totalColumns,a=t.fixedRowsTop,s=t.fixedRowsBottom,l=t.fixedColumnsLeft;if(e.row<0||e.row>Math.max(o-1,0))throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>Math.max(i-1,0))throw new Error("column "+e.col+" does not exist");e.row>=a&&e.row<this.getFirstVisibleRow()?n.scrollTo(e.row):e.row>this.getLastVisibleRow()&&e.row<o-s&&n.scrollTo(e.row,!0),e.col>=l&&e.col<this.getFirstVisibleColumn()?r.scrollTo(e.col):e.col>this.getLastVisibleColumn()&&r.scrollTo(e.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,s=e.fixedRowsTop,l=n.getFirstVisibleRow();if(t.mainTableScrollableElement===window){var u=(0,i.offset)(n.wtRootElement),c=(0,i.innerHeight)(n.hider),f=(0,i.innerHeight)(window),h=(0,i.getScrollTop)(window);if(u.top+c-f<=h){var d=r.getColumnHeaderHeight();d+=t.sumCellSizes(0,s),(0,a.rangeEachReverse)(o,1,function(e){if(d+=t.sumCellSizes(e-1,e),u.top+c-d<=h)return l=e,!1})}}return l}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,s=n.getLastVisibleRow();if(t.mainTableScrollableElement===window){var l=(0,i.offset)(n.wtRootElement),u=(0,i.innerHeight)(window),c=(0,i.getScrollTop)(window);if(l.top>c){var f=r.getColumnHeaderHeight();(0,a.rangeEach)(1,o,function(e){if(f+=t.sumCellSizes(e-1,e),l.top+f-c>=u)return s=e-2,!1})}}return s}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,s=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===window){var l=(0,i.offset)(n.wtRootElement),u=(0,i.innerWidth)(n.hider),c=(0,i.innerWidth)(window),f=(0,i.getScrollLeft)(window);if(l.left+u-c<=f){var h=r.getRowHeaderWidth();(0,a.rangeEachReverse)(o,1,function(e){if(h+=t.sumCellSizes(e-1,e),l.left+u-h<=f)return s=e,!1})}}return s}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,s=n.getLastVisibleColumn();if(t.mainTableScrollableElement===window){var l=(0,i.offset)(n.wtRootElement),u=(0,i.innerWidth)(window),c=(0,i.getScrollLeft)(window);if(l.left>c){var f=r.getRowHeaderWidth();(0,a.rangeEach)(1,o,function(e){if(f+=t.sumCellSizes(e-1,e),l.left+f-c>=u)return s=e-2,!1})}}return s}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(2);t.default=function(){function e(t,n){var o=this;r(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var r=o.getSetting("data",e,t);(0,i.fastInnerText)(n,void 0===r||null===r?"":r)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var s in this.defaults)if((0,a.hasOwnProperty)(this.defaults,s))if(void 0!==n[s])this.settings[s]=n[s];else{if(void 0===this.defaults[s])throw new Error('A required setting "'+s+'" was not provided');this.settings[s]=this.defaults[s]}}return o(e,[{key:"update",value:function(e,t){if(void 0===t)for(var n in e)(0,a.hasOwnProperty)(e,n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.wot}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=n(34),c=n(60),f=r(c),h=n(151),d=(r(h),n(189)),p=r(d),g=n(190),v=r(g),m=n(312),y=r(m),w=n(29),b=r(w);t.default=function(){function e(t,n){var r=this;i(this,e),this.wot=t,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,(0,l.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(o)}}return s(e,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,l.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}},{key:"createHider",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,l.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),n}},{key:"createHolder",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,l.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isWorkingOnClone()||(n.parentNode.className+="ht_master handsontable"),n.appendChild(e)),n}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=(0,l.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",e===window){var t=this.wot.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=(0,l.getStyle)(e,"width"),this.holder.style.height=(0,l.getStyle)(e,"height"),this.holder.style.overflow=""}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(e){var t=this.wot,n=t.wtOverlays,r=t.wtViewport,o=this.instance.getSetting("totalRows"),i=this.wot.getSetting("rowHeaders").length,a=this.wot.getSetting("columnHeaders").length,s=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=(0,l.offset)(this.holder),e=r.createRenderCalculators(e),i&&!this.wot.getSetting("fixedColumnsLeft"))){var u=n.leftOverlay.getScrollPosition(),c=this.correctHeaderWidth;this.correctHeaderWidth=u>0,c!==this.correctHeaderWidth&&(e=!1)}if(this.isWorkingOnClone()||(s=n.prepareOverlays()),e)this.isWorkingOnClone()||r.createVisibleCalculators(),n&&n.refresh(!0);else{this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:(0,l.offset)(this.TABLE);var f=void 0;f=b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_DEBUG)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP_LEFT_CORNER)?0:b.default.isOverlayTypeOf(this.instance.cloneOverlay,b.default.CLONE_BOTTOM)||b.default.isOverlayTypeOf(this.instance.cloneOverlay,b.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(o-this.wot.getSetting("fixedRowsBottom"),0):r.rowsRenderCalculator.startRow;var h=void 0;h=b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_DEBUG)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_LEFT)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP_LEFT_CORNER)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_BOTTOM_LEFT_CORNER)?0:r.columnsRenderCalculator.startColumn,this.rowFilter=new v.default(f,o,a),this.columnFilter=new p.default(h,this.wot.getSetting("totalColumns"),i),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),s&&n.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){new y.default(this).render()}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,r=t.length;n<r;n++)(0,l.removeClass)(t[n],e)}},{key:"refreshSelections",value:function(e){if(this.wot.selections){var t=this.wot.selections.length;if(e)for(var n=0;n<t;n++)this.wot.selections[n].settings.className&&this.removeClassFromCells(this.wot.selections[n].settings.className),this.wot.selections[n].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightHeaderClassName),this.wot.selections[n].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightRowClassName),this.wot.selections[n].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightColumnClassName);for(var r=0;r<t;r++)this.wot.selections[r].draw(this.wot,e)}}},{key:"getCell",value:function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getRowHeader",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0}},{key:"getCoords",value:function(e){if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,l.closest)(e,["TD","TH"])),null===e)return null;var t=e.parentNode,n=t.parentNode,r=(0,l.index)(t),o=e.cellIndex;return(0,l.overlayContainsElement)(b.default.CLONE_TOP_LEFT_CORNER,e)||(0,l.overlayContainsElement)(b.default.CLONE_TOP,e)?"THEAD"===n.nodeName&&(r-=n.childNodes.length):r=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r),o=(0,l.overlayContainsElement)(b.default.CLONE_TOP_LEFT_CORNER,e)||(0,l.overlayContainsElement)(b.default.CLONE_LEFT,e)?this.columnFilter.offsettedTH(o):this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),new f.default(r,o)}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)<0&&e>=0}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var e=this.wot.wtViewport.columnsRenderCalculator.count,t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(b.default.CLONE_DEBUG))e=t;else if(this.wot.isOverlayName(b.default.CLONE_LEFT)||this.wot.isOverlayName(b.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(b.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),t);return e}},{key:"getRenderedRowsCount",value:function(){var e=this.wot.wtViewport.rowsRenderCalculator.count,t=this.wot.getSetting("totalRows");return this.wot.isOverlayName(b.default.CLONE_DEBUG)?e=t:this.wot.isOverlayName(b.default.CLONE_TOP)||this.wot.isOverlayName(b.default.CLONE_TOP_LEFT_CORNER)?e=Math.min(this.wot.getSetting("fixedRowsTop"),t):(this.wot.isOverlayName(b.default.CLONE_BOTTOM)||this.wot.isOverlayName(b.default.CLONE_BOTTOM_LEFT_CORNER))&&(e=Math.min(this.wot.getSetting("fixedRowsBottom"),t)),e}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}},{key:"getColumnHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===(void 0===t?"undefined":a(t))&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getColumnWidth(e),n=null==t?this.instance.wtSettings.settings.defaultColumnWidth:t,r=this.wot.wtViewport.columnsRenderCalculator;if(r){var o=r.getStretchedColumnWidth(e,n);o&&(n=o)}return n}},{key:"_modifyRowHeaderWidth",value:function(e){var t=(0,u.isFunction)(e)?e():null;return Array.isArray(t)?(t=[].concat(o(t)),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){return"number"!=typeof e&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&e++,e}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=document.createElement("TH");return t.insertBefore(n,e),t.removeChild(e),n}function i(e,t){var n=document.createElement("TD");return t.insertBefore(n,e),t.removeChild(e),n}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=!1;t.default=function(){function e(t){r(this,e),this.wtTable=t,this.wot=t.instance,this.instance=t.instance,this.rowFilter=t.rowFilter,this.columnFilter=t.columnFilter,this.TABLE=t.TABLE,this.THEAD=t.THEAD,this.TBODY=t.TBODY,this.COLGROUP=t.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}return a(e,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var e={};if(this.wot.getSetting("beforeDraw",!0,e),!0===e.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var t=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),r=this.wot.getSetting("totalColumns"),o=this.wot.getSetting("totalRows"),i=void 0,a=!1;if((u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM)||u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),r>=0&&(this.adjustAvailableNodes(),a=!0,this.renderColumnHeaders(),this.renderRows(o,n,t),this.wtTable.isWorkingOnClone()||(i=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(t),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),a||this.adjustAvailableNodes(),this.removeRedundantRows(n),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(u.default.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(u.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var l=(0,s.outerWidth)(this.wtTable.hider),c=(0,s.outerWidth)(this.wtTable.TABLE);if(0!==l&&c!==l&&this.adjustColumnWidths(t),i!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var f=this.wtTable.getFirstRenderedColumn(),h=this.wtTable.getLastRenderedColumn(),d=this.wot.getSetting("defaultColumnWidth"),p=this.wot.getSetting("rowHeaderWidth");if(null!=(p=this.instance.getSetting("onModifyRowHeaderWidth",p)))for(var g=0;g<this.rowHeaderCount;g++){var v=Array.isArray(p)?p[g]:p;v=null==v?d:v,this.COLGROUP.childNodes[g].style.width=v+"px"}for(var m=f;m<h;m++){var y=this.wtTable.getStretchedColumnWidth(m);this.COLGROUP.childNodes[this.columnFilter.sourceToRendered(m)+this.rowHeaderCount].style.width=y+"px"}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(e,t,n){for(var r=void 0,o=0,i=this.rowFilter.renderedToSource(o),a=this.wtTable.isWorkingOnClone();i<e&&i>=0&&(!c&&o>1e3&&(c=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===t||o!==t);){if(r=this.getOrCreateTrForRow(o,r),this.renderRowHeaders(i,r),this.adjustColumns(r,n+this.rowHeaderCount),this.renderCells(i,r,n),a&&!this.wot.isOverlayName(u.default.CLONE_BOTTOM)||this.resetOversizedRow(i),r.firstChild){var s=this.wot.wtTable.getRowHeight(i);s?(s--,r.firstChild.style.height=s+"px"):r.firstChild.style.height=""}o++,i=this.rowFilter.renderedToSource(o)}}},{key:"resetOversizedRow",value:function(e){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]&&(this.wot.wtViewport.oversizedRows[e]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e=this.instance.wtTable.TBODY.childNodes.length,t=e*this.instance.wtSettings.settings.defaultRowHeight,n=(0,s.innerHeight)(this.instance.wtTable.TBODY)-1,r=void 0,o=void 0,i=void 0,a=void 0,l=void 0;this.instance.getSetting("totalRows");if(t!==n||this.instance.getSetting("fixedRowsBottom"))for(;e;)e--,i=this.instance.wtTable.rowFilter.renderedToSource(e),r=this.instance.wtTable.getRowHeight(i),a=this.instance.wtTable.getTrForRow(i),l=a.querySelector("th"),o=l?(0,s.innerHeight)(l):(0,s.innerHeight)(a)-1,(!r&&this.instance.wtSettings.settings.defaultRowHeight<o||r<o)&&(this.instance.wtViewport.oversizedRows[i]=++o)}}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]&&!this.wtTable.isWorkingOnClone()){for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var r=-1*this.rowHeaderCount;r<t;r++)this.markIfOversizedColumnHeader(r);this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,r=0,o=e.length;r<o;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=n[r]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t=this.wot.wtTable.columnFilter.renderedToSource(e),n=this.columnHeaderCount,r=this.wot.wtSettings.settings.defaultRowHeight,o=void 0,i=void 0,a=void 0,l=this.wot.getSetting("columnHeaderHeight")||[];n;)n--,o=this.wot.wtTable.getColumnHeaderHeight(n),(i=this.wot.wtTable.getColumnHeader(t,n))&&(a=(0,s.innerHeight)(i),(!o&&r<a||o<a)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?null!=l[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.wot.wtViewport.oversizedColumnHeaders[n]=l),this.wot.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"renderCells",value:function(e,t,n){for(var r=void 0,o=void 0,a=0;a<n;a++)o=this.columnFilter.renderedToSource(a),r=0===a?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:r.nextSibling,"TH"==r.nodeName&&(r=i(r,t)),(0,s.hasClass)(r,"hide")||(r.className=""),r.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(e,o,r);return r}},{key:"adjustColumnWidths",value:function(e){var t=0,n=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=n.wtTable.holder,o=this.wot.getSetting("defaultColumnWidth"),i=this.wot.getSetting("rowHeaderWidth");if(r.offsetHeight<r.scrollHeight&&(t=(0,s.getScrollbarWidth)()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t),null!=(i=this.instance.getSetting("onModifyRowHeaderWidth",i)))for(var a=0;a<this.rowHeaderCount;a++){var l=Array.isArray(i)?i[a]:i;l=null==l?o:l,this.COLGROUP.childNodes[a].style.width=l+"px"}for(var u=0;u<e;u++){this.COLGROUP.childNodes[u+this.rowHeaderCount].style.width=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(u))+"px"}}},{key:"appendToTbody",value:function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(e,t){var n=void 0;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e}},{key:"renderRowHeader",value:function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)}},{key:"renderRowHeaders",value:function(e,t){for(var n=t.firstChild,r=0;r<this.rowHeaderCount;r++)n?"TD"==n.nodeName&&(n=o(n,t)):(n=document.createElement("TH"),t.appendChild(n)),this.renderRowHeader(e,r,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var e=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(var n=this.getTrForColumnHeaders(t),r=-1*this.rowHeaderCount;r<e;r++){var o=this.columnFilter.renderedToSource(r);this.renderColumnHeader(t,o,n.childNodes[r+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&(0,s.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var e=this.wtTable.getRenderedColumnsCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,r=this.columnHeaders.length;n<r;n++){for(t=this.THEAD.childNodes[n],t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var o=this.THEAD.childNodes.length;if(o>this.columnHeaders.length)for(var i=this.columnHeaders.length;i<o;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&(0,s.empty)(t)}},{key:"getTrForColumnHeaders",value:function(e){return this.THEAD.childNodes[e]}},{key:"renderColumnHeader",value:function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)}},{key:"adjustColumns",value:function(e,t){for(var n=e.childNodes.length;n<t;){e.appendChild(document.createElement("TD")),n++}for(;n>t;)e.removeChild(e.lastChild),n--}},{key:"removeRedundantColumns",value:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(2),l=n(7),u=r(l),c=n(187),f=r(c),h=n(188),d=r(h);t.default=function(){function e(t){var n=this;o(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new u.default(this.wot),this.eventManager.addEventListener(window,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}return i(e,[{key:"getWorkspaceHeight",value:function(){var e=this.instance.wtOverlays.topOverlay.trimmingContainer,t=void 0,n=0;return e===window?n=document.documentElement.clientHeight:(t=(0,a.outerHeight)(e),n=t>0&&e.clientHeight>0?e.clientHeight:1/0),n}},{key:"getWorkspaceWidth",value:function(){var e=void 0,t=this.wot.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,r=void 0,o=this.wot.getSetting("stretchH"),i=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?(0,a.outerWidth)(this.instance.wtTable.wtRootElement):(e=this.wot.getSetting("freezeOverlays")?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),n===window&&t>0&&this.sumColumnWidths(0,t-1)>e?document.documentElement.clientWidth:n===window||"scroll"!=(r=(0,a.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=r&&"auto"!=r?"none"!==o&&o?e:Math.max(e,(0,a.outerWidth)(this.instance.wtTable.TABLE)):Math.max(e,n.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0;e<t;)n+=this.wot.wtTable.getColumnWidth(e),e++;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,t=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",e.appendChild(n),t=n.offsetWidth,this.containerWidth=t,e.removeChild(n),t}},{key:"getWorkspaceOffset",value:function(){return(0,a.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return(0,a.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return(0,a.outerWidth)(this.wot.wtTable.TABLE)||(0,a.outerWidth)(this.wot.wtTable.TBODY)||(0,a.outerWidth)(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,a.outerHeight)(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight(),t=void 0;return e===1/0?e:(t=this.getColumnHeaderHeight(),t>0&&(e-=t),e)}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,s=t.length;i<s;i++)o?(this.rowHeaderWidth+=(0,a.outerWidth)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth(),t=void 0;return e===1/0?e:(t=this.getRowHeaderWidth(),t>0?e-t:e)}},{key:"createRowsCalculator",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=void 0,r=void 0,o=void 0,i=void 0,s=void 0,l=void 0,u=void 0;return this.rowHeaderWidth=NaN,n=this.wot.wtSettings.settings.renderAllRows&&!t?1/0:this.getViewportHeight(),r=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),r<0&&(r=0),o=this.wot.getSetting("fixedRowsTop"),s=this.wot.getSetting("fixedRowsBottom"),u=this.wot.getSetting("totalRows"),o&&(l=this.wot.wtOverlays.topOverlay.sumCellSizes(0,o),r+=l,n-=l),s&&this.wot.wtOverlays.bottomOverlay.clone&&(l=this.wot.wtOverlays.bottomOverlay.sumCellSizes(u-s,u),n-=l),i=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:(0,a.getScrollbarWidth)(),new d.default(n,r,this.wot.getSetting("totalRows"),function(t){return e.wot.wtTable.getRowHeight(t)},t?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,t,i)}},{key:"createColumnsCalculator",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getViewportWidth(),r=void 0,o=void 0;if(this.columnHeaderHeight=NaN,r=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),r<0&&(r=0),o=this.wot.getSetting("fixedColumnsLeft")){var i=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,o);r+=i,n-=i}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(n-=(0,a.getScrollbarWidth)()),new f.default(n,r,this.wot.getSetting("totalColumns"),function(t){return e.wot.wtTable.getColumnWidth(t)},t?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,t,this.wot.getSetting("stretchH"),function(t,n){return e.wot.getSetting("onBeforeStretchingColumnWidth",t,n)})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){return!!this.rowsVisibleCalculator&&(!(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0)&&!(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1))}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){return!!this.columnsVisibleCalculator&&(!(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0)&&!(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1))}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,s.objectEach)(this.hasOversizedColumnHeadersMarked,function(e,t,n){n[t]=void 0})}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(10),l=n(2),u=n(33),c=n(7),f=r(c),h=n(60),d=r(h),p=n(29);r(p);t.default=function(){function e(t,n){o(this,e),n&&(this.eventManager=new f.default(t),this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return i(e,[{key:"registerListeners",value:function(){var e=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return e.onMouseUp()});for(var t=0,n=this.main.childNodes.length;t<n;t++)!function(t,n){e.eventManager.addEventListener(e.main.childNodes[t],"mouseenter",function(n){return e.onMouseEnter(n,e.main.childNodes[t])})}(t)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){function n(e){return e.clientY<Math.floor(i.top)||(e.clientY>Math.ceil(i.top+i.height)||(e.clientX<Math.floor(i.left)||(e.clientX>Math.ceil(i.left+i.width)||void 0)))}function r(e){n(e)&&(o.eventManager.removeEventListener(document.body,"mousemove",r),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,s.stopImmediatePropagation)(e);var o=this,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",r)}}},{key:"createBorders",value:function(e){this.main=document.createElement("div");var t=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var r=0;r<5;r++){var o=t[r],i=document.createElement("div");i.className="wtBorder "+(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(i.className+=" hidden"),n=i.style,n.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,n.height=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px",n.width=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px",this.main.appendChild(i)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,u.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var e={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var t in e)(0,l.hasOwnProperty)(e,t)&&(this.selectionHandles.styles.bottomRightHitArea[t]=e[t],this.selectionHandles.styles.topLeftHitArea[t]=e[t]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var r in n)(0,l.hasOwnProperty)(n,r)&&(this.selectionHandles.styles.bottomRight[r]=n[r],this.selectionHandles.styles.topLeft[r]=n[r]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,t){return!(!this.wot.selections.area.cellRange||e==this.wot.selections.area.cellRange.to.row&&t==this.wot.selections.area.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-a,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(r-a,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-s/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-s/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+i,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(r+o,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+i-s/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+o-s/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){var t,n,r,o,i,s,l,c,f,h,p,g,v,m,y,w,b,C;C=this.wot.wtTable.getRenderedRowsCount();for(var E=0;E<C;E++){var O=this.wot.wtTable.rowFilter.renderedToSource(E);if(O>=e[0]&&O<=e[2]){v=O;break}}for(var _=C-1;_>=0;_--){var S=this.wot.wtTable.rowFilter.renderedToSource(_);if(S>=e[0]&&S<=e[2]){y=S;break}}C=this.wot.wtTable.getRenderedColumnsCount();for(var T=0;T<C;T++){var R=this.wot.wtTable.columnFilter.renderedToSource(T);if(R>=e[1]&&R<=e[3]){m=R;break}}for(var M=C-1;M>=0;M--){var N=this.wot.wtTable.columnFilter.renderedToSource(M);if(N>=e[1]&&N<=e[3]){w=N;break}}if(void 0===v||void 0===m)return void this.disappear();t=v!==y||m!==w,n=this.wot.wtTable.getCell(new d.default(v,m)),r=t?this.wot.wtTable.getCell(new d.default(y,w)):n,o=(0,a.offset)(n),i=t?(0,a.offset)(r):o,s=(0,a.offset)(this.wot.wtTable.TABLE),c=o.top,p=i.top+(0,a.outerHeight)(r)-c,h=o.left,g=i.left+(0,a.outerWidth)(r)-h,l=c-s.top-1,f=h-s.left-1;var k=(0,a.getComputedStyle)(n);parseInt(k.borderTopWidth,10)>0&&(l+=1,p=p>0?p-1:0),parseInt(k.borderLeftWidth,10)>0&&(f+=1,g=g>0?g-1:0),this.topStyle.top=l+"px",this.topStyle.left=f+"px",this.topStyle.width=g+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=f+"px",this.leftStyle.height=p+"px",this.leftStyle.display="block";var A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=l+p-A+"px",this.bottomStyle.left=f+"px",this.bottomStyle.width=g+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=f+g-A+"px",this.rightStyle.height=p+1+"px",this.rightStyle.display="block",(0,u.isMobileBrowser)()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(y,w)?this.cornerStyle.display="none":(this.cornerStyle.top=l+p-4+"px",this.cornerStyle.left=f+g-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",b=(0,a.getTrimmingContainer)(this.wot.wtTable.TABLE),w===this.wot.getSetting("totalColumns")-1&&r.offsetLeft+(0,a.outerWidth)(r)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,a.innerWidth)(b)&&(this.cornerStyle.left=Math.floor(f+g-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0),y===this.wot.getSetting("totalRows")-1&&r.offsetTop+(0,a.outerHeight)(r)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,a.innerHeight)(b)&&(this.cornerStyle.top=Math.floor(l+p-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"),(0,u.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(v,m,l,f,g,p)}}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",(0,u.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"hasSetting",value:function(e){return"function"==typeof e?e():!!e}}]),e}()},function(e,t,n){"use strict";function r(e){h=!1;var t=this.getActiveEditor();if((0,o.isPrintableChar)(e.keyCode)||e.keyCode===o.KEY_CODES.BACKSPACE||e.keyCode===o.KEY_CODES.DELETE||e.keyCode===o.KEY_CODES.INSERT){var n=0;if(e.keyCode===o.KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;t.isOpened()||(n+=10),t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value),h=!0},n))}}t.__esModule=!0;var o=n(18),i=n(16),a=n(30),s=n(0),l=n(1),u=n(316),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=c.default.prototype.extend();f.prototype.init=function(){c.default.prototype.init.apply(this,arguments),this.query=null,this.strippedChoices=[],this.rawChoices=[]},f.prototype.getValue=function(){var e=this,t=this.rawChoices.find(function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value});return(0,i.isDefined)(t)?t:this.TEXTAREA.value},f.prototype.createElements=function(){c.default.prototype.createElements.apply(this,arguments),(0,l.addClass)(this.htContainer,"autocompleteEditor"),(0,l.addClass)(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var h=!1;f.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",r),c.default.prototype.prepare.apply(this,arguments)},f.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",c.default.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var e=this.htEditor.getInstance(),t=this,n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),e.updateSettings({colWidths:n?[(0,l.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?(0,l.outerWidth)(this.TEXTAREA)+(0,l.getScrollbarWidth)()+2:void 0,afterRenderer:function(e,n,r,o,a,s){var l=t.cellProperties,u=l.filteringCaseSensitive,c=l.allowHtml,f=void 0,h=void 0;a=(0,i.stringify)(a),a&&!c&&-1!==(f=!0===u?a.indexOf(this.query):a.toLowerCase().indexOf(t.query.toLowerCase()))&&(h=a.substr(f,t.query.length),a=a.replace(h,"<strong>"+h+"</strong>")),e.innerHTML=a},autoColumnSize:!0,modifyColWidth:function(e,t){var r=this.getPlugin("autoColumnSize").widths;return r[t]&&(e=r[t]),n?e:e+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=(0,l.getScrollbarWidth)()+2+"px",h&&(h=!1),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))},f.prototype.close=function(){c.default.prototype.close.apply(this,arguments)},f.prototype.queryChoices=function(e){var t=this;this.query=e;var n=this.cellProperties.source;"function"==typeof n?n.call(this.cellProperties,e,function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])},f.prototype.updateChoicesList=function(e){var t=(0,l.getCaretPosition)(this.TEXTAREA),n=(0,l.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null;r&&(i=f.sortByRelevance(this.stripValueIfNeeded(this.getValue()),e,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(i)?i.length:0;if(!1===o)u&&(a=i[0]);else{for(var c=[],h=0,d=e.length;h<d&&!(r&&u<=h);h++)c.push(u?e[i[h]]:e[h]);a=0,e=c}this.strippedChoices=e,this.htEditor.loadData((0,s.pivot)([e])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.instance.listen(!1),(0,l.setCaretPosition)(this.TEXTAREA,t,t===n?void 0:n)},f.prototype.flipDropdownIfNeeded=function(){var e=(0,l.offset)(this.TEXTAREA),t=(0,l.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),r=(0,l.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE),o=r.scrollTop,i=(0,l.outerHeight)(this.instance.view.wt.wtTable.THEAD),a={row:0,col:0};r!==window&&(a=(0,l.offset)(r));var s=e.top-a.top-i+o,u=r.scrollHeight-s-i-t,c=n>u&&s>u;return c?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(c?s:u,n),c},f.prototype.limitDropdownIfNeeded=function(e,t){if(t>e){var n=0,r=0,o=0,i=null;do{o=this.htEditor.getRowHeight(r)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,n+=o,r++}while(n<e);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-i+"px"),this.setDropdownHeight(n-o)}},f.prototype.flipDropdown=function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0},f.prototype.unflipDropdown=function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0},f.prototype.updateDropdownHeight=function(){var e=this.htEditor.getColWidth(0)+(0,l.getScrollbarWidth)()+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},f.prototype.setDropdownHeight=function(e){this.htEditor.updateSettings({height:e})},f.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",r),c.default.prototype.finishEditing.apply(this,arguments)},f.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()},f.sortByRelevance=function(e,t,n){var r=[],o=void 0,s=e.length,l=void 0,u=void 0,c=[],f=void 0,h=t.length;if(0===s){for(f=0;f<h;f++)c.push(f);return c}for(f=0;f<h;f++)o=(0,a.stripTags)((0,i.stringify)(t[f])),-1!==(l=n?o.indexOf(e):o.toLowerCase().indexOf(e.toLowerCase()))&&(u=o.length-l-s,r.push({baseIndex:f,index:l,charsLeft:u,value:o}));for(r.sort(function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0}),f=0,h=r.length;f<h;f++)c.push(r[f].baseIndex);return c},f.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8},f.prototype.stripValueIfNeeded=function(e){return this.stripValuesIfNeeded([e])[0]},f.prototype.stripValuesIfNeeded=function(e){var t=this.cellProperties.allowHtml,n=(0,s.arrayMap)(e,function(e){return(0,i.stringify)(e)});return(0,s.arrayMap)(n,function(e){return t?e:(0,a.stripTags)(e)})},f.prototype.allowKeyEventPropagation=function(e){var t={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},n=!1;return e===o.KEY_CODES.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(n=!0),e===o.KEY_CODES.ARROW_UP&&t.row>-1&&(n=!0),n},f.prototype.discardEditor=function(e){c.default.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},t.default=f},function(e,t,n){"use strict";t.__esModule=!0;var r=n(18),o=n(2),i=n(1),a=n(10),s=n(62),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=l.default.prototype.extend();u.prototype.createElements=function(){l.default.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()},u.prototype.prepare=function(e,t,n,r,i,a){l.default.prototype.prepare.apply(this,arguments);var s=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&s.setValue(n),s.instance.destroyEditor()}};this.cellProperties.handsontable&&(0,o.extend)(u,a.handsontable),this.htOptions=u};var c=function(e){if(!(0,a.isImmediatePropagationStopped)(e)){var t,n,o=this.getActiveEditor(),i=o.htEditor.getInstance();if(e.keyCode==r.KEY_CODES.ARROW_DOWN)if(i.getSelected()||i.flipped){if(i.getSelected())if(i.flipped)t=i.getSelected()[0]+1;else if(!i.flipped){n=i.getSelected()[0];var s=i.countRows()-1;t=Math.min(s,n+1)}}else t=0;else e.keyCode==r.KEY_CODES.ARROW_UP&&(!i.getSelected()&&i.flipped?t=i.countRows()-1:i.getSelected()&&(i.flipped?(n=i.getSelected()[0],t=Math.max(0,n-1)):(n=i.getSelected()[0],t=n-1)));void 0!==t&&(t<0||i.flipped&&t>i.countRows()-1?i.deselectCell():i.selectCell(t,0),i.getData().length&&(e.preventDefault(),(0,a.stopImmediatePropagation)(e),o.instance.listen(),o.TEXTAREA.focus()))}};u.prototype.open=function(){this.instance.addHook("beforeKeyDown",c),l.default.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),(0,i.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)},u.prototype.close=function(){this.instance.removeHook("beforeKeyDown",c),this.instance.listen(),l.default.prototype.close.apply(this,arguments)},u.prototype.focus=function(){this.instance.listen(),l.default.prototype.focus.apply(this,arguments)},u.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||l.default.prototype.beginEditing.apply(this,arguments)},u.prototype.finishEditing=function(e,t){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return l.default.prototype.finishEditing.apply(this,arguments)},u.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},t.default=u},function(e,t,n){"use strict";function r(e){var t=new Date(e);return isNaN(new Date(e+"T00:00").getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}t.__esModule=!0,t.getNormalizedDate=r},function(e,t,n){"use strict";!function(e){function n(e){return e.split('"').length-1}var r={parse:function(e){var t,r,o,i,a,s,l,u=[],c=0;for(o=e.split("\n"),o.length>1&&""===o[o.length-1]&&o.pop(),t=0,r=o.length;t<r;t+=1){for(o[t]=o[t].split("\t"),i=0,a=o[t].length;i<a;i+=1)u[c]||(u[c]=[]),s&&0===i?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+o[t][0],s&&1&n(o[t][0])&&(s=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):i===a-1&&0===o[t][i].indexOf('"')&&1&n(o[t][i])?(u[c].push(o[t][i].substring(1).replace(/""/g,'"')),s=!0):(u[c].push(o[t][i].replace(/""/g,'"')),s=!1);s||(c+=1)}return u},stringify:function(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="\t"),i=e[t][r],"string"==typeof i?i.indexOf("\n")>-1?a+='"'+i.replace(/"/g,'""')+'"':a+=i:a+=null===i||void 0===i?"":i;t!==n-1&&(a+="\n")}return a}};t.parse=r.parse,t.stringify=r.stringify}(window)},function(e,t,n){"use strict";function r(e){a.set(e,!0)}function o(e){return e===s}function i(e){return a.has(e)}t.__esModule=!0,t.registerAsRootInstance=r,t.hasValidParameter=o,t.isRootInstance=i;var a=t.holder=new WeakMap,s=t.rootInstanceSymbol=Symbol("rootInstance")},function(e,t,n){"use strict";function r(){}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(16),a=n(2);r.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,r,s;for(t=0,n=this.countCols();t<n;t++)if(""!==(r=this.getDataAtCell(e,t))&&null!==r&&(0,i.isDefined)(r))return"object"===(void 0===r?"undefined":o(r))&&(s=this.getCellMeta(e,t),(0,a.isObjectEquals)(this.getSchema()[s.prop],r));return!0},isEmptyCol:function(e){var t,n,r;for(t=0,n=this.countRows();t<n;t++)if(""!==(r=this.getDataAtCell(t,e))&&null!==r&&(0,i.isDefined)(r))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},t.default=r},function(e,t,n){"use strict";function r(e,t,n){var r=(0,a.getLanguageDictionary)(e);if(null===r)return null;var i=r[t];if((0,l.isUndefined)(i))return null;var s=o(i,n);return Array.isArray(s)?s[0]:s}function o(e,t){var n=e;return(0,i.arrayEach)((0,s.getPhraseFormatters)(),function(r){n=r(e,t)}),n}t.__esModule=!0,t.getTranslatedPhrase=r;var i=n(0),a=n(83),s=n(411),l=n(16)},function(e,t,n){"use strict";function r(e,t){return(0,c.objectEach)(t,function(t,n){(0,u.isUndefined)(e[n])&&(e[n]=t)}),e}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;if(e>t){var o=[r,n];n=o[0],r=o[1]}return n+"-"+r}function i(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=t.exec(e);return n?n[1].toLowerCase()+"-"+n[2].toUpperCase():e}function a(e,t){var n=i(e);(0,h.hasLanguageDictionary)(n)?t.language=n:(t.language=h.DEFAULT_LANGUAGE_CODE,s(e))}function s(e){(0,u.isDefined)(e)&&console.error((0,f.toSingleLine)(l,e))}t.__esModule=!0;var l=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);t.extendNotExistingKeys=r,t.createCellHeadersRange=o,t.normalizeLanguageCode=i,t.applyLanguageSetting=a,t.warnUserAboutLanguageRegistration=s;var u=n(16),c=n(2),f=n(61),h=n(83)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=n(4),l=n(16);t.default=function(){function e(t){o(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return i(e,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),i(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map;return"number"==typeof n&&(n={from:n,to:n}),(0,s.rangeEach)(n.from,n.to,function(n){var i=r.generateSample(e,t,n);o.set(n,i)}),o}},{key:"generateSample",value:function(e,t,n){var o=this,i=new Map,u=[],c=void 0;return(0,s.rangeEach)(t.from,t.to,function(t){var s=void 0;if("row"===e)s=o.dataFactory(n,t);else{if("col"!==e)throw new Error("Unsupported sample type");s=o.dataFactory(t,n)}c=(0,a.isObject)(s)?Object.keys(s).length:Array.isArray(s)?s.length:(0,l.stringify)(s).length,i.has(c)||i.set(c,{needed:o.getSampleCount(),strings:[]});var f=i.get(c);if(f.needed){if(!(u.indexOf(s)>-1)||o.allowDuplicates){f.strings.push(r({value:s},"row"===e?"col":"row",t)),u.push(s),f.needed--}}}),i}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=void 0;return(0,a.arrayEach)(t,function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1}),n}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=n(2);t.default=function(){function e(t){r(this,e),this.hot=t,this.commands={},this.commonCallback=null}return i(e,[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var l=e.split(":");e=l[0];var u=2===l.length?l[1]:null,c=this.commands[e];if(!c)throw new Error("Menu command '"+e+"' not exists.");if(u&&c.submenu&&(c=o(u,c.submenu.items)),!0!==c.disabled&&("function"!=typeof c.disabled||!0!==c.disabled.call(this.hot))&&!(0,s.hasOwnProperty)(c,"submenu")){var f=[];"function"==typeof c.callback&&f.push(c.callback),"function"==typeof this.commonCallback&&f.push(this.commonCallback),r.unshift(l.join(":")),(0,a.arrayEach)(f,function(e){return e.apply(t.hot,r)})}}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];return e&&e.items?e=e.items:Array.isArray(e)||(e=t),(0,a.isObject)(e)?(0,a.objectEach)(e,function(e,t){var o=n["string"==typeof e?e:t];o||(o=e),(0,a.isObject)(e)?(0,a.extend)(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)}):(0,s.arrayEach)(e,function(e,t){var o=n[e];!o&&l.ITEMS.indexOf(e)>=0||(o||(o={name:e,key:""+t}),(0,a.isObject)(e)&&(0,a.extend)(o,e),void 0===o.key&&(o.key=t),r.push(o))}),r}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=n(0),l=n(43);t.default=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r(this,e),this.hot=t,this.predefinedItems=(0,l.predefinedItems)(),this.defaultOrderPattern=n}return i(e,[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,(0,a.objectEach)(e,function(e,r){var o="";e.name===l.SEPARATOR?(n[l.SEPARATOR]=e,o=l.SEPARATOR):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)}),this.predefinedItems=n}},{key:"getItems",value:function(){return o(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=0;t.default=function(){function e(t){r(this,e),this.hot=t,this._element=null,this.state=a}return o(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=a}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){(0,i.isNumeric)(e)&&(this._element.style.top=e+"px"),(0,i.isNumeric)(t)&&(this._element.style.left=t+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){(0,i.isNumeric)(e)&&(this._element.style.width=e+"px"),(0,i.isNumeric)(t)&&(this._element.style.height=t+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){(0,i.isNumeric)(e)&&(this._element.style.marginTop=e+"px"),(0,i.isNumeric)(t)&&(this._element.style.marginLeft=t+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=0;t.default=function(){function e(t){r(this,e),this.hot=t,this._element=null,this.state=i}return o(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=i}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+"px"),void 0!==t&&(this._element.style.left=t+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+"px"),t&&(this._element.style.height=t+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+"px"),t&&(this._element.style.marginLeft=t+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}()},function(e,t,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},a=Error;!function(e){function t(e,n){switch(void 0===e?"undefined":o(e)){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(null===e)return null===n;if(R(e)){if(!R(n)||e.length!==n.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!t(e[r],n[r]))return!1;return!0}var a=b(n),s=a.length;if(b(e).length!==s)return!1;for(var r=0;r<s;r++)if(!t(e[r],n[r]))return!1;return!0;default:return!1}}function n(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function r(e){for(var t=0,n=_.length;t<n;t++)if(_[t].obj===e)return _[t]}function s(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].callback===t)return e.observers[n].observer}function l(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].observer===t)return void e.observers.splice(n,1)}function u(e,t){t.unobserve()}function c(e){return"object"===(void 0===e?"undefined":o(e))?JSON.parse(JSON.stringify(e)):e}function f(e,t){var n,o=[],i=r(e);if(i?n=s(i,t):(i=new S(e),_.push(i)),n)return n;if(n={},i.value=c(e),t){n.callback=t,n.next=null;var u=this.intervals||[100,1e3,1e4,6e4];if(void 0===u.push)throw new a("jsonpatch.intervals must be an array");var f=0,d=function(){h(n)},p=function(){clearTimeout(n.next),n.next=setTimeout(function(){d(),f=0,n.next=setTimeout(g,u[f++])},0)},g=function e(){d(),f==u.length&&(f=u.length-1),n.next=setTimeout(e,u[f++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",p),window.addEventListener("mouseup",p),window.addEventListener("keydown",p)):(document.documentElement.attachEvent("onmousedown",p),document.documentElement.attachEvent("onmouseup",p),document.documentElement.attachEvent("onkeydown",p))),n.next=setTimeout(g,u[f++])}return n.patches=o,n.object=e,n.unobserve=function(){h(n),clearTimeout(n.next),l(i,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",p),window.removeEventListener("mouseup",p),window.removeEventListener("keydown",p)):(document.documentElement.detachEvent("onmousedown",p),document.documentElement.detachEvent("onmouseup",p),document.documentElement.detachEvent("onkeydown",p)))},i.observers.push(new T(t,n)),n}function h(e){for(var t,n=0,r=_.length;n<r;n++)if(_[n].obj===e.object){t=_[n];break}d(t.value,e.object,e.patches,""),e.patches.length&&g(t.value,e.patches);var o=e.patches;return o.length>0&&(e.patches=[],e.callback&&e.callback(o)),o}function d(e,t,r,i){for(var a=b(t),s=b(e),l=!1,u=s.length-1;u>=0;u--){var f=s[u],h=e[f];if(t.hasOwnProperty(f)){var p=t[f];"object"==(void 0===h?"undefined":o(h))&&null!=h&&"object"==(void 0===p?"undefined":o(p))&&null!=p?d(h,p,r,i+"/"+n(f)):h!=p&&(!0,r.push({op:"replace",path:i+"/"+n(f),value:c(p)}))}else r.push({op:"remove",path:i+"/"+n(f)}),l=!0}if(l||a.length!=s.length)for(var u=0;u<a.length;u++){var f=a[u];e.hasOwnProperty(f)||r.push({op:"add",path:i+"/"+n(f),value:c(t[f])})}}function p(e){for(var t,n=0,r=e.length;n<r;){t=e.charCodeAt(n);{if(!(t>=48&&t<=57))return!1;n++}}return!0}function g(e,t,n){for(var r,o,i=!1,a=0,s=t.length;a<s;){r=t[a],a++;for(var l=r.path||"",u=l.split("/"),c=e,f=1,h=u.length,d=void 0;;){if(o=u[f],n&&void 0===d&&(void 0===c[o]?d=u.slice(0,f).join("/"):f==h-1&&(d=r.path),void 0!==d&&this.validator(r,a-1,e,d)),f++,void 0===o&&f>=h){i=O[r.op].call(r,c,o,e);break}if(R(c)){if("-"===o)o=c.length;else{if(n&&!p(o))throw new M("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,r.path,r);o=parseInt(o,10)}if(f>=h){if(n&&"add"===r.op&&o>c.length)throw new M("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,r.path,r);i=E[r.op].call(r,c,o,e);break}}else if(o&&-1!=o.indexOf("~")&&(o=o.replace(/~1/g,"/").replace(/~0/g,"~")),f>=h){i=C[r.op].call(r,c,o,e);break}c=c[o]}}return i}function v(e,t){var n=[];return d(e,t,n,""),n}function m(e){if(void 0===e)return!0;if("array"==typeof e||"object"==(void 0===e?"undefined":o(e)))for(var t in e)if(m(e[t]))return!0;return!1}function y(t,n,r,i){if("object"!==(void 0===t?"undefined":o(t))||null===t||R(t))throw new M("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,t,r);if(!C[t.op])throw new M("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,t,r);if("string"!=typeof t.path)throw new M("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,t,r);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new M("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new M("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&m(t.value))throw new M("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,t,r);if(r)if("add"==t.op){var a=t.path.split("/").length,s=i.split("/").length;if(a!==s+1&&a!==s)throw new M("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,t,r)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==i)throw new M("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,t,r)}else if("move"===t.op||"copy"===t.op){var l={op:"_get",path:t.from,value:void 0},u=e.validate([l],r);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new M("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,t,r)}}function w(e,t){try{if(!R(e))throw new M("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)t=JSON.parse(JSON.stringify(t)),g.call(this,t,e,!0);else for(var n=0;n<e.length;n++)this.validator(e[n],n)}catch(e){if(e instanceof M)return e;throw e}}var b=function(e){if(R(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t},C={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var r={op:"_get",path:this.from};return g(n,[r]),g(n,[{op:"remove",path:this.from}]),g(n,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(e,t,n){var r={op:"_get",path:this.from};return g(n,[r]),g(n,[{op:"add",path:this.path,value:r.value}]),!0},test:function(e,n){return t(e[n],this.value)},_get:function(e,t){this.value=e[t]}},E={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:C.move,copy:C.copy,test:C.test,_get:C._get},O={add:function(e){O.remove.call(this,e);for(var t in this.value)this.value.hasOwnProperty(t)&&(e[t]=this.value[t]);return!0},remove:function(e){for(var t in e)e.hasOwnProperty(t)&&C.remove.call(this,e,t);return!0},replace:function(e){return g(e,[{op:"remove",path:this.path}]),g(e,[{op:"add",path:this.path,value:this.value}]),!0},move:C.move,copy:C.copy,test:function(e){return JSON.stringify(e)===JSON.stringify(this.value)},_get:function(e){this.value=e}},_=[],S=function(){function e(e){this.observers=[],this.obj=e}return e}(),T=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=u,e.observe=f,e.generate=h;var R;R=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=g,e.compare=v;var M=function(e){function t(t,n,r,o,i){e.call(this,t),this.message=t,this.name=n,this.index=r,this.operation=o,this.tree=i}return i(t,e),t}(a);e.JsonPatchError=M,e.Error=M,e.validator=y,e.validate=w}(r||(r={})),t.apply=r.apply,t.observe=r.observe,t.unobserve=r.unobserve,t.generate=r.generate,t.compare=r.compare,t.validate=r.validate,t.validator=r.validator,t.JsonPatchError=r.JsonPatchError,t.Error=r.Error},function(e,t,n){"use strict";function r(e){return""===e.value||null===e.value||void 0===e.value}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);(0,n(9).registerCondition)(t.CONDITION_NAME="empty",r,{name:i.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return(0,s.stringify)(e.value).toLowerCase()===(0,s.stringify)(r)}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=n(16);(0,n(9).registerCondition)(t.CONDITION_NAME="eq",r,{name:a.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,2),r=n[0],i=n[1];if("numeric"===e.meta.type){var a=parseFloat(r,10),c=parseFloat(i,10);r=Math.min(a,c),i=Math.max(a,c)}else if("date"===e.meta.type){var f=(0,s.getCondition)(u.CONDITION_NAME,[i]),h=(0,s.getCondition)(l.CONDITION_NAME,[r]);return f(e)&&h(e)}return e.value>=r&&e.value<=i}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=n(9),l=n(332),u=n(333),c=t.CONDITION_NAME="between";(0,s.registerCondition)(c,r,{name:a.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0],i=(0,a.default)(e.value,e.meta.dateFormat),s=(0,a.default)(r,e.meta.dateFormat);return!(!i.isValid()||!s.isValid())&&i.diff(s)>=0}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(21),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(3),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);(0,n(9).registerCondition)(t.CONDITION_NAME="date_after",r,{name:l.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0],i=(0,a.default)(e.value,e.meta.dateFormat),s=(0,a.default)(r,e.meta.dateFormat);return!(!i.isValid()||!s.isValid())&&i.diff(s)<=0}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(21),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(3),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);(0,n(9).registerCondition)(t.CONDITION_NAME="date_before",r,{name:l.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return(0,s.stringify)(e.value).toLowerCase().indexOf((0,s.stringify)(r))>=0}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=n(16);(0,n(9).registerCondition)(t.CONDITION_NAME="contains",r,{name:a.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e,t){return e.some(function(e){return e.func(t)})}t.__esModule=!0,t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0,t.operationResult=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);(0,n(64).registerOperation)(t.OPERATION_ID="disjunction",t.SHORT_NAME_FOR_COMPONENT=i.FILTERS_LABELS_DISJUNCTION,r)},function(e,t,n){"use strict";function r(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(e){return e.func(t)})&&e[e.length-1].func(t)}t.__esModule=!0,t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=void 0,t.operationResult=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);(0,n(64).registerOperation)(t.OPERATION_ID="disjunctionAndVariable",t.SHORT_NAME_FOR_COMPONENT=i.FILTERS_LABELS_DISJUNCTION,r)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\` \n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`, \n        use it consequently for a particular column)."]),a=n(0),s=n(2),l=n(61),u=n(31),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=n(9),h=n(159),d=n(64),p=function(){function e(){r(this,e),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}return o(e,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(e,t){var n=this,r=!0;if(void 0===t)(0,s.objectEach)(this.columnTypes,function(t,o){return r=n.isMatchInConditions(n.conditions[t][o],e,t)});else{var o=this.columnTypes[t];r=this.isMatchInConditions(this.getConditions(t),e,o)}return r}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.OPERATION_ID;return!e.length||(0,d.getOperationFunc)(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.OPERATION_ID,r=(0,a.arrayMap)(t.args,function(e){return"string"==typeof e?e.toLowerCase():e}),o=t.name||t.command.key;this.runLocalHooks("beforeAdd",e),-1===this.orderStack.indexOf(e)&&this.orderStack.push(e);var s=this.columnTypes[e];if(s){if(s!==n)throw Error((0,l.toSingleLine)(i,e,s))}else{if(!this.conditions[n])throw new Error("Unexpected operation named `"+n+"`. Possible ones are `disjunction` and `conjunction`.");this.columnTypes[e]=n}this.getConditions(e).push({name:o,args:r,func:(0,f.getCondition)(o,r)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t=this.columnTypes[e];return t?(this.conditions[t][e]||(this.conditions[t][e]=[]),this.conditions[t][e]):[]}},{key:"exportAllConditions",value:function(){var e=this,t=[];return(0,a.arrayEach)(this.orderStack,function(n){var r=(0,a.arrayMap)(e.getConditions(n),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:condition;return{name:e.name,args:e.args}});t.push({column:n,conditions:r})}),t}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),(0,a.arrayEach)(e,function(e){t.orderStack.push(e.column),(0,a.arrayEach)(e.conditions,function(n){return t.addCondition(e.column,n)})})}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.orderStack.indexOf(e)>=0&&this.orderStack.splice(this.orderStack.indexOf(e),1),this.clearConditions(e),this.runLocalHooks("afterRemove",e)}},{key:"clearConditions",value:function(e){this.runLocalHooks("beforeClear",e),this.getConditions(e).length=0,delete this.columnTypes[e],this.runLocalHooks("afterClear",e)}},{key:"hasConditions",value:function(e,t){var n=this.columnTypes[e];if(!n)return!1;var r=this.getConditions(e);return t?(0,a.arrayFilter)(r,function(e){return e.name===t}).length>0:r.length>0}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var e=Object.create(null);return(0,s.objectEach)(d.operations,function(t,n){e[n]=Object.create(null)}),e}}]),e}();(0,s.mixin)(p,c.default),t.default=p},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0);t.default=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return[]};r(this,e),this.conditionCollection=t,this.columnDataFactory=n}return o(e,[{key:"filter",value:function(){var e=this,t=[];return this.conditionCollection.isEmpty()||(0,i.arrayEach)(this.conditionCollection.orderStack,function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)}),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return(0,i.arrayEach)(n,function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&r.push(n)}),r}},{key:"_getIntersectData",value:function(e,t){var n=[];return(0,i.arrayEach)(t,function(t){var r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])}),n}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(66);t.default=function(){function e(t,n){r(this,e);var o=(0,i.isObject)(t),a=(0,i.isObject)(n);this._row=o?t.index:t,this.rowAbsolute=!o||t.isAbsolute,this._column=a?n.index:n,this.columnAbsolute=!a||n.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(e){this._column=e},enumerable:!0,configurable:!0})}return o(e,[{key:"translateTo",value:function(e,t){this.row=this.row+e,this.column=this.column+t}},{key:"isEqual",value:function(e){return e.row===this.row&&e.column===this.column}},{key:"toString",value:function(){return(0,a.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=n(2),s=n(341);t.default=function(){function e(t,n){r(this,e),this.year=t,this.firstWeekDay="monday",this.allowSplitWeeks=void 0===n||n,this.weekSectionCount=0,this.monthList=this.calculateMonthData(),this.daysInColumns={},this.calculateWeekStructure()}return o(e,[{key:"setYear",value:function(e){this.year=e,this.monthList=this.calculateMonthData(),this.calculateWeekStructure()}},{key:"setFirstWeekDay",value:function(e){var t=e.toLowerCase();"monday"!==t&&"sunday"!==t&&console.warn("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=t,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){return this.monthList}},{key:"parseDate",value:function(e){return e instanceof Date||(e=new Date(e),"Invalid Date"!==e.toString())?e:null}},{key:"dateToColumn",value:function(e){if(!(e=this.parseDate(e))||e.getFullYear()!==this.year)return!1;var t=e.getMonth();return this.getWeekColumn(e.getDate()-1,t)}},{key:"getWeekColumn",value:function(e,t){var n=null,r=this.getMonthCacheArray(t);return(0,i.arrayEach)(r,function(t){if((0,a.objectEach)(t,function(t,r){if(t.indexOf(e+1)>-1)return n=parseInt(r,10),!1}),n)return!1}),n}},{key:"getMonthCacheArray",value:function(e){var t=this,n=this.getMonthList(),r=[];if(this.allowSplitWeeks)r.push(this.daysInColumns[e]);else{var o=-1;(0,a.objectEach)(this.daysInColumns,function(i,a){var s=n[a];if(Object.keys(i).length>1&&o++,o===e)return s.daysBeforeFullWeeks>0&&r.push(t.daysInColumns[parseInt(a,10)-1]),r.push(i),s.daysAfterFullWeeks>0&&r.push(t.daysInColumns[parseInt(a,10)+1]),!1})}return r}},{key:"columnToDate",value:function(e){var t=null;return(0,a.objectEach)(this.daysInColumns,function(n,r){if(n[e])return t=r,!1}),1===this.daysInColumns[t][e].length?new Date(this.year,t,this.daysInColumns[t][e][0]):this.daysInColumns[t][e]}},{key:"isOnTheEdgeOfWeek",value:function(e){var t=this;if(!(e=this.parseDate(e)))return null;var n=e.getMonth(),r=e.getDate()-1,o=this.getMonthCacheArray(n),s=!1;return(0,i.arrayEach)(o,function(n){if((0,a.objectEach)(n,function(n){if(!t.allowSplitWeeks&&7!==n.length&&(0===r||r===new Date(e.getYear(),e.getMonth()+1,0).getDate()-1))return!0;var o=n.indexOf(r+1);return 0===o?(s=[1,0],!1):o===n.length-1?(s=[0,1],!1):void 0}),s)return!1}),s}},{key:"addDaysToCache",value:function(e,t,n,r){if(this.daysInColumns[e]||(this.daysInColumns[e]={}),this.daysInColumns[e][t]||(this.daysInColumns[e][t]=[]),n<=r)for(var o=n;o<=r;o++)this.daysInColumns[e][t].push(o);else{for(var i=e-1>=0?this.countMonthDays(e):31,a=n;a<=i;a++)this.daysInColumns[e][t].push(a);for(var s=1;s<=r;s++)this.daysInColumns[e][t].push(s)}}},{key:"isValidRangeBarData",value:function(e,t){var n=this.parseDate(e),r=this.parseDate(t);return n&&r&&n.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){return this.monthList.length}},{key:"countMonthDays",value:function(e){return this.monthList[e-1].days}},{key:"countMonthFullWeeks",value:function(e){return this.monthList[e-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var e=this;this.monthList=this.calculateMonthData();var t=this.getFirstWeekDay(),n=this.getMonthList(),r=this.getYear(),o=[],a=0,l=0;"monday"===t&&(a=1),(0,i.arrayEach)(n,function(t,i){var u=new Date(r,i,1).getDay(),c=0,f=null;t.daysBeforeFullWeeks=(7-u+a)%7,!e.allowSplitWeeks&&t.daysBeforeFullWeeks&&(f=(0,s.getMixedMonthName)(i,n),o.push((0,s.getMixedMonthObject)(f,i)),c++),t.fullWeeks=Math.floor((t.days-t.daysBeforeFullWeeks)/7),t.daysAfterFullWeeks=t.days-t.daysBeforeFullWeeks-7*t.fullWeeks,e.allowSplitWeeks?l+=t.fullWeeks+(t.daysBeforeFullWeeks?1:0)+(t.daysAfterFullWeeks?1:0):(i===n.length-1&&t.daysAfterFullWeeks&&(f=(0,s.getMixedMonthName)(i,n),o.push((0,s.getMixedMonthObject)(f,null)),c++),l+=t.fullWeeks+c)}),(0,i.arrayEach)(o,function(t,n){var r=t.index;delete t.index,e.addMixedMonth(null===r?r:n+r,t)}),this.weekSectionCount=l}},{key:"addMixedMonth",value:function(e,t){null===e?this.monthList.push(t):this.monthList.splice(e,0,t)}}]),e}()},function(e,t,n){"use strict";function r(e,t){return{name:e,days:a,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:t}}function o(e,t){var n=i(t[e].name),r=e>0?i(t[e-1].name):null,o=i(t[0].name),a=i(t[t.length-1].name);return e>0?r+"/"+n:e===t.length-1?n+"/"+o:a+"/"+n}function i(e){return e.substring(0,3)}t.__esModule=!0,t.getMixedMonthObject=r,t.getMixedMonthName=o,t.getShorthand=i;var a=(t.DEC_LENGTH=31,t.WEEK_LENGTH=7)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=n(4),u=n(1),c=n(161),f=function(e){return e&&e.__esModule?e:{default:e}}(c);t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i.trimRowsPlugin=e.trimRowsPlugin,i}return i(t,e),a(t,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),a(t,[{key:"appendLevelIndicators",value:function(e,n){e=this.trimRowsPlugin.rowsMapper.getValueByIndex(e);var r=this.dataManager.getRowLevel(e),o=this.dataManager.getDataObject(e),i=n.getElementsByTagName("DIV")[0],a=i.querySelector("span.rowHeader"),c=i.querySelectorAll('[class^="ht_nesting"]');if((0,s.arrayEach)(c,function(e,t){e&&i.removeChild(e)}),(0,u.addClass)(n,t.CSS_CLASSES.indicatorContainer),r){var f=a.cloneNode(!0);i.innerHTML="",(0,l.rangeEach)(0,r-1,function(e){var n=document.createElement("SPAN");(0,u.addClass)(n,t.CSS_CLASSES.emptyIndicator),i.appendChild(n)}),i.appendChild(f)}if(this.dataManager.hasChildren(o)){var h=document.createElement("DIV");(0,u.addClass)(n,t.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(e)?(0,u.addClass)(h,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.expandButton):(0,u.addClass)(h,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.collapseButton),i.appendChild(h)}}},{key:"updateRowHeaderWidth",value:function(e){e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}]),t}(f.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,n(85),n(94),n(95),n(96),n(97),n(99),n(101),n(102),n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(131),n(132),n(133),n(134),n(135),n(80),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150);var o=n(362),i=r(o),a=n(474),s=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(a),n(554)),l=(r(s),n(555));r(l);i.default.baseVersion="0.35.0",t.default=i.default},function(e,t,n){var r=n(22),o=n(20),i=n(45);e.exports=n(24)?Object.defineProperties:function(e,t){o(e);for(var n,a=i(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){"use strict";var r=n(88),o=n(56),i=n(58),a={};n(38)(a,n(14)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(11),o=n(175).set;e.exports=function(e,t,n){var i,a=t.constructor;return a!==n&&"function"==typeof a&&(i=a.prototype)!==n.prototype&&r(i)&&o&&o(e,i),e}},function(e,t,n){var r=n(348);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(11),o=n(176),i=n(14)("species");e.exports=function(e){var t;return o(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(20),o=n(71),i=n(14)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[i])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(17),o=n(98).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(47)(a);e.exports=function(){var e,t,n,u=function(){var r,o;for(l&&(r=a.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(i){var c=!0,f=document.createTextNode("");new i(u).observe(f,{characterData:!0}),n=function(){f.data=c=!c}}else if(s&&s.resolve){var h=s.resolve();n=function(){h.then(u)}}else n=function(){o.call(r,u)};return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(20),o=n(11),i=n(179);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(17),o=n(48),i=n(74),a=n(180),s=n(22).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(45),o=n(78),i=n(59);e.exports=function(e){var t=r(e),n=o.f;if(n)for(var a,s=n(e),l=i.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(68),o=n(46);e.exports=function(e){return function(t,n){var i,a,s=String(o(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(i=s.charCodeAt(l),i<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):i:e?s.slice(l,l+2):a-56320+(i-55296<<10)+65536)}}},function(e,t,n){"use strict";var r=n(20);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(40),o=n(69),i=n(27);e.exports=[].copyWithin||function(e,t){var n=r(this),a=i(n.length),s=o(e,a),l=o(t,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:o(u,a))-l,a-s),f=1;for(l<s&&s<l+c&&(f=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=f,l+=f;return n}},function(e,t,n){"use strict";var r=n(40),o=n(69),i=n(27);e.exports=function(e){for(var t=r(this),n=i(t.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)t[s++]=e;return t}},function(e,t,n){var r=n(100),o=n(78),i=n(20),a=n(17).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(i(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=new f.default(e,t||{},J.rootInstanceSymbol);return n.init(),n}t.__esModule=!0,n(85),n(94),n(95),n(96),n(97),n(99),n(101),n(102),n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(131),n(132),n(133),n(134),n(135),n(80),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(363),n(364),n(365);var a=n(19),s=n(13),l=n(35),u=n(152),c=n(153),f=o(c),h=n(413),d=o(h),p=n(7),g=o(p),v=n(12),m=o(v),y=n(155),w=o(y),b=n(0),C=r(b),E=n(33),O=r(E),_=n(82),S=r(_),T=n(317),R=r(T),M=n(42),N=r(M),k=n(34),A=r(k),I=n(16),D=r(I),P=n(4),x=r(P),L=n(2),H=r(L),j=n(154),V=r(j),F=n(30),B=r(F),U=n(18),W=r(U),Y=n(1),$=r(Y),G=n(10),z=r(G),X=n(414),K=r(X),q=n(6),Q=n(320),Z=o(Q),J=n(319),ee=n(321),te=n(3),ne=r(te),re=n(83);(0,d.default)(i),i.Core=f.default,i.DefaultSettings=Z.default,i.EventManager=g.default,i._getListenersCounter=p.getListenersCounter,i.buildDate="06/12/2017 12:54:51",i.packageName="handsontable-pro",i.version="1.15.0";i.baseVersion="0.35.0",i.hooks=m.default.getSingleton(),i.__GhostTable=w.default;var oe=[C,O,S,R,N,A,D,x,H,V,B,W],ie=[$,z];i.helper={},i.dom={},C.arrayEach(oe,function(e){C.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(i.helper[t]=e[t])})}),C.arrayEach(ie,function(e){C.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(i.dom[t]=e[t])})}),i.cellTypes={},C.arrayEach((0,u.getRegisteredCellTypeNames)(),function(e){i.cellTypes[e]=(0,u.getCellType)(e)}),i.cellTypes.registerCellType=u.registerCellType,i.cellTypes.getCellType=u.getCellType,i.editors={},C.arrayEach((0,a.getRegisteredEditorNames)(),function(e){i.editors[B.toUpperCaseFirst(e)+"Editor"]=(0,a.getEditor)(e)}),i.editors.registerEditor=a.registerEditor,i.editors.getEditor=a.getEditor,i.renderers={},C.arrayEach((0,s.getRegisteredRendererNames)(),function(e){var t=(0,s.getRenderer)(e);"base"===e&&(i.renderers.cellDecorator=t),i.renderers[B.toUpperCaseFirst(e)+"Renderer"]=t}),i.renderers.registerRenderer=s.registerRenderer,i.renderers.getRenderer=s.getRenderer,i.validators={},C.arrayEach((0,l.getRegisteredValidatorNames)(),function(e){i.validators[B.toUpperCaseFirst(e)+"Validator"]=(0,l.getValidator)(e)}),i.validators.registerValidator=l.registerValidator,i.validators.getValidator=l.getValidator,i.plugins={},C.arrayEach(Object.getOwnPropertyNames(K),function(e){var t=K[e];"Base"===e?i.plugins[e+"Plugin"]=t:i.plugins[e]=t}),i.plugins.registerPlugin=q.registerPlugin,i.languages={},i.languages.dictionaryKeys=ne,i.languages.getLanguageDictionary=re.getLanguageDictionary,i.languages.getLanguagesDictionaries=re.getLanguagesDictionaries,i.languages.registerLanguageDictionary=re.registerLanguageDictionary,i.languages.getTranslatedPhrase=function(){return ee.getTranslatedPhrase.apply(void 0,arguments)},t.default=i},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(1),s=n(29),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(l.default.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",(0,a.addClass)(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return i(t,e),t}(l.default);l.default.registerOverlay(l.default.CLONE_DEBUG,u),t.default=u},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./af":192,"./af.js":192,"./ar":193,"./ar-dz":194,"./ar-dz.js":194,"./ar-kw":195,"./ar-kw.js":195,"./ar-ly":196,"./ar-ly.js":196,"./ar-ma":197,"./ar-ma.js":197,"./ar-sa":198,"./ar-sa.js":198,"./ar-tn":199,"./ar-tn.js":199,"./ar.js":193,"./az":200,"./az.js":200,"./be":201,"./be.js":201,"./bg":202,"./bg.js":202,"./bn":203,"./bn.js":203,"./bo":204,"./bo.js":204,"./br":205,"./br.js":205,"./bs":206,"./bs.js":206,"./ca":207,"./ca.js":207,"./cs":208,"./cs.js":208,"./cv":209,"./cv.js":209,"./cy":210,"./cy.js":210,"./da":211,"./da.js":211,"./de":212,"./de-at":213,"./de-at.js":213,"./de-ch":214,"./de-ch.js":214,"./de.js":212,"./dv":215,"./dv.js":215,"./el":216,"./el.js":216,"./en-au":217,"./en-au.js":217,"./en-ca":218,"./en-ca.js":218,"./en-gb":219,"./en-gb.js":219,"./en-ie":220,"./en-ie.js":220,"./en-nz":221,"./en-nz.js":221,"./eo":222,"./eo.js":222,"./es":223,"./es-do":224,"./es-do.js":224,"./es.js":223,"./et":225,"./et.js":225,"./eu":226,"./eu.js":226,"./fa":227,"./fa.js":227,"./fi":228,"./fi.js":228,"./fo":229,"./fo.js":229,"./fr":230,"./fr-ca":231,"./fr-ca.js":231,"./fr-ch":232,"./fr-ch.js":232,"./fr.js":230,"./fy":233,"./fy.js":233,"./gd":234,"./gd.js":234,"./gl":235,"./gl.js":235,"./gom-latn":236,"./gom-latn.js":236,"./he":237,"./he.js":237,"./hi":238,"./hi.js":238,"./hr":239,"./hr.js":239,"./hu":240,"./hu.js":240,"./hy-am":241,"./hy-am.js":241,"./id":242,"./id.js":242,"./is":243,"./is.js":243,"./it":244,"./it.js":244,"./ja":245,"./ja.js":245,"./jv":246,"./jv.js":246,"./ka":247,"./ka.js":247,"./kk":248,"./kk.js":248,"./km":249,"./km.js":249,"./kn":250,"./kn.js":250,"./ko":251,"./ko.js":251,"./ky":252,"./ky.js":252,"./lb":253,"./lb.js":253,"./lo":254,"./lo.js":254,"./lt":255,"./lt.js":255,"./lv":256,"./lv.js":256,"./me":257,"./me.js":257,"./mi":258,"./mi.js":258,"./mk":259,"./mk.js":259,"./ml":260,"./ml.js":260,"./mr":261,"./mr.js":261,"./ms":262,"./ms-my":263,"./ms-my.js":263,"./ms.js":262,"./my":264,"./my.js":264,"./nb":265,"./nb.js":265,"./ne":266,"./ne.js":266,"./nl":267,"./nl-be":268,"./nl-be.js":268,"./nl.js":267,"./nn":269,"./nn.js":269,"./pa-in":270,"./pa-in.js":270,"./pl":271,"./pl.js":271,"./pt":272,"./pt-br":273,"./pt-br.js":273,"./pt.js":272,"./ro":274,"./ro.js":274,"./ru":275,"./ru.js":275,"./sd":276,"./sd.js":276,"./se":277,"./se.js":277,"./si":278,"./si.js":278,"./sk":279,"./sk.js":279,"./sl":280,"./sl.js":280,"./sq":281,"./sq.js":281,"./sr":282,"./sr-cyrl":283,"./sr-cyrl.js":283,"./sr.js":282,"./ss":284,"./ss.js":284,"./sv":285,"./sv.js":285,"./sw":286,"./sw.js":286,"./ta":287,"./ta.js":287,"./te":288,"./te.js":288,"./tet":289,"./tet.js":289,"./th":290,"./th.js":290,"./tl-ph":291,"./tl-ph.js":291,"./tlh":292,"./tlh.js":292,"./tr":293,"./tr.js":293,"./tzl":294,"./tzl.js":294,"./tzm":295,"./tzm-latn":296,"./tzm-latn.js":296,"./tzm.js":295,"./uk":297,"./uk.js":297,"./ur":298,"./ur.js":298,"./uz":299,"./uz-latn":300,"./uz-latn.js":300,"./uz.js":299,"./vi":301,"./vi.js":301,"./x-pseudo":302,"./x-pseudo.js":302,"./yo":303,"./yo.js":303,"./zh-cn":304,"./zh-cn.js":304,"./zh-hk":305,"./zh-hk.js":305,"./zh-tw":306,"./zh-tw.js":306};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=368},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_LEFT),n}return i(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)t=this.getScrollPosition(),(0,s.resetCssTransform)(e);else{var r=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(r.left),i=Math.ceil(r.right),a=void 0,l=void 0;l=this.wot.wtTable.hider.style.top,l=""===l?0:l,a=o<0&&i-e.offsetWidth>0?-o:0,t=a,a+="px",(0,s.setOverlayPosition)(e,a,l)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(e){this.mainTableScrollableElement===window?window.scrollTo(e,(0,s.getWindowScrollTop)()):this.mainTableScrollableElement.scrollLeft=e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=0,r=this.wot.wtSettings.defaultColumnWidth;e<t;)n+=this.wot.wtTable.getStretchedColumnWidth(e)||r,e++;return n}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable.holder,t=e.clientHeight===e.offsetHeight?0:(0,s.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,r=n.style,o=this.wot.getSetting("preventOverflow"),i=void 0;if(this.trimmingContainer!==window||"vertical"===o){var a=this.wot.wtViewport.getWorkspaceHeight()-t;a=Math.min(a,(0,s.innerHeight)(this.wot.wtTable.wtRootElement)),r.height=a+"px"}else r.height="";this.clone.wtTable.holder.style.height=r.height,i=(0,s.outerWidth)(this.clone.wtTable.TABLE),r.width=(0===i?i:i+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var e=(0,s.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===e&&(e=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.top="number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;t&&o.offsetWidth!==o.clientWidth&&(i=(0,s.getScrollbarWidth)()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=this.wot.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==window||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return(0,s.getScrollLeft)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?(0,s.removeClass)(t,"emptyRows"):(0,s.addClass)(t,"emptyRows"),r&&!n.length)(0,s.addClass)(t,"innerBorderLeft");else if(!r&&n.length){var o=(0,s.hasClass)(t,"innerBorderLeft");e?(0,s.addClass)(t,"innerBorderLeft"):(0,s.removeClass)(t,"innerBorderLeft"),(!o&&e||o&&!e)&&this.wot.wtOverlays.adjustElementsSize()}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_LEFT,c),t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_TOP),n}return i(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)t=this.getScrollPosition(),(0,s.resetCssTransform)(e);else{var r=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(r.top),i=Math.ceil(r.bottom),a=void 0,l=void 0;a=this.wot.wtTable.hider.style.left,a=""===a?0:a,l=o<0&&i-e.offsetHeight>0?-o:0,t=l,l+="px",(0,s.setOverlayPosition)(e,a,l)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(e){this.mainTableScrollableElement===window?window.scrollTo((0,s.getWindowScrollLeft)(),e):this.mainTableScrollableElement.scrollTop=e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=0,r=this.wot.wtSettings.settings.defaultRowHeight;e<t;){var o=this.wot.wtTable.getRowHeight(e);n+=void 0===o?r:o,e++}return n}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable.holder,t=e.clientWidth===e.offsetWidth?0:(0,s.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,r=n.style,o=this.wot.getSetting("preventOverflow"),i=void 0;if(this.trimmingContainer!==window||"horizontal"===o){var a=this.wot.wtViewport.getWorkspaceWidth()-t;a=Math.min(a,(0,s.innerWidth)(this.wot.wtTable.wtRootElement)),r.width=a+"px"}else r.width="";this.clone.wtTable.holder.style.width=r.width,i=(0,s.outerHeight)(this.clone.wtTable.TABLE),r.height=(0===i?i:i+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var e=(0,s.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;if(t&&o.offsetHeight!==o.clientHeight&&(i=(0,s.getScrollbarWidth)()),t){var a=this.wot.getSetting("fixedRowsBottom"),l=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(l-a,l),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e);n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,s.getScrollTop)(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(e){if(e&&e.cellRange){var t=e.getBorder(this.wot);if(t){var n=e.getCorners();t.disappear(),t.appear(n)}}}},{key:"redrawAllSelectionsBorders",value:function(){var e=this.wot.selections;this.redrawSelectionBorders(e.current),this.redrawSelectionBorders(e.area),this.redrawSelectionBorders(e.fill),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?(0,s.removeClass)(t,"emptyColumns"):(0,s.addClass)(t,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=(0,s.hasClass)(t,"innerBorderTop");e||0===this.wot.getSetting("totalRows")?(0,s.addClass)(t,"innerBorderTop"):(0,s.removeClass)(t,"innerBorderTop"),(!n&&e||n&&!e)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(r)for(var o=0;o<r.length;o++)r[o].style["border-left-width"]=0}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP,c),t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_TOP_LEFT_CORNER),n}return i(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=(0,s.outerHeight)(this.clone.wtTable.TABLE),n=(0,s.outerWidth)(this.clone.wtTable.TABLE),r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.top),a=Math.ceil(o.left),l=Math.ceil(o.bottom),u=Math.ceil(o.right),c="0",f="0";r&&"vertical"!==r||a<0&&u-e.offsetWidth>0&&(c=-a+"px"),r&&"horizontal"!==r||i<0&&l-e.offsetHeight>0&&(f=-i+"px"),(0,s.setOverlayPosition)(e,c,f)}else(0,s.resetCssTransform)(e);e.style.height=(0===t?t:t+4)+"px",e.style.width=(0===n?n:n+4)+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP_LEFT_CORNER,c),t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(314),u=r(l),c=n(60),f=r(c),h=n(151),d=r(h);t.default=function(){function e(t,n){o(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={}}return a(e,[{key:"getBorder",value:function(e){if(this.instanceBorders[e.guid])return this.instanceBorders[e.guid];this.instanceBorders[e.guid]=new u.default(e,this.settings)}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){this.isEmpty()?this.cellRange=new d.default(e,e,e):this.cellRange.expand(e)}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){this.cellRange=null}},{key:"getCorners",value:function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=e.wtTable.getCell(new f.default(t,n));"object"===(void 0===o?"undefined":i(o))&&(0,s.addClass)(o,r)}},{key:"draw",value:function(e){if(this.isEmpty()){if(this.settings.border){var t=this.getBorder(e);t&&t.disappear()}}else{for(var n=e.wtTable.getRenderedRowsCount(),r=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),i=void 0,a=void 0,l=void 0,u=0;u<r;u++)if((a=e.wtTable.columnFilter.renderedToSource(u))>=o[1]&&a<=o[3]&&(l=e.wtTable.getColumnHeader(a))){var c=[];this.settings.highlightHeaderClassName&&c.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&c.push(this.settings.highlightColumnClassName),(0,s.addClass)(l,c)}for(var f=0;f<n;f++){if((i=e.wtTable.rowFilter.renderedToSource(f))>=o[0]&&i<=o[2]&&(l=e.wtTable.getRowHeader(i))){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),(0,s.addClass)(l,h)}for(var d=0;d<r;d++)a=e.wtTable.columnFilter.renderedToSource(d),i>=o[0]&&i<=o[2]&&a>=o[1]&&a<=o[3]?this.settings.className&&this.addClassAtCoords(e,i,a,this.settings.className):i>=o[0]&&i<=o[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(e,i,a,this.settings.highlightRowClassName):a>=o[1]&&a<=o[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,i,a,this.settings.highlightColumnClassName)}if(e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border){var p=this.getBorder(e);p&&p.appear(o)}}}}]),e}()},function(e,t,n){"use strict";function r(){function e(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}var t,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),a=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},s=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},l=function(a){var s,l;a?/^[a-zA-Z \.,\\\/\|0-9]$/.test(a)||(a="."):a="",void 0!==o.textContent?o.textContent=t.value+a:o.data=t.value+a,i.style.fontSize=e(t).fontSize,i.style.fontFamily=e(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),s=i.clientWidth+2,r.removeChild(i),t.style.height=n.minHeight+"px",t.style.width=n.minWidth>s?n.minWidth+"px":s>n.maxWidth?n.maxWidth+"px":s+"px",l=t.scrollHeight?t.scrollHeight-1:0,n.minHeight>l?t.style.height=n.minHeight+"px":n.maxHeight<l?(t.style.height=n.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},u=function(){window.setTimeout(l,0)},c=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=t.clientHeight;else{var r=parseInt(e.minHeight);isNaN(r)||(n.minHeight=r)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=t.clientHeight;else{var a=parseInt(e.maxHeight);isNaN(a)||(n.maxHeight=a)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=t.clientWidth;else{var s=parseInt(e.minWidth);isNaN(s)||(n.minWidth=s)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=t.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))},f=function(e,r,o){t=e,c(r),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=n.minHeight+"px",t.style.minWidth=n.minWidth+"px",t.style.maxWidth=n.maxWidth+"px",t.style.overflowY="hidden"),o&&(a(t,"change",l),a(t,"cut",u),a(t,"paste",u),a(t,"drop",u),a(t,"keydown",u),a(t,"focus",l)),l()};return{init:function(e,t,n){f(e,t,n)},unObserve:function(){s(t,"change",l),s(t,"cut",u),s(t,"paste",u),s(t,"drop",u),s(t,"keydown",u),s(t,"focus",l)},resize:l}}e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(52),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(1);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"beginEditing",value:function(e,t){if(void 0===t){var n=this.TD.querySelector('input[type="checkbox"]');(0,u.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),t}(l.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(21),c=r(u),f=n(376),h=r(f);n(377);var d=n(1),p=n(2),g=n(7),v=r(g),m=n(18),y=n(10),w=n(62),b=r(w);t.default=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return a(t,e),s(t,[{key:"init",value:function(){var e=this;if("function"!=typeof c.default)throw new Error("You need to include moment.js to your project.");if("function"!=typeof h.default)throw new Error("You need to include Pikaday to your project.");l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})}},{key:"createElements",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,(0,d.addClass)(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new h.default(this.getDatePickerConfig()),new v.default(this).addEventListener(this.datePicker,"mousedown",function(e){return(0,y.stopPropagation)(e)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(e,n,r,o,i,a){this._opened=!1,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n,r,o,i,a)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var r=this.originalValue;void 0!==r&&this.setValue(r)}this.hideDatepicker(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"finishEditing",this).call(this,e,n)}},{key:"showDatepicker",value:function(e){this.$datePicker.config(this.getDatePickerConfig());var t=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.$datePicker.config(),o=void 0,i=this.instance.view.isMouseDown(),a=!!e&&(0,m.isMetaKey)(e.keyCode);this.datePickerStyle.top=window.pageYOffset+t.top+(0,d.outerHeight)(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+t.left+"px",this.$datePicker._onInputFocus=function(){},r.format=n,this.originalValue?(o=this.originalValue,(0,c.default)(o,n,!0).isValid()&&this.$datePicker.setMoment((0,c.default)(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||i||this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,r.defaultDate=o,(0,c.default)(o,n,!0).isValid()&&this.$datePicker.setMoment((0,c.default)(o,n),!0),a||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,p.deepExtend)(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(t){isNaN(t.getTime())||(t=(0,c.default)(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}}]),t}(b.default)},function(e,t,n){/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(t,r){"use strict";var o;try{o=n(21)}catch(e){}e.exports=r(o)}(0,function(e){"use strict";var t="function"==typeof e,n=!!window.addEventListener,r=window.document,o=window.setTimeout,i=function(e,t,r,o){n?e.addEventListener(t,r,!!o):e.attachEvent("on"+t,r)},a=function(e,t,r,o){n?e.removeEventListener(t,r,!!o):e.detachEvent("on"+t,r)},s=function(e,t,n){var o;r.createEvent?(o=r.createEvent("HTMLEvents"),o.initEvent(t,!0,!1),o=w(o,n),e.dispatchEvent(o)):r.createEventObject&&(o=r.createEventObject(),o=w(o,n),e.fireEvent("on"+t,o))},l=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},u=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},c=function(e,t){u(e,t)||(e.className=""===e.className?t:e.className+" "+t)},f=function(e,t){e.className=l((" "+e.className+" ").replace(" "+t+" "," "))},h=function(e){return/Array/.test(Object.prototype.toString.call(e))},d=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},p=function(e){var t=e.getDay();return 0===t||6===t},g=function(e){return e%4==0&&e%100!=0||e%400==0},v=function(e,t){return[31,g(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},m=function(e){d(e)&&e.setHours(0,0,0,0)},y=function(e,t){return e.getTime()===t.getTime()},w=function(e,t,n){var r,o;for(r in t)o=void 0!==e[r],o&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?d(t[r])?n&&(e[r]=new Date(t[r].getTime())):h(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=w({},t[r],n):!n&&o||(e[r]=t[r]);return e},b=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},C={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},E=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},O=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},_=function(e,t,n){var r=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,t,e)-r)/864e5+r.getDay()+1)/7)+"</td>"},S=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},T=function(e){return"<tbody>"+e.join("")+"</tbody>"},R=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+E(e,t)+'">'+E(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},M=function(e,t,n,r,o,i){var a,s,l,u,c,f=e._o,d=n===f.minYear,p=n===f.maxYear,g='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',v=!0,m=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===o?a-t:12+a-t)+'"'+(a===r?' selected="selected"':"")+(d&&a<f.minMonth||p&&a>f.maxMonth?'disabled="disabled"':"")+">"+f.i18n.months[a]+"</option>");for(u='<div class="pika-label">'+f.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",h(f.yearRange)?(a=f.yearRange[0],s=f.yearRange[1]+1):(a=n-f.yearRange,s=1+n+f.yearRange),l=[];a<s&&a<=f.maxYear;a++)a>=f.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return c='<div class="pika-label">'+n+f.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",g+=f.showMonthAfterYear?c+u:u+c,d&&(0===r||f.minMonth>=r)&&(v=!1),p&&(11===r||f.maxMonth<=r)&&(m=!1),0===t&&(g+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+f.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+f.i18n.nextMonth+"</button>"),g+="</div>"},N=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+R(e)+T(t)+"</table>"},k=function(a){var s=this,l=s.config(a);s._onMouseDown=function(e){if(s._v){e=e||window.event;var t=e.target||e.srcElement;if(t)if(u(t,"is-disabled")||(!u(t,"pika-button")||u(t,"is-empty")||u(t.parentNode,"is-disabled")?u(t,"pika-prev")?s.prevMonth():u(t,"pika-next")&&s.nextMonth():(s.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),l.bound&&o(function(){s.hide(),l.field&&l.field.blur()},100))),u(t,"pika-select"))s._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},s._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(u(t,"pika-select-month")?s.gotoMonth(t.value):u(t,"pika-select-year")&&s.gotoYear(t.value))},s._onKeyChange=function(e){if(e=e||window.event,s.isVisible())switch(e.keyCode){case 13:case 27:l.field.blur();break;case 37:e.preventDefault(),s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7)}},s._onInputChange=function(n){var r;n.firedBy!==s&&(t?(r=e(l.field.value,l.format,l.formatStrict),r=r&&r.isValid()?r.toDate():null):r=new Date(Date.parse(l.field.value)),d(r)&&s.setDate(r),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){var e=r.activeElement;do{if(u(e,"pika-single"))return}while(e=e.parentNode);s._c||(s._b=o(function(){s.hide()},50)),s._c=!1},s._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,r=t;if(t){!n&&u(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",s._onChange)));do{if(u(r,"pika-single")||r===l.trigger)return}while(r=r.parentNode);s._v&&t!==l.trigger&&r!==l.trigger&&s.hide()}},s.el=r.createElement("div"),s.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:""),i(s.el,"mousedown",s._onMouseDown,!0),i(s.el,"touchend",s._onMouseDown,!0),i(s.el,"change",s._onChange),i(r,"keydown",s._onKeyChange),l.field&&(l.container?l.container.appendChild(s.el):l.bound?r.body.appendChild(s.el):l.field.parentNode.insertBefore(s.el,l.field.nextSibling),i(l.field,"change",s._onInputChange),l.defaultDate||(l.defaultDate=t&&l.field.value?e(l.field.value,l.format).toDate():new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var c=l.defaultDate;d(c)?l.setDefaultDate?s.setDate(c,!0):s.gotoDate(c):s.gotoDate(new Date),l.bound?(this.hide(),s.el.className+=" is-bound",i(l.trigger,"click",s._onInputClick),i(l.trigger,"focus",s._onInputFocus),i(l.trigger,"blur",s._onInputBlur)):this.show()};return k.prototype={config:function(e){this._o||(this._o=w({},C,!0));var t=w(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,d(t.minDate)||(t.minDate=!1),d(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),h(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else(t.yearRange=Math.abs(parseInt(t.yearRange,10))||C.yearRange)>100&&(t.yearRange=100);return t},toString:function(n){return d(this._d)?t?e(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,r){t&&e.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return d(this._d)?new Date(this._d.getTime()):new Date},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",s(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),d(e)){var n=this._o.minDate,r=this._o.maxDate;d(n)&&e<n?e=n:d(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),s(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(d(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=o<n.getTime()||r.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,r){var o,i=this.getDate(),a=24*parseInt(r)*60*60*1e3;"add"===n?o=new Date(i.valueOf()+a):"subtract"===n&&(o=new Date(i.valueOf()-a)),t&&("add"===n?o=e(i).add(r,"days").toDate():"subtract"===n&&(o=e(i).subtract(r,"days").toDate())),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=b({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(m(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=C.minDate,this._o.minYear=C.minYear,this._o.minMonth=C.minMonth,this._o.startRange=C.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(m(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=C.maxDate,this._o.maxYear=C.maxYear,this._o.maxMonth=C.maxMonth,this._o.endRange=C.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,r=n.minYear,i=n.maxYear,a=n.minMonth,s=n.maxMonth,l="";this._y<=r&&(this._y=r,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+M(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&o(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var e,t,n,o,i,a,s,l,u,c;if(!this._o.container){if(this.el.style.position="absolute",e=this._o.trigger,t=e,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||r.documentElement.clientWidth,a=window.innerHeight||r.documentElement.clientHeight,s=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,"function"==typeof e.getBoundingClientRect)c=e.getBoundingClientRect(),l=c.left+window.pageXOffset,u=c.bottom+window.pageYOffset;else for(l=t.offsetLeft,u=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,u+=t.offsetTop;(this._o.reposition&&l+n>i||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth),(this._o.reposition&&u+o>a+s||this._o.position.indexOf("top")>-1&&u-o-e.offsetHeight>0)&&(u=u-o-e.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(e,t,n){var r=this._o,o=new Date,i=v(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];m(o),r.firstDay>0&&(a-=r.firstDay)<0&&(a+=7);for(var u=0===t?11:t-1,c=11===t?0:t+1,f=0===t?e-1:e,h=11===t?e+1:e,g=v(f,u),w=i+a,b=w;b>7;)b-=7;w+=7-b;for(var C=0,E=0;C<w;C++){var T=new Date(e,t,C-a+1),R=!!d(this._d)&&y(T,this._d),M=y(T,o),k=C<a||C>=i+a,A=C-a+1,I=t,D=e,P=r.startRange&&y(r.startRange,T),x=r.endRange&&y(r.endRange,T),L=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,H=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&p(T)||r.disableDayFn&&r.disableDayFn(T);k&&(C<a?(A=g+A,I=u,D=f):(A-=i,I=c,D=h));l.push(O({day:A,month:I,year:D,isSelected:R,isToday:M,isDisabled:H,isEmpty:k,isStartRange:P,isEndRange:x,isInRange:L,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths})),7==++E&&(r.showWeekNumber&&l.unshift(_(C-a,t,e)),s.push(S(l,r.isRTL)),l=[],E=0)}return N(r,s,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(f(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(i(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&a(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",c(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),this._o.field&&(a(this._o.field,"change",this._onInputChange),this._o.bound&&(a(this._o.trigger,"click",this._onInputClick),a(this._o.trigger,"focus",this._onInputFocus),a(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},k})},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(315),c=r(u),f=n(12),h=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"prepare",value:function(e,n,r,o,i,a){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),t}(c.default);h.default.getSingleton().add("beforeValidate",function(e,t,n,r){var o=this.getCellMeta(t,this.propToCol(n));o.editor===d&&void 0===o.strict&&(o.filter=!1,o.strict=!0)}),t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(18),i=n(10),a=n(1),s=n(52),l=r(s),u=n(7),c=r(u),f=l.default.prototype.extend(),h={},d=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)Object.prototype.hasOwnProperty.call(this.controls,e)&&this.positionControls.appendChild(this.controls[e])};f.prototype.valueChanged=function(){return this.initValue!=this.getValue()},f.prototype.init=function(){var e=this;this.eventManager=new c.default(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},f.prototype.getValue=function(){return this.TEXTAREA.value},f.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},f.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),(0,a.addClass)(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),d.call(this),document.body.appendChild(this.editorContainer)},f.prototype.onBeforeKeyDown=function(e){var t=this,n=t.getActiveEditor();if(e.target===n.TEXTAREA&&!(0,i.isImmediatePropagationStopped)(e))switch(e.keyCode){case o.KEY_CODES.ENTER:n.close(),e.preventDefault();break;case o.KEY_CODES.BACKSPACE:(0,i.stopImmediatePropagation)(e)}},f.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),(0,a.addClass)(this.editorContainer,"active"),(0,a.removeClass)(this.cellPointer,"hidden"),this.updateEditorPosition()},f.prototype.focus=function(){this.TEXTAREA.focus(),(0,a.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},f.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),(0,a.removeClass)(this.editorContainer,"active")},f.prototype.scrollToView=function(){this.instance.view.scrollViewport(this.instance.getSelectedRange().highlight)},f.prototype.hideCellPointer=function(){(0,a.hasClass)(this.cellPointer,"hidden")||(0,a.addClass)(this.cellPointer,"hidden")},f.prototype.updateEditorPosition=function(e,t){if(e&&t)e=parseInt(e,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=e+"px";else{var n=this.instance.getSelected(),r=this.instance.getCell(n[0],n[1]);if(h.cellPointer||(h.cellPointer={height:(0,a.outerHeight)(this.cellPointer),width:(0,a.outerWidth)(this.cellPointer)}),h.editorContainer||(h.editorContainer={width:(0,a.outerWidth)(this.editorContainer)}),void 0!==r){var o=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:(0,a.getScrollLeft)(this.instance.view.wt.wtOverlays.leftOverlay.holder),i=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:(0,a.getScrollTop)(this.instance.view.wt.wtOverlays.topOverlay.holder),s=(0,a.offset)(r),l=(0,a.outerWidth)(r),u={x:o,y:i};this.editorContainer.style.top=parseInt(s.top+(0,a.outerHeight)(r)-u.y+h.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-h.editorContainer.width/2,10)+"px",s.left+l/2>parseInt(this.editorContainer.style.left,10)+h.editorContainer.width?this.editorContainer.style.left=window.innerWidth-h.editorContainer.width+"px":s.left+l/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-h.cellPointer.width/2-(0,a.offset)(this.editorContainer).left+l/2-u.x,10)+"px"}}},f.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},f.prototype.prepareAndSave=function(){var e;this.valueChanged()&&(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(e))},f.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,-1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(-1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(1==t.touches.length){var n=t.touches[0],r={x:e.editorContainer.offsetLeft,y:e.editorContainer.offsetTop},o={x:n.pageX-r.x,y:n.pageY-r.y};e.eventManager.addEventListener(this,"touchmove",function(t){var n=t.touches[0];e.updateEditorPosition(n.pageX-o.x,n.pageY-o.y),e.hideCellPointer(),t.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(t){(0,a.isChildOf)(t.target,e.editorContainer)||(0,a.isChildOf)(t.target,e.instance.rootElement)||e.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&e.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&e.hideCellPointer()})},f.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(81),c=r(u),f=n(62),h=r(f);t.default=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"beginEditing",value:function(e){if(void 0===e&&this.originalValue){var n=c.default.cultureData().delimiters.decimal,r=this.cellProperties.numericFormat,o=r&&r.culture;void 0!==o&&c.default.culture(o),e=(""+this.originalValue).replace(".",n)}l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"beginEditing",this).call(this,e)}}]),t}(h.default)},function(e,t){},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(1),u=n(62),c=function(e){return e&&e.__esModule?e:{default:e}}(u);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"createElements",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,l.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),t}(c.default)},function(e,t,n){"use strict";t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(1),i=n(10),a=n(18),s=n(52),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=l.default.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT"),(0,o.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},u.prototype.registerHooks=function(){var e=this;this.instance.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return e.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return e.refreshDimensions()})},u.prototype.prepare=function(){l.default.prototype.prepare.apply(this,arguments);var e,t=this.cellProperties.selectOptions;e=this.prepareOptions("function"==typeof t?t(this.row,this.col,this.prop):t),(0,o.empty)(this.select);for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=document.createElement("OPTION");r.value=n,(0,o.fastInnerHTML)(r,e[n]),this.select.appendChild(r)}},u.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,o=e.length;n<o;n++)t[e[n]]=e[n];else"object"==(void 0===e?"undefined":r(e))&&(t=e);return t},u.prototype.getValue=function(){return this.select.value},u.prototype.setValue=function(e){this.select.value=e};var c=function(e){var t=this,n=t.getActiveEditor();switch(e.keyCode){case a.KEY_CODES.ARROW_UP:var r=n.select.selectedIndex-1;r>=0&&(n.select[r].selected=!0),(0,i.stopImmediatePropagation)(e),e.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:var o=n.select.selectedIndex+1;o<=n.select.length-1&&(n.select[o].selected=!0),(0,i.stopImmediatePropagation)(e),e.preventDefault()}};u.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",c)},u.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",c)},u.prototype.focus=function(){this.select.focus()},u.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()},u.prototype.refreshDimensions=function(){if(this.state===s.EditorState.EDITING){if(!(this.TD=this.getEditedCell()))return void this.close();var e,t=(0,o.outerWidth)(this.TD)+1,n=(0,o.outerHeight)(this.TD)+1,r=(0,o.offset)(this.TD),i=(0,o.offset)(this.instance.rootElement),a=(0,o.getScrollableElement)(this.TD),l=r.top-i.top-1-(a.scrollTop||0),u=r.left-i.left-1-(a.scrollLeft||0),c=this.checkEditorSection();this.instance.getSettings();switch(c){case"top":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=(0,o.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(l+=1),0===this.instance.getSelected()[1]&&(u+=1);var f=this.select.style;e&&-1!=e?f[e[0]]=e[1]:(0,o.resetCssTransform)(this.select);var h=(0,o.getComputedStyle)(this.TD);parseInt(h.borderTopWidth,10)>0&&(n-=1),parseInt(h.borderLeftWidth,10)>0&&(t-=1),f.height=n+"px",f.minWidth=t+"px",f.top=l+"px",f.left=u+"px",f.margin="0px"}},u.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.default=u},function(e,t,n){"use strict";function r(e,t,n,r,i,a,s){s.className&&(t.className=t.className?t.className+" "+s.className:s.className),s.readOnly&&(0,o.addClass)(t,s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?(0,o.addClass)(t,s.invalidCellClassName):(0,o.removeClass)(t,s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&(0,o.addClass)(t,s.noWordWrapClassName),!a&&s.placeholder&&(0,o.addClass)(t,s.placeholderCellClassName)}t.__esModule=!0;var o=n(1);t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,i,f,h){var d=(u.cloneNode(!0),c.cloneNode(!0));if(h.allowHtml?(0,l.getRenderer)("html").apply(this,arguments):(0,l.getRenderer)("text").apply(this,arguments),t.appendChild(d),(0,o.addClass)(t,"htAutocomplete"),t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160))),!e.acArrowListener){var p=new a.default(e);e.acArrowListener=function(i){(0,o.hasClass)(i.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new s.CellCoords(n,r),t)},p.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){p.destroy()})}}t.__esModule=!0;var o=n(1),i=n(7),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(15),l=n(13),u=document.createElement("DIV");u.className="htAutocompleteWrapper";var c=document.createElement("DIV");c.className="htAutocompleteArrow",c.appendChild(document.createTextNode(String.fromCharCode(9660)));t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,s,l,u){function c(e){var t=(0,v.partial)(g.isKey,e.keyCode);t("SPACE|ENTER|DELETE|BACKSPACE")&&!(0,m.isImmediatePropagationStopped)(e)&&p(function(){(0,m.stopImmediatePropagation)(e),e.preventDefault()}),t("SPACE|ENTER")&&d(),t("DELETE|BACKSPACE")&&d(!0)}function d(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n){for(var r=n.getTopLeftCorner(),o=r.row,i=r.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],c=o;c<=s;c+=1)for(var f=i;f<=l;f+=1){var h=e.getCellMeta(c,f);if("checkbox"!==h.type)return;if(!0!==h.readOnly){void 0===h.checkedTemplate&&(h.checkedTemplate=!0),void 0===h.uncheckedTemplate&&(h.uncheckedTemplate=!1);var d=e.getDataAtCell(c,f);!1===t?[h.checkedTemplate,h.checkedTemplate.toString()].includes(d)?u.push([c,f,h.uncheckedTemplate]):[h.uncheckedTemplate,h.uncheckedTemplate.toString(),null,void 0].includes(d)&&u.push([c,f,h.checkedTemplate]):u.push([c,f,h.uncheckedTemplate])}}u.length>0&&e.setDataAtCell(u)}}function p(t){var n=e.getSelectedRange();if(n)for(var r=n.getTopLeftCorner(),o=n.getBottomRightCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var s=e.getCellMeta(i,a);if("checkbox"!==s.type)return;var l=e.getCell(i,a);if(null==l)t(i,a,s);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!s.readOnly&&t(u)}}}(0,y.getRenderer)("base").apply(this,arguments);var b=(o(e),i()),E=u.label,O=!1;if(void 0===u.checkedTemplate&&(u.checkedTemplate=!0),void 0===u.uncheckedTemplate&&(u.uncheckedTemplate=!1),(0,f.empty)(t),l===u.checkedTemplate||(0,h.equalsIgnoreCase)(l,u.checkedTemplate)?b.checked=!0:l===u.uncheckedTemplate||(0,h.equalsIgnoreCase)(l,u.uncheckedTemplate)?b.checked=!1:null===l?(0,f.addClass)(b,"noValue"):(b.style.display="none",(0,f.addClass)(b,C),O=!0),b.setAttribute("data-row",n),b.setAttribute("data-col",r),!O&&E){var _="";E.value?_="function"==typeof E.value?E.value.call(this,n,r,s,l):E.value:E.property&&(_=e.getDataAtRowProp(n,E.property));var S=a(_);"before"===E.position?S.appendChild(b):S.insertBefore(b,S.firstChild),b=S}t.appendChild(b),O&&t.appendChild(document.createTextNode("#bad-value#")),w.has(e)||(w.set(e,!0),e.addHook("beforeKeyDown",c))}function o(e){var t=b.get(e);return t||(t=new p.default(e),t.addEventListener(e.rootElement,"click",function(t){return l(t,e)}),t.addEventListener(e.rootElement,"mouseup",function(t){return s(t,e)}),t.addEventListener(e.rootElement,"change",function(t){return u(t,e)}),b.set(e,t)),t}function i(){var e=document.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function a(e){var t=document.createElement("label");return t.className="htCheckboxRendererLabel",t.appendChild(document.createTextNode(e)),t.cloneNode(!0)}function s(e,t){c(e.target)&&setTimeout(t.listen,10)}function l(e,t){if(!c(e.target))return!1;t.getCellMeta(parseInt(e.target.getAttribute("data-row"),10),parseInt(e.target.getAttribute("data-col"),10)).readOnly&&e.preventDefault()}function u(e,t){if(!c(e.target))return!1;var n=parseInt(e.target.getAttribute("data-row"),10),r=parseInt(e.target.getAttribute("data-col"),10),o=t.getCellMeta(n,r);if(!o.readOnly){var i=null;i=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(n,r,i)}}function c(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}t.__esModule=!0;var f=n(1),h=n(30),d=n(7),p=function(e){return e&&e.__esModule?e:{default:e}}(d),g=n(18),v=n(34),m=n(10),y=n(13),w=new WeakMap,b=new WeakMap,C="htBadValue";t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,a,s,l){(0,i.getRenderer)("base").apply(this,arguments),null!==s&&void 0!==s||(s=""),(0,o.fastInnerHTML)(t,s)}t.__esModule=!0;var o=n(1),i=n(13);t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,o,l,u){if((0,s.isNumeric)(l)){var c=u.numericFormat,f=c&&c.culture,h=c&&c.pattern,d=u.className||"",p=d.length?d.split(" "):[];void 0!==f&&i.default.culture(f),l=(0,i.default)(l).format(h||"0"),p.indexOf("htLeft")<0&&p.indexOf("htCenter")<0&&p.indexOf("htRight")<0&&p.indexOf("htJustify")<0&&p.push("htRight"),p.indexOf("htNumeric")<0&&p.push("htNumeric"),u.className=p.join(" ")}(0,a.getRenderer)("text")(e,t,n,r,o,l,u)}t.__esModule=!0;var o=n(81),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(13),s=n(4);t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,s,l,u){(0,i.getRenderer)("text").apply(this,arguments),l=t.innerHTML;var c=u.hashLength||l.length,f=u.hashSymbol||"*",h="";(0,a.rangeEach)(c-1,function(){h+=f}),(0,o.fastInnerHTML)(t,h)}t.__esModule=!0;var o=n(1),i=n(13),a=n(4);t.default=r},function(e,t,n){"use strict";function r(e,t,n,r,s,l,u){(0,a.getRenderer)("base").apply(this,arguments),!l&&u.placeholder&&(l=u.placeholder);var c=(0,i.stringify)(l);if(e.getSettings().trimWhitespace||(c=c.replace(/ /g,String.fromCharCode(160))),u.rendererTemplate){(0,o.empty)(t);var f=document.createElement("TEMPLATE");f.setAttribute("bind","{{}}"),f.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(f),f.model=e.getSourceDataAtRow(n),t.appendChild(f)}else(0,o.fastInnerText)(t,c)}t.__esModule=!0;var o=n(1),i=n(16),a=n(13);t.default=r},function(e,t,n){"use strict";function r(e,t){if(null==e&&(e=""),this.allowEmpty&&""===e)return void t(!0);this.strict&&this.source?"function"==typeof this.source?this.source(e,o(e,t)):o(e,t)(this.source):t(!0)}function o(e,t){var n=e;return function(e){for(var r=!1,o=0,i=e.length;o<i;o++)if(n===e[o]){r=!0;break}t(r)}}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e,t){var n=!0,r=(0,l.getEditorInstance)("date",this.instance);null==e&&(e="");var i=(0,a.default)(new Date(e)).isValid()||(0,a.default)(e,r.defaultDateFormat).isValid(),s=(0,a.default)(e,this.dateFormat||r.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===e&&(i=!0,s=!0),i||(n=!1),!i&&s&&(n=!0),i&&!s)if(!0===this.correctFormat){var u=o(e,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),f=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,f,u,"dateValidator"),n=!0}else n=!1;t(n)}function o(e,t){var n=(0,a.default)((0,s.getNormalizedDate)(e)),r=(0,a.default)(e,t),o=e.search(/[A-z]/g)>-1,i=void 0;return i=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||o?n:r,i.format(t)}t.__esModule=!0,t.default=r,t.correctFormat=o;var i=n(21),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(317),l=n(19)},function(e,t,n){"use strict";function r(e,t){null==e&&(e=""),t(this.allowEmpty&&""===e?!0:""===e?!1:/^-?\d*(\.|,)?\d*$/.test(e))}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e,t){var n=!0,r=this.timeFormat||"h:mm:ss a";null===e&&(e=""),e=/^\d{3,}$/.test(e)?parseInt(e,10):e;var o=/^\d{1,2}$/.test(e);o&&(e+=":00");var s=(0,i.default)(e,a,!0).isValid()?(0,i.default)(e):(0,i.default)(e,r),l=s.isValid(),u=(0,i.default)(e,r,!0).isValid()&&!o;if(this.allowEmpty&&""===e&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(!0===this.correctFormat){var c=s.format(r),f=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,h,c,"timeValidator"),n=!0}else n=!1;t(n)}t.__esModule=!0,t.default=r;var o=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13),i=n(35);t.default={editor:(0,r.getEditor)("autocomplete"),renderer:(0,o.getRenderer)("autocomplete"),validator:(0,i.getValidator)("autocomplete")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13);t.default={editor:(0,r.getEditor)("checkbox"),renderer:(0,o.getRenderer)("checkbox")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13),i=n(35);t.default={editor:(0,r.getEditor)("date"),renderer:(0,o.getRenderer)("autocomplete"),validator:(0,i.getValidator)("date")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13),i=n(35);t.default={editor:(0,r.getEditor)("dropdown"),renderer:(0,o.getRenderer)("autocomplete"),validator:(0,i.getValidator)("autocomplete")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13);t.default={editor:(0,r.getEditor)("handsontable"),renderer:(0,o.getRenderer)("autocomplete")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13),i=n(35);t.default={editor:(0,r.getEditor)("numeric"),renderer:(0,o.getRenderer)("numeric"),validator:(0,i.getValidator)("numeric"),dataType:"number"}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13);n(35);t.default={editor:(0,r.getEditor)("password"),renderer:(0,o.getRenderer)("password"),copyable:!1}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(33),o=n(19),i=n(13);t.default={editor:(0,o.getEditor)((0,r.isMobileBrowser)()?"mobile":"text"),renderer:(0,i.getRenderer)("text")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(19),o=n(13),i=n(35);t.default={editor:(0,r.getEditor)("text"),renderer:(0,o.getRenderer)("text"),validator:(0,i.getValidator)("time")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=this;this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap(),this.interval=d.default.create(function(){return r.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(e){return r.onSkipLengthCache(e)}),this.onSkipLengthCache(500)}t.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(318),s=r(a),l=n(82),u=n(154),c=n(2),f=n(0),h=n(405),d=r(h),p=n(4),g=n(406),v=r(g),m=n(12);r(m);o.prototype.DESTINATION_RENDERER=1,o.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,o.prototype.recursiveDuckSchema=function(e){return(0,c.duckSchema)(e)},o.prototype.recursiveDuckColumns=function(e,t,n){var r,o;if(void 0===t&&(t=0,n=""),"object"===(void 0===e?"undefined":i(e))&&!Array.isArray(e))for(o in e)(0,c.hasOwnProperty)(e,o)&&(null===e[o]?(r=n+o,this.colToPropCache.push(r),this.propToColCache.set(r,t),t++):t=this.recursiveDuckColumns(e[o],t,o+"."));return t},o.prototype.createMap=function(){var e=void 0,t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new v.default;var n=this.instance.getSettings().columns;if(n){var r=this.instance.getSettings().maxCols,o=Math.min(r,n.length),i=0,a=!1,s=(0,c.deepObjectSize)(t);for("function"==typeof n&&(o=s>0?s:this.instance.countSourceCols(),a=!0),e=0;e<o;e++){var l=a?n(e):n[e];if((0,c.isObject)(l)){if(void 0!==l.data){var u=a?i:e;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}i++}}}else this.recursiveDuckColumns(t)},o.prototype.colToProp=function(e){return e=this.instance.runHooks("modifyCol",e),!isNaN(e)&&this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e},o.prototype.propToCol=function(e){var t;return t=void 0===this.propToColCache.get(e)?e:this.propToColCache.get(e),t=this.instance.runHooks("unmodifyCol",t)},o.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},o.prototype.createRow=function(e,t,n){var r,o,i=this.instance.countCols(),a=0;t||(t=1),("number"!=typeof e||e>=this.instance.countSourceRows())&&(e=this.instance.countSourceRows()),this.instance.runHooks("beforeCreateRow",e,t,n),o=e;for(var s=this.instance.getSettings().maxRows;a<t&&this.instance.countSourceRows()<s;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?r=(0,c.deepClone)(this.getSchema()):(r=[],(0,p.rangeEach)(i-1,function(){return r.push(null)})):"function"===this.instance.dataType?r=this.instance.getSettings().dataSchema(e):(r={},(0,c.deepExtend)(r,this.getSchema())),e===this.instance.countSourceRows()?this.dataSource.push(r):this.spliceData(e,0,r),a++,o++;return this.instance.runHooks("afterCreateRow",e,a,n),this.instance.forceFullRender=!0,a},o.prototype.createCol=function(e,t,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,o,i=this.instance.countSourceRows(),a=this.dataSource,s=0;t||(t=1),("number"!=typeof e||e>=this.instance.countCols())&&(e=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",e,t,n),o=e;for(var l=this.instance.getSettings().maxCols;s<t&&this.instance.countCols()<l;){if(r=(0,u.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){if(i>0)for(var c=0;c<i;c++)void 0===a[c]&&(a[c]=[]),a[c].push(null);else a.push([null]);this.priv.columnSettings.push(r)}else{for(var f=0;f<i;f++)a[f].splice(o,0,null);this.priv.columnSettings.splice(o,0,r)}s++,o++}return this.instance.runHooks("afterCreateCol",e,s,n),this.instance.forceFullRender=!0,s},o.prototype.removeRow=function(e,t,n){t||(t=1),"number"!=typeof e&&(e=-t),t=this.instance.runHooks("modifyRemovedAmount",t,e),e=(this.instance.countSourceRows()+e)%this.instance.countSourceRows();var r=this.visualRowsToPhysical(e,t);if(!1!==this.instance.runHooks("beforeRemoveRow",e,t,r,n)){var o=this.dataSource,i=void 0;i=this.filterData(e,t),i&&(o.length=0,Array.prototype.push.apply(o,i)),this.instance.runHooks("afterRemoveRow",e,t,r,n),this.instance.forceFullRender=!0}},o.prototype.removeCol=function(e,t,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols();var r=this.visualColumnsToPhysical(e,t),o=r.slice(0).sort(function(e,t){return t-e});if(!1!==this.instance.runHooks("beforeRemoveCol",e,t,r,n)){for(var i=!0,a=o.length,s=this.dataSource,l=0;l<a;l++)i&&r[0]!==r[l]-l&&(i=!1);if(i)for(var u=0,c=this.instance.countSourceRows();u<c;u++)s[u].splice(r[0],t);else{for(var f=0,h=this.instance.countSourceRows();f<h;f++)for(var d=0;d<a;d++)s[f].splice(o[d],1);for(var p=0;p<a;p++)this.priv.columnSettings.splice(r[p],1)}this.instance.runHooks("afterRemoveCol",e,t,r,n),this.instance.forceFullRender=!0}},o.prototype.spliceCol=function(e,t,n){var r=arguments.length>=4?[].slice.call(arguments,3):[],o=this.instance.getDataAtCol(e),i=o.slice(t,t+n),a=o.slice(t+n);(0,f.extendArray)(r,a);for(var s=0;s<n;)r.push(null),s++;return(0,f.to2dArray)(r),this.instance.populateFromArray(t,e,r,null,null,"spliceCol"),i},o.prototype.spliceRow=function(e,t,n){var r=arguments.length>=4?[].slice.call(arguments,3):[],o=this.instance.getSourceDataAtRow(e),i=o.slice(t,t+n),a=o.slice(t+n);(0,f.extendArray)(r,a);for(var s=0;s<n;)r.push(null),s++;return this.instance.populateFromArray(e,t,[r],null,null,"spliceRow"),i},o.prototype.spliceData=function(e,t,n){!1!==this.instance.runHooks("beforeDataSplice",e,t,n)&&this.dataSource.splice(e,t,n)},o.prototype.filterData=function(e,t){var n=this.visualRowsToPhysical(e,t);if(!1!==this.instance.runHooks("beforeDataFilter",e,t,n))return this.dataSource.filter(function(e,t){return-1==n.indexOf(t)})},o.prototype.get=function(e,t){e=this.instance.runHooks("modifyRow",e);var n=this.dataSource[e],r=this.instance.runHooks("modifyRowData",e);n=isNaN(r)?r:n;var o=null;if(n&&n.hasOwnProperty&&(0,c.hasOwnProperty)(n,t))o=n[t];else if("string"==typeof t&&t.indexOf(".")>-1){var i=t.split("."),a=n;if(!a)return null;for(var s=0,l=i.length;s<l;s++)if(void 0===(a=a[i[s]]))return null;o=a}else"function"==typeof t&&(o=t(this.dataSource.slice(e,e+1)[0]));if(this.instance.hasHook("modifyData")){var u=(0,c.createObjectPropListener)(o);this.instance.runHooks("modifyData",e,this.propToCol(t),u,"get"),u.isTouched()&&(o=u.value)}return o};var y=(0,l.cellMethodLookupFactory)("copyable",!1);o.prototype.getCopyable=function(e,t){return y.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},o.prototype.set=function(e,t,n,r){e=this.instance.runHooks("modifyRow",e,r||"datamapGet");var o=this.dataSource[e],i=this.instance.runHooks("modifyRowData",e);if(o=isNaN(i)?i:o,this.instance.hasHook("modifyData")){var a=(0,c.createObjectPropListener)(n);this.instance.runHooks("modifyData",e,this.propToCol(t),a,"set"),a.isTouched()&&(n=a.value)}if(o&&o.hasOwnProperty&&(0,c.hasOwnProperty)(o,t))o[t]=n;else if("string"==typeof t&&t.indexOf(".")>-1){var s=t.split("."),l=o,u=0,f=void 0;for(u=0,f=s.length-1;u<f;u++)void 0===l[s[u]]&&(l[s[u]]={}),l=l[s[u]];l[s[u]]=n}else"function"==typeof t?t(this.dataSource.slice(e,e+1)[0],n):o[t]=n},o.prototype.visualRowsToPhysical=function(e,t){for(var n,r=this.instance.countSourceRows(),o=(r+e)%r,i=[],a=t;o<r&&a;)n=this.instance.runHooks("modifyRow",o),i.push(n),a--,o++;return i},o.prototype.visualColumnsToPhysical=function(e,t){for(var n=this.instance.countCols(),r=(n+e)%n,o=[],i=t;r<n&&i;){o.push(this.instance.runHooks("modifyCol",r)),i--,r++}return o},o.prototype.clear=function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},o.prototype.clearLengthCache=function(){this.cachedLength=null},o.prototype.getLength=function(){var e=this,t=void 0,n=this.instance.getSettings().maxRows;t=n<0||0===n?0:n||1/0;var r=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var o=this.skipCache;this.interval.start(),r!==this.latestSourceRowsCount&&(o=!0),this.latestSourceRowsCount=r,null===this.cachedLength||o?((0,p.rangeEach)(r-1,function(t){null===(t=e.instance.runHooks("modifyRow",t))&&--r}),this.cachedLength=r):r=this.cachedLength}else this.interval.stop();return Math.min(r,t)},o.prototype.getAll=function(){var e={row:0,col:0},t={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row!=0||this.instance.countSourceRows()?this.getRange(e,t,o.prototype.DESTINATION_RENDERER):[]},o.prototype.getRange=function(e,t,n){var r,o,i,a,s,l=[],u=this.instance.getSettings().maxRows,c=this.instance.getSettings().maxCols;if(0===u||0===c)return[];var f=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(o=Math.min(Math.max(u-1,0),Math.max(e.row,t.row)),a=Math.min(Math.max(c-1,0),Math.max(e.col,t.col)),r=Math.min(e.row,t.row);r<=o;r++){s=[];var h=this.instance.runHooks("modifyRow",r);for(i=Math.min(e.col,t.col);i<=a&&null!==h;i++)s.push(f.call(this,r,this.colToProp(i)));null!==h&&l.push(s)}return l},o.prototype.getText=function(e,t){return s.default.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},o.prototype.getCopyableText=function(e,t){return s.default.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))},o.prototype.onSkipLengthCache=function(e){var t=this;this.skipCache=!0,setTimeout(function(){t.skipCache=!1},e)},o.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null},t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10)),e}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.parseDelay=o;var a=n(42);t.default=function(){function e(t,n){var i=this;r(this,e),this.timer=null,this.func=t,this.delay=o(n),this.stopped=!0,this._then=null,this._callback=function(){return i.__callback()}}return i(e,null,[{key:"create",value:function(t,n){return new e(t,n)}}]),i(e,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=(0,a.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,(0,a.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=(0,a.requestAnimationFrame)(this._callback),this.delay){var e=Date.now(),t=e-this._then;t>this.delay&&(this._then=e-t%this.delay,this.func())}else this.func()}}]),e}()},function(e,t,n){"use strict";function r(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==(void 0===e?"undefined":o(e))||"function"==typeof e)}function n(e){return e!==e}var r={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?r.arrayMap[n]:t(n)?r.weakMap.get(n):void 0},set:function(n,o){if(e(n))r.arrayMap[n]=o;else{if(!t(n))throw new Error("Invalid key type");r.weakMap.set(n,o)}},delete:function(n){e(n)?delete r.arrayMap[n]:t(n)&&r.weakMap.delete(n)}}}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=r},function(e,t,n){"use strict";function r(e,t,n){function r(e){n.setSelectedHeaders(!1,!1,!1);var r="function"==typeof t.settings.enterMoves?t.settings.enterMoves(event):t.settings.enterMoves;e?n.transformStart(-r.row,-r.col):n.transformStart(r.row,r.col,!0)}function l(e){e?(n.selectedHeader.cols&&n.setSelectedHeaders(n.selectedHeader.rows,!1,!1),n.transformEnd(-1,0)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(-1,0))}function f(e){e?n.transformEnd(1,0):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(1,0))}function h(e){e?n.transformEnd(0,1):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,1))}function d(e){e?(n.selectedHeader.rows&&n.setSelectedHeaders(!1,n.selectedHeader.cols,!1),n.transformEnd(0,-1)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,-1))}function p(s){var u,p;if(e.isListening()&&(e.runHooks("beforeKeyDown",s),!y&&!(0,a.isImmediatePropagationStopped)(s)&&(t.lastKeyCode=s.keyCode,n.isSelected()))){if(u=(s.ctrlKey||s.metaKey)&&!s.altKey,v&&!v.isWaiting()&&!((0,i.isMetaKey)(s.keyCode)||(0,i.isCtrlKey)(s.keyCode)||u||m.isEditorOpened()))return void m.openEditor("",s);switch(p=s.shiftKey?n.setRangeEnd:n.setRangeStart,s.keyCode){case i.KEY_CODES.A:!m.isEditorOpened()&&u&&(n.selectAll(),s.preventDefault(),(0,a.stopPropagation)(s));break;case i.KEY_CODES.ARROW_UP:m.isEditorOpened()&&!v.isWaiting()&&m.closeEditorAndSaveChanges(u),l(s.shiftKey),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_DOWN:m.isEditorOpened()&&!v.isWaiting()&&m.closeEditorAndSaveChanges(u),f(s.shiftKey),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_RIGHT:m.isEditorOpened()&&!v.isWaiting()&&m.closeEditorAndSaveChanges(u),h(s.shiftKey),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.ARROW_LEFT:m.isEditorOpened()&&!v.isWaiting()&&m.closeEditorAndSaveChanges(u),d(s.shiftKey),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.TAB:n.setSelectedHeaders(!1,!1,!1);var g="function"==typeof t.settings.tabMoves?t.settings.tabMoves(s):t.settings.tabMoves;s.shiftKey?n.transformStart(-g.row,-g.col):n.transformStart(g.row,g.col,!0),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.BACKSPACE:case i.KEY_CODES.DELETE:n.empty(s),m.prepareEditor(),s.preventDefault();break;case i.KEY_CODES.F2:m.openEditor(null,s),v&&v.enableFullEditMode(),s.preventDefault();break;case i.KEY_CODES.ENTER:m.isEditorOpened()?(v&&v.state!==c.EditorState.WAITING&&m.closeEditorAndSaveChanges(u),r(s.shiftKey)):e.getSettings().enterBeginsEditing?(m.openEditor(null,s),v&&v.enableFullEditMode()):r(s.shiftKey),s.preventDefault(),(0,a.stopImmediatePropagation)(s);break;case i.KEY_CODES.ESCAPE:m.isEditorOpened()&&m.closeEditorAndRestoreOriginalValue(u),s.preventDefault();break;case i.KEY_CODES.HOME:n.setSelectedHeaders(!1,!1,!1),p(s.ctrlKey||s.metaKey?new o.CellCoords(0,t.selRange.from.col):new o.CellCoords(t.selRange.from.row,0)),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.END:n.setSelectedHeaders(!1,!1,!1),p(s.ctrlKey||s.metaKey?new o.CellCoords(e.countRows()-1,t.selRange.from.col):new o.CellCoords(t.selRange.from.row,e.countCols()-1)),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.PAGE_UP:n.setSelectedHeaders(!1,!1,!1),n.transformStart(-e.countVisibleRows(),0),s.preventDefault(),(0,a.stopPropagation)(s);break;case i.KEY_CODES.PAGE_DOWN:n.setSelectedHeaders(!1,!1,!1),n.transformStart(e.countVisibleRows(),0),s.preventDefault(),(0,a.stopPropagation)(s)}}}var g,v,m=this,y=!1;g=new u.default(e),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return v},this.prepareEditor=function(){var n,r,o,i,a,l,u;if(v&&v.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&m.prepareEditor()});n=t.selRange.highlight.row,r=t.selRange.highlight.col,o=e.colToProp(r),i=e.getCell(n,r),a=e.getSourceDataAtCell(e.runHooks("modifyRow",n),r),l=e.getCellMeta(n,r),u=e.getCellEditor(l),u?(v=(0,s.getEditorInstance)(u,e),v.prepare(n,r,o,i,a,l)):v=void 0},this.isEditorOpened=function(){return v&&v.isOpened()},this.openEditor=function(e,t){v&&!v.cellProperties.readOnly?v.beginEditing(e,t):v&&v.cellProperties.readOnly&&t&&t.keyCode===i.KEY_CODES.ENTER&&r()},this.closeEditor=function(e,t,n){v?v.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},function(){function t(e,t,n){"TD"==n.nodeName&&(m.openEditor(),v&&v.enableFullEditMode())}e.addHook("afterDocumentKeyDown",p),g.addEventListener(document.documentElement,"keydown",function(t){y||e.runHooks("afterDocumentKeyDown",t)}),e.view.wt.update("onCellDblClick",t),e.addHook("afterDestroy",function(){y=!0})}()}t.__esModule=!0;var o=n(15),i=n(18),a=n(10),s=n(19),l=n(7),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(52);t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=this,n=this;this.eventManager=new u.default(e),this.instance=e,this.settings=e.getSettings(),this.selectionMouseDown=!1;var r=e.rootElement.getAttribute("style");r&&e.rootElement.setAttribute("data-originalstyle",r),(0,a.addClass)(e.rootElement,"handsontable");var o=document.createElement("TABLE");(0,a.addClass)(o,"htCore"),e.getSettings().tableClassName&&(0,a.addClass)(o,e.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),o.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),o.appendChild(this.TBODY),e.table=o,e.container.insertBefore(o,e.container.firstChild),this.eventManager.addEventListener(e.rootElement,"mousedown",function(e){this.selectionMouseDown=!0,n.isTextSelectionAllowed(e.target)||(l(),e.preventDefault(),window.focus())}),this.eventManager.addEventListener(e.rootElement,"mouseup",function(e){this.selectionMouseDown=!1}),this.eventManager.addEventListener(e.rootElement,"mousemove",function(e){this.selectionMouseDown&&!n.isTextSelectionAllowed(e.target)&&(l(),e.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(t){e.selection.isInProgress()&&!t.shiftKey&&e.selection.finish()});var i;this.isMouseDown=function(){return i},this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){e.selection.isInProgress()&&1===t.which&&e.selection.finish(),i=!1,!(0,a.isOutsideInput)(document.activeElement)&&e.selection.isSelected()||e.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){var r=t.target,o=t.target,s=t.x||t.clientX,l=t.y||t.clientY;if(!i&&e.rootElement){if(o===e.view.wt.wtTable.holder){var u=(0,a.getScrollbarWidth)();if(document.elementFromPoint(s+u,l)!==e.view.wt.wtTable.holder||document.elementFromPoint(s,l+u)!==e.view.wt.wtTable.holder)return}else for(;o!==document.documentElement;){if(null===o){if(t.isTargetWebComponent)break;return}if(o===e.rootElement)return;o=o.parentNode}("function"==typeof n.settings.outsideClickDeselects?n.settings.outsideClickDeselects(r):n.settings.outsideClickDeselects)?e.deselectCell():e.destroyEditor()}}),this.eventManager.addEventListener(o,"selectstart",function(e){n.settings.fragmentSelection||(0,a.isInput)(e.target)||e.preventDefault()});var l=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},d=[new f.Selection({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!e.selection.isMultiple()}}}),new f.Selection({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&e.selection.isMultiple()}}}),new f.Selection({className:"highlight",highlightHeaderClassName:n.settings.currentHeaderClassName,highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new f.Selection({className:"fill",border:{width:1,color:"red"}})];d.current=d[0],d.area=d[1],d.highlight=d[2],d.fill=d[3];var p={debug:function(){return n.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:o,preventOverflow:function(){return t.settings.preventOverflow},stretchH:function(){return n.settings.stretchH},data:e.getDataAtCell,totalRows:function(){return e.countRows()},totalColumns:function(){return e.countCols()},fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},fixedRowsBottom:function(){return n.settings.fixedRowsBottom},minSpareRows:function(){return n.settings.minSpareRows},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var t=[];return e.hasRowHeaders()&&t.push(function(e,t){n.appendRowHeader(e,t)}),e.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.hasColHeaders()&&t.push(function(e,t){n.appendColHeader(e,t)}),e.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(e,t,r){var o=n.instance.getCellMeta(e,t),i=n.instance.colToProp(t),a=n.instance.getDataAtRowProp(e,i);n.instance.hasHook("beforeValueRender")&&(a=n.instance.runHooks("beforeValueRender",a)),n.instance.runHooks("beforeRenderer",r,e,t,i,a,o),n.instance.getCellRenderer(o)(n.instance,r,e,t,i,a,o),n.instance.runHooks("afterRenderer",r,e,t,i,a,o)},selections:d,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(t,r,o,a){var s={row:!1,column:!1,cells:!1};if(e.listen(),n.activeWt=a,i=!0,e.runHooks("beforeOnCellMouseDown",t,r,o,s),!(0,c.isImmediatePropagationStopped)(t)){var l=e.getSelectedRange(),u=e.selection,h=u.selectedHeader;if(t.shiftKey&&l)r.row>=0&&r.col>=0&&!s.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(r)):(h.cols||h.rows)&&r.row>=0&&r.col>=0&&!s.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(new f.CellCoords(r.row,r.col))):h.cols&&r.row<0&&!s.column?u.setRangeEnd(new f.CellCoords(l.to.row,r.col)):h.rows&&r.col<0&&!s.row?u.setRangeEnd(new f.CellCoords(r.row,l.to.col)):(!h.cols&&!h.rows&&r.col<0||h.cols&&r.col<0)&&!s.row?(u.setSelectedHeaders(!0,!1),u.setRangeStartOnly(new f.CellCoords(l.from.row,0)),u.setRangeEnd(new f.CellCoords(r.row,e.countCols()-1))):(!h.cols&&!h.rows&&r.row<0||h.rows&&r.row<0)&&!s.column&&(u.setSelectedHeaders(!1,!0),u.setRangeStartOnly(new f.CellCoords(0,l.from.col)),u.setRangeEnd(new f.CellCoords(e.countRows()-1,r.col)));else{var d=!0;if(l){var p=l.from,g=l.to,v=!u.inInSelection(r);if(r.row<0&&h.cols){var m=Math.min(p.col,g.col),y=Math.max(p.col,g.col);d=r.col<m||r.col>y}else if(r.col<0&&h.rows){var w=Math.min(p.row,g.row),b=Math.max(p.row,g.row);d=r.row<w||r.row>b}else d=v}var C=(0,c.isRightClick)(t),E=(0,c.isLeftClick)(t)||"touchstart"===t.type;r.row<0&&r.col>=0&&!s.column?(u.setSelectedHeaders(!1,!0),(E||C&&d)&&(u.setRangeStartOnly(new f.CellCoords(0,r.col)),u.setRangeEnd(new f.CellCoords(Math.max(e.countRows()-1,0),r.col),!1))):r.col<0&&r.row>=0&&!s.row?(u.setSelectedHeaders(!0,!1),(E||C&&d)&&(u.setRangeStartOnly(new f.CellCoords(r.row,0)),u.setRangeEnd(new f.CellCoords(r.row,Math.max(e.countCols()-1,0)),!1))):r.col>=0&&r.row>=0&&!s.cells?(E||C&&d)&&(u.setSelectedHeaders(!1,!1),u.setRangeStart(r)):r.col<0&&r.row<0&&(r.row=0,r.col=0,u.setSelectedHeaders(!1,!1,!0),u.setRangeStart(r))}e.runHooks("afterOnCellMouseDown",t,r,o),n.activeWt=n.wt}},onCellMouseOut:function(t,r,o,i){n.activeWt=i,e.runHooks("beforeOnCellMouseOut",t,r,o),(0,c.isImmediatePropagationStopped)(t)||(e.runHooks("afterOnCellMouseOut",t,r,o),n.activeWt=n.wt)},onCellMouseOver:function(t,r,o,a){var s={row:!1,column:!1,cell:!1};n.activeWt=a,e.runHooks("beforeOnCellMouseOver",t,r,o,s),(0,c.isImmediatePropagationStopped)(t)||(0===t.button&&i&&(e.selection.selectedHeader.cols&&!s.column?e.selection.setRangeEnd(new f.CellCoords(e.countRows()-1,r.col),!1):e.selection.selectedHeader.rows&&!s.row?e.selection.setRangeEnd(new f.CellCoords(r.row,e.countCols()-1),!1):s.cell||e.selection.setRangeEnd(r)),e.runHooks("afterOnCellMouseOver",t,r,o),n.activeWt=n.wt)},onCellMouseUp:function(t,r,o,i){n.activeWt=i,e.runHooks("beforeOnCellMouseUp",t,r,o),e.runHooks("afterOnCellMouseUp",t,r,o),n.activeWt=n.wt},onCellCornerMouseDown:function(t){t.preventDefault(),e.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(e,t){n.beforeRender(e,t)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,n){e.runHooks("beforeDrawBorders",t,n)},onBeforeTouchScroll:function(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){e.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){return e.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:function(t){return e.runHooks("modifyRowHeaderWidth",t)},viewportRowCalculatorOverride:function(t){var r=e.countRows(),o=n.settings.viewportRowRenderingOffset;if("auto"===o&&n.settings.fixedRowsTop&&(o=10),"number"==typeof o&&(t.startRow=Math.max(t.startRow-o,0),t.endRow=Math.min(t.endRow+o,r-1)),"auto"===o){var i=t.startRow+t.endRow-t.startRow,a=Math.ceil(i/r*12);t.startRow=Math.max(t.startRow-a,0),t.endRow=Math.min(t.endRow+a,r-1)}e.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var r=e.countCols(),o=n.settings.viewportColumnRenderingOffset;if("auto"===o&&n.settings.fixedColumnsLeft&&(o=10),"number"==typeof o&&(t.startColumn=Math.max(t.startColumn-o,0),t.endColumn=Math.min(t.endColumn+o,r-1)),"auto"===o){var i=t.startColumn+t.endColumn-t.startColumn,a=Math.ceil(i/r*12);t.startRow=Math.max(t.startColumn-a,0),t.endColumn=Math.min(t.endColumn+a,r-1)}e.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return n.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.runHooks("modifyColumnHeaderHeight");return n.settings.columnHeaderHeight||t}};e.runHooks("beforeInitWalkontable",p),this.wt=new h.default(p),this.activeWt=this.wt,(0,s.isChrome)()||(0,s.isSafari)()||this.eventManager.addEventListener(e.rootElement,"wheel",function(e){e.preventDefault();var t=parseInt((0,a.getComputedStyle)(document.body)["font-size"],10),r=n.wt.wtOverlays.scrollableElement,o=e.wheelDeltaY||e.deltaY,i=e.wheelDeltaX||e.deltaX;switch(e.deltaMode){case 0:r.scrollLeft+=i,r.scrollTop+=o;break;case 1:r.scrollLeft+=i*t,r.scrollTop+=o*t}}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&(0,c.stopPropagation)(e)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&(0,c.stopPropagation)(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})}t.__esModule=!0;var i=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(1),s=n(33),l=n(7),u=r(l),c=n(10),f=n(15),h=r(f);o.prototype.isTextSelectionAllowed=function(e){if((0,a.isInput)(e))return!0;var t=(0,a.isChildOf)(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))},o.prototype.isSelectedOnlyCell=function(){var e=this.instance.getSelected()||[],t=i(e,4),n=t[0],r=t[1],o=t[2],a=t[3];return void 0!==n&&n===o&&r===a},o.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},o.prototype.beforeRender=function(e,t){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)},o.prototype.onDraw=function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)},o.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},o.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n},o.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},o.prototype.appendRowHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!(0,a.hasClass)(n,"relative"))return(0,a.empty)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=document.createElement("div"),o=document.createElement("span");r.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,this.instance.getRowHeader),r.appendChild(o),t.appendChild(r)}this.instance.runHooks("afterGetRowHeader",e,t)},o.prototype.appendColHeader=function(e,t){if(t.firstChild){var n=t.firstChild;(0,a.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):((0,a.empty)(t),this.appendColHeader(e,t))}else{var r=document.createElement("div"),o=document.createElement("span");r.className="relative",o.className="colHeader",this.updateCellHeader(o,e,this.instance.getColHeader),r.appendChild(o),t.appendChild(r)}this.instance.runHooks("afterGetColHeader",e,t)},o.prototype.updateCellHeader=function(e,t,n){var r=t,o=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&((0,a.hasClass)(e,"colHeader")?r=o.wtTable.columnFilter.sourceToRendered(t):(0,a.hasClass)(e,"rowHeader")&&(r=o.wtTable.rowFilter.sourceToRendered(t))),r>-1?(0,a.fastInnerHTML)(e,n(t)):((0,a.fastInnerText)(e,String.fromCharCode(160)),(0,a.addClass)(e,"cornerHeader"))},o.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0},o.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0},o.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},o.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()},t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(0),s=n(4);t.default=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return o(e,[{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data;return e&&(t=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),t}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return(0,a.arrayEach)(this.data,function(r){var o=t.colToProp(e);r="string"==typeof o?(0,i.getProperty)(r,o):r[o],n.push(r)}),n}},{key:"getAtRow",value:function(e){return this.data[e]}},{key:"getAtCell",value:function(e,t){var n=null,r=this.hot.runHooks("modifyRowData",e),o=isNaN(r)?r:this.data[e];if(o){var a=this.colToProp(t);n="string"==typeof a?(0,i.getProperty)(o,a):"function"==typeof a?a(this.data.slice(e,e+1)[0]):o[a]}return n}},{key:"getByRange",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Math.min(e.row,t.row),i=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col),u=[];return(0,s.rangeEach)(o,a,function(e){var t=n.getAtRow(e),o=void 0;"array"===n.dataType?o=t.slice(i,l+1):"object"===n.dataType&&(o=r?[]:{},(0,s.rangeEach)(i,l,function(e){var i=n.colToProp(e);r?o.push(t[i]):o[i]=t[i]})),u.push(o)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var e=0;return Array.isArray(this.data)&&("array"===this.dataType?e=this.data[0].length:"object"===this.dataType&&(e=Object.keys(this.data[0]).length)),e}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}()},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0;var o,i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i);t.default=(o={languageCode:"en-US"},r(o,a.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),r(o,a.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),r(o,a.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),r(o,a.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),r(o,a.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),r(o,a.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),r(o,a.CONTEXTMENU_ITEMS_UNDO,"Undo"),r(o,a.CONTEXTMENU_ITEMS_REDO,"Redo"),r(o,a.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),r(o,a.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),r(o,a.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),r(o,a.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),r(o,a.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),r(o,a.CONTEXTMENU_ITEMS_BORDERS,"Borders"),r(o,a.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),r(o,a.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),r(o,a.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),r(o,a.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),r(o,a.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),r(o,a.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),r(o,a.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),r(o,a.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),r(o,a.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),r(o,a.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),r(o,a.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),r(o,a.CONTEXTMENU_ITEMS_COPY,"Copy"),r(o,a.CONTEXTMENU_ITEMS_CUT,"Cut"),r(o,a.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),r(o,a.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),r(o,a.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),r(o,a.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),r(o,a.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),r(o,a.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),r(o,a.FILTERS_CONDITIONS_NONE,"None"),r(o,a.FILTERS_CONDITIONS_EMPTY,"Is empty"),r(o,a.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),r(o,a.FILTERS_CONDITIONS_EQUAL,"Is equal to"),r(o,a.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),r(o,a.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),r(o,a.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),r(o,a.FILTERS_CONDITIONS_CONTAINS,"Contains"),r(o,a.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),r(o,a.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),r(o,a.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),r(o,a.FILTERS_CONDITIONS_LESS_THAN,"Less than"),r(o,a.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),r(o,a.FILTERS_CONDITIONS_BETWEEN,"Is between"),r(o,a.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),r(o,a.FILTERS_CONDITIONS_AFTER,"After"),r(o,a.FILTERS_CONDITIONS_BEFORE,"Before"),r(o,a.FILTERS_CONDITIONS_TODAY,"Today"),r(o,a.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),r(o,a.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),r(o,a.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),r(o,a.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),r(o,a.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),r(o,a.FILTERS_LABELS_CONJUNCTION,"And"),r(o,a.FILTERS_LABELS_DISJUNCTION,"Or"),r(o,a.FILTERS_BUTTONS_SELECT_ALL,"Select all"),r(o,a.FILTERS_BUTTONS_CLEAR,"Clear"),r(o,a.FILTERS_BUTTONS_OK,"OK"),r(o,a.FILTERS_BUTTONS_CANCEL,"Cancel"),r(o,a.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),r(o,a.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),r(o,a.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){f(e,t)}function i(){return h()}t.__esModule=!0,t.getPhraseFormatters=t.registerPhraseFormatter=void 0,t.register=o,t.getAll=i;var a=n(51),s=r(a),l=n(412),u=r(l),c=(0,s.default)("phraseFormatters"),f=c.register,h=c.getValues;t.registerPhraseFormatter=o,t.getPhraseFormatters=i,o("pluralize",u.default)},function(e,t,n){"use strict";function r(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n=this.first(),r=n.data("handsontable");if("string"!=typeof t){var o=t||{};return r?r.updateSettings(o):(r=new e.Core(n[0],o),n.data("handsontable",r),r.init()),n}var i=[],a=void 0;if(arguments.length>1)for(var s=1,l=arguments.length;s<l;s++)i.push(arguments[s]);if(r){if(void 0===r[t])throw new Error("Handsontable do not provide action: "+t);a=r[t].apply(r,i),"destroy"===t&&n.removeData()}return a})}t.__esModule=!0,t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.Base=t.UndoRedo=t.TouchScroll=t.Search=t.PersistentState=t.ObserveChanges=t.MultipleSelectionHandles=t.MergeCells=t.ManualRowResize=t.ManualRowMove=t.ManualColumnResize=t.ManualColumnMove=t.ManualColumnFreeze=t.DragToScroll=t.CustomBorders=t.CopyPaste=t.ContextMenu=t.Comments=t.ColumnSorting=t.AutoRowSize=t.AutoFill=t.AutoColumnSize=void 0;var o=n(415),i=r(o),a=n(416),s=r(a),l=n(418),u=r(l),c=n(419),f=r(c),h=n(422),d=r(h),p=n(426),g=r(p),v=n(440),m=r(v),y=n(447),w=r(y),b=n(448),C=r(b),E=n(449),O=r(E),_=n(453),S=r(_),T=n(458),R=r(T),M=n(459),N=r(M),k=n(464),A=r(k),I=n(465),D=r(I),P=n(466),x=r(P),L=n(467),H=r(L),j=n(470),V=r(j),F=n(471),B=r(F),U=n(472),W=r(U),Y=n(473),$=r(Y),G=n(8),z=r(G);t.AutoColumnSize=i.default,t.AutoFill=s.default,t.AutoRowSize=u.default,t.ColumnSorting=f.default,t.Comments=d.default,t.ContextMenu=g.default,t.CopyPaste=m.default,t.CustomBorders=w.default,t.DragToScroll=C.default,t.ManualColumnFreeze=O.default,t.ManualColumnMove=S.default,t.ManualColumnResize=R.default,t.ManualRowMove=N.default,t.ManualRowResize=A.default,t.MergeCells=D.default,t.MultipleSelectionHandles=x.default,t.ObserveChanges=H.default,t.PersistentState=V.default,t.Search=B.default,t.TouchScroll=W.default,t.UndoRedo=$.default,t.Base=z.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(8),f=r(c),h=n(0),d=n(42),p=n(1),g=n(155),v=r(g),m=n(2),y=n(4),w=n(6),b=n(323),C=r(b),E=n(30),O=n(15),_=new WeakMap,S=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return _.set(n,{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new v.default(n.hot),n.samplesGenerator=new C.default(function(e,t){return n.hot.getDataAtCell(e,t)}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",function(e,t,r){return n.onBeforeColumnResize(e,t,r)}),n}return a(t,e),u(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),u(t,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings().autoColumnSize;n&&null!=n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("beforeChange",function(t){return e.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return e.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,n){return e.getColumnWidth(n,t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&this.clearCache(e),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"number"==typeof e&&(e={from:e,to:e}),"number"==typeof n&&(n={from:n,to:n}),(0,y.rangeEach)(e.from,e.to,function(e){if(r||void 0===t.widths[e]&&!t.hot._getColWidthFromSettings(e)){t.samplesGenerator.generateColumnSamples(e,n).forEach(function(e,n){return t.ghostTable.addColumn(n,e)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(e,n){t.widths[e]=n}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,r=this.getSyncCalculationLimit()+1),r<o?function a(){if(!e.hot)return(0,d.cancelAnimationFrame)(i),void(e.inProgress=!1);e.calculateColumnsWidth({from:r,to:Math.min(r+t.CALCULATION_STEP,o)},n),r=r+t.CALCULATION_STEP+1,r<o?i=(0,d.requestAnimationFrame)(a):((0,d.cancelAnimationFrame)(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&(0,m.hasOwnProperty)(e,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=e&&(0,m.hasOwnProperty)(e,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&(0,p.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=t.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return(0,m.isObject)(this.hot.getSettings().autoColumnSize)&&(e=this.hot.getSettings().autoColumnSize.syncLimit,(0,E.isPercentValue)(e)?e=(0,y.valueAccordingPercent)(n,e):e>>=0),Math.min(e,n)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.widths[e],n&&"number"==typeof r&&(r=Math.max(r,O.ViewportColumnsCalculator.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view.wt;return e.wtViewport.columnsVisibleCalculator?e.wtTable.getFirstVisibleColumn():e.wtViewport.columnsRenderCalculator?e.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view.wt;return e.wtViewport.columnsVisibleCalculator?e.wtTable.getLastVisibleColumn():e.wtViewport.columnsRenderCalculator?e.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=_.get(this),n=t.cachedColumnHeaders;return(0,h.arrayReduce)(e,function(e,t,r){var o=n.length;return(o-1<r||n[r]!==t)&&e.push(r),o-1<r?n.push(t):n[r]=t,e},[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?(0,h.arrayEach)(t,function(t){e.widths[t]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!(0,h.arrayFilter)(this.widths,function(e){return void 0===e}).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,e),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){e.hot&&e.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(e){var t=this;this.clearCache((0,h.arrayMap)(e,function(e){var n=s(e,2);return t.hot.propToCol(n[1])}))}},{key:"onBeforeColumnResize",value:function(e,t,n){return n&&(this.calculateColumnsWidth(e,void 0,!0),t=this.getColumnWidth(e,void 0,!1)),t}},{key:"onAfterInit",value:function(){_.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);(0,w.registerPlugin)("autoColumnSize",S),t.default=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(12),h=r(f),d=n(1),p=n(7),g=r(p),v=n(6),m=n(15),y=n(417);h.default.getSingleton().register("modifyAutofillRange"),h.default.getSingleton().register("beforeAutofill");var w=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new g.default(n),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(t){return e.onAfterCellCornerMouseDown(t)}),this.addHook("afterOnCellCornerDblClick",function(t){return e.onCellCornerDblClick(t)}),this.addHook("beforeOnCellMouseOver",function(t,n,r){return e.onBeforeCellMouseOver(n)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e={from:this.hot.getSelectedRange().from,to:this.hot.getSelectedRange().to};return this.hot.getData(e.from.row,e.from.col,e.to.row,e.to.col)}},{key:"fillIn",value:function(){if(this.hot.view.wt.selections.fill.isEmpty())return!1;var e=this.hot.view.wt.selections.fill.getCorners();this.resetSelectionOfDraggedArea();var t=this.getCornersOfSelectedCells(),n=(0,y.getDragDirectionAndRange)(t,e),r=n.directionOfDrag,o=n.startOfDragCoords,i=n.endOfDragCoords;if(this.hot.runHooks("modifyAutofillRange",t,e),o&&o.row>-1&&o.col>-1){var a=this.getSelectionData(),s=(0,y.getDeltas)(o,i,a,r),l=a;if(this.hot.runHooks("beforeAutofill",o,i,a),["up","left"].indexOf(r)>-1){l=[];var u=null,c=null;if("up"===r){u=i.row-o.row+1,c=u%a.length;for(var f=0;f<u;f++)l.push(a[(f+(a.length-c))%a.length])}else{u=i.col-o.col+1,c=u%a[0].length;for(var h=0;h<a.length;h++){l.push([]);for(var d=0;d<u;d++)l[h].push(a[h][(d+(a[h].length-c))%a[h].length])}}}this.hot.populateFromArray(o.row,o.col,l,i.row,i.col,this.pluginName+".fill",null,r,s),this.setSelection(e)}else this.hot.selection.refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRange().getTopLeftCorner(),n=this.hot.getSelectedRange().getBottomRightCorner(),r=void 0;if(this.directions.includes(y.DIRECTIONS.vertical)&&(n.row<e.row||t.row>e.row))r=new m.CellCoords(e.row,n.col);else{if(!this.directions.includes(y.DIRECTIONS.horizontal))return;r=new m.CellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.alter("insert_row",void 0,1,e.pluginName+".fill"),e.addingStarted=!1},200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelected(),t=this.hot.view.wt.selections.fill.getCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.view.wt.selections.area.getCorners():this.hot.view.wt.selections.current.getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t=this.hot.getData(),n=this.hot.countRows(),r=void 0,o=e[2]+1;o<n;o++){for(var i=e[1];i<=e[3];i++){if(t[o][i])return-1}var a=t[o][e[1]-1],s=t[o][e[3]+1];(a||s)&&(r=o)}return r}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(new m.CellCoords(e[0],e[1])),this.hot.view.wt.selections.fill.add(new m.CellCoords(t,e[3]))}},{key:"setSelection",value:function(e){this.hot.selection.setRangeStart(new m.CellCoords(e[0],e[1])),this.hot.selection.setRangeEnd(new m.CellCoords(e[2],e[3]))}},{key:"selectAdjacent",value:function(){var e=this.getCornersOfSelectedCells(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.view.wt.selections.fill.clear()}},{key:"redrawBorders",value:function(e){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to),this.hot.view.wt.selections.fill.add(e),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=(0,d.offset)(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+(0,d.outerHeight)(this.hot.table),n=(0,d.offset)(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+(0,d.outerWidth)(this.hot.table);return e.clientY>t&&e.clientX<=n}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)})}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=(0,y.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,v.registerPlugin)("autofill",w),t.default=w},function(e,t,n){"use strict";function r(e,t,n,r){var o=n.length,i=n?n[0].length:0,a=[],s=t.row-e.row,l=t.col-e.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<=l;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10);u.push(("down"===r?h-f:f-h)/(o-1)||0)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var d=0;d<=s;d++){var p=parseInt(n[d][0],10),g=parseInt(n[d][i-1],10),v=("right"===r?g-p:p-g)/(i-1)||0;a.push([v])}return a}function o(e,t){var n=void 0,r=void 0,o=void 0;return t[0]===e[0]&&t[1]<e[1]?(o="left",n=new l.CellCoords(t[0],t[1]),r=new l.CellCoords(t[2],e[1]-1)):t[0]===e[0]&&t[3]>e[3]?(o="right",n=new l.CellCoords(t[0],e[3]+1),r=new l.CellCoords(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=new l.CellCoords(t[0],t[1]),r=new l.CellCoords(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=new l.CellCoords(e[2]+1,t[1]),r=new l.CellCoords(t[2],t[3])),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:r}}function i(e){var t={};return!0===e?(t.directions=Object.keys(u),t.autoInsertRow=!0):(0,a.isObject)(e)?(t.autoInsertRow=!!(0,s.isDefined)(e.autoInsertRow)&&(e.direction!==u.horizontal&&e.autoInsertRow),t.directions=(0,s.isDefined)(e.direction)?[e.direction]:Object.keys(u)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}t.__esModule=!0,t.DIRECTIONS=void 0,t.getDeltas=r,t.getDragDirectionAndRange=o,t.getMappedFillHandleSetting=i;var a=n(2),s=n(16),l=n(15),u=t.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(8),c=r(u),f=n(0),h=n(42),d=n(1),p=n(155),g=r(p),v=n(2),m=n(4),y=n(6),w=n(323),b=r(w),C=n(30),E=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.heights=[],n.ghostTable=new g.default(n.hot),n.samplesGenerator=new b.default(function(e,t){return e>=0?n.hot.getDataAtCell(e,t):-1===e?n.hot.getColHeader(t):null}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",function(e,t,r){return n.onBeforeRowResize(e,t,r)}),n}return a(t,e),l(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),l(t,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||(0,v.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("beforeChange",function(t){return e.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return e.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return e.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return e.clearCache()}),this.addHook("beforeRender",function(t){return e.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,n){return e.onBeforeRowMove(t,n)}),this.addHook("modifyRowHeight",function(t,n){return e.getRowHeight(n,t)}),this.addHook("modifyColumnHeaderHeight",function(){return e.getColumnHeaderHeight()}),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e&&(e={from:e,to:e}),"number"==typeof n&&(n={from:n,to:n}),null!==this.hot.getColHeader(0)){this.ghostTable.addColumnHeadersRow(this.samplesGenerator.generateRowSamples(-1,n).get(-1))}(0,m.rangeEach)(e.from,e.to,function(e){if(r||void 0===t.heights[e]){t.samplesGenerator.generateRowSamples(e,n).forEach(function(e,n){t.ghostTable.addRow(n,e)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(e,n){t.heights[e]=n}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},n),this.firstCalculation=!1,r=this.getSyncCalculationLimit()+1),r<o?function a(){if(!e.hot)return(0,h.cancelAnimationFrame)(i),void(e.inProgress=!1);e.calculateRowsHeight({from:r,to:Math.min(r+t.CALCULATION_STEP,o)},n),r=r+t.CALCULATION_STEP+1,r<o?i=(0,h.requestAnimationFrame)(a):((0,h.cancelAnimationFrame)(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&(0,v.hasOwnProperty)(e,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=e&&(0,v.hasOwnProperty)(e,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){(0,d.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=t.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return(0,v.isObject)(this.hot.getSettings().autoRowSize)&&(e=this.hot.getSettings().autoRowSize.syncLimit,(0,C.isPercentValue)(e)?e=(0,m.valueAccordingPercent)(n,e):e>>=0),Math.min(e,n)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=t;return void 0!==this.heights[e]&&this.heights[e]>(t||0)&&(n=this.heights[e]),n}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(e){var t=this;"number"==typeof e&&(e={from:e,to:e}),(0,m.rangeEach)(Math.min(e.from,e.to),Math.max(e.from,e.to),function(e){t.heights[e]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!(0,f.arrayFilter)(this.heights,function(e){return void 0===e}).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,e);var t=this.hot.getSettings().fixedRowsBottom;if(t){var n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-t,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){return n&&(this.calculateRowsHeight(e,void 0,!0),t=this.getRowHeight(e)),t}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){e.hot&&e.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,y.registerPlugin)("autoRowSize",E),t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=n(21),h=r(f),d=n(1),p=n(0),g=n(16),v=n(2),m=n(8),y=r(m),w=n(6),b=n(420),C=r(b),E=n(12),O=r(E);O.default.getSingleton().register("beforeColumnSort"),O.default.getSingleton().register("afterColumnSort");var _=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sortIndicators=[],n.lastSortedColumn=null,n.sortEmptyCells=!1,n}return s(t,e),u(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSorting}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.setPluginOptions();var n=this;this.hot.sortIndex=[],this.hot.sort=function(){var e=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(n,o(e))},void 0===this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(t){return e.sort()}),this.addHook("afterUntrimRow",function(t){return e.sort()}),this.addHook("modifyRow",function(t){return e.translateRow(t)}),this.addHook("unmodifyRow",function(t){return e.untranslateRow(t)}),this.addHook("afterUpdateSettings",function(){return e.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(t,n){return e.getColHeader(t,n)}),this.addHook("afterOnCellMouseDown",function(t,n){return e.onAfterOnCellMouseDown(t,n)}),this.addHook("afterCreateRow",function(){n.afterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){n.afterRemoveRow.apply(n,arguments)}),this.addHook("afterInit",function(){return e.sortBySettings()}),this.addHook("afterLoadData",function(){e.hot.sortIndex=[],e.hot.view&&e.sortBySettings()}),this.hot.view&&this.sortBySettings(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.sort=void 0,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onAfterUpdateSettings",value:function(){this.sortBySettings()}},{key:"sortBySettings",value:function(){var e=this.hot.getSettings().columnSorting,t=this.loadSortingState(),n=void 0,r=void 0;void 0===t?(n=e.column,r=e.sortOrder):(n=t.sortColumn,r=t.sortOrder),"number"==typeof n&&(this.lastSortedColumn=n,this.sortByColumn(n,r))}},{key:"setSortingColumn",value:function(e,t){if(void 0===e)return this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0);this.hot.sortOrder=this.hot.sortColumn===e&&void 0===t?!1===this.hot.sortOrder?void 0:!this.hot.sortOrder:void 0===t||t,this.hot.sortColumn=e}},{key:"sortByColumn",value:function(e,t){if(this.setSortingColumn(e,t),void 0!==this.hot.sortColumn){!1!==this.hot.runHooks("beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder)&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),this.hot.runHooks("afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState()}}},{key:"saveSortingState",value:function(){var e={};void 0!==this.hot.sortColumn&&(e.sortColumn=this.hot.sortColumn),void 0!==this.hot.sortOrder&&(e.sortOrder=this.hot.sortOrder),((0,v.hasOwnProperty)(e,"sortColumn")||(0,v.hasOwnProperty)(e,"sortOrder"))&&this.hot.runHooks("persistentStateSave","columnSorting",e)}},{key:"loadSortingState",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","columnSorting",e),e.value}},{key:"updateOrderClass",value:function(){var e=void 0;!0===this.hot.sortOrder?e="ascending":!1===this.hot.sortOrder&&(e="descending"),this.sortOrderClass=e}},{key:"enableObserveChangesPlugin",value:function(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.updateSettings({observeChanges:!0})},0))}},{key:"defaultSort",value:function(e,t){return function(n,r){return"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),"string"==typeof r[1]&&(r[1]=r[1].toLowerCase()),n[1]===r[1]?0:(0,g.isEmpty)(n[1])?(0,g.isEmpty)(r[1])?0:t.columnSorting.sortEmptyCells&&e?-1:1:(0,g.isEmpty)(r[1])?(0,g.isEmpty)(n[1])?0:t.columnSorting.sortEmptyCells&&e?1:-1:isNaN(n[1])&&!isNaN(r[1])?e?1:-1:!isNaN(n[1])&&isNaN(r[1])?e?-1:1:(isNaN(n[1])||isNaN(r[1])||(n[1]=parseFloat(n[1]),r[1]=parseFloat(r[1])),n[1]<r[1]?e?-1:1:n[1]>r[1]?e?1:-1:0)}}},{key:"dateSort",value:function(e,t){return function(n,r){if(n[1]===r[1])return 0;if((0,g.isEmpty)(n[1]))return(0,g.isEmpty)(r[1])?0:t.columnSorting.sortEmptyCells&&e?-1:1;if((0,g.isEmpty)(r[1]))return(0,g.isEmpty)(n[1])?0:t.columnSorting.sortEmptyCells&&e?1:-1;var o=(0,h.default)(n[1],t.dateFormat),i=(0,h.default)(r[1],t.dateFormat);return o.isValid()?i.isValid()?i.isAfter(o)?e?-1:1:i.isBefore(o)?e?1:-1:0:-1:1}}},{key:"numericSort",value:function(e,t){return function(n,r){var o=parseFloat(n[1]),i=parseFloat(r[1]);if(o===i||isNaN(o)&&isNaN(i))return 0;if(t.columnSorting.sortEmptyCells){if((0,g.isEmpty)(n[1]))return e?-1:1;if((0,g.isEmpty)(r[1]))return e?1:-1}return isNaN(o)?1:isNaN(i)?-1:o<i?e?-1:1:o>i?e?1:-1:0}}},{key:"sort",value:function(){if(void 0===this.hot.sortOrder)return void(this.hot.sortIndex.length=0);var e=this.hot.getCellMeta(0,this.hot.sortColumn),t=this.hot.countEmptyRows(),n=void 0,r=void 0;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,void 0===e.columnSorting.sortEmptyCells&&(e.columnSorting={sortEmptyCells:this.sortEmptyCells}),r=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-t;for(var o=0,i=r;o<i;o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn)]);if(e.sortFunction)n=e.sortFunction;else switch(e.type){case"date":n=this.dateSort;break;case"numeric":n=this.numericSort;break;default:n=this.defaultSort}(0,C.default)(this.hot.sortIndex,n(this.hot.sortOrder,e));for(var a=this.hot.sortIndex.length;a<this.hot.countRows();a++)this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}},{key:"updateSortIndicator",value:function(){if(void 0!==this.hot.sortOrder){this.sortIndicators[this.hot.sortColumn]=this.hot.getCellMeta(0,this.hot.sortColumn).sortIndicator}}},{key:"translateRow",value:function(e){return this.hot.sortingEnabled&&void 0!==this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[e]?this.hot.sortIndex[e][0]:e}},{key:"untranslateRow",value:function(e){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==e)return t}},{key:"getColHeader",value:function(e,t){if(e<0||!t.parentNode)return!1;var n=t.querySelector(".colHeader"),r=(t.getAttribute("colspan"),t.parentNode.parentNode.childNodes),o=Array.prototype.indexOf.call(r,t.parentNode);o-=r.length,n&&(this.hot.getSettings().columnSorting&&e>=0&&-1===o&&(0,d.addClass)(n,"columnSorting"),(0,d.removeClass)(n,"descending"),(0,d.removeClass)(n,"ascending"),this.sortIndicators[e]&&e===this.hot.sortColumn&&("ascending"===this.sortOrderClass?(0,d.addClass)(n,"ascending"):"descending"===this.sortOrderClass&&(0,d.addClass)(n,"descending")))}},{key:"isSorted",value:function(){return void 0!==this.hot.sortColumn}},{key:"afterCreateRow",value:function(e,t){if(this.isSorted()){for(var n=0;n<this.hot.sortIndex.length;n++)this.hot.sortIndex[n][0]>=e&&(this.hot.sortIndex[n][0]+=t);for(var r=0;r<t;r++)this.hot.sortIndex.splice(e+r,0,[e+r,this.hot.getSourceData()[e+r][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}}},{key:"afterRemoveRow",value:function(e,t){function n(e){return(0,p.arrayReduce)(r,function(t,n){return e>n&&t++,t},0)}if(this.isSorted()){var r=this.hot.sortIndex.splice(e,t);r=(0,p.arrayMap)(r,function(e){return e[0]}),this.hot.sortIndex=(0,p.arrayMap)(this.hot.sortIndex,function(e,t){var r=n(e[0]);return r&&(e[0]-=r),e}),this.saveSortingState()}}},{key:"setPluginOptions",value:function(){var e=this.hot.getSettings().columnSorting;this.sortEmptyCells="object"===(void 0===e?"undefined":l(e))&&(e.sortEmptyCells||!1)}},{key:"onAfterOnCellMouseDown",value:function(e,t){t.row>-1||(0,d.hasClass)(e.realTarget,"columnSorting")&&(t.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=t.col,this.sortByColumn(t.col))}}]),t}(y.default);(0,w.registerPlugin)("columnSorting",_),t.default=_},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(i-n)<=1)return[];var a=Math.ceil((n+i)/2);return r(e,t,n,a),r(e,t,a,i),o(e,t,n,a,i)}function o(e,t,n,r,o){for(var i=new a.default,s=new a.default,l=r-n,u=o-r,c=Math.max(l,u),f=o-n,h=0;h<c;h+=1)h<l&&i.push(e[n+h]),h<u&&s.push(e[r+h]);for(var d=0;d<f;)e[n+d]=i.first&&s.first?t(i.first.data,s.first.data)>0?s.shift().data:i.shift().data:i.first?i.shift().data:s.shift().data,d+=1;return e}t.__esModule=!0,t.default=r,t.merge=o;var i=n(421),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e,t){var n=e.toString(),r=t.toString();return n===r?0:n<r?-1:1}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t){r(this,e),this.data=t,this.next=null,this.prev=null},a=function(){function e(){r(this,e),this.first=null,this.last=null}return o(e,[{key:"push",value:function(e){var t=new i(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.last;this.last=t,t.prev=n,n.next=t}}},{key:"unshift",value:function(e){var t=new i(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.first;this.first=t,t.next=n,n.prev=t}}},{key:"inorder",value:function(e){for(var t=this.first;t;)e(t),t=t.next}},{key:"remove",value:function(e){if(null===this.first)return!1;for(var t=this.first,n=void 0,r=void 0;t;){if(t.data===e)return n=t.next,r=t.prev,n&&(n.prev=r),r&&(r.next=n),t===this.first&&(this.first=n),t===this.last&&(this.last=r),!0;t=t.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,t=this.first;;){if(null===e)return!1;if(null===(e=e.next))return!1;if(e=e.next,t=t.next,e===t)return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){function e(t,n){n&&(e(n,n.next),n.next=t)}if(this.first){e(this.first,this.first.next),this.first.next=null;var t=this.first;this.first=this.last,this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var e=this.first.next,t=this.first,n=void 0;e;)n=e.next,e.next=t,t.prev=e,t=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=t,this.last=n}}}]),e}();t.NodeStructure=i,t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(1),f=n(2),h=n(7),d=r(h),p=n(15),g=n(6),v=n(8),m=r(v),y=n(423),w=r(y),b=n(23),C=n(424),E=r(C),O=n(3),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(O);n(425);var S=new WeakMap,T=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,S.set(n,{tempEditorDimensions:{},cellBelowCursor:null}),n}return s(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new w.default),this.eventManager||(this.eventManager=new d.default(this)),this.displaySwitch||(this.displaySwitch=new E.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(t){return e.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,n,r,o,i,a){return e.onAfterRenderer(t,a)}),this.addHook("afterScrollHorizontally",function(){return e.hide()}),this.addHook("afterScrollVertically",function(){return e.hide()}),this.addHook("afterBeginEditing",function(t){return e.onAfterBeginEditing(t)}),this.displaySwitch.addLocalHook("hide",function(){return e.hide()}),this.displaySwitch.addLocalHook("show",function(t,n){return e.showAtCell(t,n)}),this.registerListeners(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this;this.eventManager.addEventListener(document,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(document,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(document,"mouseup",function(t){return e.onMouseUp(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return e.onEditorBlur(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return e.onEditorMouseDown(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return e.onEditorMouseUp(t)})}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=(0,c.closest)(e.target,"TD","TBODY");return!!(t&&(0,c.hasClass)(t,"htCommentCell")&&(0,c.closest)(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!=e?n=e:null!=t&&(n=t),this.updateCommentMeta(this.range.from.row,this.range.from.col,o({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:new p.CellCoords(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new p.CellCoords(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){return this.getCommentMeta(this.range.from.row,this.range.from.col,"value")}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,"value")}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(e.comment?e.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:new p.CellCoords(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var e=(0,c.getScrollableElement)(this.hot.view.wt.wtTable.TABLE),t=this.hot.view.wt.wtTable.getCell(this.range.from),n=this.range.from.row,r=this.range.from.col,o=(0,c.offset)(t),i=this.hot.view.wt.wtTable.getStretchedColumnWidth(r),a=o.top<0?0:o.top,s=o.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&e!==window&&(a-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&e!==window&&(s-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var l=s+i,u=a,f=this.getCommentMeta(n,r,"style"),h=this.getCommentMeta(n,r,"readOnly");f?this.editor.setSize(f.width,f.height):this.editor.resetSize(),this.editor.setReadOnlyState(h),this.editor.setPosition(l,u)}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRange();if(!e)return!1;var t=!1,n=e.from;return this.getCommentMeta(n.row,n.col,"value")&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t).comment,o=void 0;r?(o=(0,f.deepClone)(r),(0,f.deepExtend)(o,n)):o=n,this.hot.setCellMeta(e,t,"comment",o)}},{key:"getCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r.comment)return r.comment[n]}},{key:"onMouseDown",value:function(e){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=(0,c.closest)(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.view.wt.wtTable.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(e){var t=S.get(this);if(t.cellBelowCursor=document.elementFromPoint(e.clientX,e.clientY),!(this.mouseDown||this.editor.isFocused()||(0,c.hasClass)(e.target,"wtBorder")||t.cellBelowCursor!==e.target)&&this.editor)if(this.targetIsCellWithComment(e)){var n=this.hot.view.wt.wtTable.getCoords(e.target),r={from:new p.CellCoords(n.row,n.col)};this.displaySwitch.show(r)}else(0,c.isChildOf)(e.target,document)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(e){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(e,t){t.comment&&t.comment.value&&(0,c.addClass)(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(e){this.setComment()}},{key:"onEditorMouseDown",value:function(e){S.get(this).tempEditorDimensions={width:(0,c.outerWidth)(e.target),height:(0,c.outerHeight)(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=S.get(this),n=(0,c.outerWidth)(e.target),r=(0,c.outerHeight)(e.target);n===t.tempEditorDimensions.width+1&&r===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,o({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var e=this;this.displaySwitch.cancelHiding();var t=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:t.from}),this.show(),setTimeout(function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(e){this.contextMenuEvent=!0;for(var t=e.start.row;t<=e.end.row;t++)for(var n=e.start.col;n<=e.end.col;n++)this.removeCommentAtCell(t,n,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(e){this.contextMenuEvent=!0;for(var t=e.start.row;t<=e.end.row;t++)for(var n=e.start.col;n<=e.end.col;n++){var r=!!this.getCommentMeta(t,n,"readOnly");this.updateCommentMeta(t,n,o({},"readOnly",!r))}}},{key:"addToContextMenu",value:function(e){var t=this;e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.hot.getTranslatedPhrase(t.checkSelectionCommentsConsistency()?_.CONTEXTMENU_ITEMS_EDIT_COMMENT:_.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!(this.getSelected()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(_.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(e,n){return t.onContextMenuRemoveComment(n)},disabled:function(){return t.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var e=this,t=this.getTranslatedPhrase(_.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return(0,b.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).comment;if(r&&(r=r.readOnly),r)return!0})&&(t=(0,b.markLabelAsSelected)(t)),t},callback:function(e,n){return t.onContextMenuMakeReadOnly(n)},disabled:function(){return t.hot.selection.selectedHeader.corner||!t.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings().comments;if((0,f.isObject)(e))return e.displayDelay}},{key:"onAfterBeginEditing",value:function(e,t){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(m.default);(0,g.registerPlugin)("comments",T),t.default=T},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1);t.default=function(){function e(){r(this,e),this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return o(e,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),o(e,[{key:"setPosition",value:function(e,t){this.editorStyle.left=e+"px",this.editorStyle.top=t+"px"}},{key:"setSize",value:function(e,t){if(e&&t){var n=this.getInputElement();n.style.width=e+"px",n.style.height=t+"px"}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){this.getInputElement().readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=e||"",this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=document.querySelector("."+e.CLASS_EDITOR_CONTAINER),n=void 0,r=void 0;return t||(t=document.createElement("div"),(0,i.addClass)(t,e.CLASS_EDITOR_CONTAINER),document.body.appendChild(t)),n=document.createElement("div"),(0,i.addClass)(n,e.CLASS_EDITOR),r=document.createElement("textarea"),(0,i.addClass)(r,e.CLASS_INPUT),n.appendChild(r),t.appendChild(n),n}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+e.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(34),a=n(2),s=n(31),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(){function e(t){r(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return o(e,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")},250)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,i.debounce)(function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)},t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();(0,a.mixin)(u,l.default),t.default=u},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(8),c=r(u),f=n(12),h=r(f),d=n(0),p=n(324),g=r(p),v=n(7),m=r(v),y=n(325),w=r(y),b=n(157),C=r(b),E=n(6),O=n(10),_=n(1),S=n(43);n(439),h.default.getSingleton().register("afterContextMenuDefaultOptions"),h.default.getSingleton().register("afterContextMenuShow"),h.default.getSingleton().register("afterContextMenuHide"),h.default.getSingleton().register("afterContextMenuExecute");var T=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new m.default(n),n.commandExecutor=new g.default(n.hot),n.itemsFactory=null,n.menu=null,n}return a(t,e),l(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[S.ROW_ABOVE,S.ROW_BELOW,S.SEPARATOR,S.COLUMN_LEFT,S.COLUMN_RIGHT,S.SEPARATOR,S.REMOVE_ROW,S.REMOVE_COLUMN,S.SEPARATOR,S.UNDO,S.REDO,S.SEPARATOR,S.READ_ONLY,S.SEPARATOR,S.ALIGNMENT]}}]),l(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new w.default(this.hot,t.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,r={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this);var o=function(){if(e.hot){e.hot.runHooks("afterContextMenuDefaultOptions",r),e.itemsFactory.setPredefinedItems(r.items);var t=e.itemsFactory.getItems(n);e.menu=new C.default(e.hot,{className:"htContextMenu",keepInViewport:!0}),e.hot.runHooks("beforeContextMenuSetItems",t),e.menu.setMenuItems(t),e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()}),e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()}),e.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.apply(e,n)}),(0,d.arrayEach)(t,function(t){return e.commandExecutor.registerCommand(t.key,t)})}};this.callOnPluginsReady(function(){e.isPluginsReady?setTimeout(o,0):o()})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return e.onContextMenu(t)})}},{key:"open",value:function(e){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt((0,O.pageY)(e),10)-(0,_.getWindowScrollTop)(),left:parseInt((0,O.pageX)(e),10)-(0,_.getWindowScrollLeft)()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,t)}},{key:"onContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders,o=e.realTarget;this.close(),(0,_.hasClass)(o,"handsontableInput")||(e.preventDefault(),(0,O.stopPropagation)(e),(n||r||function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(o)||(0,_.hasClass)(o,"current")&&(0,_.hasClass)(o,"wtBorder"))&&this.open(e))}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);T.SEPARATOR={name:S.SEPARATOR},(0,E.registerPlugin)("contextMenu",T),t.default=T},function(e,t,n){"use strict";function r(){return{key:l,name:function(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:l+":left",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"horizontal","htLeft"),(0,o.align)(t,"horizontal","htLeft",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{key:l+":center",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"horizontal","htCenter"),(0,o.align)(t,"horizontal","htCenter",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{key:l+":right",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htRight"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"horizontal","htRight"),(0,o.align)(t,"horizontal","htRight",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{key:l+":justify",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"horizontal","htJustify"),(0,o.align)(t,"horizontal","htJustify",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{name:i.KEY},{key:l+":top",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htTop"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"vertical","htTop"),(0,o.align)(t,"vertical","htTop",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{key:l+":middle",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"vertical","htMiddle"),(0,o.align)(t,"vertical","htMiddle",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1},{key:l+":bottom",name:function(){var e=this,t=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.getAlignmentClasses)(t,function(t,n){return e.getCellMeta(t,n).className});this.runHooks("beforeCellAlignment",n,t,"vertical","htBottom"),(0,o.align)(t,"vertical","htBottom",function(t,n){return e.getCellMeta(t,n)},function(t,n,r,o){return e.setCellMeta(t,n,r,o)}),this.render()},disabled:!1}]}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(156),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),l=t.KEY="alignment"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(e,t){var n=t.start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t.start.row,t.end.row),n,"ContextMenu.clearColumn")},disabled:function(){var e=(0,o.getValidSelection)(this);if(!e)return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")===e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||n}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="clear_column"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(e,t){this.alter("insert_col",t.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var e=(0,o.getValidSelection)(this);if(!e)return!0;if(!this.isColumnModificationAllowed())return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")===e.join(","),r=1===this.countCols();return e[1]<0||this.countCols()>=this.getSettings().maxCols||!r&&n},hidden:function(){return!this.getSettings().allowInsertColumn}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="col_left"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(e,t){this.alter("insert_col",t.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var e=(0,o.getValidSelection)(this);if(!e)return!0;if(!this.isColumnModificationAllowed())return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")===e.join(","),r=1===this.countCols();return e[1]<0||this.countCols()>=this.getSettings().maxCols||!r&&n},hidden:function(){return!this.getSettings().allowInsertColumn}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="col_right"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){var e=this,t=this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_READ_ONLY);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,n){return e.getCellMeta(t,n).readOnly})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=(0,o.checkSelectionConsistency)(t,function(t,n){return e.getCellMeta(t,n).readOnly});t.forAll(function(t,r){e.setCellMeta(t,r,"readOnly",!n)}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="make_read_only"},function(e,t,n){"use strict";function r(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=t.KEY="redo"},function(e,t,n){"use strict";function r(){return{key:l,name:function(){var e=this.getSelected(),t=0;if(Array.isArray(e)){var n=o(e,4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback:function(e,t){this.alter("remove_col",t.start.col,t.end.col-t.start.col+1,"ContextMenu.removeColumn")},disabled:function(){var e=(0,i.getValidSelection)(this),t=this.countCols();return!e||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!t},hidden:function(){return!this.getSettings().allowRemoveColumn}}}t.__esModule=!0,t.KEY=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(23),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),l=t.KEY="remove_col"},function(e,t,n){"use strict";function r(){return{key:l,name:function(){var e=this.getSelected(),t=0;if(Array.isArray(e)){var n=o(e,3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback:function(e,t){this.alter("remove_row",t.start.row,t.end.row-t.start.row+1,"ContextMenu.removeRow")},disabled:function(){var e=(0,i.getValidSelection)(this),t=this.countRows();return!e||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!t},hidden:function(){return!this.getSettings().allowRemoveRow}}}t.__esModule=!0,t.KEY=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(23),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),l=t.KEY="remove_row"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(e,t){this.alter("insert_row",t.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!(0,o.getValidSelection)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="row_above"},function(e,t,n){"use strict";function r(){return{key:s,name:function(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(e,t){this.alter("insert_row",t.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!(0,o.getValidSelection)(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(23),i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=t.KEY="row_below"},function(e,t,n){"use strict";function r(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}t.__esModule=!0,t.KEY=void 0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=t.KEY="undo"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(10);t.default=function(){function e(t){r(this,e);var n=(0,i.getWindowScrollTop)(),o=(0,i.getWindowScrollLeft)(),s=void 0,l=void 0,u=void 0,c=void 0,f=void 0,h=void 0;this.type=this.getSourceType(t),"literal"===this.type?(s=parseInt(t.top,10),u=parseInt(t.left,10),f=t.height||0,h=t.width||0,l=s,c=u,s+=n,u+=o):"event"===this.type&&(s=parseInt((0,a.pageY)(t),10),u=parseInt((0,a.pageX)(t),10),f=t.target.clientHeight,h=t.target.clientWidth,l=s-n,c=u-o),this.top=s,this.topRelative=l,this.left=u,this.leftRelative=c,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=f,this.cellWidth=h}return o(e,[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){return this.topRelative+e.offsetHeight<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight)}},{key:"fitsOnRight",value:function(e){return this.leftRelative+this.cellWidth+e.offsetWidth<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth)}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),e}()},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(8),f=r(c),h=n(12),d=r(h),p=n(318),g=r(p),v=n(15),m=n(1),y=n(0),w=n(4),b=n(6),C=n(441),E=r(C),O=n(442),_=r(O),S=n(443),T=r(S),R=n(7),M=r(R),N=n(444),k=r(N);n(446),d.default.getSingleton().register("afterCopyLimit"),d.default.getSingleton().register("modifyCopyableRange"),d.default.getSingleton().register("beforeCut"),d.default.getSingleton().register("afterCut"),d.default.getSingleton().register("beforePaste"),d.default.getSingleton().register("afterPaste"),d.default.getSingleton().register("beforeCopy"),d.default.getSingleton().register("afterCopy");var A=1e3,I=1e3,D=new WeakMap,P=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new M.default(n),n.columnsLimit=I,n.copyableRanges=[],n.pasteMode="overwrite",n.rowsLimit=A,n.textarea=void 0,D.set(n,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}return a(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings(),r=D.get(this);this.textarea=E.default.getSingleton(),r.isFragmentSelectionEnabled=n.fragmentSelection,"object"===s(n.copyPaste)&&(this.pasteMode=n.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=n.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=n.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterSelectionEnd",function(){return e.onAfterSelectionEnd()}),this.registerEvents(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.textarea&&this.textarea.destroy(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRange();if(e){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),r=t.row,o=t.col,i=n.row,a=n.col,s=Math.min(i,r+this.rowsLimit-1),l=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===l||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],o=[];return(0,y.arrayEach)(e,function(e){(0,w.rangeEach)(e.startRow,e.endRow,function(e){-1===r.indexOf(e)&&r.push(e)}),(0,w.rangeEach)(e.startCol,e.endCol,function(e){-1===o.indexOf(e)&&o.push(e)})}),(0,y.arrayEach)(r,function(e){var r=[];(0,y.arrayEach)(o,function(n){r.push(t.hot.getCopyableData(e,n))}),n.push(r)}),g.default.stringify(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],o=[];return(0,y.arrayEach)(e,function(e){(0,w.rangeEach)(e.startRow,e.endRow,function(e){-1===r.indexOf(e)&&r.push(e)}),(0,w.rangeEach)(e.startCol,e.endCol,function(e){-1===o.indexOf(e)&&o.push(e)})}),(0,y.arrayEach)(r,function(e){var r=[];(0,y.arrayEach)(o,function(n){r.push(t.hot.getCopyableData(e,n))}),n.push(r)}),n}},{key:"copy",value:function(){D.get(this).isTriggeredByCopy=!0,this.textarea.select(),document.execCommand("copy")}},{key:"cut",value:function(){D.get(this).isTriggeredByCut=!0,this.textarea.select(),document.execCommand("cut")}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new k.default;t.clipboardData.setData("text/plain",e),this.onPaste(t)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.textarea.element,"paste",function(t){return e.onPaste(t)}),this.eventManager.addEventListener(this.textarea.element,"cut",function(t){return e.onCut(t)}),this.eventManager.addEventListener(this.textarea.element,"copy",function(t){return e.onCopy(t)})}},{key:"onCopy",value:function(e){var t=D.get(this);if(this.hot.isListening()||t.isTriggeredByCopy){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",n,this.copyableRanges),o="";r&&(o=g.default.stringify(n),e&&e.clipboardData?e.clipboardData.setData("text/plain",o):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",o),this.hot.runHooks("afterCopy",n,this.copyableRanges)),e.preventDefault()}}},{key:"onCut",value:function(e){var t=D.get(this);if(this.hot.isListening()||t.isTriggeredByCut){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCut",n,this.copyableRanges),o=void 0;r&&(o=g.default.stringify(n),e&&e.clipboardData?e.clipboardData.setData("text/plain",o):"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",o),this.hot.selection.empty(),this.hot.runHooks("afterCut",n,this.copyableRanges)),e.preventDefault()}}},{key:"onPaste",value:function(e){var t=this;if(this.hot.isListening()){e&&e.preventDefault&&e.preventDefault();var n=void 0;if(e&&void 0!==e.clipboardData?this.textarea.setValue(e.clipboardData.getData("text/plain")):"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&this.textarea.setValue(window.clipboardData.getData("Text")),n=g.default.parse(this.textarea.getValue()),this.textarea.setValue(" "),0!==n.length){if(!!this.hot.runHooks("beforePaste",n,this.copyableRanges)){var r=this.hot.getSelected(),o=new v.CellCoords(r[0],r[1]),i=new v.CellCoords(r[2],r[3]),a=new v.CellRange(o,o,i),s=a.getTopLeftCorner(),l=a.getBottomRightCorner(),u=s,c=new v.CellCoords(Math.max(l.row,n.length-1+s.row),Math.max(l.col,n[0].length-1+s.col)),f=i.row-o.row>=n.length-1,h=i.col-o.col>=n[0].length-1;this.hot.addHookOnce("afterChange",function(e){var n=e?e.length:0;if(n){var r={row:0,col:0},o=-1;(0,y.arrayEach)(e,function(t,i){var a=n>i+1?e[i+1]:null;a&&(f||(r.row+=Math.max(a[0]-t[0]-1,0)),!h&&t[1]>o&&(o=t[1],r.col+=Math.max(a[1]-t[1]-1,0)))}),t.hot.selectCell(u.row,u.col,c.row+r.row,c.col+r.col)}}),this.hot.populateFromArray(u.row,u.col,n,c.row,c.col,"CopyPaste.paste",this.pasteMode),this.hot.runHooks("afterPaste",n,this.copyableRanges)}}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:"---------"},(0,_.default)(this),(0,T.default)(this))}},{key:"onAfterSelectionEnd",value:function(){var e=D.get(this),t=this.hot.getActiveEditor();t&&void 0!==t.isOpened&&t.isOpened()||e.isFragmentSelectionEnabled&&!this.textarea.isActive()&&(0,m.getSelectionText)()||(this.setCopyableText(),this.textarea.select())}},{key:"destroy",value:function(){this.textarea&&this.textarea.destroy(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);(0,b.registerPlugin)("CopyPaste",P),t.default=P},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this.element=void 0,this.isAppended=!1,this.refCounter=0}return o(e,null,[{key:"getSingleton",value:function(){return a.append(),a}}]),o(e,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea"),this.element.id="HandsontableCopyPaste",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus(),this.element.select()}},{key:"setValue",value:function(e){this.element.value=e}}]),e}(),a=new i;t.default=i},function(e,t,n){"use strict";function r(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copy()},disabled:function(){return!e.hot.getSelected()},hidden:!1}}t.__esModule=!0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o)},function(e,t,n){"use strict";function r(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){return!e.hot.getSelected()},hidden:!1}}t.__esModule=!0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=n(445),i=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=function e(){r(this,e),this.clipboardData=new i.default}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(){function e(){r(this,e),this.data={}}return o(e,[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),e}()},function(e,t){},function(e,t,n){"use strict";function r(){}t.__esModule=!0;var o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(12),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=n(2),u=n(15),c=n(3),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),h=function(e){return"boolean"==typeof e&&!0===e||"object"===(void 0===e?"undefined":i(e))&&e.length>0},d=function(){h(this.getSettings().customBorders)&&(this.customBorders||(o=this,this.customBorders=new r))},p=function(e){for(var t=0;t<o.view.wt.selections.length;t++)if(o.view.wt.selections[t].settings.className==e)return t;return-1},g=function(e){var t={row:e.row,col:e.col},n=new u.Selection(e,new u.CellRange(t,t,t)),r=p(e.className);r>=0?o.view.wt.selections[r]=n:o.view.wt.selections.push(n)},v=function(e,t,n){var r=E(e,t);r=O(r,n),this.setCellMeta(e,t,"borders",r),g(r)},m=function(e){for(var t=e.range,n=t.from.row;n<=t.to.row;n++)for(var r=t.from.col;r<=t.to.col;r++){var o=E(n,r),i=0;n==t.from.row&&(i++,(0,l.hasOwnProperty)(e,"top")&&(o.top=e.top)),n==t.to.row&&(i++,(0,l.hasOwnProperty)(e,"bottom")&&(o.bottom=e.bottom)),r==t.from.col&&(i++,(0,l.hasOwnProperty)(e,"left")&&(o.left=e.left)),r==t.to.col&&(i++,(0,l.hasOwnProperty)(e,"right")&&(o.right=e.right)),i>0&&(this.setCellMeta(n,r,"borders",o),g(o))}},y=function(e,t){return"border_row"+e+"col"+t},w=function(){return{width:1,color:"#000"}},b=function(){return{hide:!0}},C=function(){return{width:1,color:"#000",cornerVisible:!1}},E=function(e,t){return{className:y(e,t),border:C(),row:e,col:t,top:b(),right:b(),bottom:b(),left:b()}},O=function(e,t){return(0,l.hasOwnProperty)(t,"border")&&(e.border=t.border),(0,l.hasOwnProperty)(t,"top")&&(e.top=t.top),(0,l.hasOwnProperty)(t,"right")&&(e.right=t.right),(0,l.hasOwnProperty)(t,"bottom")&&(e.bottom=t.bottom),(0,l.hasOwnProperty)(t,"left")&&(e.left=t.left),e},_=function(e){for(var t=document.querySelectorAll("."+e),n=0;n<t.length;n++)if(t[n]&&"TD"!=t[n].nodeName){var r=t[n].parentNode;r.parentNode&&r.parentNode.removeChild(r)}},S=function(e,t){var n=y(e,t);_(n),this.removeCellMeta(e,t,"borders")},T=function(e,t,n,r){var o=this.getCellMeta(e,t).borders;o&&void 0!=o.border||(o=E(e,t)),o[n]=r?b():w(),this.setCellMeta(e,t,"borders",o);var i=y(e,t);_(i),g(o),this.render()},R=function(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?S.call(this,e.from.row,e.from.col):T.call(this,e.from.row,e.from.col,t,n);else switch(t){case"noBorders":for(var r=e.from.col;r<=e.to.col;r++)for(var o=e.from.row;o<=e.to.row;o++)S.call(this,o,r);break;case"top":for(var i=e.from.col;i<=e.to.col;i++)T.call(this,e.from.row,i,t,n);break;case"right":for(var a=e.from.row;a<=e.to.row;a++)T.call(this,a,e.to.col,t);break;case"bottom":for(var s=e.from.col;s<=e.to.col;s++)T.call(this,e.to.row,s,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)T.call(this,l,e.from.col,t)}},M=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(r,o){var i=e.getCellMeta(r,o).borders;if(i){if(!t)return n=!0,!1;if(!(0,l.hasOwnProperty)(i[t],"hide"))return n=!0,!1}}),n},N=function(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e},k=function(e){this.getSettings().customBorders&&(e.items.push({name:"---------"}),e.items.push({key:"borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_TOP);return M(this,"top")&&(e=N(e)),e},callback:function(){var e=M(this,"top");R.call(this,this.getSelectedRange(),"top",e)}},{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return M(this,"right")&&(e=N(e)),e},callback:function(){var e=M(this,"right");R.call(this,this.getSelectedRange(),"right",e)}},{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return M(this,"bottom")&&(e=N(e)),e},callback:function(){var e=M(this,"bottom");R.call(this,this.getSelectedRange(),"bottom",e)}},{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_LEFT);return M(this,"left")&&(e=N(e)),e},callback:function(){var e=M(this,"left");R.call(this,this.getSelectedRange(),"left",e)}},{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(){R.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!M(this)}}]}}))};s.default.getSingleton().add("beforeInit",d),s.default.getSingleton().add("afterContextMenuDefaultOptions",k),s.default.getSingleton().add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?m.call(this,e[t]):v.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){this.boundaries=null,this.callback=null}t.__esModule=!0;var i=n(12),a=r(i),s=n(7),l=r(s);n(6);o.prototype.setBoundaries=function(e){this.boundaries=e},o.prototype.setCallback=function(e){this.callback=e},o.prototype.check=function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)};var u,c=function(e){e.dragToScrollListening=!1;var t=e.view.wt.wtTable.holder;u=new o,t!==window&&(u.setBoundaries(t.getBoundingClientRect()),u.setCallback(function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),e.dragToScrollListening=!0)};a.default.getSingleton().add("afterInit",function(){var e=this,t=new l.default(this);t.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),t.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&u.check(t.clientX,t.clientY)})}),a.default.getSingleton().add("afterDestroy",function(){new l.default(this).clear()}),a.default.getSingleton().add("afterOnCellMouseDown",function(){c(this)}),a.default.getSingleton().add("afterOnCellCornerMouseDown",function(){c(this)}),t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(6),h=n(0),d=n(450),p=r(d),g=n(451),v=r(g);n(452);var m=new WeakMap,y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return m.set(n,{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return e.addContextMenuEntry(t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("beforeColumnMove",function(t,n){return e.onBeforeColumnMove(t,n)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=m.get(this);e.afterFirstUse=!1,e.moveByFreeze=!1,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=m.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||e<=n.fixedColumnsLeft-1||(t.moveByFreeze=!0,e!==this.getMovePlugin().columnsMapper.getValueByIndex(e)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=e),this.getMovePlugin().moveColumn(e,n.fixedColumnsLeft++))}},{key:"unfreezeColumn",value:function(e){var t=m.get(this),n=this.hot.getSettings();if(t.afterFirstUse||(t.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||e>n.fixedColumnsLeft-1)){var r=this.getBestColumnReturnPosition(e);t.moveByFreeze=!0,n.fixedColumnsLeft--,this.getMovePlugin().moveColumn(e,r+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(e){var t=this.getMovePlugin(),n=this.hot.getSettings(),r=n.fixedColumnsLeft,o=t.columnsMapper.getValueByIndex(r),i=void 0;if(null==this.frozenColumnsBasePositions[e])for(i=t.columnsMapper.getValueByIndex(e);o<i;)r++,o=t.columnsMapper.getValueByIndex(r);else{for(i=this.frozenColumnsBasePositions[e],this.frozenColumnsBasePositions[e]=void 0;o<=i;)r++,o=t.columnsMapper.getValueByIndex(r);r=o}return r-1}},{key:"addContextMenuEntry",value:function(e){e.items.push({name:"---------"},(0,p.default)(this),(0,v.default)(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(e,t){var n=m.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var r=this.hot.getSettings().fixedColumnsLeft,o=t<r;if(o||(0,h.arrayEach)(e,function(e,t,n){if(e<r)return o=!0,!1}),o)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,f.registerPlugin)("manualColumnFreeze",y),t.default=y},function(e,t,n){"use strict";function r(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(){var t=this.getSelectedRange().from.col;e.freezeColumn(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:(e.from.col!==e.to.col||e.from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}}t.__esModule=!0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o)},function(e,t,n){"use strict";function r(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(){var t=this.getSelectedRange().from.col;e.unfreezeColumn(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:(e.from.col!==e.to.col||e.from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}t.__esModule=!0,t.default=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(12),h=r(f),d=n(0),p=n(1),g=n(4),v=n(7),m=r(v),y=n(6),w=n(454),b=r(w),C=n(455),E=r(C),O=n(456),_=r(O),S=n(15);n(457),h.default.getSingleton().register("beforeColumnMove"),h.default.getSingleton().register("afterColumnMove"),h.default.getSingleton().register("unmodifyCol");var T=new WeakMap,R=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return T.set(n,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new b.default(n),n.eventManager=new m.default(n),n.backlight=new E.default(e),n.guideline=new _.default(e),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,n,r,o){return e.onBeforeOnCellMouseDown(t,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterScrollVertically",function(){return e.onAfterScrollVertically()}),this.addHook("modifyCol",function(t,n){return e.onModifyCol(t,n)}),this.addHook("beforeRemoveCol",function(t,n){return e.onBeforeRemoveCol(t,n)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(t,n){return e.onAfterCreateCol(t,n)}),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("unmodifyCol",function(t){return e.onUnmodifyCol(t)}),this.registerEvents(),(0,p.addClass)(this.hot.rootElement,"ht__manualColumnMove"),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this.hot.getSettings().manualColumnMove;Array.isArray(e)&&this.columnsMapper.clearMap(),(0,p.removeClass)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=this,r=T.get(this),o=this.hot.runHooks("beforeColumnMove",e,t);r.disallowMoving=!o,!1!==o&&((0,d.arrayEach)(e,function(e,t,r){r[t]=n.columnsMapper.getValueByIndex(e)}),(0,d.arrayEach)(e,function(e,r){var o=n.columnsMapper.getIndexByValue(e);o!==t&&n.columnsMapper.moveColumn(o,t+r)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",e,t)}},{key:"changeSelection",value:function(e,t){var n=this.hot.selection,r=this.hot.countRows()-1;n.setRangeStartOnly(new S.CellCoords(0,e)),n.setRangeEnd(new S.CellCoords(r,t),!1)}},{key:"getColumnsWidth",value:function(e,t){for(var n=0,r=e;r<t;r++){var o=0;o=r<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(r)||0,n+=o}return n}},{key:"initialSettings",value:function(){var e=this.hot.getSettings().manualColumnMove;Array.isArray(e)?this.moveColumns(e,0):void 0!==e&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(e){return e<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var e={};this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value&&(this.columnsMapper._arrayMap=e.value)}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return(0,g.rangeEach)(e,t,function(e){n.push(e)}),n}},{key:"refreshPositions",value:function(){var e=T.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coordsColumn),s=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?i:0)),l=r.hider.offsetWidth,u=r.TBODY.offsetLeft,c=this.backlight.getOffset().left,f=this.backlight.getSize().width,h=0;if(e.rootElementOffset+r.holder.offsetWidth+i<e.target.eventPageX&&e.coordsColumn<e.countCols&&e.coordsColumn++,e.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(e.coordsColumn)&&(a+=i),a+=h,e.coordsColumn<0)e.target.col=e.fixedColumns>0?0:t>0?t-1:t;else if(e.target.TD.offsetWidth/2+a<=s){var d=e.coordsColumn>=e.countCols?e.countCols-1:e.coordsColumn;e.target.col=d+1,a+=e.target.TD.offsetWidth,e.target.col>n&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else(e.target.col=e.coordsColumn)<=t&&e.target.col>=e.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);var p=s,g=a;s+f+c>=l?p=l-f-c:s+c<u+h&&(p=u+h+Math.abs(c)),a>=l-1?g=l-1:0===g?g=1:void 0!==o.scrollX&&e.coordsColumn<e.fixedColumns&&(g-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,g)}},{key:"updateColumnsMapper",value:function(){var e=this.hot.countSourceCols(),t=this.columnsMapper._arrayMap.length;if(0===t)this.columnsMapper.createMap(e||this.hot.getSettings().startCols);else if(t<e){var n=e-t;this.columnsMapper.insertItems(t,n)}else if(t>e){var r=e-1,o=[];(0,d.arrayEach)(this.columnsMapper._arrayMap,function(e,t){e>r&&o.push(t)}),this.columnsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.cols,a=this.hot.getSelectedRange(),s=T.get(this),l=e.realTarget.className.indexOf("columnSorting")>-1;if(!a||!i||s.pressed||0!==e.button||l)return s.pressed=!1,s.columnsToMove.length=0,void(0,p.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui"]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),g=Math.max(f.col,h.col);if(t.row<0&&t.col>=d&&t.col<=g){r.column=!0,s.pressed=!0,s.target.eventPageX=e.pageX,s.coordsColumn=t.col,s.target.TD=n,s.target.col=t.col,s.columnsToMove=this.prepareColumnsToMoving(d,g),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=(0,p.offset)(this.hot.rootElement).left;var v=s.hasRowHeaders?-1:0,m=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,y=t.col<s.fixedColumns,w=this.hot.view.wt.wtOverlays.scrollableElement,b=w.scrollX?w.scrollX-s.rootElementOffset:0,C=e.layerX-(y?b:0),E=Math.abs(this.getColumnsWidth(d,t.col)+C);this.backlight.setPosition(m,this.getColumnsWidth(v,d)+E),this.backlight.setSize(this.getColumnsWidth(d,g+1),o.hider.offsetHeight-m),this.backlight.setOffset(null,-1*E),(0,p.addClass)(this.hot.rootElement,"on-moving--columns")}else(0,p.removeClass)(this.hot.rootElement,"after-selection--columns"),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=T.get(this);if(t.pressed){if(e.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRange(),i=T.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?(0,p.removeClass)(this.hot.rootElement,"show-ui"):(0,p.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.coordsColumn=t.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=T.get(this);if(e.coordsColumn=void 0,e.pressed=!1,e.backlightWidth=0,(0,p.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.selectedHeader.cols&&(0,p.addClass)(this.hot.rootElement,"after-selection--columns"),!(e.columnsToMove.length<1||void 0===e.target.col||e.columnsToMove.indexOf(e.target.col)>-1)){if(this.moveColumns(e.columnsToMove,e.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!e.disallowMoving){this.changeSelection(this.columnsMapper.getIndexByValue(e.columnsToMove[0]),this.columnsMapper.getIndexByValue(e.columnsToMove[e.columnsToMove.length-1]))}e.columnsToMove.length=0}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,r=t+n;this.backlight.setPosition(r),this.backlight.setSize(null,e.hider.offsetHeight-r)}},{key:"onAfterCreateCol",value:function(e,t){this.columnsMapper.shiftItems(e,t)}},{key:"onBeforeRemoveCol",value:function(e,t){var n=this;this.removedColumns.length=0,!1!==e&&(0,g.rangeEach)(e,e+t-1,function(e){n.removedColumns.push(n.hot.runHooks("modifyCol",e,n.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(e,t){if(t!==this.pluginName){var n=this.columnsMapper.getValueByIndex(e);e=null===n?e:n}return e}},{key:"onUnmodifyCol",value:function(e){var t=this.columnsMapper.getIndexByValue(e);return null===t?e:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,y.registerPlugin)("ManualColumnMove",R),t.default=R},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(0),l=n(2),u=n(4),c=function(){function e(t){r(this,e),this.manualColumnMove=t}return o(e,[{key:"createMap",value:function(e){var t=this,n=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,(0,u.rangeEach)(n-1,function(e){t._arrayMap[e]=e})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(e,t){var n=this._arrayMap[e];this._arrayMap[e]=null,this._arrayMap.splice(t,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,s.arrayFilter)(this._arrayMap,function(e){return null!==e})}}]),e}();(0,l.mixin)(c,a.default),t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(326),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(1);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),(0,c.addClass)(this._element,"ht__manualColumnMove--backlight")}}]),t}(u.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(326),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(1);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),(0,c.addClass)(this._element,"ht__manualColumnMove--guideline")}}]),t}(u.default)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(1),h=n(7),d=r(h),p=n(10),g=n(0),v=n(4),m=n(6),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new d.default(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],(0,f.addClass)(n.handle,"manualColumnResizer"),(0,f.addClass)(n.guide,"manualColumnResizerGuide"),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.manualColumnWidths=[];var n=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.addHook("beforeStretchingColumnWidth",function(t,n){return e.onBeforeStretchingColumnWidth(t,n)}),this.addHook("beforeColumnResize",function(t,n,r){return e.onBeforeColumnResize(t,n,r)}),this.manualColumnWidths=void 0!==r?r:Array.isArray(n)?n:[],this.bindEvents(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().manualColumnResize;Array.isArray(e)?this.manualColumnWidths=e:e||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",e),e.value}},{key:"setupHandlePosition",value:function(e){var t=this;if(!e.parentNode)return!1;this.currentTH=e;var n=this.hot.view.wt.wtTable.getCoords(e).col,r=(0,f.outerHeight)(this.currentTH);if(n>=0){var o=this.currentTH.getBoundingClientRect();if(this.currentCol=n,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var i=this.hot.getSelectedRange(),a=i.from,s=i.to,l=a.col,u=s.col;l>=u&&(l=s.col,u=a.col),this.currentCol>=l&&this.currentCol<=u?(0,v.rangeEach)(l,u,function(e){return t.selectedCols.push(e)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=o.left-6,this.startWidth=parseInt(o.width,10),this.handle.style.top=o.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=r+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var e=parseInt((0,f.outerHeight)(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,f.addClass)(this.handle,"active"),(0,f.addClass)(this.guide,"active"),this.guide.style.top=t+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=n-e+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){(0,f.removeClass)(this.handle,"active"),(0,f.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(e){if(e!=this.hot.rootElement){var t=e.parentNode;return"THEAD"===t.tagName||this.checkIfColumnHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:this.getTHFromTargetElement(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(this.checkIfColumnHeader(e.target)){var t=this.getTHFromTargetElement(e.target);if(!t)return;var n=t.getAttribute("colspan");!t||null!==n&&1!==n||this.pressed||this.setupHandlePosition(t)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",n,e.newSize,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",n,e.newSize,!0)};if(this.dblclick>=2){this.selectedCols.length>1?((0,g.arrayEach)(this.selectedCols,function(e){n(e)}),t()):(0,g.arrayEach)(this.selectedCols,function(e){n(e,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;(0,f.hasClass)(e.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=(0,p.pageX)(e),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentWidth=this.startWidth+((0,p.pageX)(e)-this.startX),(0,g.arrayEach)(this.selectedCols,function(e){t.newSize=t.setManualSize(e,t.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(e){var t=this,n=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(e,r){t.hot.runHooks("beforeColumnResize",e,t.newSize),r&&n(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",e,t.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth){this.selectedCols.length>1?((0,g.arrayEach)(this.selectedCols,function(e){r(e)}),n()):(0,g.arrayEach)(this.selectedCols,function(e){r(e,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})}},{key:"setManualSize",value:function(e,t){return t=Math.max(t,20),e=this.hot.runHooks("modifyCol",e),this.manualColumnWidths[e]=t,t}},{key:"clearManualSize",value:function(e){e=this.hot.runHooks("modifyCol",e),this.manualColumnWidths[e]=void 0}},{key:"onModifyColWidth",value:function(e,t){return this.enabled&&(t=this.hot.runHooks("modifyCol",t),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:e}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.manualColumnWidths[t];return void 0===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),t}(c.default);(0,m.registerPlugin)("manualColumnResize",y),t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(12),h=r(f),d=n(0),p=n(1),g=n(4),v=n(7),m=r(v),y=n(6),w=n(460),b=r(w),C=n(461),E=r(C),O=n(462),_=r(O),S=n(15);n(463),h.default.getSingleton().register("beforeRowMove"),h.default.getSingleton().register("afterRowMove"),h.default.getSingleton().register("unmodifyRow");var T=new WeakMap,R=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return T.set(n,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new b.default(n),n.eventManager=new m.default(n),n.backlight=new E.default(e),n.guideline=new _.default(e),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,n,r,o){return e.onBeforeOnCellMouseDown(t,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterScrollHorizontally",function(){return e.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(t,n){return e.onModifyRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("beforeColumnSort",function(t,n){return e.onBeforeColumnSort(t,n)}),this.addHook("unmodifyRow",function(t){return e.onUnmodifyRow(t)}),this.registerEvents(),(0,p.addClass)(this.hot.rootElement,"ht__manualRowMove"),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this.hot.getSettings().manualRowMove;Array.isArray(e)&&this.rowsMapper.clearMap(),(0,p.removeClass)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=this,r=T.get(this);r.disallowMoving=!1===this.hot.runHooks("beforeRowMove",e,t),r.disallowMoving||((0,d.arrayEach)(e,function(e,t,r){r[t]=n.rowsMapper.getValueByIndex(e)}),(0,d.arrayEach)(e,function(e,r){var o=n.rowsMapper.getIndexByValue(e);o!==t&&n.rowsMapper.moveRow(o,t+r)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",e,t)}},{key:"changeSelection",value:function(e,t){var n=this.hot.selection,r=this.hot.countCols()-1;n.setRangeStartOnly(new S.CellCoords(e,0)),n.setRangeEnd(new S.CellCoords(t,r),!1)}},{key:"getRowsHeight",value:function(e,t){for(var n=0,r=e;r<t;r++){n+=this.hot.view.wt.wtTable.getRowHeight(r)||23}return n}},{key:"initialSettings",value:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRange(),t=[];if(!e)return t;var n=e.from,r=e.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return(0,g.rangeEach)(o,i,function(e){t.push(e)}),t}},{key:"refreshPositions",value:function(){var e=T.get(this),t=e.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();t.row<o&&n>0&&this.hot.scrollViewportTo(n-1),t.row>=r&&r<i&&this.hot.scrollViewportTo(r+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=e.target.TD,l=(0,p.offset)(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row),c=e.target.eventPageY-l.top+a.holder.scrollTop,f=a.hider.offsetHeight,h=a.TBODY.offsetTop,d=this.backlight.getOffset().top,g=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(u+=a.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:s.offsetHeight/2+u<=c?(e.target.row=t.row+1,u+=0===t.row?s.offsetHeight-1:s.offsetHeight):e.target.row=t.row;var v=c,m=u;c+g+d>=f?v=f-g-d:c+d<h&&(v=h+Math.abs(d)),u>=f-1&&(m=f-1);var y=0;this.hot.view.wt.wtOverlays.topOverlay&&(y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=o&&m-a.holder.scrollTop<y&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(v),this.guideline.setPosition(m)}},{key:"updateRowsMapper",value:function(){var e=this.hot.countSourceRows(),t=this.rowsMapper._arrayMap.length;if(0===t)this.rowsMapper.createMap(e||this.hot.getSettings().startRows);else if(t<e){var n=e-t;this.rowsMapper.insertItems(t,n)}else if(t>e){var r=e-1,o=[];(0,d.arrayEach)(this.rowsMapper._arrayMap,function(e,t){e>r&&o.push(t)}),this.rowsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(e,t){T.get(this).disallowMoving=void 0!==t}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.rows,a=this.hot.getSelectedRange(),s=T.get(this);if(!a||!i||s.pressed||0!==e.button)return s.pressed=!1,s.rowsToMove.length=0,void(0,p.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui"]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var c=a.from,f=a.to,h=Math.min(c.row,f.row),d=Math.max(c.row,f.row);if(t.col<0&&t.row>=h&&t.row<=d){r.row=!0,s.pressed=!0,s.target.eventPageY=e.pageY,s.target.coords=t,s.target.TD=n,s.rowsToMove=this.prepareRowsToMoving();var g=o.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,g),this.backlight.setSize(o.hider.offsetWidth-g,this.getRowsHeight(h,d+1)),this.backlight.setOffset(-1*(this.getRowsHeight(h,t.row)+e.layerY),null),(0,p.addClass)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}else(0,p.removeClass)(this.hot.rootElement,"after-selection--rows"),s.pressed=!1,s.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=T.get(this);if(t.pressed){if(e.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRange(),i=T.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?(0,p.removeClass)(this.hot.rootElement,"show-ui"):(0,p.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=t,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=T.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,(0,p.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.selectedHeader.rows&&(0,p.addClass)(this.hot.rootElement,"after-selection--rows"),!(n<1||void 0===t||e.rowsToMove.indexOf(t)>-1||e.rowsToMove[n-1]===t-1)){if(this.moveRows(e.rowsToMove,t),this.persistentStateSave(),this.hot.render(),!e.disallowMoving){this.changeSelection(this.rowsMapper.getIndexByValue(e.rowsToMove[0]),this.rowsMapper.getIndexByValue(e.rowsToMove[n-1]))}e.rowsToMove.length=0}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view.wt.wtTable,t=this.hot.view.wt.wtViewport.getRowHeaderWidth(),n=e.holder.scrollLeft,r=t+n;this.backlight.setPosition(null,r),this.backlight.setSize(e.hider.offsetWidth-r)}},{key:"onAfterCreateRow",value:function(e,t){this.rowsMapper.shiftItems(e,t)}},{key:"onBeforeRemoveRow",value:function(e,t){var n=this;this.removedRows.length=0,!1!==e&&(0,g.rangeEach)(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(e,t){if(t!==this.pluginName){var n=this.rowsMapper.getValueByIndex(e);e=null===n?e:n}return e}},{key:"onUnmodifyRow",value:function(e){var t=this.rowsMapper.getIndexByValue(e);return null===t?e:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,y.registerPlugin)("ManualRowMove",R),t.default=R},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(0),l=n(2),u=n(4),c=function(){function e(t){r(this,e),this.manualRowMove=t}return o(e,[{key:"createMap",value:function(e){var t=this,n=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,(0,u.rangeEach)(n-1,function(e){t._arrayMap[e]=e})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(e,t){var n=this._arrayMap[e];this._arrayMap[e]=null,this._arrayMap.splice(t,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,s.arrayFilter)(this._arrayMap,function(e){return null!==e})}}]),e}();(0,l.mixin)(c,a.default),t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(327),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(1);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),(0,c.addClass)(this._element,"ht__manualRowMove--backlight")}}]),t}(u.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(327),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(1);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),(0,c.addClass)(this._element,"ht__manualRowMove--guideline")}}]),t}(u.default)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(1),h=n(7),d=r(h),p=n(10),g=n(0),v=n(4),m=n(6),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new d.default(n),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],(0,f.addClass)(n.handle,"manualRowResizer"),(0,f.addClass)(n.guide,"manualRowResizerGuide"),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.manualRowHeights=[];var n=this.hot.getSettings().manualRowResize,r=this.loadManualRowHeights();this.manualRowHeights=void 0!==r?r:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(t,n){return e.onModifyRowHeight(t,n)}),this.bindEvents(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().manualRowResize;Array.isArray(e)?this.manualRowHeights=e:e||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",e),e.value}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var n=this.hot.view.wt.wtTable.getCoords(e).row,r=(0,f.outerWidth)(this.currentTH);if(n>=0){var o=this.currentTH.getBoundingClientRect();if(this.currentRow=n,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var i=this.hot.getSelectedRange(),a=i.from,s=i.to,l=a.row,u=s.row;l>=u&&(l=s.row,u=a.row),this.currentRow>=l&&this.currentRow<=u?(0,v.rangeEach)(l,u,function(e){return t.selectedRows.push(e)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=o.top-6,this.startHeight=parseInt(o.height,10),this.handle.style.left=o.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=r+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var e=parseInt((0,f.outerWidth)(this.handle),10),t=parseInt(this.handle.style.left,10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,f.addClass)(this.handle,"active"),(0,f.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=t+"px",this.guide.style.width=n-e+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){(0,f.removeClass)(this.handle,"active"),(0,f.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(e){if(e!=this.hot.rootElement){var t=e.parentNode;return"TBODY"===t.tagName||this.checkIfRowHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:this.getTHFromTargetElement(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(this.checkIfRowHeader(e.target)){var t=this.getTHFromTargetElement(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",n,e.newSize,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),r&&t(),e.hot.runHooks("afterRowResize",n,e.newSize,!0)};if(this.dblclick>=2){this.selectedRows.length>1?((0,g.arrayEach)(this.selectedRows,function(e){n(e)}),t()):(0,g.arrayEach)(this.selectedRows,function(e){n(e,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;(0,f.hasClass)(e.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=(0,p.pageY)(e),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+((0,p.pageY)(e)-this.startY),(0,g.arrayEach)(this.selectedRows,function(e){t.newSize=t.setManualSize(e,t.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(e){var t=this,n=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(e,r){t.hot.runHooks("beforeRowResize",e,t.newSize),r&&n(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",e,t.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight){this.selectedRows.length>1?((0,g.arrayEach)(this.selectedRows,function(e){r(e)}),n()):(0,g.arrayEach)(this.selectedRows,function(e){r(e,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})}},{key:"setManualSize",value:function(e,t){return e=this.hot.runHooks("modifyRow",e),this.manualRowHeights[e]=t,t}},{key:"onModifyRowHeight",value:function(e,t){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),r=n?n.heights[t]:null;t=this.hot.runHooks("modifyRow",t);var o=this.manualRowHeights[t];if(void 0!==o&&(o===r||o>(e||0)))return o}return e}}]),t}(c.default);(0,m.registerPlugin)("manualRowResize",y),t.default=y},function(e,t,n){"use strict";function r(){var e=[];return e.getInfo=function(e,t){for(var n=0,r=this.length;n<r;n++)if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t)return this[n]},e.setInfo=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var n=0,r=this.length;n<r;n++)if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}},e}function o(e){if(this.mergedCellInfoCollection=new r,Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.mergedCellInfoCollection.setInfo(e[t])}function i(e,t){if(this.getSettings().mergeCells&&!this.selection.isMultiple()){var n=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);n&&(e[0]=n.row,e[1]=n.col,e[2]=n.row+n.rowspan-1,e[3]=n.col+n.colspan-1)}}function a(e,t){this.mergeCells&&this.mergeCells.shiftCollection("right",e,t)}function s(e,t){this.mergeCells&&this.mergeCells.shiftCollection("left",e,t)}function l(e,t){this.mergeCells&&this.mergeCells.shiftCollection("down",e,t)}function u(e,t){this.mergeCells&&this.mergeCells.shiftCollection("up",e,t)}t.__esModule=!0;var c=n(12),f=function(e){return e&&e.__esModule?e:{default:e}}(c),h=n(10),d=n(15),p=n(3),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p);o.prototype.canMergeRange=function(e){return!e.isSingle()},o.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),r={};r.row=t.row,r.col=t.col,r.rowspan=n.row-t.row+1,r.colspan=n.col-t.col+1,this.mergedCellInfoCollection.setInfo(r)}},o.prototype.mergeOrUnmergeSelection=function(e){this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col)?this.unmergeSelection(e.from):this.mergeSelection(e)},o.prototype.mergeSelection=function(e){this.mergeRange(e)},o.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},o.prototype.applySpanProperties=function(e,t,n){var r=this.mergedCellInfoCollection.getInfo(t,n);r?r.row===t&&r.col===n?(e.setAttribute("rowspan",r.rowspan),e.setAttribute("colspan",r.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},o.prototype.modifyTransform=function(e,t,n){var r={row:n.row,col:n.col};if("modifyTransformStart"==e){var o;this.lastDesiredCoords||(this.lastDesiredCoords=new d.CellCoords(null,null));for(var i=new d.CellCoords(t.highlight.row,t.highlight.col),a=this.mergedCellInfoCollection.getInfo(i.row,i.col),s=0,l=this.mergedCellInfoCollection.length;s<l;s++){var u=this.mergedCellInfoCollection[s];if(u=new d.CellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),t.includes(u)){!0;break}}if(a){var c=new d.CellCoords(a.row,a.col),f=new d.CellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);new d.CellRange(c,c,f).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new d.CellCoords(null,null)),r.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-i.row:r.row,r.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-i.col:r.col,n.row>0?r.row=a.row+a.rowspan-1-i.row+n.row:n.row<0&&(r.row=i.row-a.row+n.row),n.col>0?r.col=a.col+a.colspan-1-i.col+n.col:n.col<0&&(r.col=i.col-a.col+n.col)}o=new d.CellCoords(t.highlight.row+r.row,t.highlight.col+r.col);var h=this.mergedCellInfoCollection.getInfo(o.row,o.col);h&&(this.lastDesiredCoords=o,r={row:h.row-i.row,col:h.col-i.col})}else if("modifyTransformEnd"==e)for(var p=0,g=this.mergedCellInfoCollection.length;p<g;p++){var v=this.mergedCellInfoCollection[p],m=new d.CellCoords(v.row,v.col),y=new d.CellCoords(v.row+v.rowspan-1,v.col+v.colspan-1),w=new d.CellRange(m,m,y),b=t.getBordersSharedWith(w);if(w.isEqual(t))t.setDirection("NW-SE");else if(b.length>0){var C=t.highlight.isEqual(w.from);b.indexOf("top")>-1?t.to.isSouthEastOf(w.from)&&C?t.setDirection("NW-SE"):t.to.isSouthWestOf(w.from)&&C&&t.setDirection("NE-SW"):b.indexOf("bottom")>-1&&(t.to.isNorthEastOf(w.from)&&C?t.setDirection("SW-NE"):t.to.isNorthWestOf(w.from)&&C&&t.setDirection("SE-NW"))}o=function(e){return new d.CellCoords(t.to.row+e.row,t.to.col+e.col)}(r);var E=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1}(v,o),O=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1}(v,o);t.includesRange(w)&&(w.includes(o)||E||O)&&(E&&(r.row<0?r.row-=v.rowspan-1:r.row>0&&(r.row+=v.rowspan-1)),O&&(r.col<0?r.col-=v.colspan-1:r.col>0&&(r.col+=v.colspan-1)))}0!==r.row&&(n.row=r.row),0!==r.col&&(n.col=r.col)},o.prototype.shiftCollection=function(e,t,n){var r=[0,0];switch(e){case"right":r[0]+=1;break;case"left":r[0]-=1;break;case"down":r[1]+=1;break;case"up":r[1]-=1}for(var o=0;o<this.mergedCellInfoCollection.length;o++){var i=this.mergedCellInfoCollection[o];"right"===e||"left"===e?t<=i.col&&(i.col+=r[0]):t<=i.row&&(i.row+=r[1])}};var v=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new o(t)))},m=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var n=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);n&&(t=n)}return d.Table.prototype.getCell.call(this,t)})},y=function(){var e=this,t=e.getSettings().mergeCells;if(t)if(e.mergeCells){if(e.mergeCells.mergedCellInfoCollection=new r,Array.isArray(t))for(var n=0,i=t.length;n<i;n++)e.mergeCells.mergedCellInfoCollection.setInfo(t[n])}else e.mergeCells=new o(t);else e.mergeCells&&(e.mergeCells.mergedCellInfoCollection=new r)},w=function(e){if(this.mergeCells){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),(0,h.stopImmediatePropagation)(e))}},b=function(e){this.getSettings().mergeCells&&(e.items.push({name:"---------"}),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected();return this.getTranslatedPhrase(this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1])?g.CONTEXTMENU_ITEMS_UNMERGE_CELLS:g.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return this.selection.selectedHeader.corner}}))},C=function(e,t,n,r,o,i){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,n)},E=function(e){return function(t){if(this.getSettings().mergeCells){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var r=this.countRows(),o=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=r&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=o&&(n.from.col=o-1)}}}},O=function(e){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var t=this.getSelectedRange();t.highlight=new d.CellCoords(t.highlight.row,t.highlight.col),t.to=e;var n=!1;do{n=!1;for(var r=0,o=this.mergeCells.mergedCellInfoCollection.length;r<o;r++){var i=this.mergeCells.mergedCellInfoCollection[r],a=new d.CellCoords(i.row,i.col),s=new d.CellCoords(i.row+i.rowspan-1,i.col+i.colspan-1);t.expandByRange(new d.CellRange(a,a,s))&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},_=function(e,t){if(t&&"area"==t){if(this.getSettings().mergeCells)for(var n=this.getSelectedRange(),r=new d.CellRange(n.from,n.from,n.from),o=new d.CellRange(n.to,n.to,n.to),i=0,a=this.mergeCells.mergedCellInfoCollection.length;i<a;i++){var s=this.mergeCells.mergedCellInfoCollection[i],l=new d.CellCoords(s.row,s.col),u=new d.CellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=new d.CellRange(l,l,u);r.expandByRange(c)&&(e[0]=r.from.row,e[1]=r.from.col),o.expandByRange(c)&&(e[2]=o.from.row,e[3]=o.from.col)}}},S=function(e,t,n){if(this.getSettings().mergeCells){var r=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!r||r.row==e&&r.col==t||(n.copyable=!1)}},T=function e(t){if(this.getSettings().mergeCells)for(var n,r=this.countCols(),o=0;o<r;o++){if((n=this.mergeCells.mergedCellInfoCollection.getInfo(t.startRow,o))&&n.row<t.startRow)return t.startRow=n.row,e.call(this,t);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(t.endRow,o)){var i=n.row+n.rowspan-1;if(i>t.endRow)return t.endRow=i,e.call(this,t)}}},R=function e(t){if(this.getSettings().mergeCells)for(var n,r=this.countRows(),o=0;o<r;o++){if((n=this.mergeCells.mergedCellInfoCollection.getInfo(o,t.startColumn))&&n.col<t.startColumn)return t.startColumn=n.col,e.call(this,t);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(o,t.endColumn)){var i=n.col+n.colspan-1;if(i>t.endColumn)return t.endColumn=i,e.call(this,t)}}},M=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var r in t)if(n.highlight.row==t[r].row&&n.highlight.col==t[r].col&&n.to.row==t[r].row+t[r].rowspan-1&&n.to.col==t[r].col+t[r].colspan-1)return!1}return e},N=f.default.getSingleton();N.add("beforeInit",v),N.add("afterInit",m),N.add("afterUpdateSettings",y),N.add("beforeKeyDown",w),N.add("modifyTransformStart",E("modifyTransformStart")),N.add("modifyTransformEnd",E("modifyTransformEnd")),N.add("beforeSetRangeEnd",O),N.add("beforeDrawBorders",_),N.add("afterIsMultipleSelection",M),N.add("afterRenderer",C),N.add("afterContextMenuDefaultOptions",b),N.add("afterGetCellMeta",S),N.add("afterViewportRowCalculatorOverride",T),N.add("afterViewportColumnCalculatorOverride",R),N.add("modifyAutofillRange",i),N.add("afterCreateCol",a),N.add("afterRemoveCol",s),N.add("afterCreateRow",l),N.add("afterRemoveRow",u),t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(12),c=(r(u),n(1)),f=n(33),h=n(8),d=r(h),p=n(7),g=r(p),v=n(6),m=n(15),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.dragged=[],n.eventManager=null,n.lastSetCell=null,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return(0,f.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new g.default(this)),this.registerListeners(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){function e(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1==n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1==n&&(t.dragged=t.dragged.slice(-1))}var t=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(e){var n=void 0;return(0,c.hasClass)(e.target,"topLeftSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("topLeft"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):(0,c.hasClass)(e.target,"bottomRightSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("bottomRight"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(n){return(0,c.hasClass)(n.target,"topLeftSelectionHandle-HitArea")?(e.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):(0,c.hasClass)(n.target,"bottomRightSelectionHandle-HitArea")?(e.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(e){var n=(0,c.getWindowScrollTop)(),r=(0,c.getWindowScrollLeft)(),o=void 0,i=void 0,a=void 0,s=void 0,l=void 0,u=void 0,f=void 0;0!==t.dragged.length&&(o=document.elementFromPoint(e.touches[0].screenX-r,e.touches[0].screenY-n))&&o!==t.lastSetCell&&("TD"!=o.nodeName&&"TH"!=o.nodeName||(i=t.hot.getCoords(o),-1==i.col&&(i.col=0),a=t.hot.getSelectedRange(),s=a.getWidth(),l=a.getHeight(),u=a.getDirection(),1==s&&1==l&&t.hot.selection.setRangeEnd(i),f=t.getCurrentRangeCoords(a,i,t.touchStartRange.direction,u,t.dragged[0]),null!==f.start&&t.hot.selection.setRangeStart(f.start),t.hot.selection.setRangeEnd(f.end),t.lastSetCell=o),e.preventDefault())})}},{key:"getCurrentRangeCoords",value:function(e,t,n,r,o){var i=e.getTopLeftCorner(),a=e.getBottomRightCorner(),s=e.getBottomLeftCorner(),l=e.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="topLeft"==o?{start:new m.CellCoords(t.row,e.highlight.col),end:new m.CellCoords(s.row,t.col)}:{start:new m.CellCoords(e.highlight.row,t.col),end:new m.CellCoords(t.row,i.col)};break;case"SE-NW":"bottomRight"==o&&(u={start:new m.CellCoords(a.row,t.col),end:new m.CellCoords(t.row,i.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"==o?u={start:t,end:s}:u.end=t;break;case"NW-SE":"topLeft"==o?u={start:t,end:a}:u.end=t;break;case"SE-NW":"topLeft"==o?u={start:t,end:i}:u.end=t;break;case"SW-NE":"topLeft"==o?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(r){case"NW-SE":u="bottomRight"==o?{start:new m.CellCoords(t.row,i.col),end:new m.CellCoords(s.row,t.col)}:{start:new m.CellCoords(i.row,t.col),end:new m.CellCoords(t.row,a.col)};break;case"SW-NE":u="topLeft"==o?{start:new m.CellCoords(e.highlight.row,t.col),end:new m.CellCoords(t.row,a.col)}:{start:new m.CellCoords(t.row,i.col),end:new m.CellCoords(i.row,t.col)};break;case"SE-NW":"bottomRight"==o?u={start:new m.CellCoords(t.row,l.col),end:new m.CellCoords(i.row,t.col)}:"topLeft"==o&&(u={start:s,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==o&&(u.end=t);break;case"SE-NW":"topLeft"==o?u.end=t:u={start:t,end:i}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),t}(d.default);(0,v.registerPlugin)("multipleSelectionHandles",y),t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(328),h=(r(f),n(468)),d=r(h),p=n(0),g=n(6),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.observer=null,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.observer||(this.observer=new d.default(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(t){return e.onDataChange(t)}),this.addHook("afterCreateRow",function(){return e.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return e.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return e.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return e.onAfterTableAlter()}),this.addHook("afterChange",function(t,n){return e.onAfterTableAlter(n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(e){var t=this;if(!this.observer.isPaused()){var n=this.pluginName+".change",r={add:function(e){isNaN(e.col)?t.hot.runHooks("afterCreateRow",e.row,1,n):t.hot.runHooks("afterCreateCol",e.col,1,n)},remove:function(e){isNaN(e.col)?t.hot.runHooks("afterRemoveRow",e.row,1,n):t.hot.runHooks("afterRemoveCol",e.col,1,n)},replace:function(e){t.hot.runHooks("afterChange",[e.row,e.col,null,e.value],n)}};(0,p.arrayEach)(e,function(e){r[e.op]&&r[e.op](e)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(e){var t=this;"loadData"!==e&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return t.observer.resume()}))}},{key:"onAfterLoadData",value:function(e){e||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var e=this,t=this.hot;t.pauseObservingChanges=function(){return e.observer.pause()},t.resumeObservingChanges=function(){return e.observer.resume()},t.isPausedObservingChanges=function(){return e.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var e=this.hot;delete e.pauseObservingChanges,delete e.resumeObservingChanges,delete e.isPausedObservingChanges}}]),t}(c.default);t.default=v,(0,g.registerPlugin)("observeChanges",v)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(328),s=r(a),l=n(31),u=r(l),c=n(2),f=n(469),h=function(){function e(t){o(this,e),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(t)}return i(e,[{key:"setObservedData",value:function(e){var t=this;this.observer&&s.default.unobserve(this.observedData,this.observer),this.observedData=e,this.observer=s.default.observe(this.observedData,function(e){return t.onChange(e)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(e){this.runLocalHooks("change",(0,f.cleanPatches)(e))}},{key:"destroy",value:function(){s.default.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),e}();(0,c.mixin)(h,u.default),t.default=h},function(e,t,n){"use strict";function r(e){var t=[];return e=(0,a.arrayFilter)(e,function(e){return!/[\/]length/gi.test(e.path)&&!!o(e.path)}),e=(0,a.arrayMap)(e,function(e){var t=o(e.path);return e.row=t.row,e.col=t.col,e}),e=(0,a.arrayFilter)(e,function(e){if(-1!==["add","remove"].indexOf(e.op)&&!isNaN(e.col)){if(-1!==t.indexOf(e.col))return!1;t.push(e.col)}return!0}),t.length=0,e}function o(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);if(!t)return null;var n=i(t,3),r=n[1],o=n[2];return{row:parseInt(r,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}t.__esModule=!0;var i=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.cleanPatches=r,t.parsePath=o;var a=n(0)},function(e,t,n){"use strict";function r(e){var t,n=function(){window.localStorage[e+"__persistentStateKeys"]=JSON.stringify(t)},r=function(){t=[],n()};!function(){var n=window.localStorage[e+"__persistentStateKeys"],r="string"==typeof n?JSON.parse(n):void 0;t=r||[]}(),this.saveValue=function(r,o){window.localStorage[e+"_"+r]=JSON.stringify(o),-1==t.indexOf(r)&&(t.push(r),n())},this.loadValue=function(t,n){t=void 0===t?n:t;var r=window.localStorage[e+"_"+t];return void 0===r?void 0:JSON.parse(r)},this.reset=function(t){window.localStorage.removeItem(e+"_"+t)},this.resetAll=function(){for(var n=0;n<t.length;n++)window.localStorage.removeItem(e+"_"+t[n]);r()}}function o(){function e(){var e=this;for(var t in o)(0,s.hasOwnProperty)(o,t)&&e.addHook(t,o[t])}function t(){var e=this;for(var t in o)(0,s.hasOwnProperty)(o,t)&&e.removeHook(t,o[t])}var n=this;this.init=function(){var o=this,i=o.getSettings().persistentState;if(!(n.enabled=!!i))return void t.call(o);o.storage||(o.storage=new r(o.rootElement.id)),o.resetState=n.resetValue,e.call(o)},this.saveValue=function(e,t){this.storage.saveValue(e,t)},this.loadValue=function(e,t){t.value=this.storage.loadValue(e)},this.resetValue=function(e){var t=this;void 0===e?t.storage.resetAll():t.storage.reset(e)};var o={persistentStateSave:n.saveValue,persistentStateLoad:n.loadValue,persistentStateReset:n.resetValue};for(var i in o)(0,s.hasOwnProperty)(o,i)&&a.default.getSingleton().register(i)}t.__esModule=!0;var i=n(12),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=(n(6),n(2)),l=new o;a.default.getSingleton().add("beforeInit",l.init),a.default.getSingleton().add("afterUpdateSettings",l.init),t.default=o},function(e,t,n){"use strict";function r(e){this.query=function(t,n,o){var i=e.countRows(),a=e.countCols(),s=[];n||(n=r.global.getDefaultCallback()),o||(o=r.global.getDefaultQueryMethod());for(var l=0;l<i;l++)for(var u=0;u<a;u++){var c=e.getDataAtCell(l,u),f=e.getCellMeta(l,u),h=f.search.callback||n,d=f.search.queryMethod||o,p=d(t,c);if(p){var g={row:l,col:u,data:c};s.push(g)}h&&h(e,l,u,c,p)}return s}}function o(e,t,n,o,i,s,l){var c=null!==l.search&&"object"==a(l.search)&&l.search.searchResultClass||r.global.getDefaultSearchResultClass();l.isSearchResult?(0,u.addClass)(t,c):(0,u.removeClass)(t,c)}function i(){var e=this;!e.getSettings().search?delete e.search:e.search=new r(e)}t.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(12),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(1),c=n(13);r.DEFAULT_CALLBACK=function(e,t,n,r,o){e.getCellMeta(t,n).isSearchResult=o},r.DEFAULT_QUERY_METHOD=function(e,t){return!(void 0===e||null==e||!e.toLowerCase||0===e.length)&&(void 0!==t&&null!=t&&-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()))},r.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",r.global=function(){var e=r.DEFAULT_CALLBACK,t=r.DEFAULT_QUERY_METHOD,n=r.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return e},setDefaultCallback:function(t){e=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(e){t=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}();var f=(0,c.getRenderer)("base");(0,c.registerRenderer)("base",function(e,t,n,r,i,a,s){f.apply(this,arguments),o.apply(this,arguments)}),l.default.getSingleton().add("afterInit",i),l.default.getSingleton().add("afterUpdateSettings",i),t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(1),u=n(0),c=n(8),f=function(e){return e&&e.__esModule?e:{default:e}}(c),h=n(6),d=n(42),p=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return i(t,e),a(t,[{key:"isEnabled",value:function(){return(0,d.isTouchSupported)()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterRender",function(){return e.onAfterRender()}),this.registerEvents(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.leftOverlay,o=e.topLeftCornerOverlay,i=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,(0,u.arrayEach)(this.clones,function(e){(0,l.addClass)(e,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,(0,u.arrayEach)(this.clones,function(e){(0,l.removeClass)(e,"hide-tween"),(0,l.addClass)(e,"show-tween")}),setTimeout(function(){(0,u.arrayEach)(e.clones,function(e){(0,l.removeClass)(e,"show-tween")})},400),(0,u.arrayEach)(this.scrollbars,function(e){e.refresh(),e.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),t}(f.default);(0,h.registerPlugin)("touchScroll",p),t.default=p},function(e,t,n){"use strict";function r(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e,n){e&&"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&t.done(new r.ChangeAction(e))}),e.addHook("afterCreateRow",function(e,n,o){if("UndoRedo.undo"!==o&&"UndoRedo.undo"!==o&&"auto"!==o){var i=new r.CreateRowAction(e,n);t.done(i)}}),e.addHook("beforeRemoveRow",function(e,n,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=t.instance.getSourceDataArray();e=(a.length+e)%a.length;var s=(0,d.deepClone)(a.slice(e,e+n));t.done(new r.RemoveRowAction(e,s))}}),e.addHook("afterCreateCol",function(e,n,o){"UndoRedo.undo"!==o&&"UndoRedo.redo"!==o&&"auto"!==o&&t.done(new r.CreateColumnAction(e,n))}),e.addHook("beforeRemoveCol",function(n,o,i,a){if("UndoRedo.undo"!==a&&"UndoRedo.redo"!==a&&"auto"!==a){var s=t.instance.getSourceDataArray();n=(t.instance.countCols()+n)%t.instance.countCols();var l=[],u=[],c=[];(0,h.rangeEach)(s.length-1,function(t){var r=[],i=s[t];(0,h.rangeEach)(n,n+(o-1),function(t){r.push(i[e.runHooks("modifyCol",t)])}),l.push(r)}),(0,h.rangeEach)(o-1,function(t){c.push(e.runHooks("modifyCol",n+t))}),Array.isArray(e.getSettings().colHeaders)&&(0,h.rangeEach)(o-1,function(t){u.push(e.getSettings().colHeaders[e.runHooks("modifyCol",n+t)]||null)});var f=t.instance.getPlugin("manualColumnMove"),d=f.isEnabled()?f.columnsMapper.__arrayMap:[],p=new r.RemoveColumnAction(n,c,l,u,d);t.done(p)}}),e.addHook("beforeCellAlignment",function(e,n,o,i){var a=new r.CellAlignmentAction(e,n,o,i);t.done(a)}),e.addHook("beforeFilter",function(e){t.done(new r.FiltersAction(e))}),e.addHook("beforeRowMove",function(e,n){!1!==e&&t.done(new r.RowMoveAction(e,n))})}function o(){var e=this;void 0===e.getSettings().undo||e.getSettings().undo?e.undoRedo||(e.undoRedo=new r(e),s(e),e.addHook("beforeKeyDown",i),e.addHook("afterChange",a)):e.undoRedo&&(delete e.undoRedo,l(e),e.removeHook("beforeKeyDown",i),e.removeHook("afterChange",a))}function i(e){var t=this;(e.ctrlKey||e.metaKey)&&!e.altKey&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),(0,p.stopImmediatePropagation)(e)):90===e.keyCode&&(t.undoRedo.undo(),(0,p.stopImmediatePropagation)(e)))}function a(e,t){var n=this;if("loadData"===t)return n.undoRedo.clear()}function s(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function l(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}t.__esModule=!0;var u=n(12),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=n(0),h=n(4),d=n(2),p=n(10),g=n(15);r.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},r.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop(),t=(0,d.deepClone)(e),n=this.instance;if(!1===n.runHooks("beforeUndo",t))return;this.ignoreNewActions=!0;var r=this;e.undo(this.instance,function(){r.ignoreNewActions=!1,r.undoneActions.push(e)}),n.runHooks("afterUndo",t)}},r.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop(),t=(0,d.deepClone)(e),n=this.instance;if(!1===n.runHooks("beforeRedo",t))return;this.ignoreNewActions=!0;var r=this;e.redo(this.instance,function(){r.ignoreNewActions=!1,r.doneActions.push(e)}),n.runHooks("afterRedo",t)}},r.prototype.isUndoAvailable=function(){return this.doneActions.length>0},r.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},r.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},r.Action=function(){},r.Action.prototype.undo=function(){},r.Action.prototype.redo=function(){},r.ChangeAction=function(e){this.changes=e,this.actionType="change"},(0,d.inherit)(r.ChangeAction,r.Action),r.ChangeAction.prototype.undo=function(e,t){for(var n=(0,d.deepClone)(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;s<l;s++)e.getSettings().minSpareRows&&n[s][0]+1+e.getSettings().minSpareRows===e.countRows()&&r==e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(n[s][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&n[s][1]+1+e.getSettings().minSpareCols===e.countCols()&&o==e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(n[s][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())},r.ChangeAction.prototype.redo=function(e,t){for(var n=(0,d.deepClone)(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"UndoRedo.redo")},r.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},(0,d.inherit)(r.CreateRowAction,r.Action),r.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},r.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},r.RemoveRowAction=function(e,t){this.index=e,this.data=t,this.actionType="remove_row"},(0,d.inherit)(r.RemoveRowAction,r.Action),r.RemoveRowAction.prototype.undo=function(e,t){e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},r.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},r.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},(0,d.inherit)(r.CreateColumnAction,r.Action),r.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},r.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},r.RemoveColumnAction=function(e,t,n,r,o){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.actionType="remove_col"},(0,d.inherit)(r.RemoveColumnAction,r.Action),r.RemoveColumnAction.prototype.undo=function(e,t){var n=this,r=void 0,o=this.indexes.slice(0).sort(),i=function(e,t,r){return r[n.indexes.indexOf(o[t])]},a=[];(0,h.rangeEach)(this.data.length-1,function(e){a[e]=(0,f.arrayMap)(n.data[e],i)});var s=[];s=(0,f.arrayMap)(this.headers,i);var l=[];e.runHooks("beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),(0,h.rangeEach)(this.data.length-1,function(t){r=e.getSourceDataAtRow(t),(0,h.rangeEach)(o.length-1,function(e){r.splice(o[e],0,a[t][e]),l.push([t,o[e],null,a[t][e]])})}),e.getPlugin("formulas")&&e.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&(0,h.rangeEach)(s.length-1,function(t){e.getSettings().colHeaders.splice(o[t],0,s[t])}),e.getPlugin("manualColumnMove")&&(e.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),e.addHookOnce("afterRender",t),e.runHooks("afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),e.getPlugin("formulas")&&e.getPlugin("formulas").recalculateFull(),e.render()},r.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},r.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},r.CellAlignmentAction.prototype.undo=function(e,t){if(e.getPlugin("contextMenu").isEnabled()){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var r=this.range.from.col;r<=this.range.to.col;r++)e.setCellMeta(n,r,"className",this.stateBefore[n][r]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},r.CellAlignmentAction.prototype.redo=function(e,t){e.getPlugin("contextMenu").isEnabled()&&(e.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),e.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),e.addHookOnce("afterRender",t),e.render())},r.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},(0,d.inherit)(r.FiltersAction,r.Action),r.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},r.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()},r.RowMoveAction=function(e,t){this.rows=e.slice(),this.target=t},(0,d.inherit)(r.RowMoveAction,r.Action),r.RowMoveAction.prototype.undo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);for(var r=this.rows[0]<this.target?-1*this.rows.length:0,o=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],i=[],a=this.rows.length+r,s=r;s<a;s++)i.push(this.target+s);n.moveRows(i.slice(),o),e.render(),e.selection.setRangeStartOnly(new g.CellCoords(this.rows[0],0)),e.selection.setRangeEnd(new g.CellCoords(this.rows[this.rows.length-1],e.countCols()-1))},r.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t),n.moveRows(this.rows.slice(),this.target),e.render();var r=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selection.setRangeStartOnly(new g.CellCoords(r,0)),e.selection.setRangeEnd(new g.CellCoords(r+this.rows.length-1,e.countCols()-1))};var v=c.default.getSingleton();v.add("afterInit",o),v.add("afterUpdateSettings",o),v.register("beforeUndo"),v.register("afterUndo"),v.register("beforeRedo"),v.register("afterRedo"),t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.TrimRows=t.NestedRows=t.NestedHeaders=t.HiddenRows=t.HiddenColumns=t.HeaderTooltips=t.GanttChart=t.Formulas=t.Filters=t.ExportFile=t.DropdownMenu=t.ColumnSummary=t.CollapsibleColumns=t.BindRowsWithHeaders=void 0;var o=n(475),i=r(o),a=n(480),s=r(a),l=n(481),u=r(l),c=n(483),f=r(c),h=n(485),d=r(h),p=n(490),g=r(p),v=n(519),m=r(v),y=n(532),w=r(y),b=n(535),C=r(b),E=n(536),O=r(E),_=n(539),S=r(_),T=n(544),R=r(T),M=n(548),N=r(M),k=n(552),A=r(k);t.BindRowsWithHeaders=i.default,t.CollapsibleColumns=s.default,t.ColumnSummary=u.default,t.DropdownMenu=f.default,t.ExportFile=d.default,t.Filters=g.default,t.Formulas=m.default,t.GanttChart=w.default,t.HeaderTooltips=C.default,t.HiddenColumns=R.default,t.HiddenRows=N.default,t.NestedHeaders=O.default,t.NestedRows=S.default,t.TrimRows=A.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=(n(0),n(4)),h=n(6),d=n(476),p=r(d),g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.bindStrategy=new p.default,n.removedRows=[],n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof n&&(n=p.default.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(n),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(t){return e.onModifyRowHeader(t)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",e))}},{key:"onAfterCreateRow",value:function(e,t){this.bindStrategy.createRow(e,t)}},{key:"onBeforeRemoveRow",value:function(e,t){var n=this;this.removedRows.length=0,!1!==e&&(0,f.rangeEach)(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e))})}},{key:"onAfterRemoveRow",value:function(e,t){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(e){e||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,h.registerPlugin)("bindRowsWithHeaders",g),t.default=g},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n(54),n(2),n(4)),a=n(30),s=n(477),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.default=function(){function e(){r(this,e),this.strategy=null}return o(e,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),o(e,[{key:"setStrategy",value:function(e){var t=l[(0,a.toUpperCaseFirst)(e)];if(!t)throw new Error('Bind strategy "'+e+'" does not exist.');this.strategy=new t}},{key:"createMap",value:function(e){var t=this.strategy,n=void 0===e?t._arrayMap.length:e;t._arrayMap.length=0,(0,i.rangeEach)(n-1,function(e){t._arrayMap.push(e)})}},{key:"createRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.strategy.createRow.apply(this.strategy,t)}},{key:"removeRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.strategy.removeRow.apply(this.strategy,t)}},{key:"translate",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.strategy.getValueByIndex.apply(this.strategy,t)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.Strict=t.Loose=void 0;var o=n(478),i=r(o),a=n(479),s=r(a);t.Loose=i.default,t.Strict=s.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(2),l=function(){function e(){r(this,e)}return o(e,[{key:"createRow",value:function(e,t){this.shiftItems(e,t)}},{key:"removeRow",value:function(e,t){this.unshiftItems(e,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"loose"}}]),e}();(0,s.mixin)(l,a.default),t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(2),l=function(){function e(){r(this,e)}return o(e,[{key:"createRow",value:function(e,t){this.insertItems(e,t)}},{key:"removeRow",value:function(e,t){this.removeItems(e,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"strict"}}]),e}();(0,s.mixin)(l,a.default),t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(2),c=n(0),f=n(4),h=n(1),d=n(7),p=r(d),g=n(6),v=n(10),m=n(8),y=r(m),w=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings=null,n.buttonEnabledList={},n.hiddenColumnsPlugin=null,n.nestedHeadersPlugin=null,n.collapsedSections={},n.columnHeaderLevelCount=null,n.eventManager=null,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return e.onAfterRender()}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetColHeader(t,n)}),this.addHook("beforeOnCellMouseDown",function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)}),this.eventManager=new p.default(this.hot),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};(0,f.rangeEach)(0,e-1,function(e){var i=t.childNodes[e],a=n.childNodes[e],s=r?r.childNodes[e]:null;(0,f.rangeEach)(0,i.childNodes.length-1,function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".collapsibleIndicator"),o(t)),r&&s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(".collapsibleIndicator"),o(t))})},!0)}}},{key:"parseSettings",value:function(){var e=this;(0,u.objectEach)(this.settings,function(t){e.buttonEnabledList[t.row]||(e.buttonEnabledList[t.row]={}),e.buttonEnabledList[t.row][t.col]=t.collapsible})}},{key:"meetsDependencies",value:function(){var e=this.hot.getSettings();return e.nestedHeaders&&e.hiddenColumns}},{key:"checkDependencies",value:function(){var e=this.hot.getSettings();this.meetsDependencies()||(e.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),e.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(e,t){var n=t.parentNode,r=n.parentNode,o=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[o]||!this.buttonEnabledList[o][e]))return null;var i=document.createElement("DIV");return(0,h.addClass)(i,"collapsibleIndicator"),this.collapsedSections[o]&&!0===this.collapsedSections[o][e]?((0,h.addClass)(i,"collapsed"),(0,h.fastInnerText)(i,"+")):((0,h.addClass)(i,"expanded"),(0,h.fastInnerText)(i,"-")),i}},{key:"markSectionAs",value:function(e,t,n,r){switch(this.collapsedSections[t]||(this.collapsedSections[t]={}),e){case"collapsed":this.collapsedSections[t][n]=!0;break;case"expanded":this.collapsedSections[t][n]=void 0}if(r)for(var o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(t),a=this.nestedHeadersPlugin.getChildHeaders(t,n),s=o[i+1],l=1;l<a.length;l++)s&&s[a[l]].colspan>1&&this.markSectionAs(e,t+1,a[l],!0)}},{key:"expandSection",value:function(e){this.markSectionAs("expanded",e.row,e.col,!0),this.toggleCollapsibleSection(e,"expand")}},{key:"collapseSection",value:function(e){this.markSectionAs("collapsed",e.row,e.col,!0),this.toggleCollapsibleSection(e,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.nestedHeadersPlugin.colspanArray;!0===this.settings?(0,c.arrayEach)(n,function(n,r){(0,c.arrayEach)(n,function(n,o){if(n.colspan>1){r=parseInt(r,10),o=parseInt(o,10);var i=t.nestedHeadersPlugin.levelToRowCoords(r),a=o;t.markSectionAs("collapse"===e?"collapsed":"expanded",i,a,!0),t.toggleCollapsibleSection({row:i,col:a},e)}})}):(0,u.objectEach)(this.buttonEnabledList,function(n,r){(0,u.objectEach)(n,function(n,o){r=parseInt(r,10),o=parseInt(o,10),t.markSectionAs("collapse"===e?"collapsed":"expanded",r,o,!0),t.toggleCollapsibleSection({row:r,col:o},e)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;e.row&&(e.row=parseInt(e.row,10)),e.col&&(e.col=parseInt(e.col,10));for(var r=this.hiddenColumnsPlugin.hiddenColumns,o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e.row),a=o[i][e.col].colspan,s=this.nestedHeadersPlugin.getChildHeaders(e.row,e.col),l=i+1,u=o[l],c=u?u[s[0]].colspan||1:1;c===a&&l<this.columnHeaderLevelCount;)l+=1,u=o[l],c=u?u[s[0]].colspan||1:1;(0,f.rangeEach)(c,a-1,function(o){var i=e.col+o;switch(t){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||r.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&r.splice(r.indexOf(i),1)}}),this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){if(t.hasAttribute("colspan")&&t.getAttribute("colspan")>1&&e>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(e,t);null!==n&&t.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){if((0,h.hasClass)(e.target,"collapsibleIndicator"))return(0,h.hasClass)(e.target,"expanded")?(this.collapsedSections[t.row]||(this.collapsedSections[t.row]=[]),this.markSectionAs("collapsed",t.row,t.col,!0),this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection(t,"collapse")):(0,h.hasClass)(e.target,"collapsed")&&(this.markSectionAs("expanded",t.row,t.col,!0),this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection(t,"expand")),(0,v.stopImmediatePropagation)(e),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(y.default);(0,g.registerPlugin)("collapsibleColumns",w),t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(2),h=(n(0),n(6)),d=n(482),p=r(d),g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.endpoints=null,n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new p.default(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit.apply(e,arguments)}),this.addHook("afterChange",function(){return e.onAfterChange.apply(e,arguments)}),this.addHook("beforeCreateRow",function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,r)}),this.addHook("beforeCreateCol",function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,r)}),this.addHook("beforeRemoveRow",function(){for(var t,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(r))}),this.addHook("beforeRemoveCol",function(){for(var t,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(r))}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove.apply(e,arguments)}),this.addHook("afterCreateRow",function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,r)}),this.addHook("afterCreateCol",function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,r)}),this.addHook("afterRemoveRow",function(){for(var t,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(r))}),this.addHook("afterRemoveCol",function(){for(var t,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(r))}),this.addHook("afterRowMove",function(){return e.onAfterRowMove.apply(e,arguments)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}},{key:"calculateSum",value:function(e){var t=0;for(var n in e.ranges)(0,f.hasOwnProperty)(e.ranges,n)&&(t+=this.getPartialSum(e.ranges[n],e.sourceColumn));return t}},{key:"getPartialSum",value:function(e,t){var n=0,r=e[1]||e[0],o=null,i=0;do{o=this.getCellValue(r,t)||0;var a=((o+"").split(".")[1]||[]).length||1;a>i&&(i=a),n+=o||0,r--}while(r>=e[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(e,t){var n=null;for(var r in e.ranges)if((0,f.hasOwnProperty)(e.ranges,r)){var o=this.getPartialMinMax(e.ranges[r],e.sourceColumn,t);if(null===n&&null!==o&&(n=o),null!==o)switch(t){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o)}}return null===n?"Not enough data":n}},{key:"getPartialMinMax",value:function(e,t,n){var r=null,o=e[1]||e[0],i=void 0;do{if(i=this.getCellValue(o,t)||null,null===r)r=i;else if(null!==i)switch(n){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i)}o--}while(o>=e[0]);return r}},{key:"countEmpty",value:function(e,t){var n=void 0,r=0,o=e[1]||e[0];do{n=this.getCellValue(o,t),n||r++,o--}while(o>=e[0]);return r}},{key:"countEntries",value:function(e){var t=0,n=e.ranges;for(var r in n)if((0,f.hasOwnProperty)(n,r)){var o=void 0===n[r][1]?1:n[r][1]-n[r][0]+1,i=this.countEmpty(n[r],e.sourceColumn);t+=o,t-=i}return t}},{key:"calculateAverage",value:function(e){return this.calculateSum(e)/this.countEntries(e)}},{key:"getCellValue",value:function(e,t){var n=this.endpoints.getVisualRowIndex(e),r=this.endpoints.getVisualColumnIndex(t),o=this.hot.getSourceDataAtCell(e,t);if((this.hot.getCellMeta(n,r).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+e+", "+t+") is not in a numeric format. Cannot do the calculation.");return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onBeforeRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}]),t}(c.default);(0,h.registerPlugin)("columnSummary",g),t.default=g},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=(n(2),n(53));t.default=function(){function e(t,n){r(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=(0,s.getTranslator)(this.hot)}return i(e,[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[];return e||"function"!=typeof this.settings?(e||(e=this.settings),(0,a.arrayEach)(e,function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)}),n):void(this.settingsType="function")}},{key:"assignSetting",value:function(e,t,n,r){if("ranges"===n&&void 0===e[n])return void(t[n]=r);if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else t[n]="destinationRow"===n&&t.reversedRowCoords?this.hot.countRows()-e[n]-1:e[n]}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n,r,o){if("function"===this.settingsType){var i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();(0,a.arrayEach)(s,function(r,o,a){"row"===i&&r.destinationRow>=t&&("insert_row"===e?r.alterRowOffset=n:"remove_row"===e&&(r.alterRowOffset=-1*n)),"col"===i&&r.destinationColumn>=t&&("insert_col"===e?r.alterColumnOffset=n:"remove_col"===e&&(r.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,r,o){var i=this,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){return void this.hot.addHookOnce("beforeRender",function e(){return i.hot.removeHook("beforeRender",e),i.refreshAllEndpoints(!0)})}var l=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),f=0===e.indexOf("move_row"),h=t;(0,a.arrayEach)(c,function(e,t,r){"row"===l&&e.destinationRow>=h&&(e.alterRowOffset=u*n),"col"===l&&e.destinationColumn>=h&&(e.alterColumnOffset=u*n)}),this.resetAllEndpoints(c,!f),f?(0,a.arrayEach)(c,function(e,t,n){i.extendEndpointRanges(e,h,r[0],r.length),i.recreatePhysicalRanges(e),i.clearOffsetInformation(e)}):(0,a.arrayEach)(c,function(e,t,n){i.shiftEndpointCoordinates(e,h)}),s&&this.refreshAllEndpoints(!0)}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,r){(0,a.arrayEach)(e.ranges,function(e,o){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]++,e[1]++)))})}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,r=[],o=[];(0,a.arrayEach)(n,function(e){var n=[];if(e[1])for(var r=e[0];r<=e[1];r++)n.push(t.recordTranslator.toPhysicalRow(r));else n.push(t.recordTranslator.toPhysicalRow(e[0]));o.push(n)}),(0,a.arrayEach)(o,function(e){var t=[];(0,a.arrayEach)(e,function(n,o){0===o?t.push(n):e[o]!==e[o-1]+1&&(t.push(e[o-1]),r.push(t),t=[],t.push(n)),o===e.length-1&&(t.push(n),r.push(t))})}),e.ranges=r}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,(0,a.arrayEach)(e.ranges,function(n,r){(0,a.arrayEach)(n,function(r,o){r>=t&&(n[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.cellsToSetCache=[],e||(e=this.getAllEndpoints()),(0,a.arrayEach)(e,function(e){t.resetEndpointValue(e,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(e){var t=this;this.cellsToSetCache=[],(0,a.arrayEach)(this.getAllEndpoints(),function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],(0,a.arrayEach)(e,function(e,r,o){(e[2]||"")+""!=e[3]+""&&(0,a.arrayEach)(t.getAllEndpoints(),function(e,i){t.hot.propToCol(o[r][1])===e.sourceColumn&&-1===n.indexOf(i)&&n.push(i)})}),(0,a.arrayEach)(n,function(e){t.refreshEndpoint(t.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0,i=this.recordTranslator.toVisual(e.destinationRow,e.destinationColumn),a=o(i,2),s=a[0],l=a[1],u=this.hot.getCellMeta(s,l);u.readOnly=!1,u.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(e.destinationRow+(t?n:0)),this.recordTranslator.toVisualColumn(e.destinationColumn+(t?r:0)),""])}},{key:"setEndpointValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,i=this.getVisualRowIndex(e.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(e.destinationRow+r),e.destinationColumn+o);if(i>this.hot.countRows()||e.destinationColumn>this.hot.countCols())return void this.throwOutOfBoundsWarning();"init"!==t&&a.readOnly===e.readOnly||(a.readOnly=e.readOnly,a.className="columnSummaryResult"),e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"getVisualRowIndex",value:function(e){return this.hot.runHooks("unmodifyRow",e,"columnSummary")}},{key:"getVisualColumnIndex",value:function(e){return this.hot.runHooks("unmodifyCol",e,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(8),c=r(u),f=n(0),h=(n(2),n(324)),d=r(h),p=n(7),g=r(p),v=n(1),m=n(325),y=r(m),w=n(157),b=r(w),C=n(6),E=n(12),O=r(E),_=n(10),S=n(43);n(484),O.default.getSingleton().register("afterDropdownMenuDefaultOptions"),O.default.getSingleton().register("afterDropdownMenuShow"),O.default.getSingleton().register("afterDropdownMenuHide"),O.default.getSingleton().register("afterDropdownMenuExecute");var T=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new g.default(n),n.commandExecutor=new d.default(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",function(e,t){return n.onAfterGetColHeader(e,t)}),n}return a(t,e),l(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[S.COLUMN_LEFT,S.COLUMN_RIGHT,S.SEPARATOR,S.REMOVE_COLUMN,S.SEPARATOR,S.CLEAR_COLUMN,S.SEPARATOR,S.READ_ONLY,S.SEPARATOR,S.ALIGNMENT]}}]),l(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new y.default(this.hot,t.DEFAULT_ITEMS);var n=this.hot.getSettings().dropdownMenu,r={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",r),e.itemsFactory.setPredefinedItems(r.items);var t=e.itemsFactory.getItems(n);e.menu&&e.menu.destroy(),e.menu=new b.default(e.hot,{className:"htDropdownMenu",keepInViewport:!0}),e.hot.runHooks("beforeDropdownMenuSetItems",t),e.menu.setMenuItems(t),e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()}),e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()}),e.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.apply(e,n)}),(0,f.arrayEach)(t,function(t){return e.commandExecutor.registerCommand(t.key,t)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,t)}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if((0,_.stopPropagation)(e),(0,v.hasClass)(e.target,"changeType")&&!this.menu.isOpened()){var t=e.target.getBoundingClientRect();this.open({left:t.left,top:t.top+e.target.offsetHeight+3,width:t.width,height:t.height})}}},{key:"onAfterGetColHeader",value:function(e,t){var n=t.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(e<0||o!==r.length-1)){var i=t.querySelector(".changeType");if(!this.enabled||!i){if(!this.enabled)return void(i&&i.parentNode.removeChild(i));var a=document.createElement("button");a.className="changeType",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}}}}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);T.SEPARATOR={name:S.SEPARATOR},(0,C.registerPlugin)("dropdownMenu",T),t.default=T},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(8),u=r(l),c=(n(2),n(6)),f=n(486),h=r(f),d=n(487),p=r(d),g=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){return this._createTypeFormatter(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).export()}},{key:"exportAsBlob",value:function(e){return this._createBlob(this._createTypeFormatter(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._createTypeFormatter(e,t),r=this._createBlob(n),o=window.URL||window.webkitURL,i=document.createElement("a"),a=n.options.filename+"."+n.options.fileExtension;if(void 0!==i.download){var s=o.createObjectURL(r);i.style.display="none",i.setAttribute("href",s),i.setAttribute("download",a),document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i),setTimeout(function(){o.revokeObjectURL(s)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!d.EXPORT_TYPES[e])throw new Error('Export format type "'+e+'" is not supported.');return(0,p.default)(e,new h.default(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:e.options.mimeType+";charset="+e.options.encoding})),t}}]),t}(u.default);(0,c.registerPlugin)("exportFile",g),t.default=g},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(n(0),n(2),n(4));t.default=function(){function e(t){r(this,e),this.hot=t,this.options={}}return i(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,i=t.endCol,s=this.options,l=[];return(0,a.rangeEach)(n,o,function(t){var n=[];!s.exportHiddenRows&&e._isHiddenRow(t)||((0,a.rangeEach)(r,i,function(r){!s.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))}),l.push(n))}),l}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();(0,a.rangeEach)(r,o,function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(i[n])})}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();(0,a.rangeEach)(r,o,function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(i[n])})}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=o(this.options.range,4),r=n[0],i=void 0===r?0:r,a=n[1],s=void 0===a?0:a,l=n[2],u=void 0===l?t:l,c=n[3],f=void 0===c?e:c;return i=Math.max(i,0),s=Math.max(s,0),u=Math.min(u,t),f=Math.min(f,e),{startRow:i,startCol:s,endRow:u,endCol:f}}},{key:"_isHiddenRow",value:function(e){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",e)}},{key:"_isHiddenColumn",value:function(e){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",e)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n){return"function"==typeof s[e]?new s[e](t,n):null}t.__esModule=!0,t.EXPORT_TYPES=t.TYPE_PDF=t.TYPE_EXCEL=t.TYPE_CSV=void 0,t.default=r;var o=n(488),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=t.TYPE_CSV="csv",s=(t.TYPE_EXCEL="excel",t.TYPE_PDF="pdf",t.EXPORT_TYPES=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,i.default))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=n(16),u=n(489),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=String.fromCharCode(13),h=String.fromCharCode(34),d=String.fromCharCode(10);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"export",value:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,l="\ufeff";return o&&(r=(0,s.arrayMap)(r,function(t){return e._escapeCell(t,!0)}),a&&(l+=t.columnDelimiter),l+=r.join(t.columnDelimiter),l+=t.rowDelimiter),(0,s.arrayEach)(n,function(n,r){r>0&&(l+=t.rowDelimiter),a&&(l+=e._escapeCell(i[r])+t.columnDelimiter),l+=n.map(function(t){return e._escapeCell(t)}).join(t.columnDelimiter)}),l}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=(0,l.stringify)(e),""!==e&&(t||e.indexOf(f)>=0||e.indexOf(h)>=0||e.indexOf(d)>=0||e.indexOf(this.options.columnDelimiter)>=0)&&(e=e.replace(new RegExp('"',"g"),'""'),e='"'+e+'"'),e}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}}]),t}(c.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n(0),n(2)),a=(n(4),n(30));t.default=function(){function e(t,n){r(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return o(e,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),o(e,[{key:"_mergeOptions",value:function(t){var n=(0,i.clone)(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=(0,i.extend)((0,i.clone)(e.DEFAULT_OPTIONS),n),n=(0,i.extend)(n,t),n.filename=(0,a.substitute)(n.filename,{YYYY:r.getFullYear(),MM:(r.getMonth()+1+"").padStart(2,"0"),DD:(r.getDate()+"").padStart(2,"0")}),n}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The filter conditions have been applied properly, but couldnât be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldnât be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."]),f=n(8),h=r(f),d=n(0),p=n(61),g=n(4),v=n(7),m=r(v),y=n(1),w=n(6),b=n(43),C=n(3),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(C),O=n(491),_=r(O),S=n(511),T=r(S),R=n(513),M=r(R),N=n(516),k=r(N),A=n(337),I=r(A),D=n(338),P=r(D),x=n(517),L=r(x),H=n(63),j=n(158);n(518);var V=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new m.default(n),n.trimRowsPlugin=null,n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.hot.addHook("afterGetColHeader",function(e,t){return n.onAfterGetColHeader(e,t)}),n}return a(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var n=function(t){return t.addLocalHook("accept",function(){return e.onActionBarSubmit("accept")}),t.addLocalHook("cancel",function(){return e.onActionBarSubmit("cancel")}),t.addLocalHook("change",function(n){return e.onComponentChange(t,n)}),t},r=function(){return e.hot.getTranslatedPhrase(E.FILTERS_DIVS_FILTER_BY_CONDITION)+":"},o=function(){return e.hot.getTranslatedPhrase(E.FILTERS_DIVS_FILTER_BY_VALUE)+":"};if(!this.components.get("filter_by_condition")){var i=new _.default(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1});i.addLocalHook("afterClose",function(){return e.onSelectUIClosed()}),this.components.set("filter_by_condition",n(i))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new T.default(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var a=new _.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0});a.addLocalHook("afterClose",function(){return e.onSelectUIClosed()}),this.components.set("filter_by_condition2",n(a))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new M.default(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new k.default(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new I.default),this.conditionUpdateObserver||(this.conditionUpdateObserver=new L.default(this.conditionCollection,function(t){return e.getDataMapAtColumn(t)}),this.conditionUpdateObserver.addLocalHook("update",function(t){return e.updateComponents(t)})),this.components.forEach(function(e){e.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(t){return e.onBeforeDropdownMenuSetItems(t)}),this.addHook("afterDropdownMenuDefaultOptions",function(t){return e.onAfterDropdownMenuDefaultOptions(t)}),this.addHook("afterDropdownMenuShow",function(){return e.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return e.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(t,n){return e.onAfterChange(t)}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(e){e.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll()),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j.OPERATION_AND;this.conditionCollection.addCondition(this.t.toPhysicalColumn(e),{command:{key:t},args:n},r)}},{key:"removeConditions",value:function(e){this.conditionCollection.removeConditions(this.t.toPhysicalColumn(e))}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{this.conditionCollection.clearConditions(this.t.toPhysicalColumn(e))}}},{key:"filter",value:function(){var e=this._createDataFilter(),t=!this.conditionCollection.isEmpty(),n=[],r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(t){var o=[];this.trimRowsPlugin.trimmedRows.length=0,n=(0,d.arrayMap)(e.filter(),function(e){return e.meta.visualRow});var i=(0,H.createArrayAssertion)(n);(0,g.rangeEach)(this.hot.countSourceRows()-1,function(e){i(e)||o.push(e)}),this.trimRowsPlugin.trimRows(o),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",r)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e=this.hot.getSelected()||[],t=s(e,2),n=t[0],r=t[1];void 0!==n&&void 0!==r&&this.hot.selectCell(n,r)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.t.toVisualColumn(e),r=[];return(0,d.arrayEach)(this.hot.getSourceDataAtCol(n),function(e,o){var i=t.hot.getCellMeta(o,n);r.push({meta:{row:i.row,col:i.col,visualCol:i.visualCol,visualRow:i.visualRow,type:i.type,instance:i.instance,dateFormat:i.dateFormat},value:(0,H.toEmptyString)(e)})}),r}},{key:"onAfterChange",value:function(e){var t=this;e&&(0,d.arrayEach)(e,function(e){var n=s(e,2),r=n[1],o=t.hot.propToCol(r);t.updateValueComponentCondition(o)})}},{key:"updateValueComponentCondition",value:function(e){var t=this.hot.getDataAtCol(e);this.conditionUpdateObserver.updateStatesAtColumn(e,(0,H.unifyColumnValues)(t))}},{key:"onAfterDropdownMenuShow",value:function(){var e=this.getSelectedColumn(),t=e&&e.physicalIndex;this.components.forEach(function(e){!e.isHidden()&&e.setState&&e.restoreState(t)})}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(e){var t=(0,d.arrayMap)(e,function(e){return e.key});this.components.forEach(function(e){e[-1===t.indexOf(e.getMenuItemDescriptor().key)?"hide":"show"]()}),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:b.SEPARATOR}),this.components.forEach(function(t){e.items.push(t.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(e,t,n,r){var o=e;return o===j.OPERATION_OR&&t.command.key!==j.CONDITION_NONE&&n.command.key!==j.CONDITION_NONE&&r.command.key!==j.CONDITION_NONE?o=j.OPERATION_OR_THEN_VARIABLE:r.command.key!==j.CONDITION_NONE&&(t.command.key!==j.CONDITION_NONE&&n.command.key!==j.CONDITION_NONE||(o=j.OPERATION_AND)),o}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t=this.getSelectedColumn(),n=t&&t.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,i);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(n),r.command.key===j.CONDITION_NONE&&o.command.key===j.CONDITION_NONE&&i.command.key===j.CONDITION_NONE?this.conditionCollection.removeConditions(n):(r.command.key!==j.CONDITION_NONE&&(this.conditionCollection.addCondition(n,r,a),o.command.key!==j.CONDITION_NONE&&this.conditionCollection.addCondition(n,o,a)),i.command.key!==j.CONDITION_NONE&&this.conditionCollection.addCondition(n,i,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(n),this.components.get("filter_by_value").saveState(n),this.saveHiddenRowsCache(n),this.trimRowsPlugin.trimmedRows.length=0,this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(e,t){e===this.components.get("filter_by_condition")&&(t.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))),e.constructor!==_.default||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(e,t){var n=this.t.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?(0,y.addClass)(t,"htFiltersActive"):(0,y.removeClass)(t,"htFiltersActive")}},{key:"onTableClick",value:function(e){var t=(0,y.closest)(e.target,"TH");if(t){var n=this.hot.getCoords(t).col;this.lastSelectedColumn={visualIndex:n,physicalIndex:this.t.toPhysicalColumn(n)}}}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(e){e.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin()),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var e=this;return new P.default(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection,function(t){return e.getDataMapAtColumn(t)})}},{key:"updateComponents",value:function(e){if(this.dropdownMenuPlugin.enabled){var t=e.editedConditionStack.conditions,n=e.editedConditionStack.column,r=t.filter(function(e){return e.name===j.CONDITION_BY_VALUE}),o=t.filter(function(e){return e.name!==j.CONDITION_BY_VALUE}),i=this.conditionCollection.columnTypes[n];2===r.length||3===o.length?console.warn((0,p.toSingleLine)(c)):(o.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),n),this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_by_value").updateState(e),this.components.get("filter_operators").updateState(i,n))}}},{key:"showComponentForParticularColumn",value:function(e,t){if(this.hiddenRowsCache.has(t)){this.removeIndexesFromHiddenRowsCache(t,this.getIndexesOfComponents(e))}else this.hiddenRowsCache.set(t,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(e,t){var n=this.hiddenRowsCache.get(e);(0,d.arrayEach)(t,function(e){n.includes(e)&&n.splice(n.indexOf(e),1)})}},{key:"hideComponentForParticularColumn",value:function(e,t){if(this.hiddenRowsCache.has(t)){this.addIndexesToHiddenRowsCache(t,this.getIndexesOfComponents(e))}else this.hiddenRowsCache.set(t,this.getIndexesOfComponents(e))}},{key:"addIndexesToHiddenRowsCache",value:function(e,t){var n=this.hiddenRowsCache.get(e);(0,d.arrayEach)(t,function(e){-1===n.indexOf(e)&&n.push(e)})}},{key:"getIndexesOfComponents",value:function(){for(var e=this.dropdownMenuPlugin.menu,t=[],n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(0,d.arrayEach)(r,function(n){(0,d.arrayEach)(e.menuItems,function(e,r){e.key===n.getMenuItemDescriptor().key&&t.push(r)})}),t}},{key:"changeComponentsVisibility",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.dropdownMenuPlugin.menu,n=t.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,i);e?r.showRows(s):r.hideRows(s),n.render()}},{key:"initHiddenRowsCache",value:function(){var e=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var t=e.lastSelectedColumn.physicalIndex;e.hiddenRowsCache.has(t)||e.hiddenRowsCache.set(t,e.getIndexesOfComponents(e.components.get("filter_operators"),e.components.get("filter_by_condition2"))),e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:e.hiddenRowsCache.get(t)}})})}},{key:"saveHiddenRowsCache",value:function(e){this.hiddenRowsCache.set(e,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}}]),t}(h.default);(0,w.registerPlugin)("filters",V),t.default=V},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(1),c=n(10),f=n(0),h=n(18),d=n(2),p=n(3),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),v=n(84),m=r(v),y=n(158),w=r(y),b=n(160),C=r(b),E=n(510),O=r(E),_=n(9);t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.id=n.id,r.name=n.name,r.addSeparator=n.addSeparator,r.elements.push(new O.default(r.hot)),r.elements.push(new C.default(r.hot,{placeholder:g.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),r.elements.push(new C.default(r.hot,{placeholder:g.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),r.registerHooks(),r}return a(t,e),s(t,[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",function(t){return e.onConditionSelect(t)}),this.getSelectElement().addLocalHook("afterClose",function(){return e.onSelectUIClosed()}),(0,f.arrayEach)(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})})}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=(0,d.clone)(e.command);n.name.startsWith(g.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),(0,f.arrayEach)(e.args,function(e,r){if(r>n.inputsCount-1)return!1;var o=t.getInputElement(r);o.setValue(e),o[n.inputsCount>r?"show":"hide"](),r||setTimeout(function(){return o.focus()},10)})}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||(0,_.getConditionDescriptor)(y.CONDITION_NONE),t=[];return(0,f.arrayEach)(this.getInputElements(),function(n,r){e.inputsCount>r&&t.push(n.getValue())}),{command:e,args:t}}},{key:"updateState",value:function(e,t){this.setCachedState(t,{command:(0,_.getConditionDescriptor)(e?e.name:y.CONDITION_NONE),args:e?e.args:[]}),e||(0,f.arrayEach)(this.getInputElements(),function(e){return e.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(e){return e instanceof O.default})[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter(function(e){return e instanceof C.default})}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){(0,u.addClass)(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&(0,u.addClass)(n.parentNode,"border");var s=document.createElement("div");return(0,u.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),(0,f.arrayEach)(e.elements,function(e){return n.appendChild(e.element)}),n}}}},{key:"reset",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),n=e&&e.visualIndex,r=this.hot.getDataType.apply(this.hot,this.hot.getSelected()||[0,n]),o=(0,w.default)(r);(0,f.arrayEach)(this.getInputElements(),function(e){return e.hide()}),this.getSelectElement().setItems(o),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(e){(0,f.arrayEach)(this.getInputElements(),function(t,n){t[e.inputsCount>n?"show":"hide"](),n||setTimeout(function(){return t.focus()},10)}),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){(0,h.isKey)(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),(0,c.stopImmediatePropagation)(e)):(0,h.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,c.stopImmediatePropagation)(e))}}]),t}(m.default)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0;var o,i=(n(0),n(2)),a=function(e,t){return e._states["state_"+t]},s=function(e,t,n){e._states["state_"+t]=n},l=(o={},r(o,"_states",{}),r(o,"getCachedState",function(e){return a(this,e)}),r(o,"setCachedState",function(e,t){s(this,e,t)}),r(o,"saveState",function(e){s(this,e,this.getState())}),r(o,"restoreState",function(e){this.setState(a(this,e))}),r(o,"hasSavedState",function(e){return void 0!==a(this,e)}),r(o,"clearState",function(e){s(this,e)}),r(o,"clearStates",function(){this._states={}}),o);(0,i.defineGetter)(l,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1}),t.default=l},function(e,t,n){"use strict";function r(){return!0}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);(0,n(9).registerCondition)(t.CONDITION_NAME="none",r,{name:i.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},function(e,t,n){"use strict";function r(e,t){return!(0,a.getCondition)(s.CONDITION_NAME,t)(e)}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(9),s=n(329),l=t.CONDITION_NAME="not_empty";(0,a.registerCondition)(l,r,{name:i.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},function(e,t,n){"use strict";function r(e,t){return!(0,a.getCondition)(s.CONDITION_NAME,t)(e)}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(9),s=n(330),l=t.CONDITION_NAME="neq";(0,a.registerCondition)(l,r,{name:i.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i);(0,n(9).registerCondition)(t.CONDITION_NAME="gt",r,{name:a.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i);(0,n(9).registerCondition)(t.CONDITION_NAME="gte",r,{name:a.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i);(0,n(9).registerCondition)(t.CONDITION_NAME="lt",r,{name:a.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i);(0,n(9).registerCondition)(t.CONDITION_NAME="lte",r,{name:a.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e,t){return!(0,a.getCondition)(s.CONDITION_NAME,t)(e)}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(9),s=n(331),l=t.CONDITION_NAME="not_between";(0,a.registerCondition)(l,r,{name:i.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return(0,s.stringify)(e.value).toLowerCase().startsWith((0,s.stringify)(r))}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=n(16);(0,n(9).registerCondition)(t.CONDITION_NAME="begins_with",r,{name:a.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues,n=o(t,1),r=n[0];return(0,s.stringify)(e.value).toLowerCase().endsWith((0,s.stringify)(r))}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=n(16);(0,n(9).registerCondition)(t.CONDITION_NAME="ends_with",r,{name:a.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e,t){return!(0,a.getCondition)(s.CONDITION_NAME,t)(e)}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(9),s=n(334),l=t.CONDITION_NAME="not_contains";(0,a.registerCondition)(l,r,{name:i.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},function(e,t,n){"use strict";function r(e){var t=(0,i.default)(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame((0,i.default)().subtract(-1,"days").startOf("day"),"d")}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a);(0,n(9).registerCondition)(t.CONDITION_NAME="date_tomorrow",r,{name:s.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(e,t,n){"use strict";function r(e){var t=(0,i.default)(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame((0,i.default)().startOf("day"),"d")}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a);(0,n(9).registerCondition)(t.CONDITION_NAME="date_today",r,{name:s.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(e,t,n){"use strict";function r(e){var t=(0,i.default)(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame((0,i.default)().subtract(1,"days").startOf("day"),"d")}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a);(0,n(9).registerCondition)(t.CONDITION_NAME="date_yesterday",r,{name:s.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:inputValues;return(0,o(t,1)[0])(e.value)}t.__esModule=!0,t.CONDITION_NAME=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.condition=r;var i=n(3),a=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(i),n(9)),s=n(63);(0,a.registerCondition)(t.CONDITION_NAME="by_value",r,{name:"By value",inputsCount:0,inputValuesDecorator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:inputValues,t=o(e,1);return[(0,s.createArrayAssertion)(t[0])]},showOperators:!1})},function(e,t,n){"use strict";function r(){return!0}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3);!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(o);(0,n(9).registerCondition)(t.CONDITION_NAME="true",r,{name:"True"})},function(e,t,n){"use strict";function r(){return!1}t.__esModule=!0,t.CONDITION_NAME=void 0,t.condition=r;var o=n(3);!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(o);(0,n(9).registerCondition)(t.CONDITION_NAME="false",r,{name:"False"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(157),c=r(u),f=n(2),h=n(0),d=n(3),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(d),g=n(43),v=n(65),m=r(v),y=new WeakMap;t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,(0,f.extend)(t.DEFAULTS,n)));return y.set(r,{}),r.menu=null,r.items=[],r.registerHooks(),r}return a(t,e),l(t,null,[{key:"DEFAULTS",get:function(){return(0,f.clone)({className:"htUISelect",wrapIt:!1})}}]),l(t,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)})}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return(0,h.arrayEach)(e,function(e){"string"==typeof e.name&&e.name.startsWith(p.FILTERS_CONDITIONS_NAMESPACE)&&(e.name=t.menu.hot.getTranslatedPhrase(e.name))}),e}},{key:"build",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),this.menu=new c.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var n=new m.default(this.hot,{className:"htUISelectCaption"}),r=new m.default(this.hot,{className:"htUISelectDropdown"}),o=y.get(this);o.caption=n,o.captionElement=n.element,o.dropdown=r,(0,h.arrayEach)([n,r],function(t){return e._element.appendChild(t.element)}),this.menu.addLocalHook("select",function(t){return e.onMenuSelect(t)}),this.menu.addLocalHook("afterClose",function(){return e.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=void 0;e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(p.FILTERS_CONDITIONS_NONE),y.get(this).captionElement.textContent=e,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:e.left-5,top:e.top,width:e.width,height:e.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==g.SEPARATOR&&(this.options.value=e,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(e){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=y.get(this),n=e.caption,r=e.dropdown;n&&n.destroy(),r&&r.destroy(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(m.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Radio button with index "," doesn't exist."],["Radio button with index "," doesn't exist."]),u=n(1),c=n(0),f=n(61),h=n(84),d=r(h),p=n(64),g=n(159),v=n(335),m=n(336),y=n(512),w=r(y);t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.id=n.id,r.name=n.name,r.buildOperatorsElement(),r}return a(t,e),s(t,[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){return(0,u.addClass)(n.parentNode,"htFiltersMenuOperators"),(0,c.arrayEach)(e.elements,function(e){return n.appendChild(e.element)}),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[g.OPERATION_ID,v.OPERATION_ID];(0,c.arrayEach)(t,function(n){var r=new w.default(e.hot,{name:"operator",label:{htmlFor:n,textContent:(0,p.getOperationName)(n)},value:n,checked:n===t[0],id:n});r.addLocalHook("change",function(t){return e.onRadioInputChange(t)}),e.elements.push(r)})}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error((0,f.toSingleLine)(l,e));(0,c.arrayEach)(this.elements,function(t,n){t.setChecked(n===e)})}},{key:"getActiveOperationId",value:function(){var e=this.elements.find(function(e){return e instanceof w.default&&e.isChecked()});return e?e.getValue():g.OPERATION_ID}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&(0,c.arrayEach)(this.elements,function(t){t.setChecked(t.getValue()===e)})}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.OPERATION_ID,t=arguments[1];e===m.OPERATION_ID&&(e=v.OPERATION_ID),this.setCachedState(t,e)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(e){this.setState(e.realTarget.value)}}]),t}(d.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),u=n(65),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=new WeakMap;t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,(0,l.extend)(t.DEFAULTS,n)));return f.set(i,{}),i}return i(t,e),s(t,null,[{key:"DEFAULTS",get:function(){return(0,l.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),s(t,[{key:"build",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var e=f.get(this);e.input=this._element.firstChild;var n=document.createElement("label");n.textContent=this.options.label.textContent,n.htmlFor=this.options.label.htmlFor,e.label=n,this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=f.get(this);e.input.checked=this.options.checked,e.label.textContent=this.hot.getTranslatedPhrase(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){this.options.checked=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],this.update()}},{key:"focus",value:function(){this.isBuilt()&&f.get(this).input.focus()}}]),t}(c.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(1),f=n(10),h=n(0),d=n(18),p=n(3),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),v=n(63),m=n(84),y=r(m),w=n(514),b=r(w),C=n(158),E=n(9);t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.id=n.id,r.name=n.name,r.elements.push(new b.default(r.hot)),r.registerHooks(),r}return a(t,e),l(t,[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===C.CONDITION_BY_VALUE){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0])}}},{key:"getState",value:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?C.CONDITION_NONE:C.CONDITION_BY_VALUE},args:[e.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(e){var t=this,n=function(e,n,r,o,i){var a=(0,h.arrayFilter)(n,function(e){return e.name===C.CONDITION_BY_VALUE}),l=s(a,1),u=l[0],c={},f=t.hot.getTranslatedPhrase(g.FILTERS_VALUES_BLANK_CELLS);if(u){var d=(0,h.arrayMap)(o(e,i),function(e){return e.value});d=(0,v.unifyColumnValues)(d),r&&(u.args[0]=r);var p=[],m=(0,v.intersectValues)(d,u.args[0],f,function(e){e.checked&&p.push(e.value)});c.args=[p],c.command=(0,E.getConditionDescriptor)(C.CONDITION_BY_VALUE),c.itemsSnapshot=m}else c.args=[],c.command=(0,E.getConditionDescriptor)(C.CONDITION_NONE);t.setCachedState(e,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(e){return e instanceof b.default})[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){(0,c.addClass)(n.parentNode,"htFiltersMenuValue");var s=document.createElement("div");return(0,c.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),(0,h.arrayEach)(e.elements,function(e){return n.appendChild(e.element)}),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(g.FILTERS_VALUES_BLANK_CELLS),n=(0,v.unifyColumnValues)(this._getColumnVisibleValues()),r=(0,v.intersectValues)(n,n,e);this.getMultipleSelectElement().setItems(r),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(e){(0,d.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,f.stopImmediatePropagation)(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn();return(0,h.arrayMap)(this.hot.getDataAtCol(e&&e.visualIndex),function(e){return(0,v.toEmptyString)(e)})}}]),t}(y.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var n=(0,T.createArrayAssertion)(t);return(0,p.arrayMap)(e,function(e){return e.checked=n(e.value),e})}function u(e){var t=[];return(0,p.arrayEach)(e,function(e){e.checked&&t.push(e.value)}),t}t.__esModule=!0;var c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(1),d=n(2),p=n(0),g=n(18),v=n(34),m=n(3),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),w=n(10),b=n(65),C=r(b),E=n(160),O=r(E),_=n(515),S=r(_),T=n(63),R=new WeakMap;t.default=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,(0,d.extend)(t.DEFAULTS,n)));return R.set(r,{}),r.searchInput=new O.default(r.hot,{placeholder:y.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),r.selectAllUI=new S.default(r.hot,{textContent:y.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),r.clearAllUI=new S.default(r.hot,{textContent:y.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),r.items=[],r.itemsBox=null,r.registerHooks(),r}return s(t,e),f(t,null,[{key:"DEFAULTS",get:function(){return(0,d.clone)({className:"htUIMultipleSelect",value:[]})}}]),f(t,[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)}),this.searchInput.addLocalHook("input",function(t){return e.onInput(t)}),this.selectAllUI.addLocalHook("click",function(t){return e.onSelectAllClick(t)}),this.clearAllUI.addLocalHook("click",function(t){return e.onClearAllClick(t)})}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return[].concat(o(this.items))}},{key:"getValue",value:function(){return u(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var n=document.createElement("div"),r=new C.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(n);var o=function(t){e._element&&(e.itemsBox&&e.itemsBox.destroy(),(0,h.addClass)(t,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(t,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,n,r,o,i){e.title=i.instance.getDataAtRowProp(t,i.label.property)},autoWrapCol:!0,colWidths:150,height:110,width:168,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}),e.itemsBox.init())};o(n),setTimeout(function(){return o(n)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(l(this.items,this.options.value)),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t=e.target.value.toLowerCase(),n=void 0;n=""===t?[].concat(o(this.items)):(0,p.arrayFilter)(this.items,function(e){return(e.value+"").toLowerCase().indexOf(t)>=0}),this.itemsBox.loadData(n)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this),(0,v.partial)(g.isKey,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&((0,w.stopImmediatePropagation)(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(e){var t=(0,v.partial)(g.isKey,e.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",e,this),t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||((0,w.stopImmediatePropagation)(e),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(e){e.preventDefault(),(0,p.arrayEach)(this.itemsBox.getSourceData(),function(e){e.checked=!0}),this.itemsBox.render()}},{key:"onClearAllClick",value:function(e){e.preventDefault(),(0,p.arrayEach)(this.itemsBox.getSourceData(),function(e){e.checked=!1}),this.itemsBox.render()}}]),t}(C.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),u=n(65),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=new WeakMap;t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,(0,l.extend)(t.DEFAULTS,n)));return f.set(i,{}),i}return i(t,e),s(t,null,[{key:"DEFAULTS",get:function(){return(0,l.clone)({href:"#",tagName:"a"})}}]),s(t,[{key:"build",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this),f.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(f.get(this).link.textContent=this.hot.getTranslatedPhrase(this.options.textContent))}}]),t}(c.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=n(0),c=n(3),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),h=n(84),d=r(h),p=n(160),g=r(p);t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.id=n.id,r.name=n.name,r.elements.push(new g.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:t.BUTTON_OK})),r.elements.push(new g.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:t.BUTTON_CANCEL})),r.registerHooks(),r}return a(t,e),s(t,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),s(t,[{key:"registerHooks",value:function(){var e=this;(0,u.arrayEach)(this.elements,function(t){t.addLocalHook("click",function(t,n){return e.onButtonClick(t,n)})})}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){return(0,l.addClass)(n.parentNode,"htFiltersMenuActionBar"),(0,u.arrayEach)(e.elements,function(e){return n.appendChild(e.element)}),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,n){n.options.identifier===t.BUTTON_OK?this.accept():this.cancel()}}]),t}(d.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=n(2),l=n(34),u=n(31),c=r(u),f=n(337),h=r(f),d=n(338),p=r(d),g=n(63),v=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return[]};o(this,e),this.conditionCollection=t,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(e){return n._onConditionBeforeModify(e)}),this.conditionCollection.addLocalHook("afterAdd",function(e){return n.updateStatesAtColumn(e)}),this.conditionCollection.addLocalHook("afterClear",function(e){return n.updateStatesAtColumn(e)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return i(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,(0,a.arrayEach)(this.changes,function(t){e.updateStatesAtColumn(t)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.orderStack.indexOf(e);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),s=r.slice(o);s.length&&s[0].column===e&&s.shift();var u=(0,l.curry)(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new h.default;e=[].concat(e,r),o.importAllConditions(e);var i=n.columnDataFactory(t),s=void 0;s=o.isEmpty()?i:new p.default(o,function(e){return n.columnDataFactory(e)}).filter(),s=(0,a.arrayMap)(s,function(e){return e.meta.visualRow});var l=(0,g.createArrayAssertion)(s);return(0,a.arrayFilter)(i,function(e){return l(e.meta.visualRow)})})(i);this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:[].concat(this.conditionCollection.getConditions(e))},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:t})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var e=this;(0,a.arrayEach)(this.latestOrderStack,function(t){e.updateStatesAtColumn(t)})}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),(0,s.objectEach)(this,function(t,n){e[n]=null})}}]),e}();(0,s.mixin)(v,c.default),t.default=v},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(8),f=r(c),h=n(0),d=n(2),p=n(7),g=r(p),v=n(6),m=n(36),y=n(520),w=r(y),b=n(529),C=r(b),E=n(530),O=r(E),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.eventManager=new g.default(n),n.dataProvider=new C.default(n.hot),n.sheet=new w.default(n.hot,n.dataProvider),n.undoRedoSnapshot=new O.default(n.sheet),n._skipRendering=!1,n}return a(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings().formulas;(0,d.isObject)(n)&&(0,d.isObject)(n.variables)&&(0,d.objectEach)(n.variables,function(t,n){return e.setVariable(n,t)}),this.addHook("afterColumnSort",function(){return e.onAfterColumnSort.apply(e,arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol.apply(e,arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow.apply(e,arguments)}),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol.apply(e,arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow.apply(e,arguments)}),this.addHook("afterSetDataAtCell",function(){return e.onAfterSetDataAtCell.apply(e,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return e.onAfterSetDataAtCell.apply(e,arguments)}),this.addHook("beforeColumnSort",function(){return e.onBeforeColumnSort.apply(e,arguments)}),this.addHook("beforeCreateCol",function(){return e.onBeforeCreateCol.apply(e,arguments)}),this.addHook("beforeCreateRow",function(){return e.onBeforeCreateRow.apply(e,arguments)}),this.addHook("beforeRemoveCol",function(){return e.onBeforeRemoveCol.apply(e,arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow.apply(e,arguments)}),this.addHook("beforeValidate",function(){return e.onBeforeValidate.apply(e,arguments)}),this.addHook("beforeValueRender",function(){return e.onBeforeValueRender.apply(e,arguments)}),this.addHook("modifyData",function(){return e.onModifyData.apply(e,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return e.onSheetAfterRecalculate.apply(e,arguments)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(e,t){var n=this.sheet.getCellAt(e,t);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(e,t){return null!==this.sheet.getCellAt(e,t)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(e,t){this.sheet.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.sheet.getVariable(e)}},{key:"onSheetAfterRecalculate",value:function(e,t){if(this._skipRendering)return void(this._skipRendering=!1);var n=this.hot;(0,h.arrayEach)(e,function(e){var t=e.row,r=e.column;n.validateCell(n.getDataAtCell(t,r),n.getCellMeta(t,r),function(){})}),n.render()}},{key:"onModifyData",value:function(e,t,n,r){"get"===r&&this.hasComputedCellValue(e,t)?n.value=this.getCellValue(e,t):"set"===r&&(0,m.isFormulaExpression)(n.value)&&(n.value=(0,m.toUpperCaseFormula)(n.value))}},{key:"onBeforeValueRender",value:function(e){return(0,m.isFormulaExpressionEscaped)(e)&&(e=(0,m.unescapeFormulaExpression)(e)),e}},{key:"onBeforeValidate",value:function(e,t,n,r){var o=this.hot.propToCol(n);return this.hasComputedCellValue(t,o)&&(e=this.getCellValue(t,o)),e}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;"loadData"!==t&&(this.dataProvider.clearChanges(),(0,h.arrayEach)(e,function(e){var t=s(e,4),r=t[0],o=t[1],i=t[2],a=t[3];o=n.hot.propToCol(o),r=n.t.toPhysicalRow(r),(0,m.isFormulaExpression)(a)&&(a=(0,m.toUpperCaseFormula)(a)),n.dataProvider.collectChanges(r,o,a),i!==a&&n.sheet.applyChanges(r,o,a)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(e,t,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_row",e,t,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(e,t){this.undoRedoSnapshot.save("row",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_row",e,t)}},{key:"onBeforeCreateCol",value:function(e,t,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_column",e,t,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(e,t){this.undoRedoSnapshot.save("column",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_column",e,t)}},{key:"onBeforeColumnSort",value:function(e,t){this.sheet.alterManager.prepareAlter("column_sorting",e,t)}},{key:"onAfterColumnSort",value:function(e,t){this.sheet.alterManager.triggerAlter("column_sorting",e,t)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);(0,v.registerPlugin)("formulas",_),t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(66),l=n(0),u=(n(4),n(31)),c=r(u),f=n(53),h=n(2),d=n(44),p=r(d),g=n(521),v=r(g),m=n(36),y=n(522),w=r(y),b=n(523),C=r(b),E=3,O=function(){function e(t,n){var r=this;i(this,e),this.hot=t,this.t=(0,f.getTranslator)(this.hot),this.dataProvider=n,this.parser=new s.Parser,this.matrix=new w.default(this.t),this.alterManager=new C.default(this),this._processingCell=null,this._state=E,this.parser.on("callCellValue",function(){return r._onCallCellValue.apply(r,arguments)}),this.parser.on("callRangeValue",function(){return r._onCallRangeValue.apply(r,arguments)}),this.alterManager.addLocalHook("afterAlter",function(){return r._onAfterAlter.apply(r,arguments)})}return a(e,[{key:"recalculate",value:function(){switch(this._state){case E:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var e=this,t=this.matrix.getOutOfDateCells();(0,l.arrayEach)(t,function(t){var n=e.dataProvider.getSourceDataAtCell(t.row,t.column);(0,m.isFormulaExpression)(n)&&e.parseExpression(t,n.substr(1))}),this._state=1,this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var e=this,t=this.dataProvider.getSourceDataByRange();this.matrix.reset(),(0,l.arrayEach)(t,function(t,n){(0,l.arrayEach)(t,function(t,r){(0,m.isFormulaExpression)(t)&&e.parseExpression(new p.default(n,r),t.substr(1))})}),this._state=1,this.runLocalHooks("afterRecalculate",t,"full")}},{key:"setVariable",value:function(e,t){this.parser.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.parser.getVariable(e)}},{key:"applyChanges",value:function(e,t,n){this.matrix.remove({row:e,column:t}),(0,m.isFormulaExpression)(n)&&this.parseExpression(new p.default(e,t),n.substr(1));var r=this.getCellDependencies.apply(this,o(this.t.toVisual(e,t)));(0,l.arrayEach)(r,function(e){e.setState(p.default.STATE_OUT_OFF_DATE)}),this._state=2}},{key:"parseExpression",value:function(e,t){e.setState(p.default.STATE_COMPUTING),this._processingCell=e;var n=this.parser.parse((0,m.toUpperCaseFormula)(t)),r=n.error,o=n.result;(0,m.isFormulaExpression)(o)?this.parseExpression(e,o.substr(1)):(e.setValue(o),e.setError(r),e.setState(p.default.STATE_UP_TO_DATE)),this.matrix.add(e),this._processingCell=null}},{key:"getCellAt",value:function(e,t){return this.matrix.getCellAt(e,t)}},{key:"getCellDependencies",value:function(e,t){return this.matrix.getDependencies({row:e,column:t})}},{key:"_onCallCellValue",value:function(e,t){var n=e.row,r=e.column,o=new v.default(n,r);if(!this.dataProvider.isInDataRange(o.row,o.column))throw Error(s.ERROR_REF);this.matrix.registerCellRef(o),this._processingCell.addPrecedent(o);var i=this.dataProvider.getRawDataAtCell(n.index,r.index);if((0,s.error)(i)){var a=this.matrix.getCellAt(n.index,r.index);if(a&&a.hasError())throw Error(i)}if((0,m.isFormulaExpression)(i)){var l=this.parser.parse(i.substr(1)),u=l.error,c=l.result;if(u)throw Error(u);t(c)}else t(i)}},{key:"_onCallRangeValue",value:function(e,t,n){var r=e.row,o=e.column,i=this,a=t.row,u=t.column,c=this.dataProvider.getRawDataByRange(r.index,o.index,a.index,u.index),f=function(e,t){return(0,l.arrayMap)(e,function(e,n){var a=r.index+t,l=o.index+n,u=new v.default(a,l);if(!i.dataProvider.isInDataRange(u.row,u.column))throw Error(s.ERROR_REF);if(i.matrix.registerCellRef(u),i._processingCell.addPrecedent(u),(0,s.error)(e)){var c=i.matrix.getCellAt(u.row,u.column);if(c&&c.hasError())throw Error(e)}if((0,m.isFormulaExpression)(e)){var f=i.parser.parse(e.substr(1)),h=f.error,d=f.result;if(h)throw Error(h);e=d}return e})};n((0,l.arrayMap)(c,function(e,t){return f(e,t)}))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}]),e}();(0,h.mixin)(O,c.default),t.default=O},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(66),l=n(339),u=function(e){return e&&e.__esModule?e:{default:e}}(l);t.default=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"toString",value:function(){return(0,s.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),t}(u.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=n(44),s=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=function(){function e(t){r(this,e),this.t=t,this.data=[],this.cellReferences=[]}return o(e,[{key:"getCellAt",value:function(e,t){var n=null;return(0,i.arrayEach)(this.data,function(r){if(r.row===e&&r.column===t)return n=r,!1}),n}},{key:"getOutOfDateCells",value:function(){return(0,i.arrayFilter)(this.data,function(e){return e.isState(s.default.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(e){(0,i.arrayFilter)(this.data,function(t){return t.isEqual(e)}).length||this.data.push(e)}},{key:"remove",value:function(e){var t=Array.isArray(e),n=function(e,n){var r=!1;return t?(0,i.arrayEach)(n,function(t){if(e.isEqual(t))return r=!0,!1}):r=e.isEqual(n),r};this.data=(0,i.arrayFilter)(this.data,function(t){return!n(t,e)})}},{key:"getDependencies",value:function(e){var t=this,n=function(e){return(0,i.arrayReduce)(t.data,function(t,n){return n.hasPrecedent(e)&&-1===t.indexOf(n)&&t.push(n),t},[])};return function e(r){var o=n(r);return o.length&&(0,i.arrayEach)(o,function(n){n.hasPrecedents()&&(o=o.concat(e(t.t.toVisual(n))))}),o}(e)}},{key:"registerCellRef",value:function(e){(0,i.arrayFilter)(this.cellReferences,function(t){return t.isEqual(e)}).length||this.cellReferences.push(e)}},{key:"removeCellRefsAtRange",value:function(e,t){var n=e.row,r=e.column,o=t.row,a=t.column,s=[],l=function(e){return void 0===n||e.row>=n&&e.row<=o},u=function(e){return void 0===r||e.column>=r&&e.column<=a};return this.cellReferences=(0,i.arrayFilter)(this.cellReferences,function(e){return!l(e)||!u(e)||(s.push(e),!1)}),s}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}]),e}()},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){b.has(e)||b.set(e,{prepare:t.prepare||E,operate:t.operate||E})}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.registerOperation=i;var s=(n(0),n(2)),l=n(31),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(524),f=r(c),h=n(525),d=r(h),p=n(526),g=r(p),v=n(527),m=r(v),y=n(528),w=r(y),b=new Map;i(f.OPERATION_NAME,f),i(d.OPERATION_NAME,d),i(g.OPERATION_NAME,g),i(m.OPERATION_NAME,m),i(w.OPERATION_NAME,w);var C=function(){function e(t){o(this,e),this.sheet=t,this.hot=t.hot,this.dataProvider=t.dataProvider,this.matrix=t.matrix}return a(e,[{key:"prepareAlter",value:function(e){if(!b.has(e))throw Error('Alter operation "'+e+'" not exist.');for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];b.get(e).prepare.apply(this,n)}},{key:"triggerAlter",value:function(e){if(!b.has(e))throw Error('Alter operation "'+e+'" not exist.');for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];b.get(e).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}]),e}();(0,s.mixin)(C,u.default),t.default=C;var E=function(){}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.matrix,t=this.dataProvider;h=new WeakMap,(0,a.arrayEach)(e.data,function(e){h.set(e,t.t.toVisualRow(e.row))})}function i(){var e=this.matrix,t=this.dataProvider;e.cellReferences.length=0,(0,a.arrayEach)(e.data,function(e){e.setState(u.default.STATE_OUT_OFF_DATE),e.clearPrecedents();var n=e.row,r=e.column,o=t.getSourceDataAtCell(n,r);if((0,s.isFormulaExpression)(o)){var i=h.get(e),a=new f.default(o);a.translate({row:t.t.toVisualRow(n)-i}),t.updateSourceData(n,r,a.toString())}}),h=null}t.__esModule=!0,t.OPERATION_NAME=void 0,t.prepare=o,t.operate=i;var a=n(0),s=n(36),l=n(44),u=r(l),c=n(67),f=r(c),h=(t.OPERATION_NAME="column_sorting",void 0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,l=[0,t];(0,a.arrayEach)(r.cellReferences,function(t){t.column>=e&&t.translateTo.apply(t,l)}),(0,a.arrayEach)(r.data,function(r){var a=r.row,c=r.column;if(r.column>=e&&(r.translateTo.apply(r,l),r.setState(u.default.STATE_OUT_OFF_DATE)),n){var h=r.row,d=r.column,p=o.getSourceDataAtCell(h,d);if((0,s.isFormulaExpression)(p)){var g=(0,s.cellCoordFactory)("column",e),v=new f.default(p);v.useCustomModifier(i),v.translate({column:t},g({row:a,column:c})),o.updateSourceData(h,d,v.toString())}}})}function i(e,t,n,r){var o=e.start,i=e.end,a=o[t].index,s=i[t].index,l=n,u=n;return r>a&&(l=0),r>s&&(u=0),[l,u,!1]}t.__esModule=!0,t.OPERATION_NAME=void 0,t.operate=o;var a=n(0),s=n(36),l=n(44),u=r(l),c=n(67),f=r(c);t.OPERATION_NAME="insert_column"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,l=[t,0];(0,a.arrayEach)(r.cellReferences,function(t){t.row>=e&&t.translateTo.apply(t,l)}),(0,a.arrayEach)(r.data,function(r){var a=r.row,c=r.column;if(r.row>=e&&(r.translateTo.apply(r,l),r.setState(u.default.STATE_OUT_OFF_DATE)),n){var h=r.row,d=r.column,p=o.getSourceDataAtCell(h,d);if((0,s.isFormulaExpression)(p)){var g=(0,s.cellCoordFactory)("row",e),v=new f.default(p);v.useCustomModifier(i),v.translate({row:t},g({row:a,column:c})),o.updateSourceData(h,d,v.toString())}}})}function i(e,t,n,r){var o=e.start,i=e.end,a=o[t].index,s=i[t].index,l=n,u=n;return r>a&&(l=0),r>s&&(u=0),[l,u,!1]}t.__esModule=!0,t.OPERATION_NAME=void 0,t.operate=o;var a=n(0),s=n(36),l=n(44),u=r(l),c=n(67),f=r(c);t.OPERATION_NAME="insert_row"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=-t;var r=this.matrix,o=this.dataProvider,l=this.sheet,c=[0,t],h=Math.abs(t)-1,d=r.removeCellRefsAtRange({column:e},{column:e+h}),p=[];(0,a.arrayEach)(r.data,function(t){(0,a.arrayEach)(d,function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(u.default.STATE_OUT_OFF_DATE),(0,a.arrayEach)(l.getCellDependencies(t.row,t.column),function(e){e.setState(u.default.STATE_OUT_OFF_DATE)}))}),t.column>=e&&t.column<=e+h&&p.push(t)}),r.remove(p),(0,a.arrayEach)(r.cellReferences,function(t){t.column>=e&&t.translateTo.apply(t,c)}),(0,a.arrayEach)(r.data,function(r){var a=r.row,l=r.column;if(r.column>=e&&(r.translateTo.apply(r,c),r.setState(u.default.STATE_OUT_OFF_DATE)),n){var h=r.row,d=r.column,p=o.getSourceDataAtCell(h,d);if((0,s.isFormulaExpression)(p)){var g=(0,s.cellCoordFactory)("column",e),v=new f.default(p);v.useCustomModifier(i),v.translate({column:t},g({row:a,column:l})),o.updateSourceData(h,d,v.toString())}}})}function i(e,t,n,r){var o=e.start,i=e.end,a=e.type,s=o[t].index,l=i[t].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}t.__esModule=!0,t.OPERATION_NAME=void 0,t.operate=o;var a=n(0),s=n(36),l=n(44),u=r(l),c=n(67),f=r(c);t.OPERATION_NAME="remove_column"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=-t;var r=this.matrix,o=this.dataProvider,l=this.sheet,c=[t,0],h=Math.abs(t)-1,d=r.removeCellRefsAtRange({row:e},{row:e+h}),p=[];(0,a.arrayEach)(r.data,function(t){(0,a.arrayEach)(d,function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(u.default.STATE_OUT_OFF_DATE),(0,a.arrayEach)(l.getCellDependencies(t.row,t.column),function(e){e.setState(u.default.STATE_OUT_OFF_DATE)}))}),t.row>=e&&t.row<=e+h&&p.push(t)}),r.remove(p),(0,a.arrayEach)(r.cellReferences,function(t){t.row>=e&&t.translateTo.apply(t,c)}),(0,a.arrayEach)(r.data,function(r){var a=r.row,l=r.column;if(r.row>=e&&(r.translateTo.apply(r,c),r.setState(u.default.STATE_OUT_OFF_DATE)),n){var h=r.row,d=r.column,p=o.getSourceDataAtCell(h,d);if((0,s.isFormulaExpression)(p)){var g=(0,s.cellCoordFactory)("row",e),v=new f.default(p);v.useCustomModifier(i),v.translate({row:t},g({row:a,column:l})),o.updateSourceData(h,d,v.toString())}}})}function i(e,t,n,r){var o=e.start,i=e.end,a=e.type,s=o[t].index,l=i[t].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}t.__esModule=!0,t.OPERATION_NAME=void 0,t.operate=o;var a=n(0),s=n(36),l=n(44),u=r(l),c=n(67),f=r(c);t.OPERATION_NAME="remove_row"},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=n(4),u=n(2),c=n(53);n(36);t.default=function(){function e(t){o(this,e),this.hot=t,this.changes={},this.t=(0,c.getTranslator)(this.hot)}return a(e,[{key:"collectChanges",value:function(e,t,n){this.changes[this._coordId(e,t)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(e,t){return e>=0&&e<this.hot.countRows()&&t>=0&&t<this.hot.countCols()}},{key:"getDataAtCell",value:function(e,t){var n=this._coordId.apply(this,r(this.t.toPhysical(e,t)));return(0,u.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(e,t)}},{key:"getDataByRange",value:function(e,t,n,o){var i=this,a=this.hot.getData(e,t,n,o);return(0,s.arrayEach)(a,function(n,o){(0,s.arrayEach)(n,function(n,s){var l=i._coordId.apply(i,r(i.t.toPhysical(o+e,s+t)));(0,u.hasOwnProperty)(i.changes,l)&&(a[o][s]=i.changes[l])})}),a}},{key:"getSourceDataAtCell",value:function(e,t){var n=this._coordId(e,t);return(0,u.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(e,t)}},{key:"getSourceDataByRange",value:function(e,t,n,r){return this.hot.getSourceDataArray(e,t,n,r)}},{key:"getRawDataAtCell",value:function(e,t){return this.getSourceDataAtCell.apply(this,r(this.t.toPhysical(e,t)))}},{key:"getRawDataByRange",value:function(e,t,n,r){var o=this,a=[];return(0,l.rangeEach)(e,n,function(e){var n=[];(0,l.rangeEach)(t,r,function(t){var r=o.t.toPhysical(e,t),a=i(r,2),s=a[0],l=a[1],c=o._coordId(s,l);n.push((0,u.hasOwnProperty)(o.changes,c)?o.changes[c]:o.getSourceDataAtCell(s,l))}),a.push(n)}),a}},{key:"updateSourceData",value:function(e,t,n){this.hot.getSourceData()[e][this.hot.colToProp(t)]=n}},{key:"_coordId",value:function(e,t){return e+":"+t}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=(n(4),n(531)),l=r(s),u=n(44),c=r(u);t.default=function(){function e(t){o(this,e),this.sheet=t,this.stack=new l.default}return i(e,[{key:"save",value:function(e,t,n){var r=this.sheet,o=r.matrix,i=r.dataProvider,s=[];(0,a.arrayEach)(o.data,function(r){var o=r.row,a=r.column;if(r[e]<t||r[e]>t+(n-1)){var l=i.getSourceDataAtCell(o,a);s.push({row:o,column:a,value:l})}}),this.stack.push({axis:e,index:t,amount:n,changes:s})}},{key:"restore",value:function(){var e=this.sheet,t=e.matrix,n=e.dataProvider,r=this.stack.pop(),o=r.axis,i=r.index,s=r.amount,l=r.changes;l&&(0,a.arrayEach)(l,function(e){e[o]>i+(s-1)&&(e[o]-=s);var r=e.row,a=e.column,l=e.value;n.getSourceDataAtCell(r,a)!==l&&(n.updateSourceData(r,a,l),t.getCellAt(r,a).setState(c.default.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r(this,e),this.items=t}return o(e,[{key:"push",value:function(){var e;(e=this.items).push.apply(e,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(1),f=n(2),h=n(82),d=n(6),p=n(8),g=r(p),v=n(340),m=r(v),y=n(533),w=r(y),b=n(341);n(534);var C=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings={},n.dateCalculator=null,n.currentYear=null,n.monthList=[],n.monthHeadersArray=[],n.weekHeadersArray=[],n.rangeBars={},n.rangeList={},n.nestedHeadersPlugin=null,n.hotSource=null,n.overallWeekSectionCount=null,n.initialSettings=null,n.dataFeed=null,n.colorData={},n.rangeBarMeta=Object.create(null),n}return a(t,e),l(t,[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new m.default(this.currentYear,this.settings.allowSplitWeeks),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return e.onAfterInit()}),(0,c.addClass)(this.hot.rootElement,"ganttChart"),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),(0,c.removeClass)(this.hot.rootElement,"ganttChart"),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var e=this.settings.dataSource;e.instance?this.loadData(e.instance,e.startDateColumn,e.endDateColumn,e.additionalData,e.asyncUpdates):this.loadData(e)}}},{key:"loadData",value:function(e,t,n,r,o){e.length>1&&this.hot.alter("insert_row",0,e.length-1,this.pluginName+".loadData"),this.dataFeed=new w.default(this.hot,e,t,n,r,o),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(e){return this.rangeList[e]}},{key:"generateHeaderSet",value:function(e){var t=this,n=this.settings.weekHeaderGenerator,r=[];return(0,f.objectEach)(this.monthList,function(o,i){var a=o.daysBeforeFullWeeks>0?1:0,l=o.daysAfterFullWeeks>0?1:0,u=o.fullWeeks+(t.settings.allowSplitWeeks?a+l:0),c=parseInt(i,10),f=t.settings.allowSplitWeeks,h="";if("months"===e)r.push({label:o.name,colspan:u});else if("weeks"===e)for(var d=0;d<u;d++){var p=null,g=null;if(f||1!==o.fullWeeks){var v=t.getWeekColumnRange(o,c,d),m=s(v,2);p=m[0],g=m[1]}else{var y=t.getWeekColumnRange(o,c,d,!0),w=s(y,2);p=w[0],g=w[1]}h=p===g?p:p+" -  "+g,r.push(n?n.call(t,p,g):h),t.dateCalculator.addDaysToCache(c,r.length-1,p,g)}}),r}},{key:"getWeekColumnRange",value:function(e,t,n,r){var o=this.settings.allowSplitWeeks,i=e.daysBeforeFullWeeks>0?1:0,a=e.daysAfterFullWeeks>0?1:0,s=e.fullWeeks+(this.settings.allowSplitWeeks?i+a:0),l=null,u=null;return r?0===t?(u=this.monthList[t+1].daysBeforeFullWeeks,l=b.DEC_LENGTH-(b.WEEK_LENGTH-u)+1):t===this.monthList.length-1?(u=b.WEEK_LENGTH-this.monthList[t-1].daysAfterFullWeeks,l=this.monthList[t-1].days-this.monthList[t-1].daysAfterFullWeeks+1):(u=this.monthList[t+1].daysBeforeFullWeeks,l=this.monthList[t-1].days-(b.WEEK_LENGTH-u)+1):o&&i&&0===n?(l=n+1,u=e.daysBeforeFullWeeks):o&&a&&n===s-1?(l=e.days-e.daysAfterFullWeeks+1,u=e.days):(l=null,l=o?e.daysBeforeFullWeeks+(n-i)*b.WEEK_LENGTH+1:e.daysBeforeFullWeeks+n*b.WEEK_LENGTH+1,u=l+b.WEEK_LENGTH-1),[l,u]}},{key:"generateMonthHeaders",value:function(){return this.generateHeaderSet("months")}},{key:"generateWeekHeaders",value:function(){return this.generateHeaderSet("weeks")}},{key:"generateDayHeaders",value:function(){return this.generateHeaderSet("days")}},{key:"assignGanttSettings",value:function(){var e=this;this.initialSettings=(0,f.deepClone)(this.hot.getSettings());var t={data:(0,h.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(t,n,r,o,i,a,s){return e.uniformBackgroundRenderer(t,n,r,o,i,a,s)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(t),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(e,t,n,r){this.rangeBarMeta[e]||(this.rangeBarMeta[e]={}),this.rangeBarMeta[e][t]||(this.rangeBarMeta[e][t]={}),this.rangeBarMeta[e][t][n]=r}},{key:"applyRangeBarMetaCache",value:function(){var e=this;(0,f.objectEach)(this.rangeBarMeta,function(t,n){(0,f.objectEach)(t,function(t,r){(0,f.objectEach)(t,function(t,o){e.hot.setCellMeta(n,r,o,t)})})})}},{key:"addRangeBar",value:function(e,t,n,r){var o=this,i=this.dateCalculator.dateToColumn(t),a=this.dateCalculator.dateToColumn(n);return!(!this.dateCalculator.isValidRangeBarData(t,n)||null==i||null==a)&&(this.rangeBars[e]||(this.rangeBars[e]={}),this.rangeBars[e][i]={barLength:a-i+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},(0,f.objectEach)(r,function(t,n){o.rangeBars[e][i].additionalData[n]=t}),this.colorData[e]&&(this.rangeBars[e][i].colors=this.colorData[e]),this.rangeList[e]=[e,i],this.renderRangeBar(e,i,a,r),[e,i])}},{key:"getRangeBarData",value:function(e,t){var n=this.getRangeBarCoordinates(e);if(!n)return!1;var r=this.rangeBars[n[0]][n[1]];return!(!r||e!==n[0]||!(t===n[1]||t>n[1]&&t<n[1]+r.barLength))&&r}},{key:"updateRangeBarData",value:function(e,t,n){var r=this.getRangeBarData(e,t);(0,f.objectEach)(n,function(e,t){r[t]!==e&&(r[t]=e)})}},{key:"renderRangeBar",value:function(e,t,n,r){for(var o=this.rangeBars[e][t],i=t;i<=n;i++){var a=this.hot.getCellMeta(e,i),s=(a.className||"")+" rangeBar";(i===t&&o.partialStart||i===n&&o.partialEnd)&&(s+=" partial"),i===n&&(s+=" last"),this.hot.setCellMeta(e,i,"originalClassName",a.className),this.hot.setCellMeta(e,i,"className",s),this.hot.setCellMeta(e,i,"additionalData",o.additionalData),this.cacheRangeBarMeta(e,i,"originalClassName",a.className),this.cacheRangeBarMeta(e,i,"className",s),this.cacheRangeBarMeta(e,i,"additionalData",o.additionalData)}}},{key:"removeRangeBarByDate",value:function(e,t){this.removeRangeBarByColumn(e,this.dateCalculator.dateToColumn(t))}},{key:"removeRangeBarByColumn",value:function(e,t){var n=this,r=this.rangeBars[e][t];r&&(this.unrenderRangeBar(e,t,t+r.barLength-1),this.rangeBars[e][t]=null,(0,f.objectEach)(this.rangeList,function(r,o){o=parseInt(o,10),JSON.stringify(r)===JSON.stringify([e,t])&&(n.rangeList[o]=null)}))}},{key:"removeAllRangeBars",value:function(){var e=this;(0,f.objectEach)(this.rangeBars,function(t,n){(0,f.objectEach)(t,function(t,r){e.removeRangeBarByColumn(n,r)})})}},{key:"unrenderRangeBar",value:function(e,t,n){for(var r=t;r<=n;r++){var o=this.hot.getCellMeta(e,r);this.hot.setCellMeta(e,r,"className",o.originalClassName),this.hot.setCellMeta(e,r,"originalClassName",void 0),this.cacheRangeBarMeta(e,r,"className",o.originalClassName),this.cacheRangeBarMeta(e,r,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(e,t,n,r,o,i,a){var s=this.getRangeBarData(n,r),l=this.getRangeBarCoordinates(n);a.className&&(t.className=a.className);var u="";(0,f.objectEach)(a.additionalData,function(e,t){u+=t+": "+e+"\n"}),u=u.replace(/\n$/,""),t.title=u,t.style.background=s&&s.colors?r===l[1]&&s.partialStart||r===l[1]+s.barLength-1&&s.partialEnd?s.colors[1]:s.colors[0]:""}},{key:"setRangeBarColors",value:function(e){var t=this;this.colorData=e,(0,f.objectEach)(e,function(e,n){var r=t.getRangeBarCoordinates(n);r&&t.updateRangeBarData(r[0],r[1],{colors:e})}),this.hot.render()}},{key:"setYear",value:function(e){this.hot.updateSettings({ganttChart:(0,f.extend)(this.hot.getSettings().ganttChart,{startYear:e})})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){if(this.internalUpdateSettings)return void this.applyRangeBarMetaCache();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(g.default);(0,d.registerPlugin)("ganttChart",C),t.default=C},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(0),s=n(340);t.default=function(){function e(t,n,o,i,a,s){r(this,e),this.data=n,this.chartInstance=t,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(n,o,i,a,s||!1)}return o(e,[{key:"applyData",value:function(e,t,n,r,o){"[object Array]"===Object.prototype.toString.call(e)?this.loadData(e):e.guid&&this.bindWithHotInstance(e,t,n,r,o)}},{key:"bindWithHotInstance",value:function(e,t,n,r,o){this.hotSource={instance:e,startColumn:t,endColumn:n,additionalData:r,asyncUpdates:o},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(e){var t=this;if(!this.hotSource.asyncUpdates)return void e.call(this);this.asyncStart(),setTimeout(function(){e.call(t),t.asyncEnd()},0)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var e=this;this.sourceHooks={afterLoadData:function(t){return e.onAfterSourceLoadData(t)},afterChange:function(t,n){return e.onAfterSourceChange(t,n)},afterColumnSort:function(t,n){return e.onAfterColumnSort(t,n)}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(e){this.sourceHooks.afterLoadData&&e.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&e.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&e.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(e){var t={},n=this.hotSource,r=void 0,o=[];void 0===e?r=n.instance.getData(0,0,n.instance.countRows()-1,n.instance.countCols()-1):(r=[],r[e]=n.instance.getDataAtRow(e));for(var a=e||0,s=r.length;a<(e?e+1:s);a++){(function(e,a){t={};var s=r[e];if(null===s[n.startColumn]||""===s[n.startColumn])return"continue";(0,i.objectEach)(n.additionalData,function(e,n){t[n]=s[e]}),o.push([e,s[n.startColumn],s[n.endColumn],t,e])})(a)}return o}},{key:"updateFromSource",value:function(e){var t=this,n=this.getDataFromSource(e);!e&&isNaN(e)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),(0,a.arrayEach)(n,function(e){e=t.trimRangeIfNeeded(e),t.chartPlugin.addRangeBar.apply(t.chartPlugin,e)})}},{key:"loadData",value:function(e){var t=this;(0,a.arrayEach)(e,function(e,n){e=t.trimRangeIfNeeded(e),t.chartPlugin.addRangeBar(n,e.startDate,e.endDate,e.additionalData)})}},{key:"trimRangeIfNeeded",value:function(e){var t=null;t=e[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"};var n=new Date(e[t.startDate]),r=new Date(e[t.endDate]);if("string"==typeof n||"string"==typeof r)return!1;var o=n.getFullYear(),i=r.getFullYear();return o<this.chartPlugin.currentYear&&i>=this.chartPlugin.currentYear&&(e[t.startDate]="01/01/"+this.chartPlugin.currentYear),i>this.chartPlugin.currentYear&&o<=this.chartPlugin.currentYear&&(e[t.endDate]="12/31/"+this.chartPlugin.currentYear),e}},{key:"onAfterSourceChange",value:function(e,t){var n=this;this.asyncCall(function(){if(e){for(var t={},r=0,o=e.length;r<o;r++){var a=e[r],s=parseInt(a[0],10),l=parseInt(a[1],10);t[s]||(t[s]={}),t[s][l]=[a[2],a[3]]}(0,i.objectEach)(t,function(e,t){t=parseInt(t,10),n.chartPlugin.getRangeBarCoordinates(t)&&n.chartPlugin.removeRangeBarByColumn(t,n.chartPlugin.rangeList[t][1]),n.updateFromSource(t)})}})}},{key:"onAfterSourceLoadData",value:function(e){var t=this;this.asyncCall(function(e){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})}},{key:"onAfterColumnSort",value:function(e,t){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars(),n.updateFromSource()})}}]),e}()},function(e,t){},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(1),u=n(6),c=n(4),f=n(8),h=function(e){return e&&e.__esModule?e:{default:e}}(f),d=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings=null,n}return i(t,e),a(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetHeader(t,n)}),this.addHook("afterGetRowHeader",function(t,n){return e.onAfterGetHeader(t,n)}),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;(0,c.rangeEach)(0,e-1,function(e){var o=t.childNodes[e],i=n.childNodes[e],a=r?r.childNodes[e]:null;(0,c.rangeEach)(0,o.childNodes.length-1,function(e){o.childNodes[e].removeAttribute("title"),i&&i.childNodes[e]&&i.childNodes[e].removeAttribute("title"),r&&a&&a.childNodes[e]&&a.childNodes[e].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(e,t){var n=t.querySelector("span"),r="THEAD"===t.parentNode.parentNode.nodeName;(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?(0,l.outerWidth)(n)>=(0,l.outerWidth)(t)&&0!==(0,l.outerWidth)(n)&&t.setAttribute("title",n.textContent):t.setAttribute("title",n.textContent))}},{key:"destroy",value:function(){this.settings=null,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(h.default);(0,u.registerPlugin)("headerTooltips",d),t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(1),c=n(4),f=n(0),h=n(2),d=n(6),p=n(8),g=r(p),v=n(15),m=n(537),y=r(m);n(538);var w=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings=[],n.columnHeaderLevelCount=0,n.colspanArray=[],n.ghostTable=new y.default(n),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(t){return e.onAfterGetColumnHeaderRenderers(t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(t,n,r){return e.onAfterOnCellMouseDown(t,n,r)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterViewportColumnCalculatorOverride",function(t){return e.onAfterViewportColumnCalculatorOverride(t)}),this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this),this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=0;o<e;o++){var i=t.childNodes[o];if(!i)break;for(var a=n.childNodes[o],s=r?r.childNodes[o]:null,l=0,u=i.childNodes.length;l<u;l++)i.childNodes[l].removeAttribute("colspan"),a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan"),r&&s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan")}}},{key:"checkForFixedColumnsCollision",value:function(){var e=this,t=this.hot.getSettings().fixedColumnsLeft;(0,f.arrayEach)(this.colspanArray,function(n,r){e.getNestedParent(r,t)!==t&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})}},{key:"checkForOverlappingHeaders",value:function(){var e=this;(0,f.arrayEach)(this.colspanArray,function(t,n){(0,f.arrayEach)(e.colspanArray[n],function(t,r){if(t.colspan>1){var o=e.levelToRowCoords(n),i=e.getChildHeaders(o,r);if(i.length>0){var a=0;return(0,f.arrayEach)(i,function(t,n){a+=e.getColspan(o+1,t)}),a>t.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1}}})})}},{key:"setupColspanArray",value:function(){function e(e,t){e[t]||(e[t]=[])}var t=this;(0,h.objectEach)(this.settings,function(n,r){(0,h.objectEach)(n,function(n,o,i){if(e(t.colspanArray,r),void 0===i[o].colspan)t.colspanArray[r].push({label:i[o]||"",colspan:1,hidden:!1});else{var a=i[o].colspan||1;t.colspanArray[r].push({label:i[o].label||"",colspan:a,hidden:!1}),t.fillColspanArrayWithDummies(a,r)}})})}},{key:"fillColspanArrayWithDummies",value:function(e,t){var n=this;(0,c.rangeEach)(0,e-2,function(e){n.colspanArray[t].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(e){var t=this;return function(n,r){if(r.removeAttribute("colspan"),(0,u.removeClass)(r,"hiddenHeader"),t.colspanArray[e][n]&&t.colspanArray[e][n].colspan){var o=t.colspanArray[e][n].colspan,i=t.hot.getSettings().fixedColumnsLeft||0,a=t.hot.view.wt.wtOverlays.topLeftCornerOverlay,s=t.hot.view.wt.wtOverlays.leftOverlay,l=!!a&&a.clone.wtTable.THEAD.contains(r),c=!!s&&s.clone.wtTable.THEAD.contains(r);o>1&&r.setAttribute("colspan",l||c?Math.min(o,i-n):o),(l||c&&n===i-1)&&(0,u.addClass)(r,"overlayEdge")}t.colspanArray[e][n]&&t.colspanArray[e][n].hidden&&(0,u.addClass)(r,"hiddenHeader"),(0,u.empty)(r);var f=document.createElement("DIV");(0,u.addClass)(f,"relative");var h=document.createElement("SPAN");(0,u.addClass)(h,"colHeader"),(0,u.fastInnerHTML)(h,t.colspanArray[e][n]?t.colspanArray[e][n].label||"":""),f.appendChild(h),r.appendChild(f),t.hot.runHooks("afterGetColHeader",n,r)}}},{key:"getColspan",value:function(e,t){var n=this.colspanArray[this.rowCoordsToLevel(e)][t];return n?n.colspan:1}},{key:"levelToRowCoords",value:function(e){return e-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(e){return e+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(e,t){if(e<0)return!1;var n=this.colspanArray[e][t]?this.colspanArray[e][t].colspan:1,r=!!this.colspanArray[e][t]&&this.colspanArray[e][t].hidden;if(n>1||1===n&&!1===r)return t;var o=t-1;do{if(this.colspanArray[e][o].colspan>1)break;o--}while(t>=0);return o}},{key:"getChildHeaders",value:function(e,t){var n=this.rowCoordsToLevel(e),r=this.colspanArray[n+1],o=this.getNestedParent(n,t),i=this.colspanArray[n][t].colspan,a=[];return r?((0,c.rangeEach)(o,o+i-1,function(e){r[e]&&r[e].colspan>1&&(i-=r[e].colspan-1),r[e]&&!r[e].hidden&&-1===a.indexOf(e)&&a.push(e)}),a):a}},{key:"fillTheRemainingColspans",value:function(){var e=this;(0,h.objectEach)(this.settings,function(t,n){(0,c.rangeEach)(e.colspanArray[n].length-1,e.hot.countCols()-1,function(r){e.colspanArray[n].push({label:t[r]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var e=this,t=this.hot.getSelected();if(void 0!==t){var n=this.hot.view.wt.wtOverlays,r=this.hot.selection.selectedHeader.cols,o=Math.min(t[1],t[3]),i=Math.max(t[1],t[3]),a=r?-1:this.columnHeaderLevelCount-1;(0,c.rangeEach)(o,i,function(t){for(var s=e.columnHeaderLevelCount-1;s>-1;s--)!function(s){var l=e.getNestedParent(s,t),c=n.topOverlay?n.topOverlay.clone.wtTable.getColumnHeader(l,s):void 0,h=n.topLeftCornerOverlay?n.topLeftCornerOverlay.clone.wtTable.getColumnHeader(l,s):void 0,d=[c,h],p=e.getColspan(s-e.columnHeaderLevelCount,l),g=l>=o&&l+p-1<=i;(0,f.arrayEach)(d,function(e,t,n){if(void 0===e)return!1;!r&&s<a||r&&!g?(0,u.hasClass)(e,"ht__highlight")&&(0,u.removeClass)(e,"ht__highlight"):(0,u.hasClass)(e,"ht__highlight")||(0,u.addClass)(e,"ht__highlight")})}(s)})}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this,n=e.startColumn;(0,c.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),function(r){var o=t.getNestedParent(r,e.startColumn);if(o<e.startColumn){var i=Math.min(n,o);n=i}}),e.startColumn=n}},{key:"onAfterOnCellMouseDown",value:function(e,t,n){if(t.row<0){var r=this.getColspan(t.row,t.col),o=t.col+r-1;if(r>1){var i=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new v.CellCoords(i,o))}}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){if(t.row<0&&t.col>=0&&this.hot.view.isMouseDown()){var o=this.hot.getSelectedRange(),i=o.from,a=o.to,s=this.getColspan(t.row,t.col),l=t.col+s-1,u=!1;if(i.col<=a.col?(t.col<i.col&&l===a.col||t.col<i.col&&l<i.col||t.col<i.col&&l>=i.col&&l<a.col)&&(u=!0):(t.col<a.col&&l>i.col||t.col>i.col||t.col<=a.col&&l>i.col||t.col>a.col&&l>i.col)&&(u=!0),u){var c=[a.col,i.col];i.col=c[0],a.col=c[1]}s>1&&(r.column=!0,r.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),i.col===a.col&&(l<=i.col&&t.col<i.col?(this.hot.selection.setRangeStartOnly(new v.CellCoords(i.row,a.col)),this.hot.selection.setRangeEnd(new v.CellCoords(a.row,t.col))):(this.hot.selection.setRangeStartOnly(new v.CellCoords(i.row,t.col<i.col?t.col:i.col)),this.hot.selection.setRangeEnd(new v.CellCoords(a.row,l>a.col?l:a.col)))),i.col<a.col&&(this.hot.selection.setRangeStartOnly(new v.CellCoords(i.row,t.col<i.col?t.col:i.col)),this.hot.selection.setRangeEnd(new v.CellCoords(a.row,l))),i.col>a.col&&(this.hot.selection.setRangeStartOnly(new v.CellCoords(i.row,i.col)),this.hot.selection.setRangeEnd(new v.CellCoords(a.row,t.col))))}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=this.colspanArray.length,n=t-1;n>=0;n--)e.push(this.headerRendererFactory(n));e.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.widthsCache[t];return e>n?e:n}},{key:"destroy",value:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(g.default);(0,d.registerPlugin)("nestedHeaders",w),t.default=w},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(2);t.default=function(){function e(t){r(this,e),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}return o(e,[{key:"buildWidthsMapper",value:function(){this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length,n=0;n<t;n++)this.widthsCache.push(e[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var t=document,n=t.createDocumentFragment(),r=t.createElement("table"),o=!1,s=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.colspanArray.length,u=this.nestedHeaders.hot.countCols(),c=l-1,f=0;f<l;f++){var h=t.createElement("tr");o=!1;for(var d=0;d<u;d++){var p=t.createElement("th"),g=(0,a.clone)(this.nestedHeaders.colspanArray[f][d]);g&&!g.hidden&&(f===c&&(g.colspan>1&&(o=!0),s&&(g.label+='<button class="changeType"></button>')),(0,i.fastInnerHTML)(p,g.label),p.colSpan=g.colspan,h.appendChild(p))}r.appendChild(h)}if(o){for(var v=t.createElement("tr"),m=0;m<u;m++){v.appendChild(t.createElement("th"))}r.appendChild(v)}n.appendChild(r),e.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),e}()},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(8),f=r(c),h=n(6),d=n(4),p=n(0),g=n(15),v=n(540),m=r(v),y=n(541),w=r(y),b=n(342),C=r(b),E=n(542),O=r(E);n(543);var _=new WeakMap,S=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sourceData=null,n.trimRowsPlugin=null,n.bindRowsWithHeadersPlugin=null,n.dataManager=null,n.headersUI=null,_.set(n,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),n}return s(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var e=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new m.default(this,this.hot,this.sourceData),this.collapsingUI=new w.default(this,this.hot,this.trimRowsPlugin),this.headersUI=new C.default(this,this.hot),this.contextMenuUI=new O.default(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){return e.onAfterInit.apply(e,arguments)}),this.addHook("beforeRender",function(){return e.onBeforeRender.apply(e,arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData.apply(e,arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength.apply(e,arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice.apply(e,arguments)}),this.addHook("beforeDataFilter",function(){return e.onBeforeDataFilter.apply(e,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader.apply(e,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow.apply(e,arguments)}),this.addHook("modifyRemovedAmount",function(){return e.onModifyRemovedAmount.apply(e,arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild.apply(e,arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild.apply(e,arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild.apply(e,arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild.apply(e,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth.apply(e,arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow.apply(e,arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove.apply(e,arguments)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove.apply(e,arguments)}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t){var n=_.get(this),r=e.length,o=[],i=this.dataManager.translateTrimmedRow(t),a=!0,s=void 0,l=null,u=null,c=null;for(s=0;s<r;s++)o.push(this.dataManager.translateTrimmedRow(e[s])),this.dataManager.isParent(o[s])&&(a=!1);if(o.indexOf(i)>-1||!a)return!1;if(l=this.dataManager.getRowParent(o[0]),u=this.dataManager.getRowParent(i),null==u&&(u=this.dataManager.getRowParent(i-1)),null==u&&(u=this.dataManager.getDataObject(i-1),n.movedToFirstChild=!0),!u)return!1;for(c=l===u,n.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),c||(Math.max.apply(Math,o)<=i?this.collapsingUI.collapsedRowsStash.shiftStash(o[0],-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(i,e.length)),n.changeSelection=!0,(o[r-1]<=i&&c||!0===n.movedToFirstChild)&&(e.reverse(),o.reverse(),!0!==n.movedToFirstChild&&i--),s=0;s<r;s++)this.dataManager.moveRow(o[s],i);if(o[o.length-1]<i)for(s=r-1;s>=0;s--)this.dataManager.moveCellMeta(o[s],i);else for(s=0;s<r;s++)this.dataManager.moveCellMeta(o[s],i);return(o[r-1]<=i&&c||this.dataManager.isParent(i))&&e.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(e,t){var n=_.get(this);if(n.changeSelection){var r=e.length,i=0,a=0,s=null,l=null,u=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),s=this.dataManager.translateTrimmedRow(t),n.movedToFirstChild)n.movedToFirstChild=!1,i=t,a=t+r-1,t>=Math.max.apply(Math,o(e))&&(i-=r,a-=r);else if(n.movedToCollapsed){var c=this.dataManager.getRowParent(s-1);null==c&&(c=this.dataManager.getDataObject(s-1));var f=this.dataManager.getRowIndex(c);i=f,a=i}else e[r-1]<t?(a=t-1,i=a-r+1):(i=t,a=i+r-1);l=this.hot.selection,u=this.hot.countCols()-1,l.setRangeStart(new g.CellCoords(i,0)),l.setRangeEnd(new g.CellCoords(a,u),!0),n.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,n){return this.dataManager.spliceData(e,t,n),!1}},{key:"onBeforeDataFilter",value:function(e,t,n){var r=[],o=this.dataManager.translateTrimmedRow(e),i=_.get(this);return(0,d.rangeEach)(o,o+t-1,function(e){r.push(e)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o,t),this.collapsingUI.collapsedRowsStash.shiftStash(o,-1*t),this.dataManager.filterData(e,t,r),i.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(r!==this.pluginName){var i=_.get(this);setTimeout(function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onModifyRemovedAmount",value:function(e,t){var n=this,r=[],o=0;return(0,d.rangeEach)(t,t+e-1,function(e){var t=!1,i=n.collapsingUI.translateTrimmedRow(e),a=n.dataManager.getDataObject(i);n.dataManager.hasChildren(a)&&(r.push(a),(0,p.arrayEach)(r,function(e){if(e.__children.indexOf(a)>-1)return t=!0,!1}),t||(o+=n.dataManager.countChildren(a))),t=!1,(0,p.arrayEach)(r,function(e){if(e.__children.indexOf(a)>-1)return t=!0,!1}),t&&o--}),e+o}},{key:"onBeforeAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(e,t,n){n!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var e=Math.max.apply(Math,o(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeRender",value:function(e,t){_.get(this).skipRender&&(t.skipRender=!0)}}]),t}(f.default);(0,h.registerPlugin)("nestedRows",S),t.default=S},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),s=n(2),l=n(0),u=n(53);t.default=function(){function e(t,n,o){r(this,e),this.hot=n,this.data=o,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=(0,u.getTranslator)(this.hot)}return i(e,[{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,a.rangeEach)(0,this.data.length-1,function(t){e.cacheNode(e.data[t],0,null)})}},{key:"cacheNode",value:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount++),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&(0,l.arrayEach)(e.__children,function(n,o){r.cacheNode(n,t+1,e)})}},{key:"getDataObject",value:function(e){return null==e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,r){var o=this,i=!1;return isNaN(t)&&t.end?t:(e||(e={__children:this.data},i=!0,t--),null!=n&&t===n?{result:e,end:!0}:null!=r&&e===r?{result:t,end:!0}:(t++,e.__children&&(0,l.arrayEach)(e.__children,function(a,s){if(o.parentReference.set(a,i?null:e),t=o.readTreeNodes(a,t,n,r),isNaN(t)&&t.end)return!1}),t))}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return(0,s.objectEach)(this.data[0],function(t,n){e[n]=null}),e}},{key:"getRowIndex",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){return this.countChildren({__children:this.data})}},{key:"countChildren",value:function(e){var t=this,n=0;return isNaN(e)||(e=this.getDataObject(e)),e&&e.__children?((0,l.arrayEach)(e.__children,function(e,r){n++,e.__children&&(n+=t.countChildren(e))}),n):0}},{key:"getRowParent",value:function(e){var t=void 0;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return"object"!==(void 0===e?"undefined":o(e))?null:this.cache.nodeInfo.get(e).parent}},{key:"getRowLevel",value:function(e){var t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isParent",value:function(e){return isNaN(e)||(e=this.getDataObject(e)),!!(0,s.hasOwnProperty)(e,"__children")}},{key:"addChild",value:function(e,t){this.hot.runHooks("beforeAddChild",e,t);var n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);var r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),t||(t=this.mockNode()),r.__children.push(t),this.rewriteCache(),this.hot.runHooks("afterCreateRow",this.getRowIndex(t),1),this.hot.runHooks("afterAddChild",e,t)}},{key:"addChildAtIndex",value:function(e,t,n,r){this.hot.runHooks("beforeAddChild",e,n,t),this.hot.runHooks("beforeCreateRow",r+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.splice(t,null,n),this.rewriteCache(),this.hot.runHooks("afterCreateRow",r+1,1),this.hot.runHooks("afterAddChild",e,n,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null,e);break;case"above":this.addChildAtIndex(r,o,null,e)}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(e)?((0,a.rangeEach)(e[0],e[2],function(e){var n=t.translateTrimmedRow(e);o.push(t.getDataObject(n))}),(0,a.rangeEach)(0,o.length-2,function(e){t.detachFromParent(o[e],!1)}),r=o[o.length-1]):r=e;var i=this.getRowIndex(r),s=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u),f=null;this.hot.runHooks("beforeDetachChild",l,r),null!=s&&(this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName),u?(f=c+this.countChildren(u),this.hot.runHooks("beforeCreateRow",f,1,this.plugin.pluginName),u.__children.push(r)):(f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f,1,this.plugin.pluginName),this.data.push(r))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",f,1,this.plugin.pluginName),n&&this.hot.render(),this.hot.runHooks("afterDetachChild",l,r)}},{key:"filterData",value:function(e,t,n){var r=this,o=[];(0,l.arrayEach)(n,function(e,t){o.push(r.getDataObject(e))}),(0,l.arrayEach)(o,function(e,t){var n=r.getRowIndexWithinParent(e),o=r.getRowParent(e);null===o?r.data.splice(n,1):o.__children.splice(n,1)}),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){if(null!=(e=this.translateTrimmedRow(e))){var r=this.getDataObject(e-1),o=null,i=null;r&&r.__children&&0===r.__children.length?(o=r,i=0):(o=this.getRowParent(e),i=this.getRowIndexWithinParent(e)),o?n?o.__children.splice(i,t,n):o.__children.splice(i,t):n?this.data.splice(i,t,n):this.data.splice(i,t),this.rewriteCache()}}},{key:"moveRow",value:function(e,t){var n=this.isParent(t),r=this.getRowParent(e),o=this.getRowIndexWithinParent(e),i=this.getRowParent(t);null==i&&(i=this.getRowParent(t-1)),null==i&&(i=this.getDataObject(t-1)),i?i.__children||(i.__children=[]):(i=this.getDataObject(t),i.__children=[]);var a=this.getRowParent(t-1),s=n?this.countChildren(a):this.getRowIndexWithinParent(t),l=r.__children.slice(o,o+1);r.__children.splice(o,1),i.__children.splice(s,0,l[0])}},{key:"moveCellMeta",value:function(e,t){this.hot.spliceCellsMeta(t,0,this.hot.getCellMetaAtRow(e)),this.hot.spliceCellsMeta(e+(e<t?0:1),1)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(10),u=n(0),c=n(4),f=n(1),h=n(161),d=r(h),p=n(342),g=r(p);t.default=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.trimRowsPlugin=e.trimRowsPlugin,r.dataManager=r.plugin.dataManager,r.collapsedRows=[],r.collapsedRowsStash={stash:function(){r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,!1)},shiftStash:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e=r.translateTrimmedRow(e),(0,u.arrayEach)(r.lastCollapsedRows,function(n,o){n>e-1&&(r.lastCollapsedRows[o]=n+t)})},applyStash:function(){r.hot.runHooks("skipLengthCache",100),r.collapseMultipleChildren(r.lastCollapsedRows,!0),r.lastCollapsedRows=void 0},trimStash:function(e,t){(0,c.rangeEach)(e,e+t-1,function(e){var t=r.lastCollapsedRows.indexOf(e);t>-1&&r.lastCollapsedRows.splice(t,1)})}},r}return a(t,e),s(t,[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(i)&&(0,u.arrayEach)(i.__children,function(e,n){o.push(t.dataManager.getRowIndex(e))}),s=this.collapseRows(o,!0,!1),r&&this.trimRowsPlugin.trimRows(s),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),s}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];(0,u.arrayEach)(e,function(e,n){o=o.concat(t.collapseChildren(e,!1,!1))}),r&&this.trimRowsPlugin.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){this.collapseRows([e],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return(0,u.arrayEach)(e,function(e,r){o.push(e),n&&t.collapseChildRows(e,o)}),r&&this.trimRowsPlugin.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);(0,u.arrayEach)(o.__children,function(e,r){var o=n.dataManager.getRowIndex(e);t.push(o),n.collapseChildRows(o,t)})}r&&this.trimRowsPlugin.trimRows(t)}},{key:"expandRow",value:function(e){this.expandRows([e],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return(0,u.arrayEach)(e,function(e,r){o.push(e),n&&t.expandChildRows(e,o)}),r&&this.trimRowsPlugin.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);(0,u.arrayEach)(o.__children,function(e,r){if(!n.isAnyParentCollapsed(e)){var o=n.dataManager.getRowIndex(e);t.push(o),n.expandChildRows(o,t)}})}r&&this.trimRowsPlugin.untrimRows(t)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&(0,u.arrayEach)(i.__children,function(e,n){var r=t.dataManager.getRowIndex(e);o.push(r)}),s=this.expandRows(o,!0,!1),r&&this.trimRowsPlugin.untrimRows(s),n&&this.renderAndAdjust(),s}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];(0,u.arrayEach)(e,function(e,n){o=o.concat(t.expandChildren(e,!1,!1))}),r&&this.trimRowsPlugin.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.hot.getSourceData(),n=[];(0,u.arrayEach)(t,function(t,r){e.dataManager.hasChildren(t)&&n.push(t)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.hot.getSourceData(),n=[];(0,u.arrayEach)(t,function(t,r){e.dataManager.hasChildren(t)&&n.push(t)}),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=null,r=!0;return n=isNaN(e)?e:this.dataManager.getDataObject(e),this.dataManager.hasChildren(n)&&(0,u.arrayEach)(n.__children,function(e,n){var o=t.dataManager.getRowIndex(e);if(!t.trimRowsPlugin.isTrimmed(o))return r=!1,!1}),r}},{key:"isAnyParentCollapsed",value:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);if(this.collapsedRows.indexOf(this.dataManager.getRowIndex(t))>-1)return!0}return!1}},{key:"toggleState",value:function(e,t,n){if(!(t.col>=0)){var r=this.translateTrimmedRow(t.row);(0,f.hasClass)(e.target,g.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),(0,l.stopImmediatePropagation)(e))}}},{key:"translateTrimmedRow",value:function(e){return this.trimRowsPlugin.rowsMapper.getValueByIndex(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),t}(d.default)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(4),l=n(0),u=n(3),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),f=n(161),h=function(e){return e&&e.__esModule?e:{default:e}}(f),d=new WeakMap;t.default=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return d.set(i,{row_above:function(e,t){i.dataManager.addSibling(t.start.row,"above")},row_below:function(e,t){i.dataManager.addSibling(t.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return i(t,e),a(t,[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelected();return!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]);t.dataManager.getDataObject(e);t.dataManager.detachFromParent(t.hot.getSelected())},disabled:function(){var e=t.hot.getSelected(),n=t.dataManager.translateTrimmedRow(e[0]);return!t.dataManager.getRowParent(n)||!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return(0,s.rangeEach)(0,e.items.length-1,function(t){if(0===t)return(0,l.arrayEach)(n,function(n,r){e.items.splice(t+r,0,n)}),!1}),e=this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=d.get(this);return(0,s.rangeEach)(0,e.items.length-1,function(n){null!=t[e.items[n].key]&&(e.items[n].callback=t[e.items[n].key])}),e}}]),t}(h.default)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){t.textContent=""}t.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=n(8),h=r(f),d=n(1),p=n(4),g=n(0),v=n(6),m=n(43),y=n(545),w=r(y),b=n(546),C=r(b);n(547);var E=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings={},n.hiddenColumns=[],n.lastSelectedColumn=-1,n}return a(t,e),u(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetColHeader(t,n)}):this.addHook("afterRenderer",function(t,n,r){return e.onAfterGetColHeader(r,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,n,r){return e.onAfterGetCellMeta(t,n,r)}),this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)}),this.addHook("hiddenColumn",function(t){return e.isHidden(t)}),this.addHook("beforeStretchingColumnWidth",function(t,n){return e.onBeforeStretchingColumnWidth(t,n)}),this.addHook("afterCreateCol",function(t,n){return e.onAfterCreateCol(t,n)}),this.addHook("afterRemoveCol",function(t,n){return e.onAfterRemoveCol(t,n)}),this.hot.view&&this.onAfterPluginsInitialized(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this;(0,g.arrayEach)(e,function(e){e=parseInt(e,10),e=t.getLogicalColumnIndex(e),t.isHidden(e,!0)&&t.hiddenColumns.splice(t.hiddenColumns.indexOf(e),1)})}},{key:"showColumn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this;(0,g.arrayEach)(e,function(e){e=parseInt(e,10),e=t.getLogicalColumnIndex(e),t.isHidden(e,!0)||t.hiddenColumns.push(e)})}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"isHidden",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(e=this.getLogicalColumnIndex(e)),this.hiddenColumns.indexOf(e)>-1}},{key:"resetCellsMeta",value:function(){(0,g.arrayEach)(this.hot.getCellsMeta(),function(e){e&&(e.skipColumnOnPaste=!1,null!==e.baseRenderer&&(e.renderer=e.baseRenderer,e.baseRenderer=null))})}},{key:"getLogicalColumnIndex",value:function(e){return this.hot.runHooks("modifyCol",e)}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){return this.isHidden(t)&&(e=0),e}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?.1:this.settings.indicators&&(this.isHidden(t+1)||this.isHidden(t-1))?e+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(t=this.hot.runHooks("unmodifyCol",t),!1===this.settings.copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t)?(n.renderer!==s&&(n.baseRenderer=n.renderer),n.renderer=s):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var r=!0,o=n.visualCol-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(o)){r=!1;break}o--}while(o>=0);r&&-1===n.className.indexOf("firstVisibleColumn")&&(n.className+=" firstVisibleColumn")}else if(n.className){var i=n.className.split(" ");if(i.length){var a=i.indexOf("afterHiddenColumn"),l=i.indexOf("firstVisibleColumn");a>-1&&i.splice(a,1),l>-1&&i.splice(l,1),n.className=i.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this,n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return(0,g.arrayEach)(e,function(e){var n=!0,o=0;(0,p.rangeEach)(e.startCol,e.endCol,function(i){t.isHidden(i)?(n||r(e.startRow,e.endRow,o,i-1),n=!0):(n&&(o=i),i===e.endCol&&r(e.startRow,e.endRow,o,i),n=!1)})}),n}},{key:"onAfterGetColHeader",value:function(e,t){if(!this.isHidden(e)){var n=!0,r=e-1;do{if(!this.isHidden(r)){n=!1;break}r--}while(r>=0);n&&(0,d.addClass)(t,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(e-1)&&(0,d.addClass)(t,"afterHiddenColumn"),this.isHidden(e+1)&&e>-1&&(0,d.addClass)(t,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(e){var t=this;if(!(e.col>0)){e.col=0;e.col=function e(n){var r=t.getLogicalColumnIndex(n);return t.isHidden(r,!0)&&(n=e(++n)),n}(e.col)}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this,n=this.hot.countCols();e.col=function r(o){var i=t.getLogicalColumnIndex(o);return t.isHidden(i,!0)&&(t.lastSelectedColumn>o||e.col===n-1?o>0?o=r(--o):(0,p.rangeEach)(0,t.lastSelectedColumn,function(e){if(!t.isHidden(e))return o=e,!1}):o=r(++o)),o}(e.col),this.lastSelectedColumn=e.col}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:m.SEPARATOR},(0,w.default)(this),(0,C.default)(this))}},{key:"onAfterCreateCol",value:function(e,t){var n=[];(0,g.arrayEach)(this.hiddenColumns,function(r){r>=e&&(r+=t),n.push(r)}),this.hiddenColumns=n}},{key:"onAfterRemoveCol",value:function(e,t){var n=[];(0,g.arrayEach)(this.hiddenColumns,function(r){r>=e&&(r-=t),n.push(r)}),this.hiddenColumns=n}},{key:"onAfterPluginsInitialized",value:function(){var e=this,t=this.hot.getSettings().hiddenColumns;"object"===(void 0===t?"undefined":l(t))&&(this.settings=t,void 0===t.copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.columns)&&this.hideColumns(t.columns),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))}},{key:"destroy",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(h.default);(0,v.registerPlugin)("hiddenColumns",E),t.default=E},function(e,t,n){"use strict";function r(e){return{key:"hidden_columns_hide",name:function(){var e=this.getSelected(),t=0;if(Array.isArray(e)){var n=o(e,4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback:function(){var t=this.getSelectedRange(),n=t.from,r=t.to,o=Math.min(n.col,r.col),a=Math.max(n.col,r.col);(0,i.rangeEach)(o,a,function(t){return e.hideColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(4),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t,n){"use strict";function r(e){var t=[],n=[];return{key:"hidden_columns_show",name:function(){var r=this.getSelected(),a=0;if(Array.isArray(r)){var l=o(r,4),u=l[1],c=l[3];if(u>c){var f=[c,u];u=f[0],c=f[1]}var h=0;u===c?h=t.length+n.length:(0,i.rangeEach)(u,c,function(t){e.isHidden(t)&&(h+=1)}),a=h<=1?0:1}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_SHOW_COLUMN,a)},callback:function(){var r=this.getSelectedRange(),o=r.from,a=r.to,s=Math.min(o.col,a.col),l=Math.max(o.col,a.col);s===l?(t.length===s&&(e.showColumns(t),t.length=0),n.length===this.countSourceCols()-(s+1)&&(e.showColumns(n),n.length=0)):(0,i.rangeEach)(s,l,function(t){return e.showColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!e.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;t.length=0,n.length=0;var r=this.getSelectedRange(),o=r.from,a=r.to,s=Math.min(o.col,a.col),l=Math.max(o.col,a.col),u=!1;if(s===l){var c=this.countSourceCols();(0,i.rangeEach)(0,c,function(r){if(t.length+n.length===e.hiddenColumns.length)return!1;r<s&&e.isHidden(r)?t.push(r):e.isHidden(r)&&n.push(r)}),c-=1,(t.length===s&&s>0||n.length===c-s&&s<c)&&(u=!0)}else(0,i.rangeEach)(s,l,function(t){if(e.isHidden(t))return u=!0,!1});return!u}}}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(4),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=n(8),f=r(c),h=n(1),d=n(4),p=n(0),g=n(6),v=n(549),m=r(v),y=n(550),w=r(y);n(551);var b=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.settings={},n.hiddenRows=[],n.lastSelectedRow=-1,n}return a(t,e),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(t,n){return e.onAfterGetRowHeader(t,n)}):this.addHook("afterRenderer",function(t,n){return e.onAfterGetRowHeader(n,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,n,r){return e.onAfterGetCellMeta(t,n,r)}),this.addHook("modifyRowHeight",function(t,n){return e.onModifyRowHeight(t,n)}),this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStartOnly(t)}),this.addHook("beforeSetRangeStart",function(t){return e.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)}),this.addHook("hiddenRow",function(t){return e.isHidden(t)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.hot.view&&this.onAfterPluginsInitialized(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this;(0,p.arrayEach)(e,function(e){e=parseInt(e,10),e=t.getLogicalRowIndex(e),t.isHidden(e,!0)&&t.hiddenRows.splice(t.hiddenRows.indexOf(e),1)})}},{key:"showRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this;(0,p.arrayEach)(e,function(e){e=parseInt(e,10),e=t.getLogicalRowIndex(e),t.isHidden(e,!0)||t.hiddenRows.push(e)})}},{key:"hideRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"isHidden",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(e=this.getLogicalRowIndex(e)),this.hiddenRows.indexOf(e)>-1}},{key:"resetCellsMeta",value:function(){(0,p.arrayEach)(this.hot.getCellsMeta(),function(e){e&&(e.skipRowOnPaste=!1)})}},{key:"getLogicalRowIndex",value:function(e){return this.hot.runHooks("modifyRow",e)}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(e=this.hot.runHooks("unmodifyRow",e),n.skipRowOnPaste=!(!1!==this.settings.copyPasteEnabled||!this.isHidden(e)),this.isHidden(e-1)){var r=!0,o=e-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(o)){r=!1;break}o--}while(o>=0);r&&-1===n.className.indexOf("firstVisibleRow")&&(n.className+=" firstVisibleRow")}else if(n.className){var i=n.className.split(" ");if(i.length){var a=i.indexOf("afterHiddenRow"),s=i.indexOf("firstVisibleRow");a>-1&&i.splice(a,1),s>-1&&i.splice(s,1),n.className=i.join(" ")}}}},{key:"onAfterGetRowHeader",value:function(e,t){var n=t.parentNode;n&&(this.isHidden(e)?(0,h.addClass)(n,"hide"):(0,h.removeClass)(n,"hide"));var r=!0,o=e-1;do{if(!this.isHidden(o)){r=!1;break}o--}while(o>=0);r&&(0,h.addClass)(t,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(e-1)&&(0,h.addClass)(t,"afterHiddenRow"),this.isHidden(e+1)&&(0,h.addClass)(t,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?.1:e}},{key:"onModifyCopyableRange",value:function(e){var t=this,n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return(0,p.arrayEach)(e,function(e){var n=!0,o=0;(0,d.rangeEach)(e.startRow,e.endRow,function(i){t.isHidden(i)?(n||r(o,i-1,e.startCol,e.endCol),n=!0):(n&&(o=i),i===e.endRow&&r(o,i,e.startCol,e.endCol),n=!1)})}),n}},{key:"onBeforeSetRangeStart",value:function(e){var t=this,n=this.hot.getSelected()||!1,r=this.hot.countRows()-1;e.row=function e(o){var i=0;return n&&(i=o>n[0]?1:-1,t.lastSelectedRow=n[0]),r<o||o<0?t.lastSelectedRow:(t.isHidden(o)&&(o=e(o+i)),o)}(e.row)}},{key:"onBeforeSetRangeStartOnly",value:function(e){var t=this;if(!(e.row>0)){e.row=0;e.row=function e(n){return t.isHidden(n)&&(n=e(++n)),n}(e.row)}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this,n=this.hot.countRows();e.row=function r(o){return t.isHidden(o)&&(t.lastSelectedRow>o||e.row===n-1?o>0?o=r(--o):(0,d.rangeEach)(0,t.lastSelectedRow,function(e){if(!t.isHidden(e))return o=e,!1}):o=r(++o)),o}(e.row),this.lastSelectedRow=e.row}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:"---------"},(0,m.default)(this),(0,w.default)(this))}},{key:"onAfterCreateRow",value:function(e,t){var n=[];(0,p.arrayEach)(this.hiddenRows,function(r){r>=e&&(r+=t),n.push(r)}),this.hiddenRows=n}},{key:"onAfterRemoveRow",value:function(e,t){var n=[];(0,p.arrayEach)(this.hiddenRows,function(r){r>=e&&(r-=t),n.push(r)}),this.hiddenRows=n}},{key:"onAfterPluginsInitialized",value:function(){var e=this,t=this.hot.getSettings().hiddenRows;"object"===(void 0===t?"undefined":s(t))&&(this.settings=t,void 0===t.copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.rows)&&this.hideRows(t.rows),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);(0,g.registerPlugin)("hiddenRows",b),t.default=b},function(e,t,n){"use strict";function r(e){return{key:"hidden_rows_hide",name:function(){var e=this.getSelected(),t=0;if(Array.isArray(e)){var n=o(e,3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback:function(){var t=this.getSelectedRange(),n=t.from,r=t.to,o=Math.min(n.row,r.row),a=Math.max(n.row,r.row);(0,i.rangeEach)(o,a,function(t){return e.hideRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(4),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t,n){"use strict";function r(e){var t=[],n=[];return{key:"hidden_rows_show",name:function(){var r=this.getSelected(),a=0;if(Array.isArray(r)){var l=o(r,3),u=l[0],c=l[2];if(u>c){var f=[c,u];u=f[0],c=f[1]}var h=0;u===c?h=t.length+n.length:(0,i.rangeEach)(u,c,function(t){e.isHidden(t)&&(h+=1)}),a=h<=1?0:1}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_SHOW_ROW,a)},callback:function(){var r=this.getSelectedRange(),o=r.from,a=r.to,s=Math.min(o.row,a.row),l=Math.max(o.row,a.row);s===l?(t.length===s&&(e.showRows(t),t.length=0),n.length===this.countSourceRows()-(s+1)&&(e.showRows(n),n.length=0)):(0,i.rangeEach)(s,l,function(t){return e.showRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!e.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;t.length=0,n.length=0;var r=this.getSelectedRange(),o=r.from,a=r.to,s=Math.min(o.row,a.row),l=Math.max(o.row,a.row),u=!1;if(s===l){var c=this.countSourceRows();(0,i.rangeEach)(0,c,function(r){if(t.length+n.length===e.hiddenRows.length)return!1;r<s?e.isHidden(r)&&t.push(r):e.isHidden(r)&&n.push(r)}),c-=1,(t.length===s&&s>0||n.length===c-s&&s<c)&&(u=!0)}else(0,i.rangeEach)(s,l,function(t){if(e.isHidden(t))return u=!0,!1});return!u}}}t.__esModule=!0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var i=n(4),a=n(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=n(8),c=r(u),f=n(0),h=n(4),d=n(6),p=n(553),g=r(p),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.trimmedRows=[],n.removedRows=[],n.rowsMapper=new g.default(n),n}return a(t,e),s(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.trimmedRows=n),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(t,n){return e.onModifyRow(t,n)}),this.addHook("unmodifyRow",function(t,n){return e.onUnmodifyRow(t,n)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().trimRows;Array.isArray(e)&&(this.disablePlugin(),this.enablePlugin()),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(e){var t=this;(0,f.arrayEach)(e,function(e){e=parseInt(e,10),t.isTrimmed(e)||t.trimmedRows.push(e)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterTrimRow",e)}},{key:"trimRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this;(0,f.arrayEach)(e,function(e){e=parseInt(e,10),t.isTrimmed(e)&&t.trimmedRows.splice(t.trimmedRows.indexOf(e),1)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterUntrimRow",e)}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRows.indexOf(e)>-1}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"onModifyRow",value:function(e,t){return t!==this.pluginName&&(e=this.rowsMapper.getValueByIndex(e)),e}},{key:"onUnmodifyRow",value:function(e,t){return t!==this.pluginName&&(e=this.rowsMapper.getIndexByValue(e)),e}},{key:"onAfterCreateRow",value:function(e,t){this.rowsMapper.shiftItems(e,t)}},{key:"onBeforeRemoveRow",value:function(e,t){var n=this;this.removedRows.length=0,!1!==e&&(0,h.rangeEach)(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(e,t){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(e){e||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);(0,d.registerPlugin)("trimRows",v),t.default=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(2),l=n(4),u=function(){function e(t){r(this,e),this.trimRows=t}return o(e,[{key:"createMap",value:function(e){var t=this,n=0,r=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,(0,l.rangeEach)(r-1,function(e){t.trimRows.isTrimmed(e)?n++:t._arrayMap[e-n]=e})}},{key:"destroy",value:function(){this._arrayMap=null}}]),e}();(0,s.mixin)(u,a.default),t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_BOTTOM),n}return i(t,e),a(t,[{key:"repositionOverlay",value:function(){var e=(0,s.getScrollbarWidth)(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(e=0),t.style.top="",t.style.bottom=e+"px"}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0;if(e.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var n=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(n.bottom),o=void 0,i=void 0,a=document.body.offsetHeight;o=this.wot.wtTable.hider.style.left,o=""===o?0:o,i=r>a?r-a:0,t=i,i+="px",e.style.top="",e.style.left=o,e.style.bottom=i}else t=this.getScrollPosition(),(0,s.resetCssTransform)(e),this.repositionOverlay();this.adjustHeaderBordersPosition(t)}}},{key:"setScrollPosition",value:function(e){this.mainTableScrollableElement===window?window.scrollTo((0,s.getWindowScrollLeft)(),e):this.mainTableScrollableElement.scrollTop=e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=0,r=this.wot.wtSettings.settings.defaultRowHeight;e<t;){var o=this.wot.wtTable.getRowHeight(e);n+=void 0===o?r:o,e++}return n}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable.holder,t=e.clientWidth===e.offsetWidth?0:(0,s.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,r=n.style,o=void 0;r.width=this.trimmingContainer===window?"":this.wot.wtViewport.getWorkspaceWidth()-t+"px",this.clone.wtTable.holder.style.width=r.width,o=(0,s.outerHeight)(this.clone.wtTable.TABLE),r.height=o+"px"}},{key:"adjustRootChildrenSize",value:function(){var e=(0,s.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;t&&o.offsetHeight!==o.clientHeight&&(i=(0,s.getScrollbarWidth)()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,s.getScrollTop)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(e){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var t=this.wot.wtTable.holder.parentNode,n=(0,s.hasClass)(t,"innerBorderTop");e?(0,s.addClass)(t,"innerBorderTop"):(0,s.removeClass)(t,"innerBorderTop"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");r&&(r.style["border-left-width"]=0)}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM,c),t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_BOTTOM_LEFT_CORNER),n}return i(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsBottom")||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"repositionOverlay",value:function(){var e=(0,s.getScrollbarWidth)(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(e=0),t.style.top="",t.style.bottom=e+"px"}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=(0,s.outerHeight)(this.clone.wtTable.TABLE),n=(0,s.outerWidth)(this.clone.wtTable.TABLE);if(e.style.top="",this.trimmingContainer===window){var r=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(r.bottom),i=Math.ceil(r.left),a=void 0,l=void 0,u=document.body.offsetHeight;a=i<0?-i:0,l=o>u?o-u:0,l+="px",a+="px",e.style.top="",e.style.left=a,e.style.bottom=l}else(0,s.resetCssTransform)(e),this.repositionOverlay();e.style.height=t+"px",e.style.width=n+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM_LEFT_CORNER,c),t.default=c}]).default});